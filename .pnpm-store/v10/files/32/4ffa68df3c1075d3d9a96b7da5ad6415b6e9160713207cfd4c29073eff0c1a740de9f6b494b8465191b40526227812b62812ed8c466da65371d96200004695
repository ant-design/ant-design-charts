/*!
 * @antv/g-plugin-rough-canvas-renderer
 * @description A G plugin of renderer implementation with rough.js
 * @version 2.0.48
 * @date 7/30/2025, 1:38:54 PM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@antv/g-lite")):"function"==typeof define&&define.amd?define(["exports","@antv/g-lite"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).G=t.G||{},t.G.RoughCanvasRenderer={}),t.window.G)}(this,function(t,e){"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function s(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var s=t[Symbol.toPrimitive];if(void 0!==s){var r=s.call(t,e||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}function r(t,e,n){return(e=s(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,s)}return n}function a(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach(function(e){r(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;e.length>n;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function c(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function u(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(u=function(){return!!t})()}function f(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function d(t,n){var s=""+t;if(e.isCSSRGB(t)&&1!==n){var r=t.g,o=t.b,a=t.alpha;s="rgba(".concat(t.r,",").concat(r,",").concat(o,",").concat(Number(a)*n,")")}return s}function g(t){var e=t.parsedStyle,n=e.fill,s=e.stroke,r=e.fillOpacity,o=e.strokeOpacity,a=void 0===o?1:o,i=e.lineWidth,h=void 0===i?1:i,c=e.fillStyle,l=e.fillWeight,u=e.hachureAngle,f=e.hachureGap,p=e.curveStepCount,g=e.curveFitting,y=e.lineDash,b=e.lineDashOffset,k=e.fillLineDash,M=e.fillLineDashOffset,v=e.disableMultiStroke,m=e.disableMultiStrokeFill,S=e.simplification,w=e.dashOffset,O=e.dashGap,P=e.zigzagOffset,x=e.preserveVertices,L={bowing:e.bowing,roughness:e.roughness,seed:e.seed||t.entity,fill:n?d(n,void 0===r?1:r):void 0,stroke:s?d(s,a):"none",strokeWidth:0===h?.1:h,fillStyle:c,fillWeight:l,hachureAngle:u,hachureGap:f,curveStepCount:p,curveFitting:g,strokeLineDash:y,strokeLineDashOffset:b,fillLineDash:k,fillLineDashOffset:M,disableMultiStroke:v,disableMultiStrokeFill:m,simplification:S,dashOffset:w,dashGap:O,zigzagOffset:P,preserveVertices:x};return Object.keys(L).forEach(function(t){void 0===L[t]&&delete L[t]}),L}function y(t,e){return void 0===t||("function"==typeof t?t(e):t)}var b=function(){return c(function t(e){i(this,t),this.options=e},[{key:"render",value:function(t,e,n){if(y(this.options.roughRendering,n)){var s=e.cx,r=e.cy;t.roughCanvas.circle(void 0===s?0:s,void 0===r?0:r,2*e.r,g(n))}else this.options.defaultStyleRendererFactory.render(t,e,n)}}])}(),k=function(){return c(function t(e){i(this,t),this.options=e},[{key:"render",value:function(t,e,n){if(y(this.options.roughRendering,n)){var s=e.cx,r=e.cy;t.roughCanvas.ellipse(void 0===s?0:s,void 0===r?0:r,2*e.rx,2*e.ry,g(n))}else this.options.defaultStyleRendererFactory.render(t,e,n)}}])}(),M=function(){return c(function t(e){i(this,t),this.options=e},[{key:"render",value:function(t,e,n){if(y(this.options.roughRendering,n)){var s=e.x1,r=e.y1,o=e.x2,a=e.y2;t.roughCanvas.line(void 0===s?0:s,void 0===r?0:r,void 0===o?0:o,void 0===a?0:a,g(n))}else this.options.defaultStyleRendererFactory.render(t,e,n)}}])}(),v=function(){return c(function t(e){i(this,t),this.options=e},[{key:"render",value:function(t,n,s){y(this.options.roughRendering,s)?t.roughCanvas.path(e.translatePathToString(n.d.absolutePath),g(s)):this.options.defaultStyleRendererFactory.render(t,n,s)}}])}();function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=Array(e);e>n;n++)s[n]=t[n];return s}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var s,r,o,a,i=[],h=!0,c=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;h=!1}else for(;!(h=(s=o.call(n)).done)&&(i.push(s.value),i.length!==e);h=!0);}catch(t){c=!0,r=t}finally{try{if(!h&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return m(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w=function(){return c(function t(e){i(this,t),this.options=e},[{key:"render",value:function(t,e,n){y(this.options.roughRendering,n)?t.roughCanvas.polygon(e.points.points.map(function(t){var e=S(t,2);return[e[0],e[1]]}),g(n)):this.options.defaultStyleRendererFactory.render(t,e,n)}}])}(),O=function(){return c(function t(e){i(this,t),this.options=e},[{key:"render",value:function(t,e,n){y(this.options.roughRendering,n)?t.roughCanvas.linearPath(e.points.points.map(function(t){var e=S(t,2);return[e[0],e[1]]}),g(n)):this.options.defaultStyleRendererFactory.render(t,e,n)}}])}(),P=function(){return c(function t(e){i(this,t),this.options=e},[{key:"render",value:function(t,e,n){if(y(this.options.roughRendering,n)){var s=e.x,r=e.y;t.roughCanvas.rectangle(void 0===s?0:s,void 0===r?0:r,e.width,e.height,g(n))}else this.options.defaultStyleRendererFactory.render(t,e,n)}}])}();function x(t,e,n){if(t&&t.length){const[s,r]=e,o=Math.PI/180*n,a=Math.cos(o),i=Math.sin(o);for(const e of t){const[t,n]=e;e[0]=(t-s)*a-(n-r)*i+s,e[1]=(t-s)*i+(n-r)*a+r}}}function L(t,e){return t[0]===e[0]&&t[1]===e[1]}function R(t,e,n,s=1){const r=n,o=Math.max(e,.1),a=t[0]&&t[0][0]&&"number"==typeof t[0][0]?[t]:t,i=[0,0];if(r)for(const t of a)x(t,i,r);const h=function(t,e,n){const s=[];for(const e of t){const t=[...e];L(t[0],t[t.length-1])||t.push([t[0][0],t[0][1]]),t.length>2&&s.push(t)}const r=[];e=Math.max(e,.1);const o=[];for(const t of s)for(let e=0;t.length-1>e;e++){const n=t[e],s=t[e+1];if(n[1]!==s[1]){const t=Math.min(n[1],s[1]);o.push({ymin:t,ymax:Math.max(n[1],s[1]),x:t===n[1]?n[0]:s[0],islope:(s[0]-n[0])/(s[1]-n[1])})}}if(o.sort((t,e)=>e.ymin>t.ymin?-1:t.ymin>e.ymin?1:e.x>t.x?-1:t.x>e.x?1:t.ymax===e.ymax?0:(t.ymax-e.ymax)/Math.abs(t.ymax-e.ymax)),!o.length)return r;let a=[],i=o[0].ymin,h=0;for(;a.length||o.length;){if(o.length){let t=-1;for(let e=0;o.length>e&&o[e].ymin<=i;e++)t=e;o.splice(0,t+1).forEach(t=>{a.push({s:i,edge:t})})}if(a=a.filter(t=>t.edge.ymax>i),a.sort((t,e)=>t.edge.x===e.edge.x?0:(t.edge.x-e.edge.x)/Math.abs(t.edge.x-e.edge.x)),(1!==n||h%e===0)&&a.length>1)for(let t=0;a.length>t;t+=2){const e=t+1;if(e>=a.length)break;const n=a[e].edge;r.push([[Math.round(a[t].edge.x),i],[Math.round(n.x),i]])}i+=n,a.forEach(t=>{t.edge.x=t.edge.x+n*t.edge.islope}),h++}return r}(a,o,s);if(r){for(const t of a)x(t,i,-r);!function(t,e,n){const s=[];t.forEach(t=>s.push(...t)),x(s,e,n)}(h,i,-r)}return h}function T(t,e){var n;const s=e.hachureAngle+90;let r=e.hachureGap;0>r&&(r=4*e.strokeWidth),r=Math.round(Math.max(r,.1));let o=1;return 1>e.roughness||((null===(n=e.randomizer)||void 0===n?void 0:n.next())||Math.random())>.7&&(o=r),R(t,r,s,o||1)}class C{constructor(t){this.helper=t}fillPolygons(t,e){return this._fillPolygons(t,e)}_fillPolygons(t,e){const n=T(t,e);return{type:"fillSketch",ops:this.renderLines(n,e)}}renderLines(t,e){const n=[];for(const s of t)n.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],e));return n}}function D(t){const e=t[0],n=t[1];return Math.sqrt(Math.pow(e[0]-n[0],2)+Math.pow(e[1]-n[1],2))}class E extends C{fillPolygons(t,e){let n=e.hachureGap;0>n&&(n=4*e.strokeWidth),n=Math.max(n,.1);const s=T(t,Object.assign({},e,{hachureGap:n})),r=Math.PI/180*e.hachureAngle,o=[],a=.5*n*Math.cos(r),i=.5*n*Math.sin(r);for(const[t,e]of s)D([t,e])&&o.push([[t[0]-a,t[1]+i],[...e]],[[t[0]+a,t[1]-i],[...e]]);return{type:"fillSketch",ops:this.renderLines(o,e)}}}class j extends C{fillPolygons(t,e){const n=this._fillPolygons(t,e),s=Object.assign({},e,{hachureAngle:e.hachureAngle+90}),r=this._fillPolygons(t,s);return n.ops=n.ops.concat(r.ops),n}}class A{constructor(t){this.helper=t}fillPolygons(t,e){const n=T(t,e=Object.assign({},e,{hachureAngle:0}));return this.dotsOnLines(n,e)}dotsOnLines(t,e){const n=[];let s=e.hachureGap;0>s&&(s=4*e.strokeWidth),s=Math.max(s,.1);let r=e.fillWeight;0>r&&(r=e.strokeWidth/2);const o=s/4;for(const a of t){const t=D(a),i=Math.ceil(t/s)-1,h=t-i*s,c=(a[0][0]+a[1][0])/2-s/4,l=Math.min(a[0][1],a[1][1]);for(let t=0;i>t;t++){const a=l+h+t*s,i=c-o+2*Math.random()*o,u=a-o+2*Math.random()*o,f=this.helper.ellipse(i,u,r,r,e);n.push(...f.ops)}}return{type:"fillSketch",ops:n}}}class I{constructor(t){this.helper=t}fillPolygons(t,e){const n=T(t,e);return{type:"fillSketch",ops:this.dashedLine(n,e)}}dashedLine(t,e){const n=0>e.dashOffset?0>e.hachureGap?4*e.strokeWidth:e.hachureGap:e.dashOffset,s=0>e.dashGap?0>e.hachureGap?4*e.strokeWidth:e.hachureGap:e.dashGap,r=[];return t.forEach(t=>{const o=D(t),a=Math.floor(o/(n+s)),i=(o+s-a*(n+s))/2;let h=t[0],c=t[1];h[0]>c[0]&&(h=t[1],c=t[0]);const l=Math.atan((c[1]-h[1])/(c[0]-h[0]));for(let t=0;a>t;t++){const o=t*(n+s),a=o+n,c=[h[0]+o*Math.cos(l)+i*Math.cos(l),h[1]+o*Math.sin(l)+i*Math.sin(l)],u=[h[0]+a*Math.cos(l)+i*Math.cos(l),h[1]+a*Math.sin(l)+i*Math.sin(l)];r.push(...this.helper.doubleLineOps(c[0],c[1],u[0],u[1],e))}}),r}}class _{constructor(t){this.helper=t}fillPolygons(t,e){const n=0>e.hachureGap?4*e.strokeWidth:e.hachureGap,s=0>e.zigzagOffset?n:e.zigzagOffset,r=T(t,e=Object.assign({},e,{hachureGap:n+s}));return{type:"fillSketch",ops:this.zigzagLines(r,s,e)}}zigzagLines(t,e,n){const s=[];return t.forEach(t=>{const r=D(t),o=Math.round(r/(2*e));let a=t[0],i=t[1];a[0]>i[0]&&(a=t[1],i=t[0]);const h=Math.atan((i[1]-a[1])/(i[0]-a[0]));for(let t=0;o>t;t++){const r=2*t*e,o=2*(t+1)*e,i=Math.sqrt(2*Math.pow(e,2)),c=[a[0]+r*Math.cos(h),a[1]+r*Math.sin(h)],l=[a[0]+o*Math.cos(h),a[1]+o*Math.sin(h)],u=[c[0]+i*Math.cos(h+Math.PI/4),c[1]+i*Math.sin(h+Math.PI/4)];s.push(...this.helper.doubleLineOps(c[0],c[1],u[0],u[1],n),...this.helper.doubleLineOps(u[0],u[1],l[0],l[1],n))}}),s}}const F={};class G{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const z={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function W(t,e){return t.type===e}function $(t){const e=[],n=function(t){const e=[];for(;""!==t;)if(t.match(/^([ \t\r\n,]+)/))t=t.substr(RegExp.$1.length);else if(t.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:0,text:RegExp.$1},t=t.substr(RegExp.$1.length);else{if(!t.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];e[e.length]={type:1,text:""+parseFloat(RegExp.$1)},t=t.substr(RegExp.$1.length)}return e[e.length]={type:2,text:""},e}(t);let s="BOD",r=0,o=n[r];for(;!W(o,2);){let a=0;const i=[];if("BOD"===s){if("M"!==o.text&&"m"!==o.text)return $("M0,0"+t);r++,a=z[o.text],s=o.text}else W(o,1)?a=z[s]:(r++,a=z[o.text],s=o.text);if(r+a>=n.length)throw Error("Path data ended short");for(let t=r;r+a>t;t++){const e=n[t];if(!W(e,1))throw Error("Param not a number: "+s+","+e.text);i[i.length]=+e.text}if("number"!=typeof z[s])throw Error("Bad segment: "+s);e.push({key:s,data:i}),r+=a,o=n[r],"M"===s&&(s="L"),"m"===s&&(s="l")}return e}function q(t){let e=0,n=0,s=0,r=0;const o=[];for(const{key:a,data:i}of t)switch(a){case"M":o.push({key:"M",data:[...i]}),[e,n]=i,[s,r]=i;break;case"m":e+=i[0],n+=i[1],o.push({key:"M",data:[e,n]}),s=e,r=n;break;case"L":o.push({key:"L",data:[...i]}),[e,n]=i;break;case"l":e+=i[0],n+=i[1],o.push({key:"L",data:[e,n]});break;case"C":o.push({key:"C",data:[...i]}),e=i[4],n=i[5];break;case"c":{const t=i.map((t,s)=>s%2?t+n:t+e);o.push({key:"C",data:t}),e=t[4],n=t[5];break}case"Q":o.push({key:"Q",data:[...i]}),e=i[2],n=i[3];break;case"q":{const t=i.map((t,s)=>s%2?t+n:t+e);o.push({key:"Q",data:t}),e=t[2],n=t[3];break}case"A":o.push({key:"A",data:[...i]}),e=i[5],n=i[6];break;case"a":e+=i[5],n+=i[6],o.push({key:"A",data:[i[0],i[1],i[2],i[3],i[4],e,n]});break;case"H":o.push({key:"H",data:[...i]}),e=i[0];break;case"h":e+=i[0],o.push({key:"H",data:[e]});break;case"V":o.push({key:"V",data:[...i]}),n=i[0];break;case"v":n+=i[0],o.push({key:"V",data:[n]});break;case"S":o.push({key:"S",data:[...i]}),e=i[2],n=i[3];break;case"s":{const t=i.map((t,s)=>s%2?t+n:t+e);o.push({key:"S",data:t}),e=t[2],n=t[3];break}case"T":o.push({key:"T",data:[...i]}),e=i[0],n=i[1];break;case"t":e+=i[0],n+=i[1],o.push({key:"T",data:[e,n]});break;case"Z":case"z":o.push({key:"Z",data:[]}),e=s,n=r}return o}function N(t){const e=[];let n="",s=0,r=0,o=0,a=0,i=0,h=0;for(const{key:c,data:l}of t){switch(c){case"M":e.push({key:"M",data:[...l]}),[s,r]=l,[o,a]=l;break;case"C":e.push({key:"C",data:[...l]}),s=l[4],r=l[5],i=l[2],h=l[3];break;case"L":e.push({key:"L",data:[...l]}),[s,r]=l;break;case"H":s=l[0],e.push({key:"L",data:[s,r]});break;case"V":r=l[0],e.push({key:"L",data:[s,r]});break;case"S":{let t=0,o=0;"C"===n||"S"===n?(t=s+(s-i),o=r+(r-h)):(t=s,o=r),e.push({key:"C",data:[t,o,...l]}),i=l[0],h=l[1],s=l[2],r=l[3];break}case"T":{const[t,o]=l;let a=0,c=0;"Q"===n||"T"===n?(a=s+(s-i),c=r+(r-h)):(a=s,c=r);e.push({key:"C",data:[s+2*(a-s)/3,r+2*(c-r)/3,t+2*(a-t)/3,o+2*(c-o)/3,t,o]}),i=a,h=c,s=t,r=o;break}case"Q":{const[t,n,o,a]=l;e.push({key:"C",data:[s+2*(t-s)/3,r+2*(n-r)/3,o+2*(t-o)/3,a+2*(n-a)/3,o,a]}),i=t,h=n,s=o,r=a;break}case"A":{const t=Math.abs(l[0]),n=Math.abs(l[1]),o=l[2],a=l[3],i=l[4],h=l[5],c=l[6];if(0===t||0===n)e.push({key:"C",data:[s,r,h,c,h,c]}),s=h,r=c;else if(s!==h||r!==c){H(s,r,h,c,t,n,o,a,i).forEach(function(t){e.push({key:"C",data:t})}),s=h,r=c}break}case"Z":e.push({key:"Z",data:[]}),s=o,r=a}n=c}return e}function V(t,e,n){return[t*Math.cos(n)-e*Math.sin(n),t*Math.sin(n)+e*Math.cos(n)]}function H(t,e,n,s,r,o,a,i,h,c){const l=Math.PI*a/180;let u=[],f=0,p=0,d=0,g=0;if(c)[f,p,d,g]=c;else{[t,e]=V(t,e,-l),[n,s]=V(n,s,-l);const a=(t-n)/2,c=(e-s)/2;let u=a*a/(r*r)+c*c/(o*o);u>1&&(u=Math.sqrt(u),r*=u,o*=u);const y=r*r,b=o*o,k=(i===h?-1:1)*Math.sqrt(Math.abs((y*b-y*c*c-b*a*a)/(y*c*c+b*a*a)));d=k*r*c/o+(t+n)/2,g=k*-o*a/r+(e+s)/2,f=Math.asin(parseFloat(((e-g)/o).toFixed(9))),p=Math.asin(parseFloat(((s-g)/o).toFixed(9))),d>t&&(f=Math.PI-f),d>n&&(p=Math.PI-p),0>f&&(f=2*Math.PI+f),0>p&&(p=2*Math.PI+p),h&&f>p&&(f-=2*Math.PI),!h&&p>f&&(p-=2*Math.PI)}let y=p-f;if(Math.abs(y)>120*Math.PI/180){const t=p,e=n,i=s;p=h&&p>f?f+120*Math.PI/180*1:f+120*Math.PI/180*-1,u=H(n=d+r*Math.cos(p),s=g+o*Math.sin(p),e,i,r,o,a,0,h,[p,t,d,g])}y=p-f;const b=Math.cos(f),k=Math.sin(f),M=Math.cos(p),v=Math.sin(p),m=Math.tan(y/4),S=4/3*r*m,w=4/3*o*m,O=[t,e],P=[t+S*k,e-w*b],x=[n+S*v,s-w*M],L=[n,s];if(P[0]=2*O[0]-P[0],P[1]=2*O[1]-P[1],c)return[P,x,L].concat(u);{u=[P,x,L].concat(u);const t=[];for(let e=0;u.length>e;e+=3){const n=V(u[e][0],u[e][1],l),s=V(u[e+1][0],u[e+1][1],l),r=V(u[e+2][0],u[e+2][1],l);t.push([n[0],n[1],s[0],s[1],r[0],r[1]])}return t}}const Z={randOffset:function(t,e){return at(t,e)},randOffsetWithRange:function(t,e,n){return ot(t,e,n)},ellipse:function(t,e,n,s,r){const o=X(n,s,r);return J(t,e,r,o).opset},doubleLineOps:function(t,e,n,s,r){return it(t,e,n,s,r,!0)}};function Q(t,e,n,s,r){return{type:"path",ops:it(t,e,n,s,r)}}function B(t,e,n){const s=(t||[]).length;if(s>2){const r=[];for(let e=0;s-1>e;e++)r.push(...it(t[e][0],t[e][1],t[e+1][0],t[e+1][1],n));return e&&r.push(...it(t[s-1][0],t[s-1][1],t[0][0],t[0][1],n)),{type:"path",ops:r}}return 2===s?Q(t[0][0],t[0][1],t[1][0],t[1][1],n):{type:"path",ops:[]}}function Y(t,e,n,s,r){return function(t,e){return B(t,!0,e)}([[t,e],[t+n,e],[t+n,e+s],[t,e+s]],r)}function U(t,e){if(t.length){const n="number"==typeof t[0][0]?[t]:t,s=ct(n[0],1*(1+.2*e.roughness),e),r=e.disableMultiStroke?[]:ct(n[0],1.5*(1+.22*e.roughness),st(e));for(let t=1;n.length>t;t++){const o=n[t];if(o.length){const t=ct(o,1*(1+.2*e.roughness),e),n=e.disableMultiStroke?[]:ct(o,1.5*(1+.22*e.roughness),st(e));for(const e of t)"move"!==e.op&&s.push(e);for(const t of n)"move"!==t.op&&r.push(t)}}return{type:"path",ops:s.concat(r)}}return{type:"path",ops:[]}}function X(t,e,n){const s=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),r=2*Math.PI/Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*s));let o=Math.abs(t/2),a=Math.abs(e/2);const i=1-n.curveFitting;return o+=at(o*i,n),a+=at(a*i,n),{increment:r,rx:o,ry:a}}function J(t,e,n,s){const[r,o]=ut(s.increment,t,e,s.rx,s.ry,1,s.increment*ot(.1,ot(.4,1,n),n),n);let a=lt(r,null,n);if(!n.disableMultiStroke&&0!==n.roughness){const[r]=ut(s.increment,t,e,s.rx,s.ry,1.5,0,n),o=lt(r,null,n);a=a.concat(o)}return{estimatedPoints:o,opset:{type:"path",ops:a}}}function K(t,e,n,s,r,o,a,i,h){const c=t,l=e;let u=Math.abs(n/2),f=Math.abs(s/2);u+=at(.01*u,h),f+=at(.01*f,h);let p=r,d=o;for(;0>p;)p+=2*Math.PI,d+=2*Math.PI;d-p>2*Math.PI&&(p=0,d=2*Math.PI);const g=Math.min(2*Math.PI/h.curveStepCount/2,(d-p)/2),y=ft(g,c,l,u,f,p,d,1,h);if(!h.disableMultiStroke){const t=ft(g,c,l,u,f,p,d,1.5,h);y.push(...t)}return a&&(i?y.push(...it(c,l,c+u*Math.cos(p),l+f*Math.sin(p),h),...it(c,l,c+u*Math.cos(d),l+f*Math.sin(d),h)):y.push({op:"lineTo",data:[c,l]},{op:"lineTo",data:[c+u*Math.cos(p),l+f*Math.sin(p)]})),{type:"path",ops:y}}function tt(t,e){const n=N(q($(t))),s=[];let r=[0,0],o=[0,0];for(const{key:t,data:a}of n)switch(t){case"M":o=[a[0],a[1]],r=[a[0],a[1]];break;case"L":s.push(...it(o[0],o[1],a[0],a[1],e)),o=[a[0],a[1]];break;case"C":{const[t,n,r,i,h,c]=a;s.push(...pt(t,n,r,i,h,c,o,e)),o=[h,c];break}case"Z":s.push(...it(o[0],o[1],r[0],r[1],e)),o=[r[0],r[1]]}return{type:"path",ops:s}}function et(t,e){const n=[];for(const s of t)if(s.length){const t=e.maxRandomnessOffset||0,r=s.length;if(r>2){n.push({op:"move",data:[s[0][0]+at(t,e),s[0][1]+at(t,e)]});for(let o=1;r>o;o++)n.push({op:"lineTo",data:[s[o][0]+at(t,e),s[o][1]+at(t,e)]})}}return{type:"fillPath",ops:n}}function nt(t,e){return function(t,e){let n=t.fillStyle||"hachure";if(!F[n])switch(n){case"zigzag":F[n]||(F[n]=new E(e));break;case"cross-hatch":F[n]||(F[n]=new j(e));break;case"dots":F[n]||(F[n]=new A(e));break;case"dashed":F[n]||(F[n]=new I(e));break;case"zigzag-line":F[n]||(F[n]=new _(e));break;default:n="hachure",F[n]||(F[n]=new C(e))}return F[n]}(e,Z).fillPolygons(t,e)}function st(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function rt(t){return t.randomizer||(t.randomizer=new G(t.seed||0)),t.randomizer.next()}function ot(t,e,n,s=1){return n.roughness*s*(rt(n)*(e-t)+t)}function at(t,e,n=1){return ot(-t,t,e,n)}function it(t,e,n,s,r,o=!1){const a=o?r.disableMultiStrokeFill:r.disableMultiStroke,i=ht(t,e,n,s,r,!0,!1);if(a)return i;const h=ht(t,e,n,s,r,!0,!0);return i.concat(h)}function ht(t,e,n,s,r,o,a){const i=Math.pow(t-n,2)+Math.pow(e-s,2),h=Math.sqrt(i);let c=1;c=200>h?1:h>500?.4:-.0016668*h+1.233334;let l=r.maxRandomnessOffset||0;l*l*100>i&&(l=h/10);const u=l/2,f=.2+.2*rt(r);let p=r.bowing*r.maxRandomnessOffset*(s-e)/200,d=r.bowing*r.maxRandomnessOffset*(t-n)/200;p=at(p,r,c),d=at(d,r,c);const g=[],y=()=>at(u,r,c),b=()=>at(l,r,c),k=r.preserveVertices;return o&&g.push(a?{op:"move",data:[t+(k?0:y()),e+(k?0:y())]}:{op:"move",data:[t+(k?0:at(l,r,c)),e+(k?0:at(l,r,c))]}),g.push(a?{op:"bcurveTo",data:[p+t+(n-t)*f+y(),d+e+(s-e)*f+y(),p+t+2*(n-t)*f+y(),d+e+2*(s-e)*f+y(),n+(k?0:y()),s+(k?0:y())]}:{op:"bcurveTo",data:[p+t+(n-t)*f+b(),d+e+(s-e)*f+b(),p+t+2*(n-t)*f+b(),d+e+2*(s-e)*f+b(),n+(k?0:b()),s+(k?0:b())]}),g}function ct(t,e,n){if(!t.length)return[];const s=[];s.push([t[0][0]+at(e,n),t[0][1]+at(e,n)]),s.push([t[0][0]+at(e,n),t[0][1]+at(e,n)]);for(let r=1;t.length>r;r++)s.push([t[r][0]+at(e,n),t[r][1]+at(e,n)]),r===t.length-1&&s.push([t[r][0]+at(e,n),t[r][1]+at(e,n)]);return lt(s,null,n)}function lt(t,e,n){const s=t.length,r=[];if(s>3){const o=[],a=1-n.curveTightness;r.push({op:"move",data:[t[1][0],t[1][1]]});for(let e=1;s>e+2;e++){const n=t[e];o[0]=[n[0],n[1]],o[1]=[n[0]+(a*t[e+1][0]-a*t[e-1][0])/6,n[1]+(a*t[e+1][1]-a*t[e-1][1])/6],o[2]=[t[e+1][0]+(a*t[e][0]-a*t[e+2][0])/6,t[e+1][1]+(a*t[e][1]-a*t[e+2][1])/6],o[3]=[t[e+1][0],t[e+1][1]],r.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}if(e&&2===e.length){const t=n.maxRandomnessOffset;r.push({op:"lineTo",data:[e[0]+at(t,n),e[1]+at(t,n)]})}}else 3===s?(r.push({op:"move",data:[t[1][0],t[1][1]]}),r.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):2===s&&r.push(...ht(t[0][0],t[0][1],t[1][0],t[1][1],n,!0,!0));return r}function ut(t,e,n,s,r,o,a,i){const h=[],c=[];if(0===i.roughness){c.push([e+s*Math.cos(-(t/=4)),n+r*Math.sin(-t)]);for(let o=0;2*Math.PI>=o;o+=t){const t=[e+s*Math.cos(o),n+r*Math.sin(o)];h.push(t),c.push(t)}c.push([e+1*s,n+0*r]),c.push([e+s*Math.cos(t),n+r*Math.sin(t)])}else{const l=at(.5,i)-Math.PI/2;c.push([at(o,i)+e+.9*s*Math.cos(l-t),at(o,i)+n+.9*r*Math.sin(l-t)]);const u=2*Math.PI+l-.01;for(let a=l;u>a;a+=t){const t=[at(o,i)+e+s*Math.cos(a),at(o,i)+n+r*Math.sin(a)];h.push(t),c.push(t)}c.push([at(o,i)+e+s*Math.cos(l+2*Math.PI+.5*a),at(o,i)+n+r*Math.sin(l+2*Math.PI+.5*a)]),c.push([at(o,i)+e+.98*s*Math.cos(l+a),at(o,i)+n+.98*r*Math.sin(l+a)]),c.push([at(o,i)+e+.9*s*Math.cos(l+.5*a),at(o,i)+n+.9*r*Math.sin(l+.5*a)])}return[c,h]}function ft(t,e,n,s,r,o,a,i,h){const c=o+at(.1,h),l=[];l.push([at(i,h)+e+.9*s*Math.cos(c-t),at(i,h)+n+.9*r*Math.sin(c-t)]);for(let o=c;a>=o;o+=t)l.push([at(i,h)+e+s*Math.cos(o),at(i,h)+n+r*Math.sin(o)]);return l.push([e+s*Math.cos(a),n+r*Math.sin(a)]),l.push([e+s*Math.cos(a),n+r*Math.sin(a)]),lt(l,null,h)}function pt(t,e,n,s,r,o,a,i){const h=[],c=[i.maxRandomnessOffset||1,(i.maxRandomnessOffset||1)+.3];let l=[0,0];const u=i.disableMultiStroke?1:2,f=i.preserveVertices;for(let p=0;u>p;p++)h.push(0===p?{op:"move",data:[a[0],a[1]]}:{op:"move",data:[a[0]+(f?0:at(c[0],i)),a[1]+(f?0:at(c[0],i))]}),l=f?[r,o]:[r+at(c[p],i),o+at(c[p],i)],h.push({op:"bcurveTo",data:[t+at(c[p],i),e+at(c[p],i),n+at(c[p],i),s+at(c[p],i),l[0],l[1]]});return h}function dt(t){return[...t]}function gt(t,e=0){const n=t.length;if(3>n)throw Error("A curve must have at least three points.");const s=[];if(3===n)s.push(dt(t[0]),dt(t[1]),dt(t[2]),dt(t[2]));else{const n=[];n.push(t[0],t[0]);for(let e=1;t.length>e;e++)n.push(t[e]),e===t.length-1&&n.push(t[e]);const r=[],o=1-e;s.push(dt(n[0]));for(let t=1;n.length>t+2;t++){const e=n[t];r[0]=[e[0],e[1]],r[1]=[e[0]+(o*n[t+1][0]-o*n[t-1][0])/6,e[1]+(o*n[t+1][1]-o*n[t-1][1])/6],r[2]=[n[t+1][0]+(o*n[t][0]-o*n[t+2][0])/6,n[t+1][1]+(o*n[t][1]-o*n[t+2][1])/6],r[3]=[n[t+1][0],n[t+1][1]],s.push(r[1],r[2],r[3])}}return s}function yt(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function bt(t,e,n){const s=yt(e,n);if(0===s)return yt(t,e);let r=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/s;return r=Math.max(0,Math.min(1,r)),yt(t,kt(e,n,r))}function kt(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function Mt(t,e,n,s){const r=s||[];if(function(t,e){const n=t[e+0],s=t[e+1],r=t[e+2],o=t[e+3];let a=3*s[0]-2*n[0]-o[0];a*=a;let i=3*s[1]-2*n[1]-o[1];i*=i;let h=3*r[0]-2*o[0]-n[0];h*=h;let c=3*r[1]-2*o[1]-n[1];return c*=c,h>a&&(a=h),c>i&&(i=c),a+i}(t,e)<n){const n=t[e+0];if(r.length){Math.sqrt(yt(r[r.length-1],n))>1&&r.push(n)}else r.push(n);r.push(t[e+3])}else{const s=.5,o=t[e+0],a=t[e+1],i=t[e+2],h=t[e+3],c=kt(o,a,s),l=kt(a,i,s),u=kt(i,h,s),f=kt(c,l,s),p=kt(l,u,s),d=kt(f,p,s);Mt([o,c,f,d],0,n,r),Mt([d,p,u,h],0,n,r)}return r}function vt(t,e){return mt(t,0,t.length,e)}function mt(t,e,n,s,r){const o=r||[],a=t[e],i=t[n-1];let h=0,c=1;for(let s=e+1;n-1>s;++s){const e=bt(t[s],a,i);e>h&&(h=e,c=s)}return Math.sqrt(h)>s?(mt(t,e,c+1,s,o),mt(t,c,n,s,o)):(o.length||o.push(a),o.push(i)),o}function St(t,e=.15,n){const s=[],r=(t.length-1)/3;for(let n=0;r>n;n++){Mt(t,3*n,e,s)}return n&&n>0?mt(s,0,s.length,n):s}const wt="none";class Ot{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,e,n){return{shape:t,sets:e||[],options:n||this.defaultOptions}}line(t,e,n,s,r){const o=this._o(r);return this._d("line",[Q(t,e,n,s,o)],o)}rectangle(t,e,n,s,r){const o=this._o(r),a=[],i=Y(t,e,n,s,o);if(o.fill){const r=[[t,e],[t+n,e],[t+n,e+s],[t,e+s]];a.push("solid"===o.fillStyle?et([r],o):nt([r],o))}return o.stroke!==wt&&a.push(i),this._d("rectangle",a,o)}ellipse(t,e,n,s,r){const o=this._o(r),a=[],i=X(n,s,o),h=J(t,e,o,i);if(o.fill)if("solid"===o.fillStyle){const n=J(t,e,o,i).opset;n.type="fillPath",a.push(n)}else a.push(nt([h.estimatedPoints],o));return o.stroke!==wt&&a.push(h.opset),this._d("ellipse",a,o)}circle(t,e,n,s){const r=this.ellipse(t,e,n,n,s);return r.shape="circle",r}linearPath(t,e){const n=this._o(e);return this._d("linearPath",[B(t,!1,n)],n)}arc(t,e,n,s,r,o,a=!1,i){const h=this._o(i),c=[],l=K(t,e,n,s,r,o,a,!0,h);if(a&&h.fill)if("solid"===h.fillStyle){const a=Object.assign({},h);a.disableMultiStroke=!0;const i=K(t,e,n,s,r,o,!0,!1,a);i.type="fillPath",c.push(i)}else c.push(function(t,e,n,s,r,o,a){const i=t,h=e;let c=Math.abs(n/2),l=Math.abs(s/2);c+=at(.01*c,a),l+=at(.01*l,a);let u=r,f=o;for(;0>u;)u+=2*Math.PI,f+=2*Math.PI;f-u>2*Math.PI&&(u=0,f=2*Math.PI);const p=(f-u)/a.curveStepCount,d=[];for(let t=u;f>=t;t+=p)d.push([i+c*Math.cos(t),h+l*Math.sin(t)]);return d.push([i+c*Math.cos(f),h+l*Math.sin(f)]),d.push([i,h]),nt([d],a)}(t,e,n,s,r,o,h));return h.stroke!==wt&&c.push(l),this._d("arc",c,h)}curve(t,e){const n=this._o(e),s=[],r=U(t,n);if(n.fill&&n.fill!==wt)if("solid"===n.fillStyle){const e=U(t,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(e.ops)})}else{const e=[];if(t.length){const s="number"==typeof t[0][0]?[t]:t;for(const t of s)3>t.length?e.push(...t):3===t.length?e.push(...St(gt([t[0],t[0],t[1],t[2]]),10,(1+n.roughness)/2)):e.push(...St(gt(t),10,(1+n.roughness)/2))}e.length&&s.push(nt([e],n))}return n.stroke!==wt&&s.push(r),this._d("curve",s,n)}polygon(t,e){const n=this._o(e),s=[],r=B(t,!0,n);return n.fill&&s.push("solid"===n.fillStyle?et([t],n):nt([t],n)),n.stroke!==wt&&s.push(r),this._d("polygon",s,n)}path(t,e){const n=this._o(e),s=[];if(!t)return this._d("path",s,n);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const r=n.fill&&"transparent"!==n.fill&&n.fill!==wt,o=n.stroke!==wt,a=!(!n.simplification||n.simplification>=1),i=function(t,e,n){const s=N(q($(t))),r=[];let o=[],a=[0,0],i=[];const h=()=>{4>i.length||o.push(...St(i,e)),i=[]},c=()=>{h(),o.length&&(r.push(o),o=[])};for(const{key:t,data:e}of s)switch(t){case"M":c(),a=[e[0],e[1]],o.push(a);break;case"L":h(),o.push([e[0],e[1]]);break;case"C":if(!i.length){const t=o.length?o[o.length-1]:a;i.push([t[0],t[1]])}i.push([e[0],e[1]]),i.push([e[2],e[3]]),i.push([e[4],e[5]]);break;case"Z":h(),o.push([a[0],a[1]])}if(c(),!n)return r;const l=[];for(const t of r){const e=vt(t,n);e.length&&l.push(e)}return l}(t,1,a?4-4*(n.simplification||1):(1+n.roughness)/2),h=tt(t,n);if(r)if("solid"===n.fillStyle)if(1===i.length){const e=tt(t,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(e.ops)})}else s.push(et(i,n));else s.push(nt(i,n));return o&&(a?i.forEach(t=>{s.push(B(t,!1,n))}):s.push(h)),this._d("path",s,n)}opsToPath(t,e){let n="";for(const s of t.ops){const t="number"!=typeof e||0>e?s.data:s.data.map(t=>+t.toFixed(e));switch(s.op){case"move":n+=`M${t[0]} ${t[1]} `;break;case"bcurveTo":n+=`C${t[0]} ${t[1]}, ${t[2]} ${t[3]}, ${t[4]} ${t[5]} `;break;case"lineTo":n+=`L${t[0]} ${t[1]} `}}return n.trim()}toPaths(t){const e=t.sets||[],n=t.options||this.defaultOptions,s=[];for(const t of e){let e=null;switch(t.type){case"path":e={d:this.opsToPath(t),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:wt};break;case"fillPath":e={d:this.opsToPath(t),stroke:wt,strokeWidth:0,fill:n.fill||wt};break;case"fillSketch":e=this.fillSketch(t,n)}e&&s.push(e)}return s}fillSketch(t,e){let n=e.fillWeight;return 0>n&&(n=e.strokeWidth/2),{d:this.opsToPath(t),stroke:e.fill||wt,strokeWidth:n,fill:wt}}_mergedShape(t){return t.filter((t,e)=>0===e||"move"!==t.op)}}class Pt{constructor(t,e){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Ot(e)}draw(t){const e=t.sets||[],n=t.options||this.getDefaultOptions(),s=this.ctx,r=t.options.fixedDecimalPlaceDigits;for(const o of e)switch(o.type){case"path":s.save(),s.strokeStyle="none"===n.stroke?"transparent":n.stroke,s.lineWidth=n.strokeWidth,n.strokeLineDash&&s.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(s.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(s,o,r),s.restore();break;case"fillPath":s.save(),s.fillStyle=n.fill||"";this._drawToContext(s,o,r,"curve"===t.shape||"polygon"===t.shape||"path"===t.shape?"evenodd":"nonzero"),s.restore();break;case"fillSketch":this.fillSketch(s,o,n)}}fillSketch(t,e,n){let s=n.fillWeight;0>s&&(s=n.strokeWidth/2),t.save(),n.fillLineDash&&t.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(t.lineDashOffset=n.fillLineDashOffset),t.strokeStyle=n.fill||"",t.lineWidth=s,this._drawToContext(t,e,n.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,e,n,s="nonzero"){t.beginPath();for(const s of e.ops){const e="number"!=typeof n||0>n?s.data:s.data.map(t=>+t.toFixed(n));switch(s.op){case"move":t.moveTo(e[0],e[1]);break;case"bcurveTo":t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5]);break;case"lineTo":t.lineTo(e[0],e[1])}}"fillPath"===e.type?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,e,n,s,r){const o=this.gen.line(t,e,n,s,r);return this.draw(o),o}rectangle(t,e,n,s,r){const o=this.gen.rectangle(t,e,n,s,r);return this.draw(o),o}ellipse(t,e,n,s,r){const o=this.gen.ellipse(t,e,n,s,r);return this.draw(o),o}circle(t,e,n,s){const r=this.gen.circle(t,e,n,s);return this.draw(r),r}linearPath(t,e){const n=this.gen.linearPath(t,e);return this.draw(n),n}polygon(t,e){const n=this.gen.polygon(t,e);return this.draw(n),n}arc(t,e,n,s,r,o,a=!1,i){const h=this.gen.arc(t,e,n,s,r,o,a,i);return this.draw(h),h}curve(t,e){const n=this.gen.curve(t,e);return this.draw(n),n}path(t,e){const n=this.gen.path(t,e);return this.draw(n),n}}const xt="http://www.w3.org/2000/svg";class Lt{constructor(t,e){this.svg=t,this.gen=new Ot(e)}draw(t){const e=t.sets||[],n=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,r=s.createElementNS(xt,"g"),o=t.options.fixedDecimalPlaceDigits;for(const a of e){let e=null;switch(a.type){case"path":e=s.createElementNS(xt,"path"),e.setAttribute("d",this.opsToPath(a,o)),e.setAttribute("stroke",n.stroke),e.setAttribute("stroke-width",n.strokeWidth+""),e.setAttribute("fill","none"),n.strokeLineDash&&e.setAttribute("stroke-dasharray",n.strokeLineDash.join(" ").trim()),n.strokeLineDashOffset&&e.setAttribute("stroke-dashoffset",""+n.strokeLineDashOffset);break;case"fillPath":e=s.createElementNS(xt,"path"),e.setAttribute("d",this.opsToPath(a,o)),e.setAttribute("stroke","none"),e.setAttribute("stroke-width","0"),e.setAttribute("fill",n.fill||""),"curve"!==t.shape&&"polygon"!==t.shape||e.setAttribute("fill-rule","evenodd");break;case"fillSketch":e=this.fillSketch(s,a,n)}e&&r.appendChild(e)}return r}fillSketch(t,e,n){let s=n.fillWeight;0>s&&(s=n.strokeWidth/2);const r=t.createElementNS(xt,"path");return r.setAttribute("d",this.opsToPath(e,n.fixedDecimalPlaceDigits)),r.setAttribute("stroke",n.fill||""),r.setAttribute("stroke-width",s+""),r.setAttribute("fill","none"),n.fillLineDash&&r.setAttribute("stroke-dasharray",n.fillLineDash.join(" ").trim()),n.fillLineDashOffset&&r.setAttribute("stroke-dashoffset",""+n.fillLineDashOffset),r}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,e){return this.gen.opsToPath(t,e)}line(t,e,n,s,r){const o=this.gen.line(t,e,n,s,r);return this.draw(o)}rectangle(t,e,n,s,r){const o=this.gen.rectangle(t,e,n,s,r);return this.draw(o)}ellipse(t,e,n,s,r){const o=this.gen.ellipse(t,e,n,s,r);return this.draw(o)}circle(t,e,n,s){const r=this.gen.circle(t,e,n,s);return this.draw(r)}linearPath(t,e){const n=this.gen.linearPath(t,e);return this.draw(n)}polygon(t,e){const n=this.gen.polygon(t,e);return this.draw(n)}arc(t,e,n,s,r,o,a=!1,i){const h=this.gen.arc(t,e,n,s,r,o,a,i);return this.draw(h)}curve(t,e){const n=this.gen.curve(t,e);return this.draw(n)}path(t,e){const n=this.gen.path(t,e);return this.draw(n)}}var Rt={canvas:(t,e)=>new Pt(t,e),svg:(t,e)=>new Lt(t,e),generator:t=>new Ot(t),newSeed:()=>Ot.newSeed()},Tt=function(){function t(){i(this,t)}return c(t,[{key:"apply",value:function(e){var n=e.config,s=e.contextService,r=e.renderingService;r.hooks.init.tap(t.tag,function(){n.renderer.getConfig().enableDirtyCheck=!1,n.renderer.getConfig().enableDirtyRectangleRendering=!1,s.getContext().roughCanvas=Rt.canvas(s.getDomElement())}),r.hooks.destroy.tap(t.tag,function(){})}}])}();Tt.tag="RoughCanvasRenderer",t.Plugin=function(t){function n(t){var e,s,r,o;return i(this,n),s=this,r=l(r=n),(e=f(s,u()?Reflect.construct(r,o||[],l(s).constructor):r.apply(s,o))).name="rough-canvas-renderer",e.options=t,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(n,t),c(n,[{key:"init",value:function(){var t,n=this.context.defaultStyleRendererFactory,s=this.options||{};this.context.styleRendererFactory=(r(r(r(r(r(r(r(r(r(r(t={},e.Shape.CIRCLE,new b(a({defaultStyleRendererFactory:n[e.Shape.CIRCLE]},s))),e.Shape.ELLIPSE,new k(a({defaultStyleRendererFactory:n[e.Shape.ELLIPSE]},s))),e.Shape.RECT,new P(a({defaultStyleRendererFactory:n[e.Shape.RECT]},s))),e.Shape.IMAGE,n[e.Shape.IMAGE]),e.Shape.TEXT,n[e.Shape.TEXT]),e.Shape.LINE,new M(a({defaultStyleRendererFactory:n[e.Shape.LINE]},s))),e.Shape.POLYLINE,new O(a({defaultStyleRendererFactory:n[e.Shape.POLYLINE]},s))),e.Shape.POLYGON,new w(a({defaultStyleRendererFactory:n[e.Shape.POLYGON]},s))),e.Shape.PATH,new v(a({defaultStyleRendererFactory:n[e.Shape.PATH]},s))),e.Shape.GROUP,void 0),r(r(t,e.Shape.HTML,void 0),e.Shape.MESH,void 0)),this.addRenderingPlugin(new Tt)}},{key:"destroy",value:function(){this.context.styleRendererFactory=this.context.defaultStyleRendererFactory,this.removeAllRenderingPlugins()}}])}(e.AbstractRendererPlugin)});
//# sourceMappingURL=index.umd.min.js.map
