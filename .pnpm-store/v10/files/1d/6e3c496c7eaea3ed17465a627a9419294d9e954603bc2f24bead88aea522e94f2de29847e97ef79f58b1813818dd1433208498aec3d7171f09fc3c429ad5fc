{"version":3,"file":"index.js","sources":["../src/plugins/canvas-renderer/CanvasRendererPlugin.ts","../src/plugins/canvas-renderer/shapes/styles/helper.ts","../src/plugins/canvas-renderer/shapes/styles/OptimizedDefault.ts","../src/plugins/canvas-renderer/shapes/styles/Default.ts","../src/plugins/canvas-renderer/utils/math.ts","../src/plugins/canvas-renderer/shapes/styles/Image.ts","../src/plugins/canvas-renderer/shapes/styles/Text.ts","../src/plugins/canvas-renderer/index.ts","../src/plugins/picker/CanvasPickerPlugin.ts","../src/plugins/picker/Circle.ts","../src/plugins/picker/Ellipse.ts","../src/plugins/picker/utils/math.ts","../src/plugins/picker/Line.ts","../src/plugins/picker/Path.ts","../src/plugins/picker/Polygon.ts","../src/plugins/picker/Polyline.ts","../src/plugins/picker/Rect.ts","../src/plugins/picker/Image.ts","../src/plugins/picker/Text.ts","../src/plugins/picker/index.ts","../src/plugins/path-generator/paths/Circle.ts","../src/plugins/path-generator/paths/Ellipse.ts","../src/plugins/path-generator/paths/Line.ts","../src/plugins/path-generator/paths/Path.ts","../src/plugins/path-generator/paths/Polygon.ts","../src/plugins/path-generator/paths/Polyline.ts","../src/plugins/path-generator/paths/Rect.ts","../src/plugins/path-generator/index.ts","../src/Canvas2DContextService.ts","../src/ContextRegisterPlugin.ts","../src/index.ts"],"sourcesContent":["import type {\n  DisplayObject,\n  RenderingPlugin,\n  RenderingPluginContext,\n  ContextService,\n  CanvasContext,\n  GlobalRuntime,\n  ParsedBaseStyleProps,\n  CSSRGB,\n} from '@antv/g-lite';\nimport { AABB, CanvasEvent, CustomEvent, Shape, Node } from '@antv/g-lite';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { isNil } from '@antv/util';\nimport type { CanvasRendererPluginOptions } from './interfaces';\nimport type { Plugin } from '.';\n\ninterface Rect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport interface RenderState {\n  restoreStack: DisplayObject[];\n  prevObject: DisplayObject;\n  currentContext: Map<keyof CanvasRenderingContext2D | 'lineDash', unknown>;\n}\n\n/**\n * support 2 modes in rendering:\n * * immediate\n * * delayed: render at the end of frame with dirty-rectangle\n */\nexport class CanvasRendererPlugin implements RenderingPlugin {\n  static tag = 'CanvasRenderer';\n\n  private context: Plugin['context'];\n\n  private pathGeneratorFactory: Plugin['context']['pathGeneratorFactory'];\n\n  constructor(\n    private canvasRendererPluginOptions: CanvasRendererPluginOptions, // private styleRendererFactory: Record<Shape, StyleRenderer>,\n  ) {}\n\n  private renderQueue: DisplayObject[] = [];\n\n  #renderState: RenderState = {\n    restoreStack: [],\n    prevObject: null,\n    currentContext: new Map(),\n  };\n\n  private clearFullScreenLastFrame = false;\n  private clearFullScreen = false;\n\n  /**\n   * view projection matrix\n   */\n  private vpMatrix = mat4.create();\n  private dprMatrix = mat4.create();\n  private tmpMat4 = mat4.create();\n  private vec3a = vec3.create();\n  private vec3b = vec3.create();\n  private vec3c = vec3.create();\n  private vec3d = vec3.create();\n\n  apply(context: RenderingPluginContext, runtime: GlobalRuntime) {\n    this.context = context as unknown as Plugin['context'];\n\n    const {\n      config,\n      camera,\n      renderingService,\n      renderingContext,\n      // @ts-ignore\n      pathGeneratorFactory,\n    } = this.context;\n    let enableRenderingOptimization =\n      config.renderer.getConfig().enableRenderingOptimization;\n\n    config.renderer.getConfig().enableDirtyCheck = false;\n    config.renderer.getConfig().enableDirtyRectangleRendering = false;\n\n    this.pathGeneratorFactory = pathGeneratorFactory;\n\n    const contextService =\n      context.contextService as ContextService<CanvasRenderingContext2D>;\n\n    const canvas = renderingContext.root.ownerDocument.defaultView;\n\n    renderingService.hooks.init.tap(CanvasRendererPlugin.tag, () => {\n      // clear fullscreen\n      const dpr = contextService.getDPR();\n      const { width, height } = config;\n      const context = contextService.getContext();\n      this.clearRect(\n        context,\n        0,\n        0,\n        width * dpr,\n        height * dpr,\n        config.background,\n      );\n    });\n\n    renderingService.hooks.destroy.tap(CanvasRendererPlugin.tag, () => {\n      this.renderQueue = [];\n      this.#renderState = {\n        restoreStack: [],\n        prevObject: null,\n        currentContext: null,\n      };\n    });\n\n    const beforeDraw = () => {\n      const context = contextService.getContext();\n      const dpr = contextService.getDPR();\n      const { width, height } = config;\n      const { dirtyObjectNumThreshold, dirtyObjectRatioThreshold } =\n        this.canvasRendererPluginOptions;\n\n      // some heuristic conditions such as 80% object changed\n      const { total, rendered } = renderingService.getStats();\n      const ratio = rendered / total;\n\n      this.clearFullScreen =\n        this.clearFullScreenLastFrame ||\n        // @ts-ignore\n        !canvas.context.renderingPlugins[1]?.isFirstTimeRenderingFinished ||\n        renderingService.disableDirtyRectangleRendering() ||\n        (rendered > dirtyObjectNumThreshold &&\n          ratio > dirtyObjectRatioThreshold);\n\n      if (!context) {\n        return;\n      }\n\n      if (typeof context.resetTransform === 'function') {\n        context.resetTransform();\n      } else {\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      }\n\n      if (this.clearFullScreen) {\n        this.clearRect(\n          context,\n          0,\n          0,\n          width * dpr,\n          height * dpr,\n          config.background,\n        );\n      }\n    };\n\n    /**\n     * render objects by z-index\n     *\n     * - The level of the child node will be affected by the level of the parent node\n     */\n    const renderByZIndex = (\n      object: DisplayObject,\n      context: CanvasRenderingContext2D,\n    ) => {\n      const stack = [object];\n\n      while (stack.length > 0) {\n        const currentObject = stack.pop();\n\n        if (currentObject.isVisible() && !currentObject.isCulled()) {\n          if (enableRenderingOptimization) {\n            this.renderDisplayObjectOptimized(\n              currentObject,\n              context,\n              this.context,\n              this.#renderState,\n              runtime,\n            );\n          } else {\n            this.renderDisplayObject(\n              currentObject,\n              context,\n              this.context,\n              this.#renderState,\n              runtime,\n            );\n          }\n        }\n\n        const objects =\n          currentObject.sortable?.sorted?.length > 0\n            ? currentObject.sortable.sorted\n            : currentObject.childNodes;\n        // should account for z-index\n        for (let i = objects.length - 1; i >= 0; i--) {\n          stack.push(objects[i] as unknown as DisplayObject);\n        }\n      }\n    };\n\n    // render at the end of frame\n    renderingService.hooks.endFrame.tap(CanvasRendererPlugin.tag, () => {\n      beforeDraw();\n\n      // Skip rendering.\n      if (renderingContext.root.childNodes.length === 0) {\n        this.clearFullScreenLastFrame = true;\n        return;\n      }\n\n      enableRenderingOptimization =\n        config.renderer.getConfig().enableRenderingOptimization;\n\n      // init\n      this.#renderState = {\n        restoreStack: [],\n        prevObject: null,\n        currentContext: this.#renderState.currentContext,\n      };\n      this.#renderState.currentContext.clear();\n      this.clearFullScreenLastFrame = false;\n\n      const context = contextService.getContext();\n      // clear & clip dirty rectangle\n      const dpr = contextService.getDPR();\n      mat4.fromScaling(this.dprMatrix, [dpr, dpr, 1]);\n      mat4.multiply(this.vpMatrix, this.dprMatrix, camera.getOrthoMatrix());\n\n      if (this.clearFullScreen) {\n        // console.time('renderByZIndex');\n        if (enableRenderingOptimization) {\n          context.save();\n          renderByZIndex(renderingContext.root, context);\n          context.restore();\n        } else {\n          renderByZIndex(renderingContext.root, context);\n        }\n        // console.timeEnd('renderByZIndex');\n      } else {\n        // console.log('canvas renderer next...', this.renderQueue);\n        // merge removed AABB\n        const dirtyRenderBounds = this.safeMergeAABB(\n          this.mergeDirtyAABBs(this.renderQueue),\n        );\n\n        if (AABB.isEmpty(dirtyRenderBounds)) {\n          this.renderQueue = [];\n          return;\n        }\n\n        const dirtyRect = this.convertAABB2Rect(dirtyRenderBounds);\n        const { x, y, width, height } = dirtyRect;\n\n        const tl = vec3.transformMat4(this.vec3a, [x, y, 0], this.vpMatrix);\n        const tr = vec3.transformMat4(\n          this.vec3b,\n          [x + width, y, 0],\n          this.vpMatrix,\n        );\n        const bl = vec3.transformMat4(\n          this.vec3c,\n          [x, y + height, 0],\n          this.vpMatrix,\n        );\n        const br = vec3.transformMat4(\n          this.vec3d,\n          [x + width, y + height, 0],\n          this.vpMatrix,\n        );\n\n        const minx = Math.min(tl[0], tr[0], br[0], bl[0]);\n        const miny = Math.min(tl[1], tr[1], br[1], bl[1]);\n        const maxx = Math.max(tl[0], tr[0], br[0], bl[0]);\n        const maxy = Math.max(tl[1], tr[1], br[1], bl[1]);\n\n        const ix = Math.floor(minx);\n        const iy = Math.floor(miny);\n        const iwidth = Math.ceil(maxx - minx);\n        const iheight = Math.ceil(maxy - miny);\n\n        context.save();\n        this.clearRect(context, ix, iy, iwidth, iheight, config.background);\n        context.beginPath();\n        context.rect(ix, iy, iwidth, iheight);\n        context.clip();\n\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n        context.setTransform(\n          this.vpMatrix[0],\n          this.vpMatrix[1],\n          this.vpMatrix[4],\n          this.vpMatrix[5],\n          this.vpMatrix[12],\n          this.vpMatrix[13],\n        );\n\n        // draw dirty rectangle\n        const { enableDirtyRectangleRenderingDebug } =\n          config.renderer.getConfig();\n        if (enableDirtyRectangleRenderingDebug) {\n          canvas.dispatchEvent(\n            new CustomEvent(CanvasEvent.DIRTY_RECTANGLE, {\n              dirtyRect: {\n                x: ix,\n                y: iy,\n                width: iwidth,\n                height: iheight,\n              },\n            }),\n          );\n        }\n\n        // search objects intersect with dirty rectangle\n        const [minX, minY] = dirtyRenderBounds.getMin();\n        const [maxX, maxY] = dirtyRenderBounds.getMax();\n        const dirtyObjects =\n          renderingContext.root.ownerDocument.elementsFromBBox(\n            minX,\n            minY,\n            maxX,\n            maxY,\n          );\n\n        // do rendering\n        dirtyObjects\n          // sort by z-index\n          .sort((a, b) => a.sortable.renderOrder - b.sortable.renderOrder)\n          .forEach((object) => {\n            // culled object should not be rendered\n            if (object && object.isVisible() && !object.isCulled()) {\n              this.renderDisplayObject(\n                object,\n                context,\n                this.context,\n                this.#renderState,\n                runtime,\n              );\n            }\n          });\n\n        context.restore();\n\n        // save dirty AABBs in last frame\n        this.renderQueue.forEach((object) => {\n          this.saveDirtyAABB(object);\n        });\n\n        // clear queue\n        this.renderQueue = [];\n      }\n\n      // pop restore stack, eg. root -> parent -> child\n      this.#renderState.restoreStack.forEach(() => {\n        context.restore();\n      });\n      // clear restore stack\n      this.#renderState.restoreStack = [];\n    });\n\n    renderingService.hooks.render.tap(\n      CanvasRendererPlugin.tag,\n      (object: DisplayObject) => {\n        if (!this.clearFullScreen) {\n          // render at the end of frame\n          this.renderQueue.push(object);\n        }\n      },\n    );\n  }\n\n  private clearRect(\n    context: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    background: string,\n  ) {\n    // clearRect is faster than fillRect @see https://stackoverflow.com/a/30830253\n    context.clearRect(x, y, width, height);\n    if (background) {\n      context.fillStyle = background;\n      context.fillRect(x, y, width, height);\n    }\n  }\n\n  renderDisplayObjectOptimized(\n    object: DisplayObject,\n    context: CanvasRenderingContext2D,\n    canvasContext: CanvasContext,\n    renderState: RenderState,\n    runtime: GlobalRuntime,\n  ) {\n    const nodeName = object.nodeName as Shape;\n    let updateTransform = false;\n    let clipDraw = false;\n\n    // @ts-ignore\n    const styleRenderer = this.context.styleRendererFactory[nodeName];\n    const generatePath = this.pathGeneratorFactory[nodeName];\n\n    // clip path\n    const { clipPath } = object.parsedStyle;\n    if (clipPath) {\n      updateTransform =\n        !renderState.prevObject ||\n        !mat4.exactEquals(\n          clipPath.getWorldTransform(),\n          renderState.prevObject.getWorldTransform(),\n        );\n\n      if (updateTransform) {\n        this.applyWorldTransform(context, clipPath);\n        renderState.prevObject = null;\n      }\n\n      // generate path in local space\n      const generatePath =\n        this.pathGeneratorFactory[clipPath.nodeName as Shape];\n      if (generatePath) {\n        context.save();\n        clipDraw = true;\n\n        context.beginPath();\n        generatePath(context, clipPath.parsedStyle);\n        context.closePath();\n        context.clip();\n      }\n    }\n\n    // fill & stroke\n\n    if (styleRenderer) {\n      updateTransform =\n        !renderState.prevObject ||\n        !mat4.exactEquals(\n          object.getWorldTransform(),\n          renderState.prevObject.getWorldTransform(),\n        );\n\n      if (updateTransform) {\n        this.applyWorldTransform(context, object);\n      }\n\n      let forceUpdateStyle = !renderState.prevObject;\n      if (!forceUpdateStyle) {\n        const prevNodeName = renderState.prevObject.nodeName as Shape;\n\n        if (nodeName === Shape.TEXT) {\n          forceUpdateStyle = prevNodeName !== Shape.TEXT;\n        } else if (nodeName === Shape.IMAGE) {\n          forceUpdateStyle = prevNodeName !== Shape.IMAGE;\n        } else {\n          forceUpdateStyle =\n            prevNodeName === Shape.TEXT || prevNodeName === Shape.IMAGE;\n        }\n      }\n\n      styleRenderer.applyStyleToContext(\n        context,\n        object,\n        forceUpdateStyle,\n        renderState,\n      );\n\n      renderState.prevObject = object;\n    }\n\n    if (generatePath) {\n      context.beginPath();\n      generatePath(context, object.parsedStyle);\n      if (\n        nodeName !== Shape.LINE &&\n        nodeName !== Shape.PATH &&\n        nodeName !== Shape.POLYLINE\n      ) {\n        context.closePath();\n      }\n    }\n\n    // fill & stroke\n    if (styleRenderer) {\n      styleRenderer.drawToContext(\n        context,\n        object,\n        this.#renderState,\n        this,\n        runtime,\n      );\n    }\n\n    if (clipDraw) {\n      context.restore();\n    }\n\n    // finish rendering, clear dirty flag\n    object.dirty(false);\n  }\n\n  renderDisplayObject(\n    object: DisplayObject,\n    context: CanvasRenderingContext2D,\n    canvasContext: CanvasContext,\n    renderState: RenderState,\n    runtime: GlobalRuntime,\n  ) {\n    const nodeName = object.nodeName as Shape;\n\n    // restore to its ancestor\n\n    const parent =\n      renderState.restoreStack[renderState.restoreStack.length - 1];\n    if (\n      parent &&\n      !(\n        object.compareDocumentPosition(parent) & Node.DOCUMENT_POSITION_CONTAINS\n      )\n    ) {\n      context.restore();\n      renderState.restoreStack.pop();\n    }\n\n    // @ts-ignore\n    const styleRenderer = this.context.styleRendererFactory[nodeName];\n    const generatePath = this.pathGeneratorFactory[nodeName];\n\n    // clip path\n    const { clipPath } = object.parsedStyle;\n    if (clipPath) {\n      this.applyWorldTransform(context, clipPath);\n\n      // generate path in local space\n      const generatePath =\n        this.pathGeneratorFactory[clipPath.nodeName as Shape];\n      if (generatePath) {\n        context.save();\n\n        // save clip\n        renderState.restoreStack.push(object);\n\n        context.beginPath();\n        generatePath(context, clipPath.parsedStyle);\n        context.closePath();\n        context.clip();\n      }\n    }\n\n    // fill & stroke\n\n    if (styleRenderer) {\n      this.applyWorldTransform(context, object);\n\n      context.save();\n\n      // apply attributes to context\n      this.applyAttributesToContext(context, object);\n    }\n\n    if (generatePath) {\n      context.beginPath();\n      generatePath(context, object.parsedStyle);\n      if (\n        nodeName !== Shape.LINE &&\n        nodeName !== Shape.PATH &&\n        nodeName !== Shape.POLYLINE\n      ) {\n        context.closePath();\n      }\n    }\n\n    // fill & stroke\n    if (styleRenderer) {\n      styleRenderer.render(\n        context,\n        object.parsedStyle,\n        object,\n        canvasContext,\n        this,\n        runtime,\n      );\n\n      // restore applied attributes, eg. shadowBlur shadowColor...\n      context.restore();\n    }\n\n    // finish rendering, clear dirty flag\n    object.dirty(false);\n  }\n\n  private applyAttributesToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n  ) {\n    const { stroke, fill, opacity, lineDash, lineDashOffset } =\n      object.parsedStyle as ParsedBaseStyleProps;\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setLineDash\n    if (lineDash) {\n      context.setLineDash(lineDash);\n    }\n\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineDashOffset\n    if (!isNil(lineDashOffset)) {\n      context.lineDashOffset = lineDashOffset;\n    }\n\n    if (!isNil(opacity)) {\n      context.globalAlpha *= opacity;\n    }\n\n    if (\n      !isNil(stroke) &&\n      !Array.isArray(stroke) &&\n      !(stroke as CSSRGB).isNone\n    ) {\n      context.strokeStyle = object.attributes.stroke as string;\n    }\n\n    if (!isNil(fill) && !Array.isArray(fill) && !(fill as CSSRGB).isNone) {\n      context.fillStyle = object.attributes.fill as string;\n    }\n  }\n\n  private convertAABB2Rect(aabb: AABB): Rect {\n    const min = aabb.getMin();\n    const max = aabb.getMax();\n    // expand the rectangle a bit to avoid artifacts\n    // @see https://www.yuque.com/antv/ou292n/bi8nix#ExvCu\n    const minX = Math.floor(min[0]);\n    const minY = Math.floor(min[1]);\n    const maxX = Math.ceil(max[0]);\n    const maxY = Math.ceil(max[1]);\n    const width = maxX - minX;\n    const height = maxY - minY;\n\n    return { x: minX, y: minY, width, height };\n  }\n\n  /**\n   * TODO: merge dirty rectangles with some strategies.\n   * For now, we just simply merge all the rectangles into one.\n   * @see https://idom.me/articles/841.html\n   */\n  private mergeDirtyAABBs(dirtyObjects: DisplayObject[]): AABB {\n    // merge into a big AABB\n    // TODO: skip descendant if ancestor is caculated, but compareNodePosition is really slow\n    const aabb = new AABB();\n    dirtyObjects.forEach((object) => {\n      const renderBounds = object.getRenderBounds();\n      aabb.add(renderBounds);\n\n      const { dirtyRenderBounds } = object.renderable;\n      if (dirtyRenderBounds) {\n        aabb.add(dirtyRenderBounds);\n      }\n    });\n\n    return aabb;\n  }\n\n  private saveDirtyAABB(object: DisplayObject) {\n    const { renderable } = object;\n    if (!renderable.dirtyRenderBounds) {\n      renderable.dirtyRenderBounds = new AABB();\n    }\n    const renderBounds = object.getRenderBounds();\n    if (renderBounds) {\n      // save last dirty aabb\n      renderable.dirtyRenderBounds.update(\n        renderBounds.center,\n        renderBounds.halfExtents,\n      );\n    }\n  }\n\n  private applyWorldTransform(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    matrix?: mat4,\n  ) {\n    // apply clip shape's RTS\n    if (matrix) {\n      mat4.copy(this.tmpMat4, object.getLocalTransform());\n      mat4.multiply(this.tmpMat4, matrix, this.tmpMat4);\n      mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n    } else {\n      // apply RTS transformation in world space\n      mat4.copy(this.tmpMat4, object.getWorldTransform());\n      mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n    }\n\n    // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n    context.setTransform(\n      this.tmpMat4[0],\n      this.tmpMat4[1],\n      this.tmpMat4[4],\n      this.tmpMat4[5],\n      this.tmpMat4[12],\n      this.tmpMat4[13],\n    );\n  }\n\n  private safeMergeAABB(...aabbs: AABB[]): AABB {\n    const merged = new AABB();\n    aabbs.forEach((aabb) => {\n      merged.add(aabb);\n    });\n    return merged;\n  }\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  DisplayObject,\n  GlobalRuntime,\n  LinearGradient,\n  Pattern,\n  RadialGradient,\n  Rect,\n  GradientType,\n  ImagePool,\n} from '@antv/g-lite';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\n\nexport function getPattern(\n  pattern: Pattern,\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n): CanvasPattern {\n  let $offscreenCanvas: HTMLCanvasElement;\n  let dpr: number;\n  if ((pattern.image as Rect).nodeName === 'rect') {\n    const { width, height } = (pattern.image as Rect).parsedStyle;\n    dpr = canvasContext.contextService.getDPR();\n    const { offscreenCanvas } = canvasContext.config;\n    $offscreenCanvas = runtime.offscreenCanvasCreator.getOrCreateCanvas(\n      offscreenCanvas,\n    ) as HTMLCanvasElement;\n\n    $offscreenCanvas.width = width * dpr;\n    $offscreenCanvas.height = height * dpr;\n\n    const offscreenCanvasContext =\n      runtime.offscreenCanvasCreator.getOrCreateContext(\n        offscreenCanvas,\n      ) as CanvasRenderingContext2D;\n\n    const renderState: RenderState = {\n      restoreStack: [],\n      prevObject: null,\n      currentContext: new Map(),\n    };\n\n    // offscreenCanvasContext.scale(1 / dpr, 1 / dpr);\n\n    (pattern.image as Rect).forEach((object: DisplayObject) => {\n      plugin.renderDisplayObject(\n        object,\n        offscreenCanvasContext,\n        canvasContext,\n        renderState,\n        runtime,\n      );\n    });\n\n    renderState.restoreStack.forEach(() => {\n      offscreenCanvasContext.restore();\n    });\n  }\n\n  const canvasPattern = imagePool.getOrCreatePatternSync(\n    object,\n    pattern,\n    context,\n    $offscreenCanvas,\n    dpr,\n    object.getGeometryBounds().min,\n    () => {\n      // set dirty rectangle flag\n      object.dirty();\n      canvasContext.renderingService.dirty();\n    },\n  );\n\n  return canvasPattern;\n}\n\nexport function getColor(\n  parsedColor: CSSGradientValue,\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  imagePool: ImagePool,\n) {\n  let color: CanvasGradient | string;\n\n  if (\n    parsedColor.type === GradientType.LinearGradient ||\n    parsedColor.type === GradientType.RadialGradient\n  ) {\n    const bounds = object.getGeometryBounds();\n    const width = (bounds && bounds.halfExtents[0] * 2) || 1;\n    const height = (bounds && bounds.halfExtents[1] * 2) || 1;\n    const min = (bounds && bounds.min) || [0, 0];\n    color = imagePool.getOrCreateGradient(\n      {\n        type: parsedColor.type,\n        ...(parsedColor.value as LinearGradient & RadialGradient),\n        min: min as [number, number],\n        width,\n        height,\n      },\n      context,\n    );\n  }\n\n  return color;\n}\n","import {\n  CanvasContext,\n  CSSRGB,\n  DisplayObject,\n  GlobalRuntime,\n  ParsedBaseStyleProps,\n  isPattern,\n  Shape,\n  type ImagePool,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\nimport type { StyleRenderer } from './interfaces';\nimport { getColor, getPattern } from './helper';\n\nconst SHADOW_NUMBER_STYLE = [\n  'shadowBlur',\n  'shadowOffsetX',\n  'shadowOffsetY',\n] as const;\nconst STROKE_STYLE = ['lineCap', 'lineJoin', 'miterLimit'] as const;\nexport const DEFAULT_STYLE = {\n  // common\n  globalAlpha: 1,\n  shadowBlur: 0,\n  shadowOffsetX: 0,\n  shadowOffsetY: 0,\n  shadowColor: '#000',\n  filter: 'none' as const,\n  globalCompositeOperation: 'source-over' as const,\n\n  // stroke/fill\n  strokeStyle: '#000',\n  strokeOpacity: 1,\n  lineWidth: 1,\n  lineDash: [],\n  lineDashOffset: 0,\n  lineCap: 'butt' as const,\n  lineJoin: 'miter' as const,\n  miterLimit: 10,\n  fillStyle: '#000',\n  fillOpacity: 1,\n\n  // image\n};\n\nconst defaultParsedStyle = {} as ParsedBaseStyleProps;\n\n/**\n * Updating the canvas context is an expensive operation. The state of the context is cached and the actual update operation is performed only when the cache is not hit.\n *\n * In any case, the previous value is returned, which is convenient for temporarily updating the context and restoring it later.\n */\nfunction updateContextIfNotHitCache<\n  K extends keyof CanvasRenderingContext2D | 'lineDash',\n  V = unknown,\n>(context: CanvasRenderingContext2D, key: K, value: V, cache: Map<K, unknown>) {\n  const prevValue = (\n    cache.has(key)\n      ? cache.get(key)\n      : DEFAULT_STYLE[key as keyof typeof DEFAULT_STYLE]\n  ) as V;\n\n  if (prevValue !== value) {\n    // console.log('not hit cache', key, value, prevValue, cache);\n    if (key === 'lineDash') {\n      context.setLineDash(value as number[]);\n    } else {\n      // @ts-ignore\n      context[key] = value;\n    }\n    cache.set(key, value);\n  }\n\n  return prevValue;\n}\n\nexport class OptimizedDefaultRenderer implements StyleRenderer {\n  constructor(public imagePool: ImagePool) {}\n\n  applyAttributesToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n  ) {}\n\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedBaseStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {}\n\n  // #region common style\n  private applyCommonStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    forceUpdate: boolean,\n    renderState: RenderState,\n  ) {\n    // const dpr = object.ownerDocument.defaultView.getContextService().getDPR();\n    const prevStyle = forceUpdate\n      ? defaultParsedStyle\n      : renderState.prevObject.parsedStyle;\n    const style = object.parsedStyle;\n\n    if (forceUpdate || style.opacity !== prevStyle.opacity) {\n      updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        !isNil(style.opacity) ? style.opacity : DEFAULT_STYLE.globalAlpha,\n        renderState.currentContext,\n      );\n    }\n\n    // TODO blend prop\n    // @ts-ignore\n    if (forceUpdate || style.blend !== prevStyle.blend) {\n      updateContextIfNotHitCache(\n        context,\n        'globalCompositeOperation',\n        // @ts-ignore\n        !isNil(style.blend)\n          ? // @ts-ignore\n            style.blend\n          : DEFAULT_STYLE.globalCompositeOperation,\n        renderState.currentContext,\n      );\n    }\n  }\n  // #endregion common style\n\n  // #region stroke/fill style\n  private applyStrokeFillStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    forceUpdate: boolean,\n    renderState: RenderState,\n  ) {\n    const prevStyle = forceUpdate\n      ? defaultParsedStyle\n      : renderState.prevObject.parsedStyle;\n    const style = object.parsedStyle;\n    const { lineWidth = DEFAULT_STYLE.lineWidth } = style;\n    const hasFill = style.fill && !(style.fill as CSSRGB).isNone;\n    const hasStroke =\n      style.stroke && !(style.stroke as CSSRGB).isNone && lineWidth > 0;\n\n    if (hasStroke) {\n      if (\n        forceUpdate ||\n        object.attributes.stroke !== renderState.prevObject.attributes.stroke\n      ) {\n        const value =\n          !isNil(style.stroke) &&\n          !Array.isArray(style.stroke) &&\n          !(style.stroke as CSSRGB).isNone\n            ? object.attributes.stroke\n            : DEFAULT_STYLE.strokeStyle;\n\n        updateContextIfNotHitCache(\n          context,\n          'strokeStyle',\n          value,\n          renderState.currentContext,\n        );\n      }\n\n      if (forceUpdate || style.lineWidth !== prevStyle.lineWidth) {\n        updateContextIfNotHitCache(\n          context,\n          'lineWidth',\n          !isNil(style.lineWidth) ? style.lineWidth : DEFAULT_STYLE.lineWidth,\n          renderState.currentContext,\n        );\n      }\n\n      if (forceUpdate || style.lineDash !== prevStyle.lineDash) {\n        updateContextIfNotHitCache(\n          context,\n          'lineDash',\n          style.lineDash || DEFAULT_STYLE.lineDash,\n          renderState.currentContext,\n        );\n      }\n\n      if (forceUpdate || style.lineDashOffset !== prevStyle.lineDashOffset) {\n        updateContextIfNotHitCache(\n          context,\n          'lineDashOffset',\n          !isNil(style.lineDashOffset)\n            ? style.lineDashOffset\n            : DEFAULT_STYLE.lineDashOffset,\n          renderState.currentContext,\n        );\n      }\n\n      for (let i = 0; i < STROKE_STYLE.length; i++) {\n        const styleName = STROKE_STYLE[i];\n        if (forceUpdate || style[styleName] !== prevStyle[styleName]) {\n          updateContextIfNotHitCache(\n            context,\n            styleName,\n            !isNil(style[styleName])\n              ? style[styleName]\n              : DEFAULT_STYLE[styleName],\n            renderState.currentContext,\n          );\n        }\n      }\n    }\n\n    if (\n      hasFill &&\n      (forceUpdate ||\n        object.attributes.fill !== renderState.prevObject.attributes.fill)\n    ) {\n      const value =\n        !isNil(style.fill) &&\n        !Array.isArray(style.fill) &&\n        !(style.fill as CSSRGB).isNone\n          ? object.attributes.fill\n          : DEFAULT_STYLE.fillStyle;\n\n      updateContextIfNotHitCache(\n        context,\n        'fillStyle',\n        value,\n        renderState.currentContext,\n      );\n    }\n  }\n  // #endregion stroke/fill style\n\n  applyStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    forceUpdate: boolean,\n    renderState: RenderState,\n  ) {\n    const nodeName = object.nodeName as Shape;\n\n    this.applyCommonStyleToContext(context, object, forceUpdate, renderState);\n\n    if (nodeName === Shape.IMAGE) {\n      //\n    } else {\n      this.applyStrokeFillStyleToContext(\n        context,\n        object,\n        forceUpdate,\n        renderState,\n      );\n    }\n  }\n\n  applyShadowAndFilterStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    hasShadow: boolean,\n    renderState: RenderState,\n  ) {\n    const style = object.parsedStyle;\n\n    if (hasShadow) {\n      updateContextIfNotHitCache(\n        context,\n        'shadowColor',\n        style.shadowColor.toString(),\n        renderState.currentContext,\n      );\n      for (let i = 0; i < SHADOW_NUMBER_STYLE.length; i++) {\n        const styleName = SHADOW_NUMBER_STYLE[i];\n        updateContextIfNotHitCache(\n          context,\n          styleName,\n          style[styleName] || DEFAULT_STYLE[styleName],\n          renderState.currentContext,\n        );\n      }\n    }\n\n    if (style.filter && style.filter.length) {\n      updateContextIfNotHitCache(\n        context,\n        'filter',\n        // use raw filter string\n        object.attributes.filter,\n        renderState.currentContext,\n      );\n    }\n  }\n\n  clearShadowAndFilterStyleForContext(\n    context: CanvasRenderingContext2D,\n    hasShadow: boolean,\n    hasFilter: boolean,\n    renderState: RenderState,\n    onlyClearShadowFilter = false,\n  ) {\n    if (hasShadow) {\n      updateContextIfNotHitCache(\n        context,\n        'shadowColor',\n        DEFAULT_STYLE.shadowColor,\n        renderState.currentContext,\n      );\n      for (let i = 0; i < SHADOW_NUMBER_STYLE.length; i++) {\n        const styleName = SHADOW_NUMBER_STYLE[i];\n        updateContextIfNotHitCache(\n          context,\n          styleName,\n          DEFAULT_STYLE[styleName],\n          renderState.currentContext,\n        );\n      }\n    }\n\n    if (hasFilter) {\n      if (hasShadow && onlyClearShadowFilter) {\n        // save drop-shadow filter\n        const oldFilter = context.filter;\n        if (!isNil(oldFilter) && oldFilter.indexOf('drop-shadow') > -1) {\n          updateContextIfNotHitCache(\n            context,\n            'filter',\n            oldFilter.replace(/drop-shadow\\([^)]*\\)/, '').trim() ||\n              DEFAULT_STYLE.filter,\n            renderState.currentContext,\n          );\n        }\n      } else {\n        updateContextIfNotHitCache(\n          context,\n          'filter',\n          DEFAULT_STYLE.filter,\n          renderState.currentContext,\n        );\n      }\n    }\n  }\n\n  fillToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const { fill, fillRule } = object.parsedStyle;\n    let resetStyle = null as unknown;\n\n    if (Array.isArray(fill) && fill.length > 0) {\n      fill.forEach((gradient) => {\n        const prevStyle = updateContextIfNotHitCache(\n          context,\n          'fillStyle',\n          getColor(gradient, object, context, this.imagePool),\n          renderState.currentContext,\n        );\n        resetStyle = resetStyle ?? prevStyle;\n\n        if (fillRule) {\n          context.fill(fillRule);\n        } else {\n          context.fill();\n        }\n      });\n    } else {\n      if (isPattern(fill)) {\n        const pattern = getPattern(\n          fill,\n          object,\n          context,\n          object.ownerDocument.defaultView.context,\n          plugin,\n          runtime,\n          this.imagePool,\n        );\n        if (pattern) {\n          context.fillStyle = pattern;\n          resetStyle = true;\n        }\n      }\n\n      if (fillRule) {\n        context.fill(fillRule);\n      } else {\n        context.fill();\n      }\n    }\n\n    if (resetStyle !== null) {\n      updateContextIfNotHitCache(\n        context,\n        'fillStyle',\n        resetStyle,\n        renderState.currentContext,\n      );\n    }\n  }\n\n  strokeToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const { stroke } = object.parsedStyle;\n    let resetStyle = null as unknown;\n\n    if (Array.isArray(stroke) && stroke.length > 0) {\n      stroke.forEach((gradient) => {\n        const prevStyle = updateContextIfNotHitCache(\n          context,\n          'strokeStyle',\n          getColor(gradient, object, context, this.imagePool),\n          renderState.currentContext,\n        );\n        resetStyle = resetStyle ?? prevStyle;\n\n        context.stroke();\n      });\n    } else {\n      if (isPattern(stroke)) {\n        const pattern = getPattern(\n          stroke,\n          object,\n          context,\n          object.ownerDocument.defaultView.context,\n          plugin,\n          runtime,\n          this.imagePool,\n        );\n        if (pattern) {\n          const prevStyle = updateContextIfNotHitCache(\n            context,\n            'strokeStyle',\n            pattern,\n            renderState.currentContext,\n          );\n          resetStyle = resetStyle ?? prevStyle;\n        }\n      }\n\n      context.stroke();\n    }\n\n    if (resetStyle !== null) {\n      updateContextIfNotHitCache(\n        context,\n        'strokeStyle',\n        resetStyle,\n        renderState.currentContext,\n      );\n    }\n  }\n\n  drawToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const nodeName = object.nodeName as Shape;\n    const style = object.parsedStyle;\n    const {\n      opacity = DEFAULT_STYLE.globalAlpha,\n      fillOpacity = DEFAULT_STYLE.fillOpacity,\n      strokeOpacity = DEFAULT_STYLE.strokeOpacity,\n      lineWidth = DEFAULT_STYLE.lineWidth,\n    } = style;\n\n    const hasFill = style.fill && !(style.fill as CSSRGB).isNone;\n    const hasStroke =\n      style.stroke && !(style.stroke as CSSRGB).isNone && lineWidth > 0;\n\n    if (!hasFill && !hasStroke) {\n      return;\n    }\n\n    const hasShadow = !isNil(style.shadowColor) && style.shadowBlur > 0;\n    const isInnerShadow = style.shadowType === 'inner';\n    const isFillTransparent = (style.fill as CSSRGB)?.alpha === 0;\n    const hasFilter = !!(style.filter && style.filter.length);\n    // Shadows can only be applied to fill() or stroke(), the default is fill()\n    const shouldDrawShadowWithStroke =\n      hasShadow &&\n      hasStroke &&\n      (nodeName === Shape.PATH ||\n        nodeName === Shape.LINE ||\n        nodeName === Shape.POLYLINE ||\n        isFillTransparent ||\n        isInnerShadow);\n\n    // TODO https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/paint-order\n\n    let originGlobalAlpha: number | null = null;\n\n    if (hasFill) {\n      if (!shouldDrawShadowWithStroke) {\n        this.applyShadowAndFilterStyleToContext(\n          context,\n          object,\n          hasShadow,\n          renderState,\n        );\n      }\n\n      const updateOpacity = opacity * fillOpacity;\n\n      originGlobalAlpha = updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        updateOpacity,\n        renderState.currentContext,\n      );\n\n      this.fillToContext(context, object, renderState, plugin, runtime);\n\n      if (!shouldDrawShadowWithStroke) {\n        this.clearShadowAndFilterStyleForContext(\n          context,\n          hasShadow,\n          hasFilter,\n          renderState,\n        );\n      }\n    }\n    if (hasStroke) {\n      let clearShadowAndFilter = false;\n      const updateOpacity = opacity * strokeOpacity;\n      const prevOpacity = updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        updateOpacity,\n        renderState.currentContext,\n      );\n      originGlobalAlpha = hasFill ? originGlobalAlpha : prevOpacity;\n\n      if (shouldDrawShadowWithStroke) {\n        this.applyShadowAndFilterStyleToContext(\n          context,\n          object,\n          hasShadow,\n          renderState,\n        );\n        clearShadowAndFilter = true;\n\n        if (isInnerShadow) {\n          const originBlend = context.globalCompositeOperation;\n          context.globalCompositeOperation = 'source-atop';\n\n          this.strokeToContext(context, object, renderState, plugin, runtime);\n\n          context.globalCompositeOperation = originBlend;\n          this.clearShadowAndFilterStyleForContext(\n            context,\n            hasShadow,\n            hasFilter,\n            renderState,\n            true,\n          );\n        }\n      }\n\n      this.strokeToContext(context, object, renderState, plugin, runtime);\n\n      if (clearShadowAndFilter) {\n        this.clearShadowAndFilterStyleForContext(\n          context,\n          hasShadow,\n          hasFilter,\n          renderState,\n        );\n      }\n    }\n\n    // clear\n    if (originGlobalAlpha !== null) {\n      updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        originGlobalAlpha,\n        renderState.currentContext,\n      );\n    }\n  }\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  CSSRGB,\n  DisplayObject,\n  GlobalRuntime,\n  ParsedBaseStyleProps,\n  Pattern,\n  isPattern,\n  Shape,\n  ImagePool,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { CanvasRendererPlugin } from '../../CanvasRendererPlugin';\nimport { OptimizedDefaultRenderer, DEFAULT_STYLE } from './OptimizedDefault';\nimport { getColor, getPattern } from './helper';\n\nexport class DefaultRenderer extends OptimizedDefaultRenderer {\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedBaseStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const {\n      fill,\n      fillRule,\n      opacity = 1,\n      fillOpacity = 1,\n      stroke,\n      strokeOpacity = 1,\n      lineWidth = 1,\n      lineCap,\n      lineJoin,\n      shadowType,\n      shadowColor,\n      shadowBlur,\n      filter,\n      miterLimit,\n    } = parsedStyle;\n    const hasFill = fill && !(fill as CSSRGB).isNone;\n    const hasStroke = stroke && !(stroke as CSSRGB).isNone && lineWidth > 0;\n\n    const isFillTransparent = (fill as CSSRGB)?.alpha === 0;\n    const hasFilter = !!(filter && filter.length);\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    const nodeName = object.nodeName as Shape;\n    const isInnerShadow = shadowType === 'inner';\n    const shouldDrawShadowWithStroke =\n      hasStroke &&\n      hasShadow &&\n      (nodeName === Shape.PATH ||\n        nodeName === Shape.LINE ||\n        nodeName === Shape.POLYLINE ||\n        isFillTransparent ||\n        isInnerShadow);\n\n    if (hasFill) {\n      context.globalAlpha = opacity * fillOpacity;\n\n      if (!shouldDrawShadowWithStroke) {\n        setShadowAndFilter(object, context, hasShadow);\n      }\n\n      applyFill(\n        context,\n        object,\n        fill,\n        fillRule,\n        canvasContext,\n        plugin,\n        runtime,\n        this.imagePool,\n      );\n\n      if (!shouldDrawShadowWithStroke) {\n        this.clearShadowAndFilter(context, hasFilter, hasShadow);\n      }\n    }\n\n    if (hasStroke) {\n      context.globalAlpha = opacity * strokeOpacity;\n      context.lineWidth = lineWidth;\n      if (!isNil(miterLimit)) {\n        context.miterLimit = miterLimit;\n      }\n\n      if (!isNil(lineCap)) {\n        context.lineCap = lineCap;\n      }\n\n      if (!isNil(lineJoin)) {\n        context.lineJoin = lineJoin;\n      }\n\n      if (shouldDrawShadowWithStroke) {\n        if (isInnerShadow) {\n          context.globalCompositeOperation = 'source-atop';\n        }\n        setShadowAndFilter(object, context, true);\n\n        if (isInnerShadow) {\n          applyStroke(\n            context,\n            object,\n            stroke,\n            canvasContext,\n            plugin,\n            runtime,\n            this.imagePool,\n          );\n          context.globalCompositeOperation =\n            DEFAULT_STYLE.globalCompositeOperation;\n          this.clearShadowAndFilter(context, hasFilter, true);\n        }\n      }\n\n      applyStroke(\n        context,\n        object,\n        stroke,\n        canvasContext,\n        plugin,\n        runtime,\n        this.imagePool,\n      );\n    }\n  }\n\n  private clearShadowAndFilter(\n    context: CanvasRenderingContext2D,\n    hasFilter: boolean,\n    hasShadow: boolean,\n  ) {\n    if (hasShadow) {\n      context.shadowColor = 'transparent';\n      context.shadowBlur = 0;\n    }\n\n    if (hasFilter) {\n      // save drop-shadow filter\n      const oldFilter = context.filter;\n      if (!isNil(oldFilter) && oldFilter.indexOf('drop-shadow') > -1) {\n        context.filter =\n          oldFilter.replace(/drop-shadow\\([^)]*\\)/, '').trim() || 'none';\n      }\n    }\n  }\n}\n\n/**\n * apply before fill and stroke but only once\n */\nexport function setShadowAndFilter(\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  hasShadow: boolean,\n) {\n  const { filter, shadowColor, shadowBlur, shadowOffsetX, shadowOffsetY } =\n    object.parsedStyle;\n\n  if (filter && filter.length) {\n    // use raw filter string\n    context.filter = object.style.filter;\n  }\n\n  if (hasShadow) {\n    context.shadowColor = shadowColor.toString();\n    context.shadowBlur = shadowBlur || 0;\n    context.shadowOffsetX = shadowOffsetX || 0;\n    context.shadowOffsetY = shadowOffsetY || 0;\n  }\n}\n\nexport function applyFill(\n  context: CanvasRenderingContext2D,\n  object: DisplayObject,\n  fill: CSSRGB | CSSGradientValue[] | Pattern,\n  fillRule: 'nonzero' | 'evenodd',\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n  skipFill = false,\n) {\n  if (Array.isArray(fill)) {\n    fill.forEach((gradient) => {\n      context.fillStyle = getColor(gradient, object, context, imagePool);\n      if (!skipFill) {\n        fillRule ? context.fill(fillRule) : context.fill();\n      }\n    });\n  } else {\n    if (isPattern(fill)) {\n      context.fillStyle = getPattern(\n        fill,\n        object,\n        context,\n        canvasContext,\n        plugin,\n        runtime,\n        imagePool,\n      );\n    }\n    if (!skipFill) {\n      fillRule ? context.fill(fillRule) : context.fill();\n    }\n  }\n}\n\nexport function applyStroke(\n  context: CanvasRenderingContext2D,\n  object: DisplayObject,\n  stroke: CSSRGB | CSSGradientValue[] | Pattern,\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n  skipStroke = false,\n) {\n  if (Array.isArray(stroke)) {\n    stroke.forEach((gradient) => {\n      context.strokeStyle = getColor(gradient, object, context, imagePool);\n      if (!skipStroke) {\n        context.stroke();\n      }\n    });\n  } else {\n    if (isPattern(stroke)) {\n      context.strokeStyle = getPattern(\n        stroke,\n        object,\n        context,\n        canvasContext,\n        plugin,\n        runtime,\n        imagePool,\n      );\n    }\n    if (!skipStroke) {\n      context.stroke();\n    }\n  }\n}\n","import { vec3, mat4 } from 'gl-matrix';\n\n/**\n * 判断两个点是否重合，点坐标的格式为 [x, y]\n */\nexport function isSamePoint(\n  point1: [number, number],\n  point2: [number, number],\n) {\n  return point1[0] === point2[0] && point1[1] === point2[1];\n}\n\nexport function calculateOverlapRect<\n  Rect extends [number, number, number, number],\n>(rect1: Rect, rect2: Rect): null | Rect {\n  const [x1, y1, w1, h1] = rect1;\n  const [x2, y2, w2, h2] = rect2;\n\n  // 计算重叠区域的左上角和右下角\n  const overlapLeft = Math.max(x1, x2);\n  const overlapTop = Math.max(y1, y2);\n  const overlapRight = Math.min(x1 + w1, x2 + w2);\n  const overlapBottom = Math.min(y1 + h1, y2 + h2);\n\n  if (overlapRight <= overlapLeft || overlapBottom <= overlapTop) {\n    return null;\n  }\n\n  return [\n    overlapLeft,\n    overlapTop,\n    overlapRight - overlapLeft,\n    overlapBottom - overlapTop,\n  ] as Rect;\n}\n\nexport function transformRect<Rect extends [number, number, number, number]>(\n  rect: Rect,\n  matrix: mat4,\n): Rect {\n  const tl = vec3.transformMat4(vec3.create(), [rect[0], rect[1], 0], matrix);\n  const tr = vec3.transformMat4(\n    vec3.create(),\n    [rect[0] + rect[2], rect[1], 0],\n    matrix,\n  );\n  const bl = vec3.transformMat4(\n    vec3.create(),\n    [rect[0], rect[1] + rect[3], 0],\n    matrix,\n  );\n  const br = vec3.transformMat4(\n    vec3.create(),\n    [rect[0] + rect[2], rect[1] + rect[3], 0],\n    matrix,\n  );\n\n  return [\n    Math.min(tl[0], tr[0], bl[0], br[0]),\n    Math.min(tl[1], tr[1], bl[1], br[1]),\n    Math.max(tl[0], tr[0], bl[0], br[0]) - Math.min(tl[0], tr[0], bl[0], br[0]),\n    Math.max(tl[1], tr[1], bl[1], br[1]) - Math.min(tl[1], tr[1], bl[1], br[1]),\n  ] as Rect;\n}\n","import type {\n  DisplayObject,\n  ParsedImageStyleProps,\n  GlobalRuntime,\n  ImagePool,\n  ImageCache,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\nimport { transformRect, calculateOverlapRect } from '../../utils/math';\nimport { DefaultRenderer, setShadowAndFilter } from './Default';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\n\nexport class ImageRenderer extends DefaultRenderer {\n  static renderFull(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      image: HTMLImageElement;\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    context.drawImage(\n      data.image,\n      Math.floor(data.drawRect[0]),\n      Math.floor(data.drawRect[1]),\n      Math.ceil(data.drawRect[2]),\n      Math.ceil(data.drawRect[3]),\n    );\n  }\n\n  private renderDownSampled(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      src: string | HTMLImageElement;\n      imageCache: ImageCache;\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    const { src, imageCache } = data;\n\n    if (!imageCache.downSampled) {\n      this.imagePool\n        .createDownSampledImage(src, object)\n        .then(() => {\n          // be removed from dom tree\n          if (!object.ownerDocument) {\n            return;\n          }\n\n          // rerender\n          object.dirty();\n          object.ownerDocument.defaultView.context.renderingService.dirty();\n        })\n        .catch((reason) => {\n          console.error(reason);\n        });\n\n      return;\n    }\n\n    context.drawImage(\n      imageCache.downSampled,\n      Math.floor(data.drawRect[0]),\n      Math.floor(data.drawRect[1]),\n      Math.ceil(data.drawRect[2]),\n      Math.ceil(data.drawRect[3]),\n    );\n  }\n\n  renderTile(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      src: string | HTMLImageElement;\n      imageCache: ImageCache;\n      imageRect: [number, number, number, number];\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    const { src, imageCache, imageRect, drawRect } = data;\n    const { size: originalSize } = imageCache;\n    const { a, b, c, d, e, f } = context.getTransform();\n\n    context.resetTransform();\n\n    if (!imageCache?.gridSize) {\n      this.imagePool\n        .createImageTiles(\n          src,\n          [],\n          () => {\n            // be removed from dom tree\n            if (!object.ownerDocument) {\n              return;\n            }\n\n            // rerender\n            object.dirty();\n            object.ownerDocument.defaultView.context.renderingService.dirty();\n          },\n          object,\n        )\n        .catch((reason) => {\n          console.error(reason);\n        });\n\n      return;\n    }\n\n    const scaleToOrigin = [\n      originalSize[0] / imageRect[2],\n      originalSize[1] / imageRect[3],\n    ];\n    const scaledTileSize = [\n      imageCache.tileSize[0] / scaleToOrigin[0],\n      imageCache.tileSize[1] / scaleToOrigin[1],\n    ];\n    const [startTileX, endTileX] = [\n      Math.floor((drawRect[0] - imageRect[0]) / scaledTileSize[0]),\n      Math.ceil((drawRect[0] + drawRect[2] - imageRect[0]) / scaledTileSize[0]),\n    ];\n    const [startTileY, endTileY] = [\n      Math.floor((drawRect[1] - imageRect[1]) / scaledTileSize[1]),\n      Math.ceil((drawRect[1] + drawRect[3] - imageRect[1]) / scaledTileSize[1]),\n    ];\n\n    for (let tileY = startTileY; tileY <= endTileY; tileY++) {\n      for (let tileX = startTileX; tileX <= endTileX; tileX++) {\n        const item = imageCache.tiles[tileY][tileX];\n\n        if (item) {\n          const tileRect = [\n            Math.floor(imageRect[0] + item.tileX * scaledTileSize[0]),\n            Math.floor(imageRect[1] + item.tileY * scaledTileSize[1]),\n            Math.ceil(scaledTileSize[0]),\n            Math.ceil(scaledTileSize[1]),\n          ];\n\n          context.drawImage(\n            item.data,\n            tileRect[0],\n            tileRect[1],\n            tileRect[2],\n            tileRect[3],\n          );\n        }\n      }\n    }\n\n    context.setTransform(a, b, c, d, e, f);\n  }\n\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n  ) {\n    const {\n      x = 0,\n      y = 0,\n      width,\n      height,\n      src,\n      shadowColor,\n      shadowBlur,\n    } = parsedStyle;\n\n    const imageCache = this.imagePool.getImageSync(src, object);\n    const image = imageCache?.img;\n    let iw = width;\n    let ih = height;\n\n    if (!image) {\n      return;\n    }\n\n    iw ||= image.width;\n    ih ||= image.height;\n\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    setShadowAndFilter(object, context, hasShadow);\n\n    // node-canvas will throw the following err:\n    // Error: Image given has not completed loading\n    try {\n      const { width: viewWidth, height: viewHeight } =\n        object.ownerDocument.defaultView.getContextService().getDomElement();\n\n      const currentTransform = context.getTransform();\n      const { a, b, c, d, e, f } = currentTransform;\n      // 构建 mat4 矩阵\n      // prettier-ignore\n      const transformMatrix = mat4.fromValues(\n          a, c, 0, 0,\n          b, d, 0, 0,\n          0, 0, 1, 0,\n          e, f, 0, 1,\n        );\n      const imageRect = transformRect([x, y, iw, ih], transformMatrix);\n      const drawRect = calculateOverlapRect(\n        [0, 0, viewWidth, viewHeight],\n        imageRect,\n      );\n\n      if (!drawRect) {\n        return;\n      }\n\n      if (\n        !object.ownerDocument.defaultView.getConfig()\n          .enableLargeImageOptimization\n      ) {\n        ImageRenderer.renderFull(context, parsedStyle, object, {\n          image,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      const sizeOfOrigin = imageRect[2] / imageCache.size[0];\n\n      if (sizeOfOrigin < (imageCache.downSamplingRate || 0.5)) {\n        this.renderDownSampled(context, parsedStyle, object, {\n          src,\n          imageCache,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      if (!ImagePool.isSupportTile) {\n        ImageRenderer.renderFull(context, parsedStyle, object, {\n          image,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      this.renderTile(context, parsedStyle, object, {\n        src,\n        imageCache,\n        imageRect,\n        drawRect,\n      });\n    } catch {\n      // expected error\n    }\n  }\n\n  // ---\n\n  drawToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    this.render(context, object.parsedStyle as ParsedImageStyleProps, object);\n  }\n}\n","import {\n  type CSSRGB,\n  type CanvasContext,\n  type DisplayObject,\n  type GlobalRuntime,\n  type ParsedTextStyleProps,\n  type Rectangle,\n  CSSGradientValue,\n  Pattern,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport {\n  DefaultRenderer,\n  applyFill,\n  applyStroke,\n  setShadowAndFilter,\n} from './Default';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\n\nexport class TextRenderer extends DefaultRenderer {\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedTextStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    // Trigger text geometry calculation.\n    object.getBounds();\n    const {\n      lineWidth = 1,\n      textAlign = 'start',\n      textBaseline = 'alphabetic',\n      lineJoin = 'miter',\n      miterLimit = 10,\n      letterSpacing = 0,\n      stroke,\n      fill,\n      fillRule,\n      fillOpacity = 1,\n      strokeOpacity = 1,\n      opacity = 1,\n      metrics,\n      x = 0,\n      y = 0,\n      dx,\n      dy,\n      shadowColor,\n      shadowBlur,\n      textDecorationLine,\n    } = parsedStyle;\n\n    const { font, lines, height, lineHeight, lineMetrics } = metrics;\n\n    context.font = font;\n    context.lineWidth = lineWidth;\n    context.textAlign = textAlign === 'middle' ? 'center' : textAlign;\n\n    let formattedTextBaseline = textBaseline;\n    if (formattedTextBaseline === 'alphabetic') {\n      formattedTextBaseline = 'bottom';\n    }\n\n    context.lineJoin = lineJoin;\n    if (!isNil(miterLimit)) {\n      context.miterLimit = miterLimit;\n    }\n\n    let linePositionY = y;\n    // handle vertical text baseline\n    if (textBaseline === 'middle') {\n      linePositionY += -height / 2 - lineHeight / 2;\n    } else if (\n      textBaseline === 'bottom' ||\n      textBaseline === 'alphabetic' ||\n      textBaseline === 'ideographic'\n    ) {\n      linePositionY += -height;\n    } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n      linePositionY += -lineHeight;\n    }\n\n    // account for dx & dy\n    const offsetX = x + (dx || 0);\n    linePositionY += dy || 0;\n\n    if (lines.length === 1) {\n      if (formattedTextBaseline === 'bottom') {\n        formattedTextBaseline = 'middle';\n        linePositionY -= 0.5 * height;\n      } else if (formattedTextBaseline === 'top') {\n        formattedTextBaseline = 'middle';\n        linePositionY += 0.5 * height;\n      }\n    }\n    context.textBaseline = formattedTextBaseline;\n\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    setShadowAndFilter(object, context, hasShadow);\n\n    // draw lines line by line\n    for (let i = 0; i < lines.length; i++) {\n      const linePositionX = lineWidth / 2 + offsetX;\n      linePositionY += lineHeight;\n\n      // no need to re-position X, cause we already set text align\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textAlign\n      if (!isNil(stroke) && !(stroke as CSSRGB).isNone && lineWidth) {\n        this.drawLetterSpacing(\n          context,\n          object,\n          lines[i],\n          lineMetrics[i],\n          textAlign,\n          linePositionX,\n          linePositionY,\n          letterSpacing,\n          fill,\n          fillRule,\n          fillOpacity,\n          stroke,\n          strokeOpacity,\n          opacity,\n          true,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      if (!isNil(fill)) {\n        this.drawLetterSpacing(\n          context,\n          object,\n          lines[i],\n          lineMetrics[i],\n          textAlign,\n          linePositionX,\n          linePositionY,\n          letterSpacing,\n          fill,\n          fillRule,\n          fillOpacity,\n          stroke,\n          strokeOpacity,\n          opacity,\n          false,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n    }\n\n    // Draw text decoration lines\n    if (textDecorationLine && textDecorationLine !== 'none') {\n      this.drawTextDecorations(\n        context,\n        parsedStyle,\n        object,\n        lines,\n        lineHeight,\n        offsetX,\n        y + (dy || 0),\n        canvasContext,\n        plugin,\n        runtime,\n      );\n    }\n  }\n\n  private drawLetterSpacing(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    lineMetrics: Rectangle,\n    textAlign: CanvasTextAlign | 'middle',\n    x: number,\n    y: number,\n    letterSpacing: number,\n    fill: CSSRGB | CSSGradientValue[] | Pattern,\n    fillRule: 'nonzero' | 'evenodd',\n    fillOpacity: number | undefined,\n    stroke: CSSRGB | CSSGradientValue[] | Pattern,\n    strokeOpacity: number | undefined,\n    opacity: number | undefined,\n    isStroke: boolean,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ): void {\n    // letterSpacing of 0 means normal, render all texts directly\n    if (letterSpacing === 0) {\n      if (isStroke) {\n        this.strokeText(\n          context,\n          object,\n          text,\n          x,\n          y,\n          stroke,\n          strokeOpacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      } else {\n        this.fillText(\n          context,\n          object,\n          text,\n          x,\n          y,\n          fill,\n          fillRule,\n          fillOpacity,\n          opacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      return;\n    }\n\n    // draw text using left align\n    const currentTextAlign = context.textAlign;\n    context.textAlign = 'left';\n\n    let currentPosition = x;\n    if (textAlign === 'center' || textAlign === 'middle') {\n      currentPosition = x - lineMetrics.width / 2;\n    } else if (textAlign === 'right' || textAlign === 'end') {\n      currentPosition = x - lineMetrics.width;\n    }\n\n    const stringArray = Array.from(text);\n    let previousWidth = context.measureText(text).width;\n    let currentWidth = 0;\n    for (let i = 0; i < stringArray.length; ++i) {\n      const currentChar = stringArray[i];\n      if (isStroke) {\n        this.strokeText(\n          context,\n          object,\n          currentChar,\n          currentPosition,\n          y,\n          stroke,\n          strokeOpacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      } else {\n        this.fillText(\n          context,\n          object,\n          currentChar,\n          currentPosition,\n          y,\n          fill,\n          fillRule,\n          fillOpacity,\n          opacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      currentWidth = context.measureText(text.substring(i + 1)).width;\n      currentPosition += previousWidth - currentWidth + letterSpacing;\n      previousWidth = currentWidth;\n    }\n\n    context.textAlign = currentTextAlign;\n  }\n\n  private fillText(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    x: number,\n    y: number,\n    fill: CSSRGB | CSSGradientValue[] | Pattern,\n    fillRule: 'nonzero' | 'evenodd',\n    fillOpacity: number | undefined,\n    opacity: number | undefined,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    applyFill(\n      context,\n      object,\n      fill,\n      fillRule,\n      canvasContext,\n      plugin,\n      runtime,\n      this.imagePool,\n      true,\n    );\n\n    let currentGlobalAlpha: number;\n    const applyOpacity = !isNil(fillOpacity) && fillOpacity !== 1;\n    if (applyOpacity) {\n      currentGlobalAlpha = context.globalAlpha;\n      context.globalAlpha = fillOpacity * opacity;\n    }\n    context.fillText(text, x, y);\n    if (applyOpacity) {\n      context.globalAlpha = currentGlobalAlpha;\n    }\n  }\n\n  private strokeText(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    x: number,\n    y: number,\n    stroke: CSSRGB | CSSGradientValue[] | Pattern,\n    strokeOpacity: number | undefined,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    applyStroke(\n      context,\n      object,\n      stroke,\n      canvasContext,\n      plugin,\n      runtime,\n      this.imagePool,\n      true,\n    );\n\n    let currentGlobalAlpha: number;\n    const applyOpacity = !isNil(strokeOpacity) && strokeOpacity !== 1;\n    if (applyOpacity) {\n      currentGlobalAlpha = context.globalAlpha;\n      context.globalAlpha = strokeOpacity!;\n    }\n    context.strokeText(text, x, y);\n    if (applyOpacity) {\n      context.globalAlpha = currentGlobalAlpha;\n    }\n  }\n\n  /**\n   * Draw text decoration lines (underline, overline, line-through)\n   */\n  private drawTextDecorations(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedTextStyleProps,\n    object: DisplayObject,\n    lines: string[],\n    lineHeight: number,\n    offsetX: number,\n    baseY: number,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const {\n      textDecorationLine,\n      textDecorationColor,\n      textDecorationStyle,\n      textDecorationThickness = 1,\n      textAlign = 'start',\n      lineWidth = 1,\n      metrics,\n    } = parsedStyle;\n\n    if (!textDecorationLine || textDecorationLine === 'none') {\n      return;\n    }\n\n    const { lineMetrics } = metrics;\n    const decorations = textDecorationLine.split(' ');\n\n    // Set decoration style\n    context.lineWidth = textDecorationThickness;\n\n    if (textDecorationColor) {\n      context.strokeStyle = `rgba(${textDecorationColor.r}, ${textDecorationColor.g}, ${textDecorationColor.b}, ${textDecorationColor.alpha})`;\n    }\n\n    // Set line style based on textDecorationStyle\n    switch (textDecorationStyle) {\n      case 'dashed':\n        context.setLineDash([5, 5]);\n        break;\n      case 'dotted':\n        context.setLineDash([2, 2]);\n        break;\n      case 'wavy':\n        // For wavy, we'll use a simple approximation with bezier curves\n        // A full implementation would be more complex\n        context.setLineDash([]);\n        break;\n      default:\n        context.setLineDash([]);\n        break;\n    }\n\n    let linePositionY = baseY;\n\n    // Adjust for text baseline\n    const { textBaseline = 'alphabetic' } = parsedStyle;\n    if (textBaseline === 'middle') {\n      linePositionY += -metrics.height / 2 - lineHeight / 2;\n    } else if (\n      textBaseline === 'bottom' ||\n      textBaseline === 'alphabetic' ||\n      textBaseline === 'ideographic'\n    ) {\n      linePositionY += -metrics.height;\n    } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n      linePositionY += -lineHeight;\n    }\n\n    // Draw each decoration for each line\n    for (let i = 0; i < lines.length; i++) {\n      linePositionY += lineHeight;\n\n      const lineMetric = lineMetrics[i];\n      if (!lineMetric) continue;\n\n      const lineWidthOffset = lineWidth / 2;\n      let startX = offsetX;\n      let endX = offsetX + lineMetric.width;\n\n      // Adjust for text alignment\n      if (textAlign === 'center' || textAlign === 'middle') {\n        startX = offsetX - lineMetric.width / 2;\n        endX = offsetX + lineMetric.width / 2;\n      } else if (textAlign === 'right' || textAlign === 'end') {\n        startX = offsetX - lineMetric.width;\n        endX = offsetX;\n      }\n\n      // Add lineWidth offset\n      startX += lineWidthOffset;\n      endX += lineWidthOffset;\n\n      // Draw each type of decoration\n      for (const decoration of decorations) {\n        let decorationY = linePositionY;\n\n        switch (decoration) {\n          case 'underline':\n            decorationY += 2; // Small offset below baseline\n            break;\n          case 'overline':\n            decorationY -= lineHeight - 2; // Small offset above line\n            break;\n          case 'line-through':\n            decorationY -= lineHeight / 2; // Middle of line\n            break;\n          default:\n            continue; // Unknown decoration type\n        }\n\n        if (textDecorationStyle === 'wavy') {\n          this.drawWavyLine(context, startX, endX, decorationY);\n        } else {\n          context.beginPath();\n          context.moveTo(startX, decorationY);\n          context.lineTo(endX, decorationY);\n          context.stroke();\n        }\n      }\n    }\n\n    // Reset line dash\n    context.setLineDash([]);\n  }\n\n  /**\n   * Draw a wavy line as an approximation of the wavy text decoration style\n   */\n  private drawWavyLine(\n    context: CanvasRenderingContext2D,\n    startX: number,\n    endX: number,\n    y: number,\n  ) {\n    const amplitude = 2; // Height of the wave\n    const wavelength = 10; // Length of one wave cycle\n    const numWaves = Math.floor((endX - startX) / wavelength);\n\n    context.beginPath();\n    context.moveTo(startX, y);\n\n    for (let i = 0; i < numWaves; i++) {\n      const x1 = startX + i * wavelength + wavelength / 4;\n      const y1 = y + amplitude;\n      const x2 = startX + i * wavelength + wavelength / 2;\n      const y2 = y;\n      context.quadraticCurveTo(x1, y1, x2, y2);\n\n      const x3 = startX + i * wavelength + (wavelength * 3) / 4;\n      const y3 = y - amplitude;\n      const x4 = startX + (i + 1) * wavelength;\n      const y4 = y;\n      context.quadraticCurveTo(x3, y3, x4, y4);\n    }\n\n    context.stroke();\n  }\n\n  // ---\n\n  drawToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    this.render(\n      context,\n      object.parsedStyle as ParsedTextStyleProps,\n      object,\n      object.ownerDocument.defaultView.context,\n      plugin,\n      runtime,\n    );\n  }\n}\n","import { AbstractRendererPlugin, Shape } from '@antv/g-lite';\nimport type { PathGenerator } from '../..';\nimport { CanvasRendererPlugin } from './CanvasRendererPlugin';\nimport {\n  type StyleRenderer,\n  DefaultRenderer,\n  TextRenderer,\n  ImageRenderer,\n} from './shapes/styles';\nimport type { CanvasRendererPluginOptions } from './interfaces';\n\nexport * from './shapes/styles';\n\nexport class Plugin extends AbstractRendererPlugin<{\n  defaultStyleRendererFactory: Record<Shape, StyleRenderer>;\n  styleRendererFactory: Record<Shape, StyleRenderer>;\n  pathGeneratorFactory: Record<Shape, PathGenerator<any>>;\n}> {\n  name = 'canvas-renderer';\n\n  constructor(private options: Partial<CanvasRendererPluginOptions> = {}) {\n    super();\n  }\n\n  init(): void {\n    const canvasRendererPluginOptions: CanvasRendererPluginOptions = {\n      dirtyObjectNumThreshold: 500,\n      dirtyObjectRatioThreshold: 0.8,\n      ...this.options,\n    };\n\n    // @ts-ignore\n    const { imagePool } = this.context;\n\n    const defaultRenderer = new DefaultRenderer(imagePool);\n\n    const defaultStyleRendererFactory: Record<Shape, StyleRenderer> = {\n      [Shape.CIRCLE]: defaultRenderer,\n      [Shape.ELLIPSE]: defaultRenderer,\n      [Shape.RECT]: defaultRenderer,\n      [Shape.IMAGE]: new ImageRenderer(imagePool),\n      [Shape.TEXT]: new TextRenderer(imagePool),\n      [Shape.LINE]: defaultRenderer,\n      [Shape.POLYLINE]: defaultRenderer,\n      [Shape.POLYGON]: defaultRenderer,\n      [Shape.PATH]: defaultRenderer,\n      [Shape.GROUP]: undefined,\n      [Shape.HTML]: undefined,\n      [Shape.MESH]: undefined,\n      [Shape.FRAGMENT]: undefined,\n    };\n\n    this.context.defaultStyleRendererFactory = defaultStyleRendererFactory;\n    this.context.styleRendererFactory = defaultStyleRendererFactory;\n\n    this.addRenderingPlugin(\n      new CanvasRendererPlugin(canvasRendererPluginOptions),\n    );\n  }\n  destroy(): void {\n    this.removeAllRenderingPlugins();\n\n    delete this.context.defaultStyleRendererFactory;\n    delete this.context.styleRendererFactory;\n  }\n}\n","import type {\n  BaseStyleProps,\n  DisplayObject,\n  PickingResult,\n  RenderingPlugin,\n  Shape,\n  IDocument,\n  RenderingPluginContext,\n  GlobalRuntime,\n} from '@antv/g-lite';\nimport { findClosestClipPathTarget, Point } from '@antv/g-lite';\nimport { mat4, vec3 } from 'gl-matrix';\nimport type { PathGenerator } from '../..';\n\nexport type PointInPathPicker<T extends BaseStyleProps> = (\n  displayObject: DisplayObject<T>,\n  point: Point,\n  isClipPath: boolean,\n  isPointInPath: (displayObject: DisplayObject<T>, point: Point) => boolean,\n  context: RenderingPluginContext,\n  runtime: GlobalRuntime,\n) => boolean;\n\nconst tmpVec3a = vec3.create();\nconst tmpVec3b = vec3.create();\nconst tmpVec3c = vec3.create();\nconst tmpMat4 = mat4.create();\n\ninterface Extended {\n  pathGeneratorFactory: Record<Shape, PathGenerator<any>>;\n  pointInPathPickerFactory: Record<Shape, PointInPathPicker<any>>;\n}\n\n/**\n * pick shape(s) with Mouse/Touch event\n *\n * 1. find AABB with r-tree\n * 2. do math calculation with geometry in an accurate way\n */\nexport class CanvasPickerPlugin implements RenderingPlugin {\n  static tag = 'CanvasPicker';\n\n  private context: RenderingPluginContext & Extended;\n  private runtime: GlobalRuntime;\n\n  apply(context: RenderingPluginContext, runtime: GlobalRuntime) {\n    const { renderingService, renderingContext } = context;\n    this.context = context as RenderingPluginContext & Extended;\n    this.runtime = runtime;\n\n    const document = renderingContext.root?.ownerDocument;\n\n    renderingService.hooks.pick.tapPromise(\n      CanvasPickerPlugin.tag,\n      async (result: PickingResult) => {\n        return this.pick(document, result);\n      },\n    );\n\n    renderingService.hooks.pickSync.tap(\n      CanvasPickerPlugin.tag,\n      (result: PickingResult) => {\n        return this.pick(document, result);\n      },\n    );\n  }\n\n  private pick(document: IDocument, result: PickingResult) {\n    const {\n      topmost,\n      position: { x, y },\n    } = result;\n\n    // position in world space\n    const position = vec3.set(tmpVec3a, x, y, 0);\n\n    // query by AABB\n    const hitTestList = document.elementsFromBBox(\n      position[0],\n      position[1],\n      position[0],\n      position[1],\n    );\n\n    // test with clip path & origin shape\n    // @see https://github.com/antvis/g/issues/1064\n    const pickedDisplayObjects: DisplayObject[] = [];\n    for (const displayObject of hitTestList) {\n      const worldTransform = displayObject.getWorldTransform();\n      const isHitOriginShape = this.isHit(\n        displayObject,\n        position,\n        worldTransform,\n        false,\n      );\n      if (isHitOriginShape) {\n        // should look up in the ancestor node\n        const clipped = findClosestClipPathTarget(displayObject);\n        if (clipped) {\n          const { clipPath } = clipped.parsedStyle;\n          const isHitClipPath = this.isHit(\n            clipPath,\n            position,\n            clipPath.getWorldTransform(),\n            true,\n          );\n          if (isHitClipPath) {\n            if (topmost) {\n              result.picked = [displayObject];\n              return result;\n            }\n            pickedDisplayObjects.push(displayObject);\n          }\n        } else {\n          if (topmost) {\n            result.picked = [displayObject];\n            return result;\n          }\n          pickedDisplayObjects.push(displayObject);\n        }\n      }\n    }\n\n    result.picked = pickedDisplayObjects;\n    return result;\n  }\n\n  private isHit = (\n    displayObject: DisplayObject,\n    position: vec3,\n    worldTransform: mat4,\n    isClipPath: boolean,\n  ) => {\n    // use picker for current shape's type\n    const pick =\n      this.context.pointInPathPickerFactory[displayObject.nodeName as Shape];\n    if (pick) {\n      // invert with world matrix\n      const invertWorldMat = mat4.invert(tmpMat4, worldTransform);\n\n      // transform client position to local space, do picking in local space\n      const localPosition = vec3.transformMat4(\n        tmpVec3b,\n        vec3.set(tmpVec3c, position[0], position[1], 0),\n        invertWorldMat,\n      );\n\n      if (\n        pick(\n          displayObject,\n          new Point(localPosition[0], localPosition[1]),\n          isClipPath,\n          this.isPointInPath,\n          this.context,\n          this.runtime,\n        )\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  /**\n   * use native picking method\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/isPointInPath\n   */\n  private isPointInPath = (displayObject: DisplayObject, position: Point) => {\n    const context = this.runtime.offscreenCanvasCreator.getOrCreateContext(\n      this.context.config.offscreenCanvas,\n    ) as CanvasRenderingContext2D;\n\n    const generatePath =\n      this.context.pathGeneratorFactory[displayObject.nodeName];\n    if (generatePath) {\n      context.beginPath();\n      generatePath(context, displayObject.parsedStyle);\n      context.closePath();\n    }\n\n    return context.isPointInPath(position.x, position.y);\n  };\n}\n","import type {\n  CircleStyleProps,\n  DisplayObject,\n  ParsedCircleStyleProps,\n  Point,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { distance } from '@antv/g-math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<CircleStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    cx = 0,\n    cy = 0,\n    r,\n    fill,\n    stroke,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedCircleStyleProps;\n  const halfLineWidth = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  const absDistance = distance(cx, cy, position.x, position.y);\n\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  if ((hasFill && hasStroke) || isClipPath) {\n    return absDistance <= r + halfLineWidth;\n  }\n  if (hasFill) {\n    return absDistance <= r;\n  }\n  if (hasStroke) {\n    return absDistance >= r - halfLineWidth && absDistance <= r + halfLineWidth;\n  }\n  return false;\n}\n","import type {\n  DisplayObject,\n  EllipseStyleProps,\n  ParsedEllipseStyleProps,\n  Point,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\n\nfunction ellipseDistance(\n  squareX: number,\n  squareY: number,\n  rx: number,\n  ry: number,\n) {\n  return squareX / (rx * rx) + squareY / (ry * ry);\n}\n\nexport function isPointInPath(\n  displayObject: DisplayObject<EllipseStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    cx = 0,\n    cy = 0,\n    rx,\n    ry,\n    fill,\n    stroke,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedEllipseStyleProps;\n\n  const { x, y } = position;\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  const halfLineWith = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  const squareX = (x - cx) * (x - cx);\n  const squareY = (y - cy) * (y - cy);\n  // 使用椭圆的公式： x*x/rx*rx + y*y/ry*ry = 1;\n  if ((hasFill && hasStroke) || isClipPath) {\n    return (\n      ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <=\n      1\n    );\n  }\n  if (hasFill) {\n    return ellipseDistance(squareX, squareY, rx, ry) <= 1;\n  }\n  if (hasStroke) {\n    return (\n      ellipseDistance(squareX, squareY, rx - halfLineWith, ry - halfLineWith) >=\n        1 &&\n      ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <=\n        1\n    );\n  }\n  return false;\n}\n","import { distance, linePointToLine } from '@antv/g-math';\n\nexport function inBox(\n  minX: number,\n  minY: number,\n  width: number,\n  height: number,\n  x: number,\n  y: number,\n) {\n  return x >= minX && x <= minX + width && y >= minY && y <= minY + height;\n}\n\nexport function inRect(\n  minX: number,\n  minY: number,\n  width: number,\n  height: number,\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const halfWidth = lineWidth / 2;\n  // 将四个边看做矩形来检测，比边的检测算法要快\n  return (\n    inBox(minX - halfWidth, minY - halfWidth, width, lineWidth, x, y) || // 上边\n    inBox(\n      minX + width - halfWidth,\n      minY - halfWidth,\n      lineWidth,\n      height,\n      x,\n      y,\n    ) || // 右边\n    inBox(\n      minX + halfWidth,\n      minY + height - halfWidth,\n      width,\n      lineWidth,\n      x,\n      y,\n    ) || // 下边\n    inBox(minX - halfWidth, minY + halfWidth, lineWidth, height, x, y)\n  ); // 左边\n}\n\nexport function inArc(\n  cx: number,\n  cy: number,\n  r: number,\n  startAngle: number,\n  endAngle: number,\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const angle = (Math.atan2(y - cy, x - cx) + Math.PI * 2) % (Math.PI * 2); // 转换到 0 - 2 * Math.PI 之间\n  // if (angle < startAngle || angle > endAngle) {\n  //   return false;\n  // }\n  const point = {\n    x: cx + r * Math.cos(angle),\n    y: cy + r * Math.sin(angle),\n  };\n\n  return distance(point.x, point.y, x, y) <= lineWidth / 2;\n}\n\nexport function inLine(\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const minX = Math.min(x1, x2);\n  const maxX = Math.max(x1, x2);\n  const minY = Math.min(y1, y2);\n  const maxY = Math.max(y1, y2);\n  const halfWidth = lineWidth / 2;\n  // 因为目前的方案是计算点到直线的距离，而有可能会在延长线上，所以要先判断是否在包围盒内\n  // 这种方案会在水平或者竖直的情况下载线的延长线上有半 lineWidth 的误差\n  if (\n    !(\n      x >= minX - halfWidth &&\n      x <= maxX + halfWidth &&\n      y >= minY - halfWidth &&\n      y <= maxY + halfWidth\n    )\n  ) {\n    return false;\n  }\n  // 因为已经计算了包围盒，所以仅需要计算到直线的距离即可，可以显著提升性能\n  return linePointToLine(x1, y1, x2, y2, x, y) <= lineWidth / 2;\n}\n\nexport function inPolyline(\n  points: any[],\n  lineWidth: number,\n  x: number,\n  y: number,\n  isClose: boolean,\n) {\n  const count = points.length;\n  if (count < 2) {\n    return false;\n  }\n  for (let i = 0; i < count - 1; i++) {\n    const x1 = points[i][0];\n    const y1 = points[i][1];\n    const x2 = points[i + 1][0];\n    const y2 = points[i + 1][1];\n\n    if (inLine(x1, y1, x2, y2, lineWidth, x, y)) {\n      return true;\n    }\n  }\n\n  // 如果封闭，则计算起始点和结束点的边\n  if (isClose) {\n    const first = points[0];\n    const last = points[count - 1];\n    if (inLine(first[0], first[1], last[0], last[1], lineWidth, x, y)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// 多边形的射线检测，参考：https://blog.csdn.net/WilliamSun0122/article/details/77994526\nconst tolerance = 1e-6;\n// 三态函数，判断两个double在eps精度下的大小关系\nfunction dcmp(x: number) {\n  if (Math.abs(x) < tolerance) {\n    return 0;\n  }\n\n  return x < 0 ? -1 : 1;\n}\n\n// 判断点Q是否在p1和p2的线段上\nfunction onSegment(p1: any, p2: any, q: any) {\n  if (\n    (q[0] - p1[0]) * (p2[1] - p1[1]) === (p2[0] - p1[0]) * (q[1] - p1[1]) &&\n    Math.min(p1[0], p2[0]) <= q[0] &&\n    q[0] <= Math.max(p1[0], p2[0]) &&\n    Math.min(p1[1], p2[1]) <= q[1] &&\n    q[1] <= Math.max(p1[1], p2[1])\n  ) {\n    return true;\n  }\n  return false;\n}\n\n// 判断点P在多边形内-射线法\nexport function inPolygon(points: any[], x: number, y: number) {\n  let isHit = false;\n  const n = points.length;\n  if (n <= 2) {\n    // svg 中点小于 3 个时，不显示，也无法被拾取\n    return false;\n  }\n  for (let i = 0; i < n; i++) {\n    const p1 = points[i];\n    const p2 = points[(i + 1) % n];\n    if (onSegment(p1, p2, [x, y])) {\n      // 点在多边形一条边上\n      return true;\n    }\n    // 前一个判断min(p1[1],p2[1])<P.y<=max(p1[1],p2[1])\n    // 后一个判断被测点 在 射线与边交点 的左边\n    if (\n      dcmp(p1[1] - y) > 0 !== dcmp(p2[1] - y) > 0 &&\n      dcmp(x - ((y - p1[1]) * (p1[0] - p2[0])) / (p1[1] - p2[1]) - p1[0]) < 0\n    ) {\n      isHit = !isHit;\n    }\n  }\n  return isHit;\n}\nexport function inPolygons(polygons: any[], x: number, y: number): boolean {\n  let isHit = false;\n  for (let i = 0; i < polygons.length; i++) {\n    const points = polygons[i];\n    isHit = inPolygon(points, x, y);\n    if (isHit) {\n      break;\n    }\n  }\n  return isHit;\n}\n","import type {\n  DisplayObject,\n  LineStyleProps,\n  ParsedLineStyleProps,\n  Point,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { inLine } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<LineStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    x1,\n    y1,\n    x2,\n    y2,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    pointerEvents = 'auto',\n    fill,\n    stroke,\n  } = displayObject.parsedStyle as ParsedLineStyleProps;\n\n  const [, hasStroke] = isFillOrStrokeAffected(pointerEvents, fill, stroke);\n\n  if ((!hasStroke && !isClipPath) || !lineWidth) {\n    return false;\n  }\n\n  return inLine(\n    x1,\n    y1,\n    x2,\n    y2,\n    lineWidth + increasedLineWidthForHitTesting,\n    position.x,\n    position.y,\n  );\n}\n","import type {\n  DisplayObject,\n  GlobalRuntime,\n  ParsedPathStyleProps,\n  Path,\n  PathSegment,\n  PathStyleProps,\n  Point,\n  RenderingPluginContext,\n} from '@antv/g-lite';\nimport {\n  getOrCalculatePathTotalLength,\n  isFillOrStrokeAffected,\n} from '@antv/g-lite';\nimport { cubicPointDistance, quadPointDistance } from '@antv/g-math';\nimport { arcToCubic } from '@antv/util';\nimport { inBox, inLine, inPolygons } from './utils/math';\n\n// TODO: replace it with method in @antv/util\nfunction isPointInStroke(\n  segments: PathSegment[],\n  lineWidth: number,\n  px: number,\n  py: number,\n  length: number,\n) {\n  let isHit = false;\n  const halfWidth = lineWidth / 2;\n  for (let i = 0; i < segments.length; i++) {\n    const segment = segments[i];\n    const { currentPoint, params, prePoint, box } = segment;\n    // 如果在前面已经生成过包围盒，直接按照包围盒计算\n    if (\n      box &&\n      !inBox(\n        box.x - halfWidth,\n        box.y - halfWidth,\n        box.width + lineWidth,\n        box.height + lineWidth,\n        px,\n        py,\n      )\n    ) {\n      continue;\n    }\n    switch (segment.command) {\n      // L 和 Z 都是直线， M 不进行拾取\n      case 'L':\n      case 'Z':\n        isHit = inLine(\n          prePoint[0],\n          prePoint[1],\n          currentPoint[0],\n          currentPoint[1],\n          lineWidth,\n          px,\n          py,\n        );\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'Q':\n        const qDistance = quadPointDistance(\n          prePoint[0],\n          prePoint[1],\n          params[1],\n          params[2],\n          params[3],\n          params[4],\n          px,\n          py,\n        );\n        isHit = qDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'C':\n        const cDistance = cubicPointDistance(\n          prePoint[0], // 上一段结束位置, 即 C 的起始点\n          prePoint[1],\n          params[1], // 'C' 的参数，1、2 为第一个控制点，3、4 为第二个控制点，5、6 为结束点\n          params[2],\n          params[3],\n          params[4],\n          params[5],\n          params[6],\n          px,\n          py,\n          length,\n        );\n        isHit = cDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'A':\n        // cache conversion result\n        if (!segment.cubicParams) {\n          segment.cubicParams = arcToCubic(\n            prePoint[0],\n            prePoint[1],\n            params[1],\n            params[2],\n            params[3],\n            params[4],\n            params[5],\n            params[6],\n            params[7],\n            undefined,\n          ) as [number, number, number, number, number, number];\n        }\n\n        const args = segment.cubicParams;\n\n        // fixArc\n        let prePointInCubic = prePoint;\n        for (let i = 0; i < args.length; i += 6) {\n          const cDistance = cubicPointDistance(\n            prePointInCubic[0], // 上一段结束位置, 即 C 的起始点\n            prePointInCubic[1],\n            args[i],\n            args[i + 1],\n            args[i + 2],\n            args[i + 3],\n            args[i + 4],\n            args[i + 5],\n            px,\n            py,\n            length,\n          );\n          prePointInCubic = [args[i + 4], args[i + 5]];\n          isHit = cDistance <= lineWidth / 2;\n\n          if (isHit) {\n            return true;\n          }\n        }\n        break;\n      default:\n        break;\n    }\n  }\n  return isHit;\n}\n\nexport function isPointInPath(\n  displayObject: DisplayObject<PathStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<PathStyleProps>,\n    position: Point,\n  ) => boolean,\n  renderingPluginContext: RenderingPluginContext,\n  runtime: GlobalRuntime,\n): boolean {\n  const {\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    stroke,\n    fill,\n    d,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedPathStyleProps;\n\n  const { segments, hasArc, polylines, polygons } = d;\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    // Only a closed path can be filled.\n    polygons?.length && fill,\n    stroke,\n  );\n\n  const totalLength = getOrCalculatePathTotalLength(displayObject as Path);\n\n  let isHit = false;\n\n  if (hasFill || isClipPath) {\n    if (hasArc) {\n      // 存在曲线时，暂时使用 canvas 的 api 计算，后续可以进行多边形切割\n      isHit = isPointInPath(displayObject, position);\n    } else {\n      // 提取出来的多边形包含闭合的和非闭合的，在这里统一按照多边形处理\n      isHit =\n        inPolygons(polygons, position.x, position.y) ||\n        inPolygons(polylines, position.x, position.y);\n    }\n    return isHit;\n  }\n  if (hasStroke || isClipPath) {\n    isHit = isPointInStroke(\n      segments,\n      lineWidth + increasedLineWidthForHitTesting,\n      position.x,\n      position.y,\n      totalLength,\n    );\n  }\n\n  return isHit;\n}\n","import type {\n  DisplayObject,\n  ParsedPolygonStyleProps,\n  Point,\n  PolylineStyleProps,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { inPolygon, inPolyline } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<PolylineStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    stroke,\n    fill,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    points,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedPolygonStyleProps;\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  let isHit = false;\n  if (hasStroke || isClipPath) {\n    isHit = inPolyline(\n      points.points,\n      lineWidth + increasedLineWidthForHitTesting,\n      position.x,\n      position.y,\n      true,\n    );\n  }\n  if (!isHit && (hasFill || isClipPath)) {\n    isHit = inPolygon(points.points, position.x, position.y);\n  }\n  return isHit;\n}\n","import type {\n  DisplayObject,\n  ParsedPolylineStyleProps,\n  Point,\n  PolylineStyleProps,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { inPolyline } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<PolylineStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    points,\n    pointerEvents = 'auto',\n    fill,\n    stroke,\n  } = displayObject.parsedStyle as ParsedPolylineStyleProps;\n  const [, hasStroke] = isFillOrStrokeAffected(pointerEvents, fill, stroke);\n\n  if ((!hasStroke && !isClipPath) || !lineWidth) {\n    return false;\n  }\n\n  return inPolyline(\n    points.points,\n    lineWidth + increasedLineWidthForHitTesting,\n    position.x,\n    position.y,\n    false,\n  );\n}\n","import type {\n  DisplayObject,\n  ParsedRectStyleProps,\n  Point,\n  RectStyleProps,\n} from '@antv/g-lite';\nimport { GlobalRuntime, isFillOrStrokeAffected } from '@antv/g-lite';\nimport { clamp } from '@antv/util';\nimport { inArc, inBox, inLine, inRect } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<RectStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<RectStyleProps>,\n    position: Point,\n  ) => boolean,\n  runtime: GlobalRuntime,\n): boolean {\n  const {\n    radius,\n    fill,\n    stroke,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    x = 0,\n    y = 0,\n    width,\n    height,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedRectStyleProps;\n\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  const hasRadius = radius && radius.some((r) => r !== 0);\n\n  const lineWidthForHitTesting = lineWidth + increasedLineWidthForHitTesting;\n\n  // 无圆角时的策略\n  if (!hasRadius) {\n    const halfWidth = lineWidthForHitTesting / 2;\n    // 同时填充和带有边框\n    if ((hasFill && hasStroke) || isClipPath) {\n      return inBox(\n        x - halfWidth,\n        y - halfWidth,\n        width + halfWidth,\n        height + halfWidth,\n        position.x,\n        position.y,\n      );\n    }\n    // 仅填充\n    if (hasFill) {\n      return inBox(x, y, width, height, position.x, position.y);\n    }\n    if (hasStroke) {\n      return inRect(\n        x,\n        y,\n        width,\n        height,\n        lineWidthForHitTesting,\n        position.x,\n        position.y,\n      );\n    }\n  } else {\n    let isHit = false;\n    if (hasStroke || isClipPath) {\n      isHit = inRectWithRadius(\n        x,\n        y,\n        width,\n        height,\n        radius.map((r) =>\n          clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2)),\n        ) as [number, number, number, number],\n        lineWidthForHitTesting,\n        position.x,\n        position.y,\n      );\n    }\n    // 仅填充时带有圆角的矩形直接通过图形拾取\n    // 以后可以改成纯数学的近似拾取，将圆弧切割成多边形\n    if (!isHit && (hasFill || isClipPath)) {\n      isHit = isPointInPath(displayObject, position);\n    }\n    return isHit;\n  }\n\n  return false;\n}\n\nfunction inRectWithRadius(\n  minX: number,\n  minY: number,\n  width: number,\n  height: number,\n  radiusArray: [number, number, number, number],\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const [tlr, trr, brr, blr] = radiusArray;\n  return (\n    inLine(minX + tlr, minY, minX + width - trr, minY, lineWidth, x, y) ||\n    inLine(\n      minX + width,\n      minY + trr,\n      minX + width,\n      minY + height - brr,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inLine(\n      minX + width - brr,\n      minY + height,\n      minX + blr,\n      minY + height,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inLine(minX, minY + height - blr, minX, minY + tlr, lineWidth, x, y) ||\n    inArc(\n      minX + width - trr,\n      minY + trr,\n      trr,\n      1.5 * Math.PI,\n      2 * Math.PI,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inArc(\n      minX + width - brr,\n      minY + height - brr,\n      brr,\n      0,\n      0.5 * Math.PI,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inArc(\n      minX + blr,\n      minY + height - blr,\n      blr,\n      0.5 * Math.PI,\n      Math.PI,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inArc(minX + tlr, minY + tlr, tlr, Math.PI, 1.5 * Math.PI, lineWidth, x, y)\n  );\n}\n","import {\n  DisplayObject,\n  ParsedImageStyleProps,\n  Point,\n  ImageStyleProps,\n  Shape,\n  RenderingPluginContext,\n  GlobalRuntime,\n} from '@antv/g-lite';\nimport { StyleRenderer } from '../canvas-renderer';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<ImageStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<ImageStyleProps>,\n    position: Point,\n  ) => boolean,\n  renderingPluginContext: RenderingPluginContext,\n  runtime: GlobalRuntime,\n): boolean {\n  const {\n    pointerEvents = 'auto',\n    x = 0,\n    y = 0,\n    width,\n    height,\n  } = displayObject.parsedStyle as ParsedImageStyleProps;\n\n  if (pointerEvents === 'non-transparent-pixel') {\n    const { offscreenCanvas } = renderingPluginContext.config;\n    const canvas =\n      runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n    const context = runtime.offscreenCanvasCreator.getOrCreateContext(\n      offscreenCanvas,\n      {\n        willReadFrequently: true,\n      },\n    ) as CanvasRenderingContext2D;\n    canvas.width = width;\n    canvas.height = height;\n\n    (\n      (renderingPluginContext as any).defaultStyleRendererFactory as Record<\n        Shape,\n        StyleRenderer\n      >\n    )[Shape.IMAGE].render(\n      context,\n      { ...displayObject.parsedStyle, x: 0, y: 0 },\n      displayObject,\n      undefined,\n      undefined,\n      undefined,\n    );\n\n    const imagedata = context.getImageData(\n      position.x - x,\n      position.y - y,\n      1,\n      1,\n    ).data;\n    return imagedata.every((component) => component !== 0);\n  }\n\n  return true;\n}\n","import type { DisplayObject, Point, TextStyleProps } from '@antv/g-lite';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<TextStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<TextStyleProps>,\n    position: Point,\n  ) => boolean,\n): boolean {\n  const bounds = displayObject.getGeometryBounds();\n\n  // @see https://stackoverflow.com/questions/28706989/how-do-i-check-if-a-mouse-click-is-inside-a-rotated-text-on-the-html5-canvas-in\n  return (\n    position.x >= bounds.min[0] &&\n    position.y >= bounds.min[1] &&\n    position.x <= bounds.max[0] &&\n    position.y <= bounds.max[1]\n  );\n}\n","import { AbstractRendererPlugin, Shape } from '@antv/g-lite';\nimport type { PointInPathPicker } from './CanvasPickerPlugin';\nimport { CanvasPickerPlugin } from './CanvasPickerPlugin';\nimport { isPointInPath as CirclePicker } from './Circle';\nimport { isPointInPath as EllipsePicker } from './Ellipse';\nimport { isPointInPath as LinePicker } from './Line';\nimport { isPointInPath as PathPicker } from './Path';\nimport { isPointInPath as PolygonPicker } from './Polygon';\nimport { isPointInPath as PolylinePicker } from './Polyline';\nimport { isPointInPath as RectPicker } from './Rect';\nimport { isPointInPath as ImagePicker } from './Image';\nimport { isPointInPath as TextPicker } from './Text';\n\nexport class Plugin extends AbstractRendererPlugin {\n  name = 'canvas-picker';\n  init(): void {\n    const pointInPathPickerFactory: Record<Shape, PointInPathPicker<any>> = {\n      [Shape.CIRCLE]: CirclePicker,\n      [Shape.ELLIPSE]: EllipsePicker,\n      [Shape.RECT]: RectPicker,\n      [Shape.LINE]: LinePicker,\n      [Shape.POLYLINE]: PolylinePicker,\n      [Shape.POLYGON]: PolygonPicker,\n      [Shape.PATH]: PathPicker,\n      [Shape.TEXT]: TextPicker,\n      [Shape.GROUP]: null,\n      [Shape.IMAGE]: ImagePicker,\n      [Shape.HTML]: null,\n      [Shape.MESH]: null,\n    };\n\n    // @ts-ignore\n    this.context.pointInPathPickerFactory = pointInPathPickerFactory;\n\n    this.addRenderingPlugin(new CanvasPickerPlugin());\n  }\n  destroy(): void {\n    // @ts-ignore\n    delete this.context.pointInPathPickerFactory;\n    this.removeAllRenderingPlugins();\n  }\n}\n","import type { ParsedCircleStyleProps } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedCircleStyleProps,\n) {\n  const { cx = 0, cy = 0, r } = parsedStyle;\n  context.arc(cx, cy, r, 0, Math.PI * 2, false);\n}\n","import type { ParsedEllipseStyleProps } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedEllipseStyleProps,\n) {\n  const { cx = 0, cy = 0, rx, ry } = parsedStyle;\n\n  // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n  if (context.ellipse) {\n    context.ellipse(cx, cy, rx, ry, 0, 0, Math.PI * 2, false);\n  } else {\n    // 如果不支持，则使用圆来绘制，进行变形\n    const r = rx > ry ? rx : ry;\n    const scaleX = rx > ry ? 1 : rx / ry;\n    const scaleY = rx > ry ? ry / rx : 1;\n    context.save();\n    context.scale(scaleX, scaleY);\n    context.arc(cx, cy, r, 0, Math.PI * 2);\n  }\n}\n","import type { ParsedLineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedLineStyleProps,\n) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2,\n    markerStart,\n    markerEnd,\n    markerStartOffset,\n    markerEndOffset,\n  } = parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = x2 - x1;\n    y = y2 - y1;\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = x1 - x2;\n    y = y1 - y2;\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  context.moveTo(x1 + startOffsetX, y1 + startOffsetY);\n  context.lineTo(x2 + endOffsetX, y2 + endOffsetY);\n}\n","import type { ParsedPathStyleProps, Path } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedPathStyleProps,\n) {\n  const { markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n  const { absolutePath, segments } = parsedStyle.d;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    const [p1, p2] = (markerStart.parentNode as Path).getStartTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    const [p1, p2] = (markerEnd.parentNode as Path).getEndTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  for (let i = 0; i < absolutePath.length; i++) {\n    const params = absolutePath[i];\n    const command = params[0];\n    const nextSegment = absolutePath[i + 1];\n    const useStartOffset =\n      i === 0 && (startOffsetX !== 0 || startOffsetY !== 0);\n    const useEndOffset =\n      (i === absolutePath.length - 1 ||\n        (nextSegment && (nextSegment[0] === 'M' || nextSegment[0] === 'Z'))) &&\n      endOffsetX !== 0 &&\n      endOffsetY !== 0;\n    const [startOffsetXTemp, startOffsetYTemp] = useStartOffset\n      ? [startOffsetX, startOffsetY]\n      : [0, 0];\n    const [endOffsetXTemp, endOffsetYTemp] = useEndOffset\n      ? [endOffsetX, endOffsetY]\n      : [0, 0];\n\n    switch (command) {\n      case 'M':\n        // Use start marker offset\n        context.moveTo(\n          params[1] + startOffsetXTemp,\n          params[2] + startOffsetYTemp,\n        );\n        break;\n      case 'L':\n        context.lineTo(params[1] + endOffsetXTemp, params[2] + endOffsetYTemp);\n        break;\n      case 'Q':\n        context.quadraticCurveTo(\n          params[1],\n          params[2],\n          params[3] + endOffsetXTemp,\n          params[4] + endOffsetYTemp,\n        );\n        break;\n      case 'C':\n        context.bezierCurveTo(\n          params[1],\n          params[2],\n          params[3],\n          params[4],\n          params[5] + endOffsetXTemp,\n          params[6] + endOffsetYTemp,\n        );\n        break;\n      case 'A': {\n        // FIXME startOffset / endOffset\n        const { arcParams } = segments[i];\n        const { cx, cy, rx, ry, startAngle, endAngle, xRotation, sweepFlag } =\n          arcParams;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n        if (context.ellipse) {\n          context.ellipse(\n            cx,\n            cy,\n            rx,\n            ry,\n            xRotation,\n            startAngle,\n            endAngle,\n            !!(1 - sweepFlag),\n          );\n        } else {\n          // @see https://stackoverflow.com/a/47494351\n          const r = rx > ry ? rx : ry;\n          const scaleX = rx > ry ? 1 : rx / ry;\n          const scaleY = rx > ry ? ry / rx : 1;\n          context.translate(cx, cy);\n          context.rotate(xRotation);\n          context.scale(scaleX, scaleY);\n          context.arc(0, 0, r, startAngle, endAngle, !!(1 - sweepFlag));\n          context.scale(1 / scaleX, 1 / scaleY);\n          context.rotate(-xRotation);\n          context.translate(-cx, -cy);\n        }\n\n        if (useEndOffset) {\n          context.lineTo(params[6] + endOffsetX, params[7] + endOffsetY);\n        }\n        break;\n      }\n      case 'Z':\n        context.closePath();\n        break;\n      default:\n        break;\n    }\n  }\n}\n","import type { ParsedPolygonStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedPolygonStyleProps,\n) {\n  const { markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n  const { points } = parsedStyle.points;\n  const { length } = points;\n\n  const x1 = points[0][0];\n  const y1 = points[0][1];\n  const x2 = points[length - 1][0];\n  const y2 = points[length - 1][1];\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = points[1][0] - points[0][0];\n    y = points[1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = points[length - 1][0] - points[0][0];\n    y = points[length - 1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  context.moveTo(\n    x1 + (startOffsetX || endOffsetX),\n    y1 + (startOffsetY || endOffsetY),\n  );\n  for (let i = 1; i < length - 1; i++) {\n    const point = points[i];\n    context.lineTo(point[0], point[1]);\n  }\n  context.lineTo(x2, y2);\n}\n","import type { ParsedPolylineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedPolylineStyleProps,\n) {\n  const { markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n  const { points } = parsedStyle.points;\n  const { length } = points;\n\n  const x1 = points[0][0];\n  const y1 = points[0][1];\n  const x2 = points[length - 1][0];\n  const y2 = points[length - 1][1];\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = points[1][0] - points[0][0];\n    y = points[1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = points[length - 2][0] - points[length - 1][0];\n    y = points[length - 2][1] - points[length - 1][1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  context.moveTo(x1 + startOffsetX, y1 + startOffsetY);\n  for (let i = 1; i < length - 1; i++) {\n    const point = points[i];\n    context.lineTo(point[0], point[1]);\n  }\n  context.lineTo(x2 + endOffsetX, y2 + endOffsetY);\n}\n","import type { ParsedRectStyleProps } from '@antv/g-lite';\nimport { clamp } from '@antv/util';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedRectStyleProps,\n) {\n  const { x = 0, y = 0, radius, width, height } = parsedStyle;\n\n  const w = width;\n  const h = height;\n  const hasRadius = radius && radius.some((r) => r !== 0);\n\n  if (!hasRadius) {\n    // Canvas support negative width/height of rect\n    context.rect(x, y, w, h);\n  } else {\n    const signX = width > 0 ? 1 : -1;\n    const signY = height > 0 ? 1 : -1;\n    const sweepFlag = signX + signY === 0;\n    const [tlr, trr, brr, blr] = radius.map((r) =>\n      clamp(r, 0, Math.min(Math.abs(w) / 2, Math.abs(h) / 2)),\n    );\n\n    context.moveTo(signX * tlr + x, y);\n    context.lineTo(w - signX * trr + x, y);\n    if (trr !== 0) {\n      context.arc(\n        w - signX * trr + x,\n        signY * trr + y,\n        trr,\n        (-signY * Math.PI) / 2,\n        signX > 0 ? 0 : Math.PI,\n        sweepFlag,\n      );\n    }\n    context.lineTo(w + x, h - signY * brr + y);\n    if (brr !== 0) {\n      context.arc(\n        w - signX * brr + x,\n        h - signY * brr + y,\n        brr,\n        signX > 0 ? 0 : Math.PI,\n        signY > 0 ? Math.PI / 2 : 1.5 * Math.PI,\n        sweepFlag,\n      );\n    }\n    context.lineTo(signX * blr + x, h + y);\n    if (blr !== 0) {\n      context.arc(\n        signX * blr + x,\n        h - signY * blr + y,\n        blr,\n        signY > 0 ? Math.PI / 2 : -Math.PI / 2,\n        signX > 0 ? Math.PI : 0,\n        sweepFlag,\n      );\n    }\n    context.lineTo(x, signY * tlr + y);\n    if (tlr !== 0) {\n      context.arc(\n        signX * tlr + x,\n        signY * tlr + y,\n        tlr,\n        signX > 0 ? Math.PI : 0,\n        signY > 0 ? Math.PI * 1.5 : Math.PI / 2,\n        sweepFlag,\n      );\n    }\n  }\n}\n","import { AbstractRendererPlugin, Shape } from '@antv/g-lite';\nimport type { PathGenerator } from './interfaces';\nimport {\n  CirclePath,\n  EllipsePath,\n  LinePath,\n  PathPath,\n  PolygonPath,\n  PolylinePath,\n  RectPath,\n} from './paths';\n\nexport class Plugin extends AbstractRendererPlugin<{\n  pathGeneratorFactory: Record<Shape, PathGenerator<any>>;\n}> {\n  name = 'canvas-path-generator';\n  init(): void {\n    const pathGeneratorFactory: Record<Shape, PathGenerator<any>> = {\n      [Shape.CIRCLE]: CirclePath,\n      [Shape.ELLIPSE]: EllipsePath,\n      [Shape.RECT]: RectPath,\n      [Shape.LINE]: LinePath,\n      [Shape.POLYLINE]: PolylinePath,\n      [Shape.POLYGON]: PolygonPath,\n      [Shape.PATH]: PathPath,\n      [Shape.TEXT]: undefined,\n      [Shape.GROUP]: undefined,\n      [Shape.IMAGE]: undefined,\n      [Shape.HTML]: undefined,\n      [Shape.MESH]: undefined,\n      [Shape.FRAGMENT]: undefined,\n    };\n\n    // @ts-ignore\n    this.context.pathGeneratorFactory = pathGeneratorFactory;\n  }\n  destroy(): void {\n    // @ts-ignore\n    delete this.context.pathGeneratorFactory;\n  }\n}\n\nexport * from './interfaces';\n","import type {\n  RenderingContext,\n  CanvasContext,\n  CanvasLike,\n  DataURLOptions,\n  GlobalRuntime,\n  CanvasConfig,\n  ContextService,\n} from '@antv/g-lite';\nimport { RenderReason, setDOMSize } from '@antv/g-lite';\nimport { isString } from '@antv/util';\n\nexport class Canvas2DContextService\n  implements ContextService<CanvasRenderingContext2D>\n{\n  private $container: HTMLElement | null;\n  private $canvas: CanvasLike | null;\n  private dpr: number;\n  private context:\n    | CanvasRenderingContext2D\n    | OffscreenCanvasRenderingContext2D\n    | null;\n  private canvasConfig: Partial<CanvasConfig>;\n  private renderingContext: RenderingContext;\n\n  constructor(context: GlobalRuntime & CanvasContext) {\n    this.renderingContext = context.renderingContext;\n    this.canvasConfig = context.config;\n  }\n\n  init() {\n    const { container, canvas } = this.canvasConfig;\n\n    if (canvas) {\n      this.$canvas = canvas;\n\n      if (\n        container &&\n        (canvas as HTMLCanvasElement).parentElement !== container\n      ) {\n        (container as HTMLElement).appendChild(canvas as HTMLCanvasElement);\n      }\n\n      this.$container = (canvas as HTMLCanvasElement).parentElement;\n      this.canvasConfig.container = this.$container;\n    } else if (container) {\n      // create container\n      this.$container = isString(container)\n        ? document.getElementById(container)\n        : container;\n      if (this.$container) {\n        // create canvas\n        const $canvas = document.createElement('canvas');\n\n        this.$container.appendChild($canvas);\n        if (!this.$container.style.position) {\n          this.$container.style.position = 'relative';\n        }\n        this.$canvas = $canvas;\n      }\n    }\n\n    this.context = this.$canvas.getContext('2d');\n    this.resize(this.canvasConfig.width, this.canvasConfig.height);\n  }\n\n  getContext() {\n    return this.context as CanvasRenderingContext2D;\n  }\n\n  getDomElement() {\n    return this.$canvas;\n  }\n\n  getDPR() {\n    return this.dpr;\n  }\n\n  getBoundingClientRect() {\n    if ((this.$canvas as HTMLCanvasElement).getBoundingClientRect) {\n      return (this.$canvas as HTMLCanvasElement).getBoundingClientRect();\n    }\n  }\n\n  destroy() {\n    // @ts-ignore\n    if (this.$container && this.$canvas && this.$canvas.parentNode) {\n      // destroy context\n      // @ts-ignore\n      this.$container.removeChild(this.$canvas);\n    }\n  }\n\n  resize(width: number, height: number) {\n    const { devicePixelRatio: dpr } = this.canvasConfig;\n    this.dpr = dpr;\n\n    if (this.$canvas) {\n      // set canvas width & height\n      this.$canvas.width = this.dpr * width;\n      this.$canvas.height = this.dpr * height;\n\n      // set CSS style width & height\n      setDOMSize(this.$canvas, width, height);\n\n      // const dpr = this.getDPR();\n      // scale all drawing operations by the dpr\n      // @see https://www.html5rocks.com/en/tutorials/canvas/hidpi/\n      // this.context.scale(dpr, dpr);\n    }\n\n    this.renderingContext.renderReasons.add(RenderReason.CAMERA_CHANGED);\n  }\n\n  applyCursorStyle(cursor: string) {\n    if (this.$container && this.$container.style) {\n      this.$container.style.cursor = cursor;\n    }\n  }\n\n  async toDataURL(options: Partial<DataURLOptions> = {}) {\n    const { type, encoderOptions } = options;\n    return (this.context.canvas as HTMLCanvasElement).toDataURL(\n      type,\n      encoderOptions,\n    );\n  }\n}\n","import { AbstractRendererPlugin } from '@antv/g-lite';\nimport { Canvas2DContextService } from './Canvas2DContextService';\n\nexport class ContextRegisterPlugin extends AbstractRendererPlugin {\n  name = 'canvas-context-register';\n  init(): void {\n    this.context.ContextService = Canvas2DContextService;\n  }\n  destroy(): void {\n    delete this.context.ContextService;\n  }\n}\n","import type { RendererConfig } from '@antv/g-lite';\nimport {\n  AbstractRenderer,\n  ImageLoader,\n  HTMLRenderer,\n  DomInteraction,\n} from '@antv/g-lite';\nimport * as CanvasRenderer from './plugins/canvas-renderer';\nimport * as CanvasPicker from './plugins/picker';\nimport * as CanvasPathGenerator from './plugins/path-generator';\nimport { ContextRegisterPlugin } from './ContextRegisterPlugin';\n\nexport class Renderer extends AbstractRenderer {\n  constructor(config?: Partial<RendererConfig>) {\n    super(config);\n\n    // register Canvas2DContext\n    this.registerPlugin(new ContextRegisterPlugin());\n    this.registerPlugin(new ImageLoader.Plugin());\n    this.registerPlugin(new CanvasPathGenerator.Plugin());\n    // enable rendering with Canvas2D API\n    this.registerPlugin(new CanvasRenderer.Plugin());\n    this.registerPlugin(new DomInteraction.Plugin());\n    // enable picking with Canvas2D API\n    this.registerPlugin(new CanvasPicker.Plugin());\n\n    // render HTML component\n    this.registerPlugin(new HTMLRenderer.Plugin());\n  }\n}\n\n// plugins\nexport type { PathGenerator } from './plugins/path-generator';\nexport { CanvasRenderer, CanvasPicker, CanvasPathGenerator };\nexport { DomInteraction, HTMLRenderer, ImageLoader };\n"],"names":["_renderState","_classPrivateFieldLooseKey","CanvasRendererPlugin","canvasRendererPluginOptions","_classCallCheck","renderQueue","Object","defineProperty","writable","value","restoreStack","prevObject","currentContext","Map","clearFullScreenLastFrame","clearFullScreen","vpMatrix","mat4","create","dprMatrix","tmpMat4","vec3a","vec3","vec3b","vec3c","vec3d","_createClass","key","apply","context","runtime","_this","_this$context","config","camera","renderingService","renderingContext","pathGeneratorFactory","enableRenderingOptimization","renderer","getConfig","enableDirtyCheck","enableDirtyRectangleRendering","contextService","canvas","root","ownerDocument","defaultView","hooks","init","tap","tag","dpr","getDPR","width","height","getContext","clearRect","background","destroy","_classPrivateFieldLooseBase","beforeDraw","_canvas$context$rende","_this$canvasRendererP","dirtyObjectNumThreshold","dirtyObjectRatioThreshold","_renderingService$get","getStats","total","rendered","ratio","renderingPlugins","isFirstTimeRenderingFinished","disableDirtyRectangleRendering","resetTransform","setTransform","renderByZIndex","object","stack","length","_currentObject$sortab","currentObject","pop","isVisible","isCulled","renderDisplayObjectOptimized","renderDisplayObject","objects","sortable","sorted","childNodes","i","push","endFrame","clear","fromScaling","multiply","getOrthoMatrix","save","restore","dirtyRenderBounds","safeMergeAABB","mergeDirtyAABBs","AABB","isEmpty","dirtyRect","convertAABB2Rect","x","y","tl","transformMat4","tr","bl","br","minx","Math","min","miny","maxx","max","maxy","ix","floor","iy","iwidth","ceil","iheight","beginPath","rect","clip","_config$renderer$getC","enableDirtyRectangleRenderingDebug","dispatchEvent","CustomEvent","CanvasEvent","DIRTY_RECTANGLE","_dirtyRenderBounds$ge","getMin","_dirtyRenderBounds$ge2","_slicedToArray","minX","minY","_dirtyRenderBounds$ge3","getMax","_dirtyRenderBounds$ge4","maxX","maxY","dirtyObjects","elementsFromBBox","sort","a","b","renderOrder","forEach","saveDirtyAABB","render","fillStyle","fillRect","canvasContext","renderState","nodeName","updateTransform","clipDraw","styleRenderer","styleRendererFactory","generatePath","clipPath","parsedStyle","exactEquals","getWorldTransform","applyWorldTransform","closePath","forceUpdateStyle","prevNodeName","Shape","TEXT","IMAGE","applyStyleToContext","LINE","PATH","POLYLINE","drawToContext","dirty","parent","compareDocumentPosition","Node","DOCUMENT_POSITION_CONTAINS","applyAttributesToContext","_ref","stroke","fill","opacity","lineDash","lineDashOffset","setLineDash","isNil","globalAlpha","Array","isArray","isNone","strokeStyle","attributes","aabb","renderBounds","getRenderBounds","add","renderable","update","center","halfExtents","matrix","copy","getLocalTransform","merged","_len","arguments","aabbs","_key","getPattern","pattern","plugin","imagePool","$offscreenCanvas","image","_parsedStyle","offscreenCanvas","offscreenCanvasCreator","getOrCreateCanvas","offscreenCanvasContext","getOrCreateContext","canvasPattern","getOrCreatePatternSync","getGeometryBounds","getColor","parsedColor","color","type","GradientType","LinearGradient","RadialGradient","bounds","getOrCreateGradient","_objectSpread","SHADOW_NUMBER_STYLE","STROKE_STYLE","DEFAULT_STYLE","shadowBlur","shadowOffsetX","shadowOffsetY","shadowColor","filter","globalCompositeOperation","strokeOpacity","lineWidth","lineCap","lineJoin","miterLimit","fillOpacity","defaultParsedStyle","updateContextIfNotHitCache","cache","prevValue","has","get","set","OptimizedDefaultRenderer","applyCommonStyleToContext","forceUpdate","prevStyle","style","blend","applyStrokeFillStyleToContext","_style$lineWidth","hasFill","hasStroke","styleName","applyShadowAndFilterStyleToContext","hasShadow","toString","clearShadowAndFilterStyleForContext","hasFilter","onlyClearShadowFilter","undefined","oldFilter","indexOf","replace","trim","fillToContext","_object$parsedStyle","fillRule","resetStyle","gradient","isPattern","strokeToContext","_this2","_style$fill","_style$opacity","_style$fillOpacity","_style$strokeOpacity","_style$lineWidth2","isInnerShadow","shadowType","isFillTransparent","alpha","shouldDrawShadowWithStroke","originGlobalAlpha","updateOpacity","clearShadowAndFilter","prevOpacity","originBlend","DefaultRenderer","_OptimizedDefaultRend","_callSuper","_inherits","_parsedStyle$opacity","_parsedStyle$fillOpac","_parsedStyle$strokeOp","_parsedStyle$lineWidt","setShadowAndFilter","applyFill","applyStroke","skipFill","skipStroke","calculateOverlapRect","rect1","rect2","_rect","x1","y1","w1","h1","_rect2","x2","y2","w2","h2","overlapLeft","overlapTop","overlapRight","overlapBottom","transformRect","ImageRenderer","_DefaultRenderer","renderDownSampled","data","src","imageCache","downSampled","createDownSampledImage","then","reason","console","error","drawImage","drawRect","renderTile","imageRect","originalSize","size","_context$getTransform","getTransform","c","d","e","f","gridSize","createImageTiles","scaleToOrigin","scaledTileSize","tileSize","startTileX","endTileX","_ref2","startTileY","endTileY","tileY","tileX","item","tiles","tileRect","_parsedStyle$x","_parsedStyle$y","getImageSync","img","iw","ih","_object$ownerDocument","getContextService","getDomElement","viewWidth","viewHeight","currentTransform","transformMatrix","fromValues","enableLargeImageOptimization","renderFull","sizeOfOrigin","downSamplingRate","ImagePool","isSupportTile","_unused","TextRenderer","getBounds","_parsedStyle$textAlig","textAlign","_parsedStyle$textBase","textBaseline","_parsedStyle$lineJoin","_parsedStyle$miterLim","_parsedStyle$letterSp","letterSpacing","metrics","dx","dy","textDecorationLine","font","lines","lineHeight","lineMetrics","formattedTextBaseline","linePositionY","offsetX","linePositionX","drawLetterSpacing","drawTextDecorations","text","isStroke","strokeText","fillText","currentTextAlign","currentPosition","stringArray","from","previousWidth","measureText","currentWidth","currentChar","substring","currentGlobalAlpha","applyOpacity","baseY","textDecorationColor","textDecorationStyle","_parsedStyle$textDeco","textDecorationThickness","_parsedStyle$textAlig2","_parsedStyle$lineWidt2","decorations","split","concat","r","g","_parsedStyle$textBase2","lineMetric","lineWidthOffset","startX","endX","_iterator","_createForOfIteratorHelper","_step","s","n","done","decoration","decorationY","drawWavyLine","moveTo","lineTo","err","amplitude","wavelength","numWaves","quadraticCurveTo","x3","y3","x4","y4","Plugin","_AbstractRendererPlug","options","name","_defaultStyleRenderer","defaultRenderer","defaultStyleRendererFactory","_defineProperty","CIRCLE","ELLIPSE","RECT","POLYGON","GROUP","HTML","MESH","FRAGMENT","addRenderingPlugin","removeAllRenderingPlugins","AbstractRendererPlugin","tmpVec3a","tmpVec3b","tmpVec3c","CanvasPickerPlugin","isHit","displayObject","position","worldTransform","isClipPath","pick","pointInPathPickerFactory","invertWorldMat","invert","localPosition","Point","isPointInPath","_renderingContext$roo","document","tapPromise","_asyncToGenerator","_regeneratorRuntime","mark","_callee","result","wrap","_context","prev","next","abrupt","stop","_x","pickSync","topmost","_result$position","hitTestList","pickedDisplayObjects","isHitOriginShape","clipped","findClosestClipPathTarget","isHitClipPath","picked","_ref$cx","cx","_ref$cy","cy","_ref$lineWidth","_ref$increasedLineWid","increasedLineWidthForHitTesting","_ref$pointerEvents","pointerEvents","halfLineWidth","absDistance","distance","_isFillOrStrokeAffect","isFillOrStrokeAffected","_isFillOrStrokeAffect2","ellipseDistance","squareX","squareY","rx","ry","halfLineWith","inBox","inRect","halfWidth","inArc","startAngle","endAngle","angle","atan2","PI","point","cos","sin","inLine","linePointToLine","inPolyline","points","isClose","count","first","last","tolerance","dcmp","abs","onSegment","p1","p2","q","inPolygon","inPolygons","polygons","isPointInStroke","segments","px","py","segment","currentPoint","params","prePoint","box","command","qDistance","quadPointDistance","cDistance","cubicPointDistance","cubicParams","arcToCubic","args","prePointInCubic","renderingPluginContext","hasArc","polylines","totalLength","getOrCalculatePathTotalLength","radius","_ref$x","_ref$y","hasRadius","some","lineWidthForHitTesting","inRectWithRadius","map","clamp","radiusArray","_radiusArray","tlr","trr","brr","blr","willReadFrequently","imagedata","getImageData","every","component","_pointInPathPickerFac","CirclePicker","EllipsePicker","RectPicker","LinePicker","PolylinePicker","PolygonPicker","PathPicker","TextPicker","ImagePicker","_parsedStyle$cx","_parsedStyle$cy","arc","ellipse","scaleX","scaleY","scale","markerStart","markerEnd","markerStartOffset","markerEndOffset","startOffsetX","startOffsetY","endOffsetX","endOffsetY","rad","isDisplayObject","_parsedStyle$d","absolutePath","_getStartTangent","parentNode","getStartTangent","_getStartTangent2","_getEndTangent","getEndTangent","_getEndTangent2","nextSegment","useStartOffset","useEndOffset","startOffsetXTemp","startOffsetYTemp","_ref3","_ref4","endOffsetXTemp","endOffsetYTemp","bezierCurveTo","arcParams","xRotation","sweepFlag","translate","rotate","w","h","signX","signY","_radius$map","_radius$map2","_pathGeneratorFactory","CirclePath","EllipsePath","RectPath","LinePath","PolylinePath","PolygonPath","PathPath","Canvas2DContextService","canvasConfig","_this$canvasConfig","container","$canvas","parentElement","appendChild","$container","isString","getElementById","createElement","resize","getBoundingClientRect","removeChild","devicePixelRatio","setDOMSize","renderReasons","RenderReason","CAMERA_CHANGED","applyCursorStyle","cursor","_toDataURL","encoderOptions","_args","toDataURL","ContextRegisterPlugin","ContextService","Renderer","_AbstractRenderer","registerPlugin","ImageLoader","CanvasPathGenerator","CanvasRenderer","DomInteraction","CanvasPicker","HTMLRenderer","AbstractRenderer"],"mappings":"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"}