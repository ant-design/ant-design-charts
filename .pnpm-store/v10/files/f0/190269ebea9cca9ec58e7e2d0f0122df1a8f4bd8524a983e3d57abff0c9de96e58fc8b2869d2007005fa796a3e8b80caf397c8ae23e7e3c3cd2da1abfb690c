{"version":3,"file":"index.umd.min.js","sources":["../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/typeof.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/createClass.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/callSuper.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/inherits.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/is-nil.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/is-string.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/clamp.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/common.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/mat4.js","../src/plugins/svg-renderer/components/ElementSVG.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../src/plugins/svg-renderer/shapes/paths/Image.ts","../src/plugins/svg-renderer/shapes/paths/Line.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../src/plugins/svg-renderer/shapes/paths/Path.ts","../src/plugins/svg-renderer/shapes/paths/Polyline.ts","../src/plugins/svg-renderer/shapes/paths/Rect.ts","../src/plugins/svg-renderer/utils/dom.ts","../src/plugins/svg-renderer/shapes/defs/Filter.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../src/plugins/svg-renderer/shapes/defs/Pattern.ts","../src/plugins/svg-renderer/shapes/defs/DefElementManager.ts","../src/plugins/svg-renderer/shapes/defs/Shadow.ts","../src/plugins/svg-renderer/utils/format.ts","../src/plugins/svg-renderer/SVGRendererPlugin.ts","../src/plugins/svg-renderer/shapes/paths/Text.ts","../src/plugins/svg-renderer/DefaultElementLifeCycleContribution.ts","../src/plugins/svg-renderer/index.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/OverloadYield.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorDefine.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regenerator.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorAsyncIterator.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorAsyncGen.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorAsync.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorKeys.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorValues.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","../src/plugins/picker/SVGPickerPlugin.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","../src/plugins/picker/index.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../src/SVGContextService.ts","../src/ContextRegisterPlugin.ts","../src/index.ts"],"sourcesContent":["function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nexport { _classCallCheck as default };","function _getPrototypeOf(t) {\n  return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, _getPrototypeOf(t);\n}\nexport { _getPrototypeOf as default };","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (_isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  })();\n}\nexport { _isNativeReflectConstruct as default };","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nexport { _possibleConstructorReturn as default };","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nexport { _assertThisInitialized as default };","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nfunction _callSuper(t, o, e) {\n  return o = getPrototypeOf(o), possibleConstructorReturn(t, isNativeReflectConstruct() ? Reflect.construct(o, e || [], getPrototypeOf(t).constructor) : o.apply(t, e));\n}\nexport { _callSuper as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nexport { _inherits as default };","/**\n * 判断值是否为 null 或 undefined\n * @return 是否为 null 或 undefined\n */\nexport default function isNil(value) {\n    return value === null || value === undefined;\n}\n//# sourceMappingURL=is-nil.js.map","/**\n * 判断值是否为字符串\n * @return 是否为字符串\n */\nexport default function isString(value) {\n    return typeof value === 'string';\n}\n//# sourceMappingURL=is-string.js.map","var clamp = function (a, min, max) {\n    if (a < min) {\n        return min;\n    }\n    else if (a > max) {\n        return max;\n    }\n    return a;\n};\nexport default clamp;\n//# sourceMappingURL=clamp.js.map","/**\n * Common utilities\n * @module glMatrix\n */\n\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== \"undefined\" ? Float32Array : Array;\nexport var RANDOM = Math.random;\nexport var ANGLE_ORDER = \"zyx\";\n\n/**\n * Symmetric round\n * see https://www.npmjs.com/package/round-half-up-symmetric#user-content-detailed-background\n *\n * @param {Number} a value to round\n */\nexport function round(a) {\n  if (a >= 0) return Math.round(a);\n  return a % 0.5 === 0 ? Math.floor(a) : Math.round(a);\n}\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\nvar radian = 180 / Math.PI;\n\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\nexport function toRadian(a) {\n  return a * degree;\n}\n\n/**\n * Convert Radian To Degree\n *\n * @param {Number} a Angle in Radians\n */\nexport function toDegree(a) {\n  return a * radian;\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a          The first number to test.\n * @param {Number} b          The second number to test.\n * @param {Number} tolerance  Absolute or relative tolerance (default glMatrix.EPSILON)\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function equals(a, b) {\n  var tolerance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : EPSILON;\n  return Math.abs(a - b) <= tolerance * Math.max(1, Math.abs(a), Math.abs(b));\n}","import * as glMatrix from \"./common.js\";\n\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n    var a12 = a[6],\n      a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function adjoint(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n  out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n  out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n  out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n  out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n  out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n  out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n  out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n  out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n  out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n  out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n  out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n  out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n  out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n  out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n  out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n  out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b0 = a00 * a11 - a01 * a10;\n  var b1 = a00 * a12 - a02 * a10;\n  var b2 = a01 * a12 - a02 * a11;\n  var b3 = a20 * a31 - a21 * a30;\n  var b4 = a20 * a32 - a22 * a30;\n  var b5 = a21 * a32 - a22 * a31;\n  var b6 = a00 * b5 - a01 * b4 + a02 * b3;\n  var b7 = a10 * b5 - a11 * b4 + a12 * b3;\n  var b8 = a20 * b2 - a21 * b1 + a22 * b0;\n  var b9 = a30 * b2 - a31 * b1 + a32 * b0;\n\n  // Calculate the determinant\n  return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n}\n\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n\n  // Cache only the current line of the second matrix\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\nexport function translate(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n  return out;\n}\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\nexport function scale(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11];\n\n  // Construct the elements of the rotation matrix\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw;\n  //Only scale if it makes sense\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion parameter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  return out;\n}\n\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n  return out;\n}\n\n/**\n * Decomposes a transformation matrix into its rotation, translation\n * and scale components. Returns only the rotation component\n * @param  {quat} out_r Quaternion to receive the rotation component\n * @param  {vec3} out_t Vector to receive the translation vector\n * @param  {vec3} out_s Vector to receive the scaling factor\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @returns {quat} out_r\n */\nexport function decompose(out_r, out_t, out_s, mat) {\n  out_t[0] = mat[12];\n  out_t[1] = mat[13];\n  out_t[2] = mat[14];\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  var is1 = 1 / out_s[0];\n  var is2 = 1 / out_s[1];\n  var is3 = 1 / out_s[2];\n  var sm11 = m11 * is1;\n  var sm12 = m12 * is2;\n  var sm13 = m13 * is3;\n  var sm21 = m21 * is1;\n  var sm22 = m22 * is2;\n  var sm23 = m23 * is3;\n  var sm31 = m31 * is1;\n  var sm32 = m32 * is2;\n  var sm33 = m33 * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out_r[3] = 0.25 * S;\n    out_r[0] = (sm23 - sm32) / S;\n    out_r[1] = (sm31 - sm13) / S;\n    out_r[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out_r[3] = (sm23 - sm32) / S;\n    out_r[0] = 0.25 * S;\n    out_r[1] = (sm12 + sm21) / S;\n    out_r[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out_r[3] = (sm31 - sm13) / S;\n    out_r[0] = (sm12 + sm21) / S;\n    out_r[1] = 0.25 * S;\n    out_r[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out_r[3] = (sm12 - sm21) / S;\n    out_r[0] = (sm31 + sm13) / S;\n    out_r[1] = (sm23 + sm32) / S;\n    out_r[2] = 0.25 * S;\n  }\n  return out_r;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     mat4.translate(dest, dest, origin);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *     mat4.translate(dest, dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\nexport function fromQuat(out, q) {\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n  return out;\n}\n\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\nexport var perspective = perspectiveNO;\n\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\nexport var ortho = orthoNO;\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} target Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n    eyey = eye[1],\n    eyez = eye[2],\n    upx = up[0],\n    upy = up[1],\n    upz = up[2];\n  var z0 = eyex - target[0],\n    z1 = eyey - target[1],\n    z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n  var x0 = upy * z2 - upz * z1,\n    x1 = upz * z0 - upx * z2,\n    x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + a[6] * a[6] + a[7] * a[7] + a[8] * a[8] + a[9] * a[9] + a[10] * a[10] + a[11] * a[11] + a[12] * a[12] + a[13] * a[13] + a[14] * a[14] + a[15] * a[15]);\n}\n\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7];\n  var a8 = a[8],\n    a9 = a[9],\n    a10 = a[10],\n    a11 = a[11];\n  var a12 = a[12],\n    a13 = a[13],\n    a14 = a[14],\n    a15 = a[15];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  var b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7];\n  var b8 = b[8],\n    b9 = b[9],\n    b10 = b[10],\n    b11 = b[11];\n  var b12 = b[12],\n    b13 = b[13],\n    b14 = b[14],\n    b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\nexport var sub = subtract;","export class ElementSVG {\n  static tag = 'c-svg-element';\n\n  /**\n   * basic element, eg. <circle>|<ellipse>\n   */\n  $el: SVGElement | null;\n\n  /**\n   * group wrapper for basic element, eg. <g><circle /></g>.\n   * if current element is <g>, same as `$el`\n   */\n  $groupEl: SVGElement | null;\n\n  /**\n   * hitArea:\n   * $groupEl -> $el\n   *          -> $hitTestingEl\n   */\n  $hitTestingEl: SVGElement | null;\n}\n","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import type { ParsedImageStyleProps } from '@antv/g-lite';\nimport { isString } from '@antv/util';\n\nexport function updateImageElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedImageStyleProps,\n) {\n  const { src = '', x = 0, y = 0, width, height } = parsedStyle;\n\n  $el.setAttribute('x', `${x}`);\n  $el.setAttribute('y', `${y}`);\n\n  if (isString(src)) {\n    $el.setAttribute('href', src);\n  } else if (src instanceof Image) {\n    if (!width) {\n      $el.setAttribute('width', `${src.width}`);\n    }\n    if (!height) {\n      $el.setAttribute('height', `${src.height}`);\n    }\n    $el.setAttribute('href', src.src);\n  } else if (\n    // @ts-ignore\n    src instanceof HTMLElement &&\n    isString((src as HTMLElement).nodeName) &&\n    (src as HTMLElement).nodeName.toUpperCase() === 'CANVAS'\n  ) {\n    $el.setAttribute('href', (src as HTMLCanvasElement).toDataURL());\n    // @ts-ignore\n  } else if (src instanceof ImageData) {\n    const canvas = document.createElement('canvas');\n    // @ts-ignore\n    canvas.setAttribute('width', `${src.width}`);\n    // @ts-ignore\n    canvas.setAttribute('height', `${src.height}`);\n    const context = canvas.getContext('2d');\n    if (context) {\n      context.putImageData(src, 0, 0);\n      if (!width) {\n        // @ts-ignore\n        $el.setAttribute('width', `${src.width}`);\n      }\n      if (!height) {\n        // @ts-ignore\n        $el.setAttribute('height', `${src.height}`);\n      }\n      $el.setAttribute('href', canvas.toDataURL());\n    }\n  }\n}\n","import type { ParsedLineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function updateLineElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedLineStyleProps,\n) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2,\n    markerStart,\n    markerEnd,\n    markerStartOffset,\n    markerEndOffset,\n  } = parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = x2 - x1;\n    y = y2 - y1;\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = x1 - x2;\n    y = y1 - y2;\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  // @see https://github.com/antvis/g/issues/1038\n  $el.setAttribute('x1', `${x1 + startOffsetX}`);\n  $el.setAttribute('y1', `${y1 + startOffsetY}`);\n  $el.setAttribute('x2', `${x2 + endOffsetX}`);\n  $el.setAttribute('y2', `${y2 + endOffsetY}`);\n}\n","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nexport { _arrayLikeToArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nexport { _unsupportedIterableToArray as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","import type { ParsedPathStyleProps, Path } from '@antv/g-lite';\nimport { isDisplayObject, translatePathToString } from '@antv/g-lite';\n\nexport function updatePathElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedPathStyleProps,\n) {\n  const { d, markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    const [p1, p2] = (markerStart.parentNode as Path).getStartTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    const [p1, p2] = (markerEnd.parentNode as Path).getEndTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  $el.setAttribute(\n    'd',\n    translatePathToString(\n      d.absolutePath,\n      startOffsetX,\n      startOffsetY,\n      endOffsetX,\n      endOffsetY,\n    ),\n  );\n}\n","import type { ParsedPolylineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function updatePolylineElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedPolylineStyleProps,\n) {\n  const {\n    points: { points },\n    markerStart,\n    markerStartOffset,\n    markerEnd,\n    markerEndOffset,\n  } = parsedStyle;\n  const { length } = points;\n\n  if (points && length >= 2) {\n    let startOffsetX = 0;\n    let startOffsetY = 0;\n    let endOffsetX = 0;\n    let endOffsetY = 0;\n\n    let rad = 0;\n    let x: number;\n    let y: number;\n\n    if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n      x = points[1][0] - points[0][0];\n      y = points[1][1] - points[0][1];\n      rad = Math.atan2(y, x);\n      startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n      startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n    }\n\n    if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n      x = points[length - 2][0] - points[length - 1][0];\n      y = points[length - 2][1] - points[length - 1][1];\n      rad = Math.atan2(y, x);\n      endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n      endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n    }\n\n    $el.setAttribute(\n      'points',\n      points\n        .map((point: [number, number], i) => {\n          let offsetX = 0;\n          let offsetY = 0;\n          if (i === 0) {\n            offsetX = startOffsetX;\n            offsetY = startOffsetY;\n          } else if (i === length - 1) {\n            offsetX = endOffsetX;\n            offsetY = endOffsetY;\n          }\n          return `${point[0] + offsetX},${point[1] + offsetY}`;\n        })\n        .join(' '),\n    );\n  }\n}\n","import type { ParsedRectStyleProps } from '@antv/g-lite';\nimport { clamp } from '@antv/util';\n\nexport function updateRectElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedRectStyleProps,\n) {\n  const { radius, x = 0, y = 0, width, height } = parsedStyle;\n\n  // CSSKeyword: auto\n  if (!isFinite(width) || !isFinite(height)) {\n    return;\n  }\n\n  const hasRadius = radius && radius.some((r) => r !== 0);\n\n  let d = '';\n  if (!hasRadius) {\n    d = `M ${x},${y} l ${width},0 l 0,${height} l${-width} 0 z`;\n  } else {\n    const [tlr, trr, brr, blr] = radius.map((r) =>\n      clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2)),\n    );\n\n    const signX = width > 0 ? 1 : -1;\n    const signY = height > 0 ? 1 : -1;\n    // sweep-flag @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths#arcs\n    const sweepFlag = signX + signY !== 0 ? 1 : 0;\n    d = [\n      [`M ${signX * tlr + x},${y}`],\n      [`l ${width - signX * (tlr + trr)},0`],\n      [`a ${trr},${trr},0,0,${sweepFlag},${signX * trr},${signY * trr}`],\n      [`l 0,${height - signY * (trr + brr)}`],\n      [`a ${brr},${brr},0,0,${sweepFlag},${-signX * brr},${signY * brr}`],\n      [`l ${signX * (brr + blr) - width},0`],\n      [`a ${blr},${blr},0,0,${sweepFlag},${-signX * blr},${-signY * blr}`],\n      [`l 0,${signY * (blr + tlr) - height}`],\n      [`a ${tlr},${tlr},0,0,${sweepFlag},${signX * tlr},${-signY * tlr}`],\n      ['z'],\n    ].join(' ');\n  }\n  $el.setAttribute('d', d);\n}\n","export function createSVGElement(type: string, doc?: Document): SVGElement {\n  return (doc || document).createElementNS('http://www.w3.org/2000/svg', type);\n}\n","import type {\n  CSSUnitValue,\n  DisplayObject,\n  ParsedBaseStyleProps,\n} from '@antv/g-lite';\nimport { UnitType } from '@antv/g-lite';\nimport { createSVGElement } from '../../utils/dom';\n\nexport const FILTER_PREFIX = 'g-filter-';\n\n/**\n * use SVG filters, eg. blur, brightness, contrast...\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nexport function createOrUpdateFilter(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  filters: ParsedBaseStyleProps['filter'],\n) {\n  // eg. filter=\"url(#f1) url(#f2)\"\n  const filterName = FILTER_PREFIX + object.entity;\n\n  const $existedFilters = $def.querySelectorAll(`[name=${filterName}]`);\n  if ($existedFilters.length) {\n    $existedFilters.forEach(($filter) => {\n      $def.removeChild($filter);\n    });\n  }\n\n  if (filters.length === 0) {\n    // 'none'\n    $el?.removeAttribute('filter');\n  } else {\n    const filterIds = filters.map(({ name, params }, i) => {\n      const $filter = createSVGElement('filter', document) as SVGFilterElement;\n      // @see https://github.com/antvis/g/issues/1025\n      $filter.setAttribute('filterUnits', 'userSpaceOnUse');\n      if (name === 'blur') {\n        createBlur(document, $filter, params);\n      } else if (name === 'brightness') {\n        createBrightness(document, $filter, params);\n      } else if (name === 'drop-shadow') {\n        createDropShadow(document, $filter, params);\n      } else if (name === 'contrast') {\n        createContrast(document, $filter, params);\n      } else if (name === 'grayscale') {\n        createGrayscale(document, $filter, params);\n      } else if (name === 'sepia') {\n        createSepia(document, $filter, params);\n      } else if (name === 'saturate') {\n        createSaturate(document, $filter, params);\n      } else if (name === 'hue-rotate') {\n        createHueRotate(document, $filter, params);\n      } else if (name === 'invert') {\n        createInvert(document, $filter, params);\n      }\n\n      $filter.id = `${filterName}-${i}`;\n      $filter.setAttribute('name', filterName);\n      $def.appendChild($filter);\n\n      return $filter.id;\n    });\n\n    // @see https://github.com/antvis/G/issues/1114\n    setTimeout(() => {\n      $el?.setAttribute(\n        'filter',\n        filterIds.map((filterId) => `url(#${filterId})`).join(' '),\n      );\n    });\n  }\n}\n\nfunction convertToAbsoluteValue(param: CSSUnitValue) {\n  return param.unit === UnitType.kPercentage ? param.value / 100 : param.value;\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#blurEquivalent\n */\nfunction createBlur(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n  $feGaussianBlur.setAttribute('in', 'SourceGraphic');\n  $feGaussianBlur.setAttribute('stdDeviation', `${params[0].value}`);\n  $filter.appendChild($feGaussianBlur);\n}\n\nfunction createFeComponentTransfer(\n  document: Document,\n  $filter: SVGElement,\n  {\n    type,\n    slope,\n    intercept,\n    tableValues,\n  }: {\n    type: string;\n    slope?: number;\n    intercept?: number;\n    tableValues?: string;\n  },\n) {\n  const $feComponentTransfer = createSVGElement(\n    'feComponentTransfer',\n    document,\n  );\n  [\n    createSVGElement('feFuncR', document),\n    createSVGElement('feFuncG', document),\n    createSVGElement('feFuncB', document),\n  ].forEach(($feFunc) => {\n    $feFunc.setAttribute('type', type);\n\n    if (type === 'table') {\n      $feFunc.setAttribute('tableValues', `${tableValues}`);\n    } else {\n      $feFunc.setAttribute('slope', `${slope}`);\n      $feFunc.setAttribute('intercept', `${intercept}`);\n    }\n\n    $feComponentTransfer.appendChild($feFunc);\n  });\n\n  $filter.appendChild($feComponentTransfer);\n}\n\nfunction createContrast(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const slope = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'linear',\n    slope,\n    intercept: -(0.5 * slope) + 0.5,\n  });\n}\n\nfunction createInvert(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'table',\n    tableValues: `${amount} ${1 - amount}`,\n  });\n}\n\nfunction createBrightness(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const slope = convertToAbsoluteValue(params[0]);\n  createFeComponentTransfer(document, $filter, {\n    type: 'linear',\n    slope,\n    intercept: 0,\n  });\n}\n\nfunction createSaturate(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'saturate');\n  $feColorMatrix.setAttribute('values', `${amount}`);\n  $filter.appendChild($feColorMatrix);\n}\n\nfunction createHueRotate(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'hueRotate');\n  // $feColorMatrix.setAttribute('values', `${params[0].to(UnitType.kDegrees).value}`);\n  // FIXME: convert to degrees\n  $feColorMatrix.setAttribute('values', `${params[0].value}`);\n  $filter.appendChild($feColorMatrix);\n}\n\nfunction createDropShadow(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const shadowOffsetX = params[0].value;\n  const shadowOffsetY = params[1].value;\n  const shadowBlur = params[2].value;\n  // @ts-ignore\n  const shadowColor = params[3].formatted as string;\n  const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n  $feGaussianBlur.setAttribute('in', 'SourceAlpha');\n  $feGaussianBlur.setAttribute('stdDeviation', `${shadowBlur}`);\n  $filter.appendChild($feGaussianBlur);\n\n  const $feOffset = createSVGElement('feOffset', document);\n  $feOffset.setAttribute('dx', `${shadowOffsetX}`);\n  $feOffset.setAttribute('dy', `${shadowOffsetY}`);\n  $feOffset.setAttribute('result', 'offsetblur');\n  $filter.appendChild($feOffset);\n\n  const $feFlood = createSVGElement('feFlood', document);\n  $feFlood.setAttribute('flood-color', shadowColor);\n  $filter.appendChild($feFlood);\n\n  const $feComposite = createSVGElement('feComposite', document);\n  $feComposite.setAttribute('in2', 'offsetblur');\n  $feComposite.setAttribute('operator', 'in');\n  $filter.appendChild($feComposite);\n\n  const $feMerge = createSVGElement('feMerge', document);\n  $filter.appendChild($feMerge);\n\n  const $feMergeNode1 = createSVGElement('feMergeNode', document);\n  const $feMergeNode2 = createSVGElement('feMergeNode', document);\n  $feMergeNode2.setAttribute('in', 'SourceGraphic');\n  $feMerge.appendChild($feMergeNode1);\n  $feMerge.appendChild($feMergeNode2);\n}\n\nfunction createFeColorMatrix(\n  document: Document,\n  $filter: SVGElement,\n  matrix: number[],\n) {\n  const $feColorMatrix = createSVGElement('feColorMatrix', document);\n  $feColorMatrix.setAttribute('type', 'matrix');\n  $feColorMatrix.setAttribute('values', matrix.join(' '));\n  $filter.appendChild($feColorMatrix);\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#grayscaleEquivalent\n */\nfunction createGrayscale(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeColorMatrix(document, $filter, [\n    0.2126 + 0.7874 * (1 - amount),\n    0.7152 - 0.7152 * (1 - amount),\n    0.0722 - 0.0722 * (1 - amount),\n    0,\n    0,\n    0.2126 - 0.2126 * (1 - amount),\n    0.7152 + 0.2848 * (1 - amount),\n    0.0722 - 0.0722 * (1 - amount),\n    0,\n    0,\n    0.2126 - 0.2126 * (1 - amount),\n    0.7152 - 0.7152 * (1 - amount),\n    0.0722 + 0.9278 * (1 - amount),\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ]);\n}\n\n/**\n * @see https://drafts.fxtf.org/filter-effects/#sepiaEquivalent\n */\nfunction createSepia(\n  document: Document,\n  $filter: SVGElement,\n  params: CSSUnitValue[],\n) {\n  const amount = convertToAbsoluteValue(params[0]);\n  createFeColorMatrix(document, $filter, [\n    0.393 + 0.607 * (1 - amount),\n    0.769 - 0.769 * (1 - amount),\n    0.189 - 0.189 * (1 - amount),\n    0,\n    0,\n    0.349 - 0.349 * (1 - amount),\n    0.686 + 0.314 * (1 - amount),\n    0.168 - 0.168 * (1 - amount),\n    0,\n    0,\n    0.272 - 0.272 * (1 - amount),\n    0.534 - 0.534 * (1 - amount),\n    0.131 + 0.869 * (1 - amount),\n    0,\n    0,\n    0,\n    0,\n    0,\n    1,\n    0,\n  ]);\n}\n","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nexport { _objectSpread2 as default };","import type { CSSRGB, Pattern, RadialGradient } from '@antv/g-lite';\nimport {\n  DisplayObject,\n  LinearGradient,\n  parseTransform,\n  computeLinearGradient,\n  computeRadialGradient,\n  CSSGradientValue,\n  GradientType,\n  Rect,\n  isBrowser,\n  isPattern,\n  isCSSRGB,\n  isCSSGradientValue,\n} from '@antv/g-lite';\nimport { isString } from '@antv/util';\nimport { SVGRendererPlugin } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { FILTER_PREFIX } from './Filter';\n\nexport const PATTERN_PREFIX = 'g-pattern-';\nlet cacheKey2IDMap: Record<string, string> = {};\nlet counter = 0;\n\nexport function resetPatternCounter() {\n  counter = 0;\n  cacheKey2IDMap = {};\n}\n\nexport function createOrUpdateGradientAndPattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  parsedColor: CSSGradientValue[] | CSSRGB | Pattern,\n  name: string,\n  createImage: () => HTMLImageElement,\n  plugin: SVGRendererPlugin,\n) {\n  // eg. clipPath don't have fill/stroke\n  if (!parsedColor) {\n    return '';\n  }\n\n  if (isCSSRGB(parsedColor)) {\n    // keep using currentColor @see https://github.com/d3/d3-axis/issues/49\n    if (object.style[name] === 'currentColor') {\n      $el?.setAttribute(name, 'currentColor');\n    } else {\n      // constant value, eg. '#fff'\n      $el?.setAttribute(\n        name,\n        parsedColor.isNone ? 'none' : parsedColor.toString(),\n      );\n    }\n  } else if (isPattern(parsedColor)) {\n    const patternId = createOrUpdatePattern(\n      document,\n      $def,\n      object,\n      parsedColor,\n      createImage,\n      plugin,\n    );\n    // use style instead of attribute when applying <pattern>\n    // @see https://stackoverflow.com/a/7723115\n    $el.style[name] = `url(#${patternId})`;\n    return patternId;\n  } else {\n    if (parsedColor.length === 1) {\n      const gradientId = createOrUpdateGradient(\n        document,\n        object,\n        $def,\n        $el,\n        parsedColor[0],\n      );\n      $el?.setAttribute(name, `url(#${gradientId})`);\n      return gradientId;\n    }\n    // @see https://stackoverflow.com/questions/20671502/can-i-blend-gradients-in-svg\n    const filterId = createOrUpdateMultiGradient(\n      document,\n      object,\n      $def,\n      $el,\n      parsedColor,\n    );\n    $el?.setAttribute('filter', `url(#${filterId})`);\n    $el?.setAttribute('fill', 'black');\n    return filterId;\n  }\n\n  return '';\n}\n\nfunction generateCacheKey(\n  src: CSSGradientValue | CSSRGB | Pattern,\n  options: any = {},\n): string {\n  let cacheKey = '';\n  if (isCSSGradientValue(src)) {\n    const { type, value } = src;\n    if (\n      type === GradientType.LinearGradient ||\n      type === GradientType.RadialGradient\n    ) {\n      // @ts-ignore\n      const { type, x, y, width, height, steps, angle, cx, cy, size } = {\n        ...value,\n        ...options,\n      };\n      cacheKey = `gradient-${type}-${x?.toString() || 0}-${\n        y?.toString() || 0\n      }-${angle?.toString() || 0}-${cx?.toString() || 0}-${\n        cy?.toString() || 0\n      }-${size?.toString() || 0}-${width}-${height}-${steps\n        .map(({ offset, color }) => `${offset}${color}`)\n        .join('-')}`;\n    }\n  } else if (isPattern(src)) {\n    if (isString(src.image)) {\n      cacheKey = `pattern-${src.image}-${src.repetition}`;\n    } else if ((src.image as Rect).nodeName === 'rect') {\n      // use rect's entity as key\n      cacheKey = `pattern-rect-${(src.image as Rect).entity}`;\n    } else {\n      cacheKey = `pattern-${counter}`;\n    }\n  }\n\n  if (cacheKey) {\n    if (!cacheKey2IDMap[cacheKey]) {\n      cacheKey2IDMap[cacheKey] = `${PATTERN_PREFIX}${counter++}`;\n    }\n  }\n\n  return cacheKey2IDMap[cacheKey];\n}\n\nfunction formatTransform(transform: string) {\n  // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/patternTransform\n  // should remove unit: rotate(20deg) -> rotate(20)\n  return parseTransform(transform)\n    .map((parsed) => {\n      const { t, d } = parsed;\n      if (t === 'translate') {\n        return `translate(${d[0].value} ${d[1].value})`;\n      }\n      if (t === 'translateX') {\n        return `translate(${d[0].value} 0)`;\n      }\n      if (t === 'translateY') {\n        return `translate(0 ${d[0].value})`;\n      }\n      if (t === 'rotate') {\n        return `rotate(${d[0].value})`;\n      }\n      if (t === 'scale') {\n        // scale(1) scale(1, 1)\n        const newScale = d?.map((s) => s.value) || [1, 1];\n        return `scale(${newScale[0]}, ${newScale[1]})`;\n      }\n      if (t === 'scaleX') {\n        const newScale = d?.map((s) => s.value) || [1];\n        return `scale(${newScale[0]}, 1)`;\n      }\n      if (t === 'scaleY') {\n        const newScale = d?.map((s) => s.value) || [1];\n        return `scale(1, ${newScale[0]})`;\n      }\n      if (t === 'skew') {\n        const newSkew = d?.map((s) => s.value) || [0, 0];\n        return `skewX(${newSkew[0]}) skewY(${newSkew[1]})`;\n      }\n      if (t === 'skewZ') {\n        const newSkew = d?.map((s) => s.value) || [0];\n        return `skewX(${newSkew[0]})`;\n      }\n      if (t === 'skewY') {\n        const newSkew = d?.map((s) => s.value) || [0];\n        return `skewY(${newSkew[0]})`;\n      }\n      if (t === 'matrix') {\n        const [a, b, c, dd, tx, ty] = d.map((s) => s.value);\n        return `matrix(${a} ${b} ${c} ${dd} ${tx} ${ty})`;\n      }\n\n      return null;\n    })\n    .filter((item) => item !== null)\n    .join(' ');\n}\n\nfunction create$Pattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  pattern: Pattern,\n  patternId: string,\n  width: number,\n  height: number,\n) {\n  const { repetition, transform } = pattern;\n\n  // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/pattern\n  const $pattern = createSVGElement('pattern', document) as SVGPatternElement;\n  if (transform) {\n    $pattern.setAttribute('patternTransform', formatTransform(transform));\n  }\n  $pattern.setAttribute('patternUnits', 'userSpaceOnUse');\n\n  $pattern.id = patternId;\n  $def.appendChild($pattern);\n\n  const { halfExtents, min } = object.getGeometryBounds();\n  $pattern.setAttribute('x', `${min[0]}`);\n  $pattern.setAttribute('y', `${min[1]}`);\n\n  // There is no equivalent to CSS no-repeat for SVG patterns\n  // @see https://stackoverflow.com/a/33481956\n  let patternWidth = width;\n  let patternHeight = height;\n  if (repetition === 'repeat-x') {\n    patternHeight = halfExtents[1] * 2;\n  } else if (repetition === 'repeat-y') {\n    patternWidth = halfExtents[0] * 2;\n  } else if (repetition === 'no-repeat') {\n    patternWidth = halfExtents[0] * 2;\n    patternHeight = halfExtents[1] * 2;\n  }\n  $pattern.setAttribute('width', `${patternWidth}`);\n  $pattern.setAttribute('height', `${patternHeight}`);\n\n  return $pattern;\n}\n\nfunction createOrUpdatePattern(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  pattern: Pattern,\n  createImage: () => HTMLImageElement,\n  plugin: SVGRendererPlugin,\n) {\n  const patternId = generateCacheKey(pattern);\n  const $existed = $def.querySelector(`#${patternId}`);\n  if (!$existed) {\n    const { image } = pattern;\n\n    let imageURL = '';\n    if (isString(image)) {\n      imageURL = image;\n    } else if (isBrowser) {\n      if (image instanceof HTMLImageElement) {\n        imageURL = image.src;\n      } else if (image instanceof HTMLCanvasElement) {\n        imageURL = image.toDataURL();\n      } else if (image instanceof HTMLVideoElement) {\n        // won't support\n      }\n    }\n\n    if (imageURL) {\n      const $image = createSVGElement('image', document);\n      // use href instead of xlink:href\n      // @see https://stackoverflow.com/a/13379007\n      $image.setAttribute('href', imageURL);\n\n      const img = createImage();\n\n      if (!imageURL.match(/^data:/i)) {\n        img.crossOrigin = 'Anonymous';\n        $image.setAttribute('crossorigin', 'anonymous');\n      }\n      img.src = imageURL;\n      const onload = function () {\n        const $pattern = create$Pattern(\n          document,\n          $def,\n          object,\n          pattern,\n          patternId,\n          img.width,\n          img.height,\n        );\n\n        $def.appendChild($pattern);\n        $pattern.appendChild($image);\n\n        $image.setAttribute('x', '0');\n        $image.setAttribute('y', '0');\n        $image.setAttribute('width', `${img.width}`);\n        $image.setAttribute('height', `${img.height}`);\n      };\n      if (img.complete) {\n        onload();\n      } else {\n        img.onload = onload;\n        // Fix onload() bug in IE9\n        // img.src = img.src;\n      }\n    }\n\n    if ((image as Rect).nodeName === 'rect') {\n      const { width, height } = (image as Rect).parsedStyle;\n\n      const $pattern = create$Pattern(\n        document,\n        $def,\n        image as Rect,\n        pattern,\n        patternId,\n        width,\n        height,\n      );\n\n      // traverse subtree of pattern\n      (image as Rect).forEach((object: DisplayObject) => {\n        plugin.createSVGDom(document, object, null);\n\n        // @ts-ignore\n        const svgElement = object.elementSVG;\n\n        // apply local RTS transformation to <group> wrapper\n        const localTransform = object.getLocalTransform();\n        plugin.applyTransform(svgElement.$groupEl, localTransform);\n      });\n\n      // @ts-ignore\n      const svgElement = image.elementSVG;\n      $pattern.appendChild(svgElement.$groupEl);\n    }\n  }\n  return patternId;\n}\n\nfunction createOrUpdateGradient(\n  document: Document,\n  object: DisplayObject,\n  $def: SVGDefsElement,\n  $el: SVGElement,\n  parsedColor: CSSGradientValue,\n) {\n  const bounds = object.getGeometryBounds();\n  const width = (bounds && bounds.halfExtents[0] * 2) || 0;\n  const height = (bounds && bounds.halfExtents[1] * 2) || 0;\n  const min = (bounds && bounds.min) || [0, 0];\n\n  const gradientId = generateCacheKey(parsedColor, {\n    x: min[0],\n    y: min[1],\n    width,\n    height,\n  });\n  let $existed = $def.querySelector(`#${gradientId}`);\n\n  if (!$existed) {\n    // <linearGradient> <radialGradient>\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/linearGradient\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/radialGradient\n    $existed = createSVGElement(\n      parsedColor.type === GradientType.LinearGradient\n        ? 'linearGradient'\n        : 'radialGradient',\n      document,\n    );\n    // @see https://github.com/antvis/g/issues/1025\n    $existed.setAttribute('gradientUnits', 'userSpaceOnUse');\n    // add stops\n    let innerHTML = '';\n    (parsedColor.value as LinearGradient).steps\n      // sort by offset @see https://github.com/antvis/G/issues/1171\n      .sort((a, b) => a.offset.value - b.offset.value)\n      .forEach(({ offset, color }) => {\n        // TODO: support absolute unit like `px`\n        innerHTML += `<stop offset=\"${\n          offset.value / 100\n        }\" stop-color=\"${color}\"></stop>`;\n      });\n    $existed.innerHTML = innerHTML;\n    $existed.id = gradientId;\n    $def.appendChild($existed);\n  }\n\n  if (parsedColor.type === GradientType.LinearGradient) {\n    const { angle } = parsedColor.value as LinearGradient;\n    const { x1, y1, x2, y2 } = computeLinearGradient(\n      [min[0], min[1]],\n      width,\n      height,\n      angle,\n    );\n\n    $existed.setAttribute('x1', `${x1}`);\n    $existed.setAttribute('y1', `${y1}`);\n    $existed.setAttribute('x2', `${x2}`);\n    $existed.setAttribute('y2', `${y2}`);\n\n    // $existed.setAttribute('gradientTransform', `rotate(${angle})`);\n  } else {\n    const { cx, cy, size } = parsedColor.value as RadialGradient;\n    const { x, y, r } = computeRadialGradient(\n      [min[0], min[1]],\n      width,\n      height,\n      cx,\n      cy,\n      size,\n    );\n\n    $existed.setAttribute('cx', `${x}`);\n    $existed.setAttribute('cy', `${y}`);\n    $existed.setAttribute('r', `${r}`);\n  }\n\n  return gradientId;\n}\n\nfunction createOrUpdateMultiGradient(\n  document: Document,\n  object: DisplayObject,\n  $def: SVGDefsElement,\n  $el: SVGElement,\n  gradients: CSSGradientValue[],\n) {\n  const filterId = `${FILTER_PREFIX + object.entity}-gradient`;\n  let $existed = $def.querySelector(`#${filterId}`);\n  if (!$existed) {\n    $existed = createSVGElement('filter', document) as SVGFilterElement;\n    $existed.setAttribute('filterUnits', 'userSpaceOnUse');\n    // @see https://github.com/antvis/g/issues/1025\n    $existed.setAttribute('x', '0%');\n    $existed.setAttribute('y', '0%');\n    $existed.setAttribute('width', '100%');\n    $existed.setAttribute('height', '100%');\n\n    $existed.id = filterId;\n\n    $def.appendChild($existed);\n  }\n\n  /**\n   * <rect id=\"wave-rect\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"url(#wave)\"></rect>\n   * <filter id=\"blend-it\" x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\">\n        <feImage xlink:href=\"#wave-rect\" result=\"myWave\" x=\"100\" y=\"100\"/>\n        <feImage xlink:href=\"#ry-rect\" result=\"myRY\"  x=\"100\" y=\"100\"/>\n        <feBlend in=\"myWave\" in2=\"myRY\" mode=\"multiply\" result=\"blendedGrad\"/>\n        <feComposite in=\"blendedGrad\" in2=\"SourceGraphic\" operator=\"in\"/>\n    </filter>\n   */\n\n  let blended = 0;\n  gradients.forEach((gradient, i) => {\n    const gradientId = createOrUpdateGradient(\n      document,\n      object,\n      $def,\n      $el,\n      gradient,\n    );\n\n    const rectId = `${gradientId}_rect`;\n    const $rect = createSVGElement('rect', document) as SVGRectElement;\n    $rect.setAttribute('x', '0');\n    $rect.setAttribute('y', '0');\n    $rect.setAttribute('width', '100%');\n    $rect.setAttribute('height', '100%');\n    $rect.setAttribute('fill', `url(#${gradientId})`);\n    $rect.id = rectId;\n    $def.appendChild($rect);\n\n    const $feImage = createSVGElement('feImage', document) as SVGFEImageElement;\n    $feImage.setAttribute('href', `#${rectId}`);\n    $feImage.setAttribute('result', `${filterId}-${i}`);\n    $existed.appendChild($feImage);\n\n    if (i > 0) {\n      const $feBlend = createSVGElement(\n        'feBlend',\n        document,\n      ) as SVGFEBlendElement;\n      $feBlend.setAttribute(\n        'in',\n        i === 1 ? `${filterId}-${i - 1}` : `${filterId}-blended-${blended - 1}`,\n      );\n      $feBlend.setAttribute('in2', `${filterId}-${i}`);\n      $feBlend.setAttribute('result', `${filterId}-blended-${blended++}`);\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/blend-mode\n      $feBlend.setAttribute('mode', 'multiply');\n      $existed.appendChild($feBlend);\n    }\n  });\n\n  const $feComposite = createSVGElement(\n    'feComposite',\n    document,\n  ) as SVGFECompositeElement;\n  $feComposite.setAttribute('in', `${filterId}-blended-${blended}`);\n  $feComposite.setAttribute('in2', 'SourceGraphic');\n  $feComposite.setAttribute('operator', 'in');\n  $existed.appendChild($feComposite);\n\n  return filterId;\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  CSSRGB,\n  DisplayObject,\n  ParsedBaseStyleProps,\n  Pattern,\n  ContextService,\n  isPattern,\n} from '@antv/g-lite';\nimport { SVGRendererPlugin } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { createOrUpdateFilter } from './Filter';\nimport { createOrUpdateGradientAndPattern } from './Pattern';\nimport { createOrUpdateShadow } from './Shadow';\n\nconst urlRegexp = /url\\(\"?#(.*)\\)/;\n\nexport class DefElementManager {\n  constructor(private context: CanvasContext) {}\n\n  /**\n   * container for <gradient> <clipPath>...\n   */\n  private $def: SVGDefsElement;\n\n  private gradientCache: Record<string, Set<number>> = {};\n\n  getDefElement() {\n    return this.$def;\n  }\n\n  init() {\n    const { document } = this.context.config;\n    const $svg = (\n      this.context.contextService as ContextService<SVGElement>\n    ).getContext();\n    this.$def = createSVGElement('defs', document) as SVGDefsElement;\n    $svg.appendChild(this.$def);\n  }\n\n  clear(entity: number) {\n    Object.keys(this.gradientCache).forEach((id) => {\n      this.clearUnusedDefElement(this.gradientCache, id, entity);\n    });\n  }\n\n  private clearUnusedDefElement(\n    cache: Record<string, Set<number>>,\n    id: string,\n    entity: number,\n  ) {\n    if (cache[id] && cache[id].size === 1 && cache[id].has(entity)) {\n      const targetElement = this.$def.querySelector(`#${id}`);\n      if (targetElement) {\n        this.$def.removeChild(targetElement);\n      }\n    }\n  }\n\n  createOrUpdateGradientAndPattern(\n    object: DisplayObject,\n    $el: SVGElement,\n    parsedColor: CSSGradientValue[] | CSSRGB | Pattern,\n    name: string,\n    plugin: SVGRendererPlugin,\n  ) {\n    const { document: doc, createImage } = this.context.config;\n\n    if ($el) {\n      let attributeValue = '';\n      if (isPattern(parsedColor)) {\n        // `fill: url(#${patternId})`\n        attributeValue = $el.style[name];\n      } else {\n        // `url(#${gradientId})`\n        attributeValue = $el.getAttribute(name) || '';\n      }\n\n      const matches = attributeValue.match(urlRegexp);\n      if (matches && matches.length > 1) {\n        this.clearUnusedDefElement(\n          this.gradientCache,\n          matches[1].replace('\"', ''),\n          object.entity,\n        );\n      }\n\n      const newDefElementId = createOrUpdateGradientAndPattern(\n        doc || document,\n        this.$def,\n        object,\n        $el,\n        parsedColor,\n        name,\n        createImage,\n        plugin,\n      );\n      if (newDefElementId) {\n        if (!this.gradientCache[newDefElementId]) {\n          this.gradientCache[newDefElementId] = new Set();\n        }\n        this.gradientCache[newDefElementId].add(object.entity);\n      }\n    }\n  }\n\n  createOrUpdateShadow(object: DisplayObject, $el: SVGElement, name: string) {\n    const { document: doc } = this.context.config;\n    createOrUpdateShadow(doc || document, this.$def, object, $el, name);\n  }\n\n  createOrUpdateFilter(\n    object: DisplayObject,\n    $el: SVGElement,\n    filters: ParsedBaseStyleProps['filter'],\n  ) {\n    const { document: doc } = this.context.config;\n    createOrUpdateFilter(doc || document, this.$def, object, $el, filters);\n  }\n}\n","import type { DisplayObject } from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { createSVGElement } from '../../utils/dom';\n\nconst FILTER_DROPSHADOW_PREFIX = 'g-filter-dropshadow-';\n\n/**\n * use SVG filters\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nexport function createOrUpdateShadow(\n  document: Document,\n  $def: SVGDefsElement,\n  object: DisplayObject,\n  $el: SVGElement,\n  name: string,\n) {\n  const {\n    shadowType = 'outer',\n    shadowBlur,\n    shadowColor,\n    shadowOffsetX,\n    shadowOffsetY,\n  } = object.parsedStyle;\n\n  const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n  const shadowId = FILTER_DROPSHADOW_PREFIX + object.entity;\n  let $existedFilter = $def.querySelector(`#${shadowId}`);\n  if ($existedFilter) {\n    const existedShadowType = $existedFilter.getAttribute('data-type');\n    if (existedShadowType !== shadowType || !hasShadow) {\n      // remove existed shadow\n      $existedFilter.remove();\n      $existedFilter = null;\n    }\n  }\n\n  // <Group> also has shadowType as its default value\n  // only apply shadow when blur > 0\n  if (hasShadow) {\n    // use filter <feDropShadow>\n    // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/feDropShadow\n    $el?.setAttribute('filter', `url(#${shadowId})`);\n  } else {\n    $el?.removeAttribute('filter');\n    return;\n  }\n\n  if (!$existedFilter) {\n    $existedFilter = createSVGElement('filter', document) as SVGFilterElement;\n    $existedFilter.setAttribute('data-type', shadowType);\n\n    if (shadowType === 'outer') {\n      const $feDropShadow = createSVGElement('feDropShadow', document);\n      $feDropShadow.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n      $feDropShadow.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n      $feDropShadow.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n      $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n      $existedFilter.appendChild($feDropShadow);\n    } else if (shadowType === 'inner') {\n      const $feComponentTransfer = createSVGElement(\n        'feComponentTransfer',\n        document,\n      );\n      $feComponentTransfer.setAttribute('in', 'SourceAlpha');\n      const $feFuncA = createSVGElement('feFuncA', document);\n      $feFuncA.setAttribute('type', 'table');\n      $feFuncA.setAttribute('tableValues', '1 0');\n      $feComponentTransfer.appendChild($feFuncA);\n      $existedFilter.appendChild($feComponentTransfer);\n\n      const $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n      $feGaussianBlur.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n      $existedFilter.appendChild($feGaussianBlur);\n\n      const $feOffset = createSVGElement('feOffset', document);\n      $feOffset.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n      $feOffset.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n      $feOffset.setAttribute('result', 'offsetblur');\n      $existedFilter.appendChild($feOffset);\n\n      const $feFlood = createSVGElement('feFlood', document);\n      $feFlood.setAttribute('flood-color', shadowColor.toString());\n      $feFlood.setAttribute('result', 'color');\n      $existedFilter.appendChild($feFlood);\n\n      const $feComposite = createSVGElement('feComposite', document);\n      $feComposite.setAttribute('in2', 'offsetblur');\n      $feComposite.setAttribute('operator', 'in');\n      $existedFilter.appendChild($feComposite);\n\n      const $feComposite2 = createSVGElement('feComposite', document);\n      $feComposite2.setAttribute('in2', 'SourceAlpha');\n      $feComposite2.setAttribute('operator', 'in');\n      $existedFilter.appendChild($feComposite2);\n\n      const $feMerge = createSVGElement('feMerge', document);\n      $existedFilter.appendChild($feMerge);\n      const $feMergeNode = createSVGElement('feMergeNode', document);\n      $feMergeNode.setAttribute('in', 'SourceGraphic');\n      const $feMergeNode2 = createSVGElement('feMergeNode', document);\n      $feMerge.appendChild($feMergeNode);\n      $feMerge.appendChild($feMergeNode2);\n    }\n\n    $existedFilter.id = shadowId;\n    // @see https://github.com/antvis/g/issues/1025\n    $existedFilter.setAttribute('filterUnits', 'userSpaceOnUse');\n    $def.appendChild($existedFilter);\n    return;\n  }\n\n  if (shadowType === 'inner') {\n    const $feGaussianBlur = $existedFilter\n      .children[1] as SVGFEGaussianBlurElement;\n    const $feOffset = $existedFilter.children[2] as SVGFEOffsetElement;\n    const $feFlood = $existedFilter.children[3] as SVGFEFloodElement;\n    if (name === 'shadowColor') {\n      $feFlood.setAttribute('flood-color', shadowColor.toString());\n    } else if (name === 'shadowBlur') {\n      // half the blur radius\n      // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n      // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n      $feGaussianBlur.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n    } else if (name === 'shadowOffsetX') {\n      $feOffset.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n    } else if (name === 'shadowOffsetY') {\n      $feOffset.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n    }\n  } else if (shadowType === 'outer') {\n    const $feDropShadow = $existedFilter.children[0] as SVGPatternElement;\n    if (name === 'shadowColor') {\n      $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n    } else if (name === 'shadowBlur') {\n      // half the blur radius\n      // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n      // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n      $feDropShadow.setAttribute('stdDeviation', `${(shadowBlur || 0) / 4}`);\n    } else if (name === 'shadowOffsetX') {\n      $feDropShadow.setAttribute('dx', `${(shadowOffsetX || 0) / 2}`);\n    } else if (name === 'shadowOffsetY') {\n      $feDropShadow.setAttribute('dy', `${(shadowOffsetY || 0) / 2}`);\n    }\n  }\n}\n","export function numberToLongString(x: number) {\n  return x.toFixed(6).replace('.000000', '');\n}\n\nexport function convertHTML(str: string) {\n  const regex = /[&|<|>|\"|']/g;\n  return str.replace(regex, function (match) {\n    if (match === '&') {\n      return '&amp;';\n    }\n    if (match === '<') {\n      return '&lt;';\n    }\n    if (match === '>') {\n      return '&gt;';\n    }\n    if (match === '\"') {\n      return '&quot;';\n    }\n    return '&apos;';\n  });\n}\n","import {\n  DisplayObject,\n  FederatedEvent,\n  CustomEvent,\n  LinearGradient,\n  MutationEvent,\n  MutationRecord,\n  RadialGradient,\n  RenderingPlugin,\n  RenderingPluginContext,\n  ContextService,\n  ElementEvent,\n  propertyMetadataCache,\n  RenderReason,\n  Shape,\n  isCSSRGB,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\nimport { ElementSVG } from './components/ElementSVG';\nimport { resetPatternCounter, type DefElementManager } from './shapes/defs';\nimport type { SVGRendererPluginOptions } from './interfaces';\nimport { createSVGElement } from './utils/dom';\nimport { numberToLongString } from './utils/format';\n\nexport const SVG_ATTR_MAP: Record<string, string> = {\n  opacity: 'opacity',\n  fillStyle: 'fill',\n  fill: 'fill',\n  fillRule: 'fill-rule',\n  fillOpacity: 'fill-opacity',\n  strokeStyle: 'stroke',\n  strokeOpacity: 'stroke-opacity',\n  stroke: 'stroke',\n  clipPath: 'clip-path',\n  textPath: 'text-path',\n  r: 'r',\n  cx: 'cx',\n  cy: 'cy',\n  rx: 'rx',\n  ry: 'ry',\n  x: 'x',\n  y: 'y',\n  width: 'width',\n  height: 'height',\n  lineCap: 'stroke-linecap',\n  lineJoin: 'stroke-linejoin',\n  lineWidth: 'stroke-width',\n  lineDash: 'stroke-dasharray',\n  lineDashOffset: 'stroke-dashoffset',\n  miterLimit: 'stroke-miterlimit',\n  font: 'font',\n  fontSize: 'font-size',\n  fontStyle: 'font-style',\n  fontVariant: 'font-variant',\n  fontWeight: 'font-weight',\n  fontFamily: 'font-family',\n  letterSpacing: 'letter-spacing',\n  startArrow: 'marker-start',\n  endArrow: 'marker-end',\n  class: 'class',\n  id: 'id',\n  // style: 'style',\n  preserveAspectRatio: 'preserveAspectRatio',\n  visibility: 'visibility',\n  shadowColor: 'flood-color',\n  shadowBlur: 'stdDeviation',\n  shadowOffsetX: 'dx',\n  shadowOffsetY: 'dy',\n  filter: 'filter',\n  innerHTML: 'innerHTML',\n  textAlign: 'text-anchor',\n  pointerEvents: 'pointer-events',\n};\n\nconst FORMAT_VALUE_MAP = {\n  textAlign: {\n    inherit: 'inherit',\n    left: 'left',\n    start: 'left',\n    center: 'middle',\n    right: 'end',\n    end: 'end',\n  },\n};\n\nexport const DEFAULT_VALUE_MAP: Record<string, string> = {\n  textAlign: 'inherit',\n  // textBaseline: 'alphabetic',\n  // @see https://www.w3.org/TR/SVG/painting.html#LineCaps\n  lineCap: 'butt',\n  // @see https://www.w3.org/TR/SVG/painting.html#LineJoin\n  lineJoin: 'miter',\n  // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/stroke-width\n  lineWidth: '1px',\n  opacity: '1',\n  fillOpacity: '1',\n  fillRule: 'nonzero',\n  strokeOpacity: '1',\n  strokeWidth: '0',\n  strokeMiterLimit: '4',\n  letterSpacing: '0',\n  fontSize: 'inherit',\n  fontFamily: 'inherit',\n  pointerEvents: 'auto',\n  transform: 'matrix(1,0,0,1,0,0)',\n};\n\nexport type GradientParams = LinearGradient | RadialGradient;\n\n/**\n * G_SVG_PREFIX + nodeName + entity\n *\n * eg. g_svg_circle_345\n */\nexport const G_SVG_PREFIX = 'g-svg';\nexport const CLIP_PATH_PREFIX = 'clip-path-';\nexport const TEXT_PATH_PREFIX = 'text-path-';\n\nexport class SVGRendererPlugin implements RenderingPlugin {\n  static tag = 'SVGRenderer';\n\n  constructor(\n    private pluginOptions: SVGRendererPluginOptions,\n    private defElementManager: DefElementManager,\n    private context: RenderingPluginContext,\n  ) {}\n\n  /**\n   * Will be used in svg-picker for finding relative SVG element of current DisplayObject.\n   */\n  private svgElementMap: WeakMap<SVGElement, DisplayObject> = new WeakMap();\n\n  /**\n   * <camera>\n   */\n  private $camera: SVGElement;\n\n  /**\n   * render at the end of frame\n   */\n  private renderQueue: DisplayObject[] = [];\n\n  /**\n   * dirty attributes at the end of frame\n   */\n  private dirtyAttributes: WeakMap<DisplayObject, string[]> = new WeakMap();\n\n  /**\n   * reorder after mounted\n   */\n  private pendingReorderQueue: Set<DisplayObject> = new Set();\n\n  /**\n   * <use> elements in <clipPath>, which should be sync with clipPath\n   *\n   * @example\n   * <clipPath transform=\"matrix(1,0,0,1,-100,-155)\" id=\"clip-path-0-2\">\n   *  <use href=\"#g_svg_circle_0\" transform=\"matrix(1.477115,0,0,1.477115,150,150)\">\n   *  </use>\n   * </clipPath>\n   */\n  private clipPathUseMap: WeakMap<DisplayObject, SVGUseElement[]> =\n    new WeakMap();\n\n  apply(context: RenderingPluginContext) {\n    const { renderingService, renderingContext } = context;\n    this.context = context;\n    // @ts-ignore\n    this.context.svgElementMap = this.svgElementMap;\n    const canvas = renderingContext.root.ownerDocument.defaultView;\n\n    const { document } = this.context.config;\n\n    const handleMounted = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n\n      // should remove clipPath already existed in <defs>\n      const $useRefs = this.clipPathUseMap.get(object);\n      if ($useRefs) {\n        const $def = this.defElementManager.getDefElement();\n        const existed = $def.querySelector(`#${this.getId(object)}`);\n        if (existed) {\n          existed.remove();\n        }\n      }\n\n      // create SVG DOM Node\n      this.createSVGDom(document, object, this.$camera);\n    };\n\n    const handleUnmounted = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n      this.defElementManager.clear(object.entity);\n      this.clipPathUseMap.delete(object);\n      this.removeSVGDom(object);\n    };\n\n    const reorderChildren = (object: DisplayObject) => {\n      const parent = object.parentNode;\n      // @ts-ignore\n      const $groupEl = object.parentNode?.elementSVG?.$groupEl;\n      const children = (parent?.children || []).slice();\n\n      if ($groupEl) {\n        this.reorderChildren(document, $groupEl, children as DisplayObject[]);\n      }\n    };\n\n    const handleReparent = (e: FederatedEvent) => {\n      const object = e.target as DisplayObject;\n      reorderChildren(object);\n    };\n\n    const handleAttributeChanged = (e: MutationEvent) => {\n      const object = e.target as DisplayObject;\n\n      // @see https://github.com/antvis/g/issues/994\n      // @ts-ignore\n      if (!object.elementSVG) {\n        return;\n      }\n\n      const { attrName } = e;\n\n      let attribtues = this.dirtyAttributes.get(object);\n      if (!attribtues) {\n        this.dirtyAttributes.set(object, []);\n        attribtues = this.dirtyAttributes.get(object);\n      }\n\n      attribtues.push(attrName);\n    };\n\n    const handleGeometryBoundsChanged = (\n      e: CustomEvent<{ detail: MutationRecord[] }>,\n    ) => {\n      const records = e.detail;\n      for (let i = 0; i < records.length; i++) {\n        const record = records[i];\n        const object = record.target as DisplayObject;\n        const nodes =\n          object.nodeName === Shape.FRAGMENT ? object.childNodes : [object];\n\n        nodes.forEach((node: DisplayObject) => {\n          // @ts-ignore\n          const $el = object.elementSVG?.$el;\n\n          const { fill, stroke, clipPath } = object.parsedStyle;\n\n          if (fill && !isCSSRGB(fill)) {\n            this.defElementManager.createOrUpdateGradientAndPattern(\n              object,\n              $el,\n              fill,\n              'fill',\n              this,\n            );\n          }\n          if (stroke && !isCSSRGB(stroke)) {\n            this.defElementManager.createOrUpdateGradientAndPattern(\n              object,\n              $el,\n              stroke,\n              'stroke',\n              this,\n            );\n          }\n          if (clipPath) {\n            const parentInvert = mat4.invert(\n              mat4.create(),\n              object.getWorldTransform(),\n            );\n\n            const clipPathId = `${CLIP_PATH_PREFIX + clipPath.entity}-${object.entity}`;\n            const $def = this.defElementManager.getDefElement();\n            const $existed = $def.querySelector<SVGElement>(`#${clipPathId}`);\n            if ($existed) {\n              this.applyTransform($existed, parentInvert);\n            }\n          }\n        });\n      }\n    };\n\n    renderingService.hooks.init.tap(SVGRendererPlugin.tag, () => {\n      const { background, document } = this.context.config;\n\n      // <defs>\n      this.defElementManager.init();\n\n      const $svg = (\n        this.context.contextService as ContextService<SVGElement>\n      ).getContext();\n      if (background) {\n        $svg.style.background = background;\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/color-interpolation-filters\n      $svg.setAttribute('color-interpolation-filters', 'sRGB');\n\n      this.$camera = createSVGElement('g', document);\n      this.$camera.id = `${G_SVG_PREFIX}-camera`;\n      this.applyTransform(this.$camera, this.context.camera.getOrthoMatrix());\n      $svg.appendChild(this.$camera);\n\n      canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n      canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.addEventListener(ElementEvent.REPARENT, handleReparent);\n      canvas.addEventListener(\n        ElementEvent.ATTR_MODIFIED,\n        handleAttributeChanged,\n      );\n      canvas.addEventListener(\n        ElementEvent.BOUNDS_CHANGED,\n        handleGeometryBoundsChanged,\n      );\n    });\n\n    renderingService.hooks.destroy.tap(SVGRendererPlugin.tag, () => {\n      canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n      canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n      canvas.removeEventListener(ElementEvent.REPARENT, handleReparent);\n      canvas.removeEventListener(\n        ElementEvent.ATTR_MODIFIED,\n        handleAttributeChanged,\n      );\n      canvas.removeEventListener(\n        ElementEvent.BOUNDS_CHANGED,\n        handleGeometryBoundsChanged,\n      );\n      resetPatternCounter();\n    });\n\n    renderingService.hooks.render.tap(\n      SVGRendererPlugin.tag,\n      (object: DisplayObject) => {\n        this.renderQueue.push(object);\n      },\n    );\n\n    renderingService.hooks.beginFrame.tap(SVGRendererPlugin.tag, () => {\n      const { document: doc } = this.context.config;\n\n      if (this.pendingReorderQueue.size) {\n        this.pendingReorderQueue.forEach((object) => {\n          const children = (object?.children || []).slice() as DisplayObject[];\n          const $parentGroupEl =\n            // @ts-ignore\n            object?.elementSVG?.$groupEl;\n\n          if ($parentGroupEl) {\n            this.reorderChildren(\n              doc || document,\n              $parentGroupEl,\n              children || [],\n            );\n          }\n        });\n        this.pendingReorderQueue.clear();\n      }\n    });\n\n    renderingService.hooks.endFrame.tap(SVGRendererPlugin.tag, () => {\n      if (renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED)) {\n        this.applyTransform(this.$camera, this.context.camera.getOrthoMatrix());\n      }\n\n      this.renderQueue.forEach((object) => {\n        const $el = ((object as any).elementSVG as ElementSVG)?.$el;\n        const $groupEl = ((object as any).elementSVG as ElementSVG)?.$groupEl;\n\n        if ($el && $groupEl) {\n          // apply local RTS transformation to <group> wrapper\n          // account for anchor\n          const localTransform = object.getLocalTransform();\n          this.applyTransform($groupEl, localTransform);\n\n          // clipped shapes should also be informed\n\n          const $useRefs = this.clipPathUseMap.get(object);\n          if ($useRefs && $useRefs.length) {\n            $useRefs.forEach(($use) => {\n              // <clipPath transform=\"matrix()\"><circle /></clipPath>\n              this.applyTransform($use, object.getWorldTransform());\n              // const parentInvert = mat4.invert(\n              //   mat4.create(),\n              //   (object as DisplayObject).getWorldTransform(),\n              // );\n              // this.applyTransform($clipPath, parentInvert);\n            });\n          }\n\n          // finish rendering, clear dirty flag\n          object.renderable.dirty = false;\n        }\n\n        // update dirty attributes\n        const attributes = this.dirtyAttributes.get(object);\n        if (attributes) {\n          attributes.forEach((attrName) => {\n            if (attrName === 'zIndex') {\n              reorderChildren(object);\n            } else if (attrName === 'increasedLineWidthForHitTesting') {\n              this.createOrUpdateHitArea(object, $el, $groupEl);\n            }\n\n            this.updateAttribute(object, [attrName]);\n          });\n\n          this.dirtyAttributes.delete(object);\n        }\n      });\n      this.renderQueue = [];\n    });\n  }\n\n  private getId(object: DisplayObject) {\n    return object.id || `${G_SVG_PREFIX}-${object.entity}`;\n  }\n\n  private reorderChildren(\n    doc: Document,\n    $groupEl: SVGElement,\n    children: DisplayObject[],\n  ) {\n    // need to reorder parent's children\n    children.sort((a, b) => a.sortable.renderOrder - b.sortable.renderOrder);\n\n    if (children.length) {\n      // create empty fragment\n      const fragment = (doc || document).createDocumentFragment();\n      children.forEach((child: DisplayObject) => {\n        if (child.isConnected) {\n          const $el = ((child as any).elementSVG as ElementSVG).$groupEl;\n          if ($el) {\n            fragment.appendChild($el);\n          }\n        }\n      });\n\n      $groupEl.appendChild(fragment);\n    }\n  }\n\n  applyTransform($el: SVGElement, rts: mat4) {\n    const matrix = `matrix(${numberToLongString(rts[0])},${numberToLongString(\n      rts[1],\n    )},${numberToLongString(rts[4])},${numberToLongString(\n      rts[5],\n    )},${numberToLongString(rts[12])},${numberToLongString(rts[13])})`;\n\n    if (matrix !== $el.getAttribute('transform')) {\n      // use proper precision avoiding too long string in `transform`\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n      $el.setAttribute('transform', matrix);\n    }\n    if (matrix === DEFAULT_VALUE_MAP.transform) {\n      $el.removeAttribute('transform');\n    }\n  }\n\n  private applyAttributes(object: DisplayObject) {\n    const elementSVG = (object as any).elementSVG as ElementSVG;\n    const $el = elementSVG?.$el;\n    const $groupEl = elementSVG?.$groupEl;\n    if ($el && $groupEl) {\n      const { nodeName, attributes } = object;\n\n      if (nodeName !== Shape.HTML) {\n        $el.setAttribute('fill', 'none');\n      }\n      if (nodeName === Shape.IMAGE) {\n        $el.setAttribute('preserveAspectRatio', 'none');\n      }\n\n      // apply attributes\n      this.updateAttribute(object, Object.keys(attributes));\n    }\n  }\n\n  private updateAttribute(object: DisplayObject, attributes: string[]) {\n    const { document } = this.context.config;\n\n    const { $el, $hitTestingEl } = (object as any).elementSVG as ElementSVG;\n    const { parsedStyle, nodeName } = object;\n    const shouldUpdateElementAttribute = attributes.some((name) =>\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.shouldUpdateElementAttribute(\n        object,\n        name,\n      ),\n    );\n\n    // need re-generate path\n    if (shouldUpdateElementAttribute && $el) {\n      [$el, $hitTestingEl].forEach(($el) => {\n        if ($el) {\n          // @ts-ignore\n          this.context.SVGElementLifeCycleContribution.updateElementAttribute(\n            object,\n            $el,\n            this.svgElementMap,\n          );\n        }\n      });\n    }\n\n    // update common attributes\n    attributes.forEach((name) => {\n      const usedName = SVG_ATTR_MAP[name];\n      const computedValue = parsedStyle[name];\n      const computedValueStr =\n        !isNil(computedValue) && computedValue.toString();\n      const formattedValueStr =\n        FORMAT_VALUE_MAP[name]?.[computedValueStr] || computedValueStr;\n      const usedValue = parsedStyle[name];\n      const inherited = usedName && !!propertyMetadataCache[name]?.inh;\n\n      // <foreignObject>\n      if (nodeName === Shape.HTML) {\n        if (name === 'fill') {\n          $el.style.background = usedValue.toString();\n        } else if (name === 'stroke') {\n          $el.style['border-color'] = usedValue.toString();\n          $el.style['border-style'] = 'solid';\n        } else if (name === 'lineWidth') {\n          $el.style['border-width'] = `${usedValue || 0}px`;\n        } else if (name === 'lineDash') {\n          $el.style['border-style'] = 'dashed';\n        } else if (name === 'innerHTML') {\n          this.createOrUpdateInnerHTML(document, $el, usedValue);\n        } else if (\n          name === 'width' ||\n          name === 'height' ||\n          name === 'class' ||\n          name === 'x' ||\n          name === 'y'\n        ) {\n          // width & height are both required for <foreignObject> and cannot be used as style.\n          $el.setAttribute(name, usedValue.toString());\n        } else if (!isNil(object.style[name]) && object.style[name] !== '') {\n          $el.style[name] = object.style[name];\n        }\n      } else {\n        if (\n          !usedName ||\n          ((nodeName === Shape.GROUP || object.isCustomElement) &&\n            (inherited || usedName === 'fill' || usedName === 'stroke'))\n        ) {\n          return;\n        }\n\n        if (name === 'fill') {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            usedValue,\n            usedName,\n            this,\n          );\n        } else if (name === 'stroke') {\n          this.defElementManager.createOrUpdateGradientAndPattern(\n            object,\n            $el,\n            usedValue,\n            usedName,\n            this,\n          );\n        } else if (name === 'clipPath') {\n          this.createOrUpdateClipOrTextPath(document, usedValue, object);\n        } else if (name === 'textPath') {\n          this.createOrUpdateClipOrTextPath(document, usedValue, object, true);\n        } else if (\n          name === 'shadowType' ||\n          name === 'shadowColor' ||\n          name === 'shadowBlur' ||\n          name === 'shadowOffsetX' ||\n          name === 'shadowOffsetY'\n        ) {\n          this.defElementManager.createOrUpdateShadow(object, $el, name);\n        } else if (name === 'filter') {\n          this.defElementManager.createOrUpdateFilter(object, $el, usedValue);\n        } else if (!isNil(computedValue)) {\n          // use computed value so that we can use cascaded effect in SVG\n          // ignore 'unset' and default value\n          [$el, $hitTestingEl].forEach(($el: SVGElement) => {\n            if ($el && usedName) {\n              if (\n                computedValueStr !== 'unset' &&\n                computedValueStr !== DEFAULT_VALUE_MAP[name]\n              ) {\n                $el.setAttribute(usedName, formattedValueStr);\n              } else {\n                $el.removeAttribute(usedName);\n              }\n            }\n          });\n        }\n      }\n    });\n  }\n\n  createSVGDom(\n    document: Document,\n    object: DisplayObject,\n    root: SVGElement,\n    noWrapWithGroup = false,\n  ) {\n    // create svg element\n    // @ts-ignore\n    object.elementSVG = new ElementSVG();\n    // @ts-ignore\n    const svgElement = object.elementSVG;\n\n    // use <group> as default, eg. CustomElement\n    const $el =\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.createElement(\n        object,\n        this.svgElementMap,\n      );\n    if ($el) {\n      let $groupEl: SVGElement;\n\n      // save $el on parsedStyle, which will be returned in getDomElement()\n      if (object.nodeName === Shape.HTML) {\n        object.parsedStyle.$el = $el;\n      }\n\n      if (this.pluginOptions.outputSVGElementId) {\n        // use user-defined id first.\n        $el.id = this.getId(object);\n      }\n      if (this.pluginOptions.outputSVGElementName && object.name) {\n        $el.setAttribute('name', object.name);\n      }\n\n      if (\n        ($el.hasAttribute('data-wrapgroup') || $el.nodeName !== 'g') &&\n        !noWrapWithGroup\n      ) {\n        $groupEl = createSVGElement('g', document);\n        // if (this.pluginOptions.outputSVGElementId) {\n        //   $groupEl.id = $el.id + '-g';\n        // }\n        $groupEl.appendChild($el);\n      } else {\n        $groupEl = $el;\n      }\n\n      svgElement.$el = $el;\n      svgElement.$groupEl = $groupEl;\n\n      // apply attributes at first time\n      this.applyAttributes(object);\n\n      // create hitArea if necessary\n      this.createOrUpdateHitArea(object, $el, $groupEl);\n\n      const $parentGroupEl =\n        root ||\n        // @ts-ignore\n        (object.parentNode && object.parentNode.elementSVG?.$groupEl);\n\n      if ($parentGroupEl) {\n        $parentGroupEl.appendChild($groupEl);\n\n        // need reorder children later\n        this.pendingReorderQueue.add(object.parentNode as DisplayObject);\n      }\n    }\n  }\n\n  private removeSVGDom(object: DisplayObject) {\n    // @ts-ignore\n    const $groupEl = object.elementSVG?.$groupEl;\n    if ($groupEl && $groupEl.parentNode) {\n      $groupEl.parentNode.removeChild($groupEl);\n\n      // @ts-ignore\n      this.context.SVGElementLifeCycleContribution.destroyElement(\n        object,\n        $groupEl,\n      );\n      // object.entity.removeComponent(ElementSVG, true);\n    }\n  }\n\n  private createOrUpdateHitArea(\n    object: DisplayObject,\n    $el: SVGElement,\n    $groupEl: SVGElement,\n  ) {\n    const svgElement = (object as any).elementSVG as ElementSVG;\n    let { $hitTestingEl } = svgElement;\n    const increasedLineWidthForHitTesting = Number(\n      object.parsedStyle.increasedLineWidthForHitTesting,\n    );\n\n    // account for hitArea\n    if (increasedLineWidthForHitTesting) {\n      if (!$hitTestingEl) {\n        $hitTestingEl = $el.cloneNode() as SVGElement;\n        // clear attributes like `filter` `font-size`\n        ['filter'].forEach((attribute) => {\n          $hitTestingEl.removeAttribute(attribute);\n        });\n        // hitArea should be 'transparent' but not 'none'\n        const hasFill = $el.getAttribute('fill') !== 'none';\n        $hitTestingEl.setAttribute('fill', hasFill ? 'transparent' : 'none');\n        $hitTestingEl.setAttribute('stroke', 'transparent');\n        $groupEl.appendChild($hitTestingEl);\n        svgElement.$hitTestingEl = $hitTestingEl;\n\n        // svg-picker will use this map to find target object\n        this.svgElementMap.set($hitTestingEl, object);\n      }\n\n      // increase interactive line width\n      $hitTestingEl.setAttribute(\n        'stroke-width',\n        `${increasedLineWidthForHitTesting + object.parsedStyle.lineWidth}`,\n      );\n    } else if ($hitTestingEl) {\n      $groupEl.removeChild($hitTestingEl);\n      svgElement.$hitTestingEl = null;\n    }\n  }\n\n  private createOrUpdateInnerHTML(\n    doc: Document,\n    $el: SVGElement,\n    usedValue: any,\n  ) {\n    const $div = (doc || document).createElement('div');\n    if (typeof usedValue === 'string') {\n      $div.innerHTML = usedValue;\n    } else {\n      $div.appendChild(usedValue);\n    }\n    $el.innerHTML = '';\n    $el.appendChild($div);\n  }\n\n  private createOrUpdateClipOrTextPath(\n    document: Document,\n    clipPath: DisplayObject,\n    object: DisplayObject,\n    isTextPath = false,\n  ) {\n    const { $groupEl } = (object as any).elementSVG as ElementSVG;\n    const PREFIX = isTextPath ? TEXT_PATH_PREFIX : CLIP_PATH_PREFIX;\n    const attributeNameCamel = isTextPath ? 'g' : 'clipPath';\n    const attributeNameHyphen = isTextPath ? 'text-path' : 'clip-path';\n\n    if (clipPath) {\n      const clipPathId = `${PREFIX + clipPath.entity}-${object.entity}`;\n      const $def = this.defElementManager.getDefElement();\n\n      const existed = $def.querySelector(`#${clipPathId}`);\n      if (!existed) {\n        let $clipPath: SVGElement;\n        if (isTextPath) {\n          // use <path> directly instead of wrapping with <g>\n          this.createSVGDom(document, clipPath, null, true);\n          // @ts-ignore\n          $clipPath = clipPath.elementSVG.$el;\n        } else {\n          // the clipPath is allowed to be detached from canvas\n          if (!clipPath.isConnected) {\n            const $existedClipPath = $def.querySelector(\n              `#${this.getId(clipPath)}`,\n            );\n            if (!$existedClipPath) {\n              this.createSVGDom(document, clipPath, $def, true);\n            }\n          }\n\n          // create <clipPath> dom node\n          $clipPath = createSVGElement(attributeNameCamel, document);\n          const $use = createSVGElement('use', document) as SVGUseElement;\n          // @ts-ignore\n          $use.setAttribute('href', `#${clipPath.elementSVG.$el.id}`);\n          $clipPath.appendChild($use);\n\n          let $useRefs = this.clipPathUseMap.get(clipPath);\n          if (!$useRefs) {\n            this.clipPathUseMap.set(clipPath, []);\n            $useRefs = this.clipPathUseMap.get(clipPath);\n          }\n          $useRefs.push($use);\n\n          // <clipPath transform=\"matrix()\"><circle /></clipPath>\n          this.applyTransform($use, clipPath.getWorldTransform());\n          const parentInvert = mat4.invert(\n            mat4.create(),\n            object.getWorldTransform(),\n          );\n          this.applyTransform($clipPath, parentInvert);\n        }\n\n        if (this.pluginOptions.outputSVGElementId) {\n          $clipPath.id = clipPathId;\n        }\n        // append it to <defs>\n        $def.appendChild($clipPath);\n      }\n\n      // apply attributes\n      this.applyAttributes(clipPath);\n\n      if (!isTextPath) {\n        // apply clipPath to $group\n        // @see https://github.com/antvis/g/issues/961\n        $groupEl.setAttribute(attributeNameHyphen, `url(#${clipPathId})`);\n      }\n    } else if (!isTextPath) {\n      // remove clip path\n      $groupEl.removeAttribute(attributeNameHyphen);\n    }\n  }\n}\n","import type { GlobalRuntime, ParsedTextStyleProps, Text } from '@antv/g-lite';\nimport { TEXT_PATH_PREFIX } from '../../SVGRendererPlugin';\nimport { createSVGElement } from '../../utils/dom';\nimport { convertHTML } from '../../utils/format';\n\n// @see https://github.com/plouc/nivo/issues/164\nconst BASELINE_MAP: Record<string, string> = {\n  top: 'hanging', // Use hanging here.\n  middle: 'central',\n  bottom: 'text-after-edge', // FIXME: It is not a standard property.\n  alphabetic: 'alphabetic',\n  ideographic: 'ideographic',\n  hanging: 'hanging',\n};\n\nexport function updateTextElementAttribute(\n  $el: SVGElement,\n  parsedStyle: ParsedTextStyleProps,\n  text: Text,\n  runtime: GlobalRuntime,\n) {\n  // Trigger text geometry calculation.\n  text.getBounds();\n  const {\n    lineWidth = 1,\n    x = 0,\n    y = 0,\n    dx = 0,\n    dy = 0,\n    textPath,\n    textPathSide = 'left',\n    textPathStartOffset = 0,\n    textDecorationLine = '',\n    textDecorationColor = '',\n    textDecorationStyle = '',\n    textDecorationThickness = 1,\n    metrics,\n  } = parsedStyle;\n  let { textBaseline = 'alphabetic' } = parsedStyle;\n\n  if (textBaseline === 'alphabetic') {\n    textBaseline = 'bottom';\n  }\n\n  $el.setAttribute('dominant-baseline', BASELINE_MAP[textBaseline]);\n\n  $el.setAttribute('paint-order', 'stroke');\n\n  const { lines, lineHeight, height } = metrics;\n\n  const lineNum = lines.length;\n\n  let styleCSSText = `transform:translate(${dx}px, ${dy}px);`;\n  if (textDecorationLine && textDecorationLine !== 'none') {\n    // Use CSS text-decoration for basic support\n    styleCSSText += `text-decoration:${textDecorationLine} ${textDecorationStyle} ${textDecorationColor};text-decoration-thickness:${textDecorationThickness};`;\n  }\n\n  if (styleCSSText) {\n    $el.setAttribute('style', styleCSSText);\n  }\n  if (x !== 0) {\n    $el.setAttribute('x', `${x}`);\n  }\n  if (y !== 0) {\n    $el.setAttribute('y', `${y}`);\n  }\n\n  if (lineNum === 1) {\n    const textContent = convertHTML(lines[0]);\n    $el.setAttribute('dx', `${lineWidth / 2}`);\n\n    // Since `text-after-edge` is not a standard property value, we use `dy` instead.\n    if (textBaseline === 'bottom' || textBaseline === 'top') {\n      $el.setAttribute('dominant-baseline', BASELINE_MAP.middle);\n      $el.setAttribute(\n        'dy',\n        textBaseline === 'bottom' ? `-${height / 2}px` : `${height / 2}px`,\n      );\n    } else {\n      $el.setAttribute('dy', '0px');\n    }\n\n    // <textPath> only support one line\n    // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/textPath\n    if (textPath) {\n      // clear existed text content first\n      $el.innerHTML = '';\n\n      // append <textPath href=\"#MyPath\">text</textPath>\n      const $textPath = createSVGElement('textPath', $el.ownerDocument);\n      $textPath.setAttribute('href', `#${TEXT_PATH_PREFIX + textPath.entity}`);\n      if (textPathSide !== 'left') {\n        $textPath.setAttribute('side', textPathSide);\n      }\n      if (textPathStartOffset !== 0) {\n        $textPath.setAttribute('startOffset', `${textPathStartOffset}`);\n      }\n      $textPath.innerHTML = textContent;\n      $el.appendChild($textPath);\n    } else {\n      $el.innerHTML = textContent;\n    }\n  } else {\n    $el.innerHTML = lines\n      .map((line: string, i: number) => {\n        const dx = lineWidth / 2;\n        let dy = 0;\n        if (i === 0) {\n          // TODO: handle other textBaseline values\n          if (textBaseline === 'middle') {\n            dy = lineHeight / 2 - height / 2;\n          } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n            dy = 0;\n          } else if (\n            textBaseline === 'bottom' ||\n            textBaseline === 'ideographic'\n          ) {\n            dy = -lineHeight * (lineNum - 1);\n          }\n        } else {\n          dy = lineHeight;\n        }\n        return `<tspan x=${x} dx=\"${dx}\" dy=\"${dy}\">${convertHTML(\n          line,\n        )}</tspan>`;\n      })\n      .join('');\n  }\n}\n","import type {\n  CanvasContext,\n  DisplayObject,\n  GlobalRuntime,\n  Text,\n} from '@antv/g-lite';\nimport { Shape } from '@antv/g-lite';\nimport {\n  updateImageElementAttribute,\n  updateLineElementAttribute,\n  updatePathElementAttribute,\n  updatePolylineElementAttribute,\n  updateRectElementAttribute,\n  updateTextElementAttribute,\n} from './shapes/paths';\nimport type { ElementLifeCycleContribution } from './interfaces';\nimport { createSVGElement } from './utils/dom';\n\nexport const SHAPE2TAGS: Record<Shape | string, string> = {\n  [Shape.RECT]: 'path',\n  [Shape.CIRCLE]: 'circle',\n  [Shape.ELLIPSE]: 'ellipse',\n  [Shape.IMAGE]: 'image',\n  [Shape.GROUP]: 'g',\n  [Shape.LINE]: 'line',\n  [Shape.POLYLINE]: 'polyline',\n  [Shape.POLYGON]: 'polygon',\n  [Shape.TEXT]: 'text',\n  [Shape.PATH]: 'path',\n  [Shape.HTML]: 'foreignObject',\n};\n\nexport const SHAPE_UPDATE_DEPS: Record<Shape | string, string[]> = {\n  [Shape.CIRCLE]: ['cx', 'cy', 'r'],\n  [Shape.ELLIPSE]: ['cx', 'cy', 'rx', 'ry'],\n  [Shape.RECT]: ['x', 'y', 'width', 'height', 'radius'],\n  [Shape.IMAGE]: ['x', 'y', 'src', 'width', 'height'],\n  [Shape.LINE]: [\n    'x1',\n    'y1',\n    'x2',\n    'y2',\n    'markerStart',\n    'markerEnd',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.POLYLINE]: [\n    'points',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.POLYGON]: [\n    'points',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.PATH]: [\n    'd',\n    'markerStart',\n    'markerEnd',\n    'markerMid',\n    'markerStartOffset',\n    'markerEndOffset',\n  ],\n  [Shape.TEXT]: [\n    'text',\n    'font',\n    'fontSize',\n    'fontFamily',\n    'fontStyle',\n    'fontWeight',\n    'fontVariant',\n    'lineHeight',\n    'letterSpacing',\n    'wordWrap',\n    'wordWrapWidth',\n    'maxLines',\n    'leading',\n    'textBaseline',\n    'textAlign',\n    'textTransform',\n    'textOverflow',\n    'textPath',\n    'textPathSide',\n    'textPathStartOffset',\n    'textDecorationLine',\n    'textDecorationColor',\n    'textDecorationStyle',\n    // 'whiteSpace',\n    'dx',\n    'dy',\n  ],\n};\n\nexport class DefaultElementLifeCycleContribution\n  implements ElementLifeCycleContribution\n{\n  constructor(\n    private context: CanvasContext,\n    private runtime: GlobalRuntime,\n  ) {}\n\n  createElement(\n    object: DisplayObject,\n    svgElementMap: WeakMap<SVGElement, DisplayObject>,\n  ): SVGElement {\n    const { document: doc } = this.context.config;\n\n    const type = SHAPE2TAGS[object.nodeName] || 'g';\n    const $el = createSVGElement(type, doc || document);\n\n    svgElementMap.set($el, object);\n    return $el;\n  }\n\n  destroyElement(object: DisplayObject, $el: SVGElement) {}\n\n  shouldUpdateElementAttribute(object: DisplayObject, attributeName: string) {\n    const { nodeName } = object;\n    return (SHAPE_UPDATE_DEPS[nodeName] || []).indexOf(attributeName) > -1;\n  }\n\n  updateElementAttribute(object: DisplayObject) {\n    // @ts-ignore\n    const { $el } = object.elementSVG as ElementSVG;\n    const { nodeName, parsedStyle } = object;\n\n    switch (nodeName) {\n      case Shape.IMAGE: {\n        updateImageElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.RECT: {\n        updateRectElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.LINE: {\n        updateLineElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.POLYGON:\n      case Shape.POLYLINE: {\n        updatePolylineElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.PATH: {\n        updatePathElementAttribute($el, parsedStyle);\n        break;\n      }\n      case Shape.TEXT: {\n        updateTextElementAttribute(\n          $el,\n          parsedStyle,\n          object as Text,\n          this.runtime,\n        );\n        break;\n      }\n    }\n  }\n}\n","import { AbstractRendererPlugin, GlobalRuntime } from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { ElementSVG } from './components/ElementSVG';\nimport { DefaultElementLifeCycleContribution } from './DefaultElementLifeCycleContribution';\nimport { DefElementManager } from './shapes/defs';\nimport { SVGRendererPlugin } from './SVGRendererPlugin';\nimport type { SVGRendererPluginOptions } from './interfaces';\n\nexport * from './DefaultElementLifeCycleContribution';\nexport * from './shapes/paths';\nexport * from './SVGRendererPlugin';\nexport * from './interfaces';\nexport * from './utils/dom';\nexport { ElementSVG };\n\nexport class Plugin extends AbstractRendererPlugin {\n  name = 'svg-renderer';\n\n  constructor(private options: Partial<SVGRendererPluginOptions> = {}) {\n    super();\n  }\n\n  init(runtime: GlobalRuntime): void {\n    const { outputSVGElementId, outputSVGElementName } = this.options;\n    const defElementManager = new DefElementManager(this.context);\n\n    // default implementation\n    const defaultElementLifeCycleContribution =\n      new DefaultElementLifeCycleContribution(this.context, runtime);\n    // @ts-ignore\n    this.context.defaultElementLifeCycleContribution =\n      defaultElementLifeCycleContribution;\n\n    // @ts-ignore\n    this.context.SVGElementLifeCycleContribution =\n      defaultElementLifeCycleContribution;\n\n    const SVGRendererPluginOptions: SVGRendererPluginOptions = {\n      outputSVGElementId: !isNil(outputSVGElementId)\n        ? !!outputSVGElementId\n        : true,\n      outputSVGElementName: !isNil(outputSVGElementName)\n        ? !!outputSVGElementName\n        : true,\n    };\n\n    this.addRenderingPlugin(\n      // @ts-ignore\n      new SVGRendererPlugin(\n        SVGRendererPluginOptions,\n        defElementManager,\n        this.context,\n      ),\n    );\n  }\n  destroy(): void {\n    this.removeAllRenderingPlugins();\n\n    // @ts-ignore\n    delete this.context.defaultElementLifeCycleContribution;\n    // @ts-ignore\n    delete this.context.SVGElementLifeCycleContribution;\n  }\n}\n","function _OverloadYield(e, d) {\n  this.v = e, this.k = d;\n}\nexport { _OverloadYield as default };","function _regeneratorDefine(e, r, n, t) {\n  var i = Object.defineProperty;\n  try {\n    i({}, \"\", {});\n  } catch (e) {\n    i = 0;\n  }\n  _regeneratorDefine = function regeneratorDefine(e, r, n, t) {\n    function o(r, n) {\n      _regeneratorDefine(e, r, function (e) {\n        return this._invoke(r, n, e);\n      });\n    }\n    r ? i ? i(e, r, {\n      value: n,\n      enumerable: !t,\n      configurable: !t,\n      writable: !t\n    }) : e[r] = n : (o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2));\n  }, _regeneratorDefine(e, r, n, t);\n}\nexport { _regeneratorDefine as default };","import regeneratorDefine from \"./regeneratorDefine.js\";\nfunction _regenerator() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */\n  var e,\n    t,\n    r = \"function\" == typeof Symbol ? Symbol : {},\n    n = r.iterator || \"@@iterator\",\n    o = r.toStringTag || \"@@toStringTag\";\n  function i(r, n, o, i) {\n    var c = n && n.prototype instanceof Generator ? n : Generator,\n      u = Object.create(c.prototype);\n    return regeneratorDefine(u, \"_invoke\", function (r, n, o) {\n      var i,\n        c,\n        u,\n        f = 0,\n        p = o || [],\n        y = !1,\n        G = {\n          p: 0,\n          n: 0,\n          v: e,\n          a: d,\n          f: d.bind(e, 4),\n          d: function d(t, r) {\n            return i = t, c = 0, u = e, G.n = r, a;\n          }\n        };\n      function d(r, n) {\n        for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) {\n          var o,\n            i = p[t],\n            d = G.p,\n            l = i[2];\n          r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0));\n        }\n        if (o || r > 1) return a;\n        throw y = !0, n;\n      }\n      return function (o, p, l) {\n        if (f > 1) throw TypeError(\"Generator is already running\");\n        for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) {\n          i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u);\n          try {\n            if (f = 2, i) {\n              if (c || (o = \"next\"), t = i[o]) {\n                if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\");\n                if (!t.done) return t;\n                u = t.value, c < 2 && (c = 0);\n              } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1);\n              i = e;\n            } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break;\n          } catch (t) {\n            i = e, c = 1, u = t;\n          } finally {\n            f = 1;\n          }\n        }\n        return {\n          value: t,\n          done: y\n        };\n      };\n    }(r, o, i), !0), u;\n  }\n  var a = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  t = Object.getPrototypeOf;\n  var c = [][n] ? t(t([][n]())) : (regeneratorDefine(t = {}, n, function () {\n      return this;\n    }), t),\n    u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c);\n  function f(e) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, regeneratorDefine(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e;\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, regeneratorDefine(u, \"constructor\", GeneratorFunctionPrototype), regeneratorDefine(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", regeneratorDefine(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), regeneratorDefine(u), regeneratorDefine(u, o, \"Generator\"), regeneratorDefine(u, n, function () {\n    return this;\n  }), regeneratorDefine(u, \"toString\", function () {\n    return \"[object Generator]\";\n  }), (_regenerator = function _regenerator() {\n    return {\n      w: i,\n      m: f\n    };\n  })();\n}\nexport { _regenerator as default };","import OverloadYield from \"./OverloadYield.js\";\nimport regeneratorDefine from \"./regeneratorDefine.js\";\nfunction AsyncIterator(t, e) {\n  function n(r, o, i, f) {\n    try {\n      var c = t[r](o),\n        u = c.value;\n      return u instanceof OverloadYield ? e.resolve(u.v).then(function (t) {\n        n(\"next\", t, i, f);\n      }, function (t) {\n        n(\"throw\", t, i, f);\n      }) : e.resolve(u).then(function (t) {\n        c.value = t, i(c);\n      }, function (t) {\n        return n(\"throw\", t, i, f);\n      });\n    } catch (t) {\n      f(t);\n    }\n  }\n  var r;\n  this.next || (regeneratorDefine(AsyncIterator.prototype), regeneratorDefine(AsyncIterator.prototype, \"function\" == typeof Symbol && Symbol.asyncIterator || \"@asyncIterator\", function () {\n    return this;\n  })), regeneratorDefine(this, \"_invoke\", function (t, o, i) {\n    function f() {\n      return new e(function (e, r) {\n        n(t, i, e, r);\n      });\n    }\n    return r = r ? r.then(f, f) : f();\n  }, !0);\n}\nexport { AsyncIterator as default };","import regenerator from \"./regenerator.js\";\nimport regeneratorAsyncIterator from \"./regeneratorAsyncIterator.js\";\nfunction _regeneratorAsyncGen(r, e, t, o, n) {\n  return new regeneratorAsyncIterator(regenerator().w(r, e, t, o), n || Promise);\n}\nexport { _regeneratorAsyncGen as default };","import regeneratorAsyncGen from \"./regeneratorAsyncGen.js\";\nfunction _regeneratorAsync(n, e, r, t, o) {\n  var a = regeneratorAsyncGen(n, e, r, t, o);\n  return a.next().then(function (n) {\n    return n.done ? n.value : a.next();\n  });\n}\nexport { _regeneratorAsync as default };","function _regeneratorKeys(e) {\n  var n = Object(e),\n    r = [];\n  for (var t in n) r.unshift(t);\n  return function e() {\n    for (; r.length;) if ((t = r.pop()) in n) return e.value = t, e.done = !1, e;\n    return e.done = !0, e;\n  };\n}\nexport { _regeneratorKeys as default };","import _typeof from \"./typeof.js\";\nfunction _regeneratorValues(e) {\n  if (null != e) {\n    var t = e[\"function\" == typeof Symbol && Symbol.iterator || \"@@iterator\"],\n      r = 0;\n    if (t) return t.call(e);\n    if (\"function\" == typeof e.next) return e;\n    if (!isNaN(e.length)) return {\n      next: function next() {\n        return e && r >= e.length && (e = void 0), {\n          value: e && e[r++],\n          done: !e\n        };\n      }\n    };\n  }\n  throw new TypeError(_typeof(e) + \" is not iterable\");\n}\nexport { _regeneratorValues as default };","import OverloadYield from \"./OverloadYield.js\";\nimport regenerator from \"./regenerator.js\";\nimport regeneratorAsync from \"./regeneratorAsync.js\";\nimport regeneratorAsyncGen from \"./regeneratorAsyncGen.js\";\nimport regeneratorAsyncIterator from \"./regeneratorAsyncIterator.js\";\nimport regeneratorKeys from \"./regeneratorKeys.js\";\nimport regeneratorValues from \"./regeneratorValues.js\";\nfunction _regeneratorRuntime() {\n  \"use strict\";\n\n  var r = regenerator(),\n    e = r.m(_regeneratorRuntime),\n    t = (Object.getPrototypeOf ? Object.getPrototypeOf(e) : e.__proto__).constructor;\n  function n(r) {\n    var e = \"function\" == typeof r && r.constructor;\n    return !!e && (e === t || \"GeneratorFunction\" === (e.displayName || e.name));\n  }\n  var o = {\n    \"throw\": 1,\n    \"return\": 2,\n    \"break\": 3,\n    \"continue\": 3\n  };\n  function a(r) {\n    var e, t;\n    return function (n) {\n      e || (e = {\n        stop: function stop() {\n          return t(n.a, 2);\n        },\n        \"catch\": function _catch() {\n          return n.v;\n        },\n        abrupt: function abrupt(r, e) {\n          return t(n.a, o[r], e);\n        },\n        delegateYield: function delegateYield(r, o, a) {\n          return e.resultName = o, t(n.d, regeneratorValues(r), a);\n        },\n        finish: function finish(r) {\n          return t(n.f, r);\n        }\n      }, t = function t(r, _t, o) {\n        n.p = e.prev, n.n = e.next;\n        try {\n          return r(_t, o);\n        } finally {\n          e.next = n.n;\n        }\n      }), e.resultName && (e[e.resultName] = n.v, e.resultName = void 0), e.sent = n.v, e.next = n.n;\n      try {\n        return r.call(this, e);\n      } finally {\n        n.p = e.prev, n.n = e.next;\n      }\n    };\n  }\n  return (_regeneratorRuntime = function _regeneratorRuntime() {\n    return {\n      wrap: function wrap(e, t, n, o) {\n        return r.w(a(e), t, n, o && o.reverse());\n      },\n      isGeneratorFunction: n,\n      mark: r.m,\n      awrap: function awrap(r, e) {\n        return new OverloadYield(r, e);\n      },\n      AsyncIterator: regeneratorAsyncIterator,\n      async: function async(r, e, t, o, u) {\n        return (n(e) ? regeneratorAsyncGen : regeneratorAsync)(a(r), e, t, o, u);\n      },\n      keys: regeneratorKeys,\n      values: regeneratorValues\n    };\n  })();\n}\nexport { _regeneratorRuntime as default };","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","import type {\n  DisplayObject,\n  GlobalRuntime,\n  PickingResult,\n  RenderingPlugin,\n  RenderingPluginContext,\n} from '@antv/g-lite';\n\n/**\n * pick shape(s) with Mouse/Touch event\n *\n * 1. find AABB with r-tree\n * 2. use elementFromPoint\n */\nexport class SVGPickerPlugin implements RenderingPlugin {\n  static tag = 'SVGPicker';\n\n  apply(context: RenderingPluginContext, runtime: GlobalRuntime) {\n    const {\n      config: { document: doc },\n      renderingService,\n      // @ts-ignore\n      svgElementMap,\n    } = context;\n\n    renderingService.hooks.pick.tapPromise(\n      SVGPickerPlugin.tag,\n      async (result: PickingResult) => {\n        return this.pick(svgElementMap, doc, result);\n      },\n    );\n\n    renderingService.hooks.pickSync.tap(\n      SVGPickerPlugin.tag,\n      (result: PickingResult) => {\n        return this.pick(svgElementMap, doc, result);\n      },\n    );\n  }\n\n  private pick(\n    svgElementMap: WeakMap<SVGElement, DisplayObject>,\n    doc: Document | ShadowRoot,\n    result: PickingResult,\n  ) {\n    const {\n      topmost,\n      position: { clientX, clientY },\n    } = result;\n\n    try {\n      const targets: DisplayObject[] = [];\n      // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/elementsFromPoint\n      for (const element of (doc || document).elementsFromPoint(\n        clientX,\n        clientY,\n      )) {\n        if (element.shadowRoot && element.shadowRoot !== doc) {\n          return this.pick(svgElementMap, element.shadowRoot, result);\n        }\n        const target = svgElementMap.get(element as SVGElement);\n        // don't need to account for `visibility` since DOM API already does\n        if (target && target.isInteractive()) {\n          targets.push(target);\n\n          if (topmost) {\n            result.picked = targets;\n            return result;\n          }\n        }\n      }\n\n      result.picked = targets;\n    } catch {\n      result.picked = [];\n    }\n    return result;\n  }\n}\n","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nfunction _createForOfIteratorHelper(r, e) {\n  var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (!t) {\n    if (Array.isArray(r) || (t = unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) {\n      t && (r = t);\n      var _n = 0,\n        F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          return _n >= r.length ? {\n            done: !0\n          } : {\n            done: !1,\n            value: r[_n++]\n          };\n        },\n        e: function e(r) {\n          throw r;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var o,\n    a = !0,\n    u = !1;\n  return {\n    s: function s() {\n      t = t.call(r);\n    },\n    n: function n() {\n      var r = t.next();\n      return a = r.done, r;\n    },\n    e: function e(r) {\n      u = !0, o = r;\n    },\n    f: function f() {\n      try {\n        a || null == t[\"return\"] || t[\"return\"]();\n      } finally {\n        if (u) throw o;\n      }\n    }\n  };\n}\nexport { _createForOfIteratorHelper as default };","import { AbstractRendererPlugin } from '@antv/g-lite';\nimport { SVGPickerPlugin } from './SVGPickerPlugin';\n\nexport class Plugin extends AbstractRendererPlugin {\n  name = 'svg-picker';\n  init(): void {\n    this.addRenderingPlugin(new SVGPickerPlugin());\n  }\n  destroy(): void {\n    this.removeAllRenderingPlugins();\n  }\n}\n","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nfunction _objectWithoutProperties(e, t) {\n  if (null == e) return {};\n  var o,\n    r,\n    i = objectWithoutPropertiesLoose(e, t);\n  if (Object.getOwnPropertySymbols) {\n    var n = Object.getOwnPropertySymbols(e);\n    for (r = 0; r < n.length; r++) o = n[r], -1 === t.indexOf(o) && {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]);\n  }\n  return i;\n}\nexport { _objectWithoutProperties as default };","function _objectWithoutPropertiesLoose(r, e) {\n  if (null == r) return {};\n  var t = {};\n  for (var n in r) if ({}.hasOwnProperty.call(r, n)) {\n    if (-1 !== e.indexOf(n)) continue;\n    t[n] = r[n];\n  }\n  return t;\n}\nexport { _objectWithoutPropertiesLoose as default };","import type {\n  CanvasContext,\n  DataURLOptions,\n  GlobalRuntime,\n  CanvasConfig,\n  ContextService,\n  DisplayObject,\n} from '@antv/g-lite';\nimport { propertyMetadataCache } from '@antv/g-lite';\nimport { isString } from '@antv/util';\nimport { createSVGElement } from './plugins/svg-renderer';\n\nexport class SVGContextService implements ContextService<SVGElement> {\n  private $container: HTMLElement | null;\n  private $namespace: SVGElement | null;\n  private dpr: number;\n\n  private canvasConfig: Partial<CanvasConfig>;\n\n  constructor(public context: GlobalRuntime & CanvasContext) {\n    this.canvasConfig = context.config;\n  }\n\n  init() {\n    const {\n      container,\n      document: doc,\n      devicePixelRatio: dpr,\n    } = this.canvasConfig;\n\n    // create container\n    this.$container = isString(container)\n      ? (doc || document).getElementById(container)\n      : container;\n    if (this.$container) {\n      if (!this.$container.style.position) {\n        this.$container.style.position = 'relative';\n      }\n      const $namespace = createSVGElement('svg', doc);\n      $namespace.setAttribute('width', `${this.canvasConfig.width}`);\n      $namespace.setAttribute('height', `${this.canvasConfig.height}`);\n\n      this.$container.appendChild($namespace);\n\n      this.$namespace = $namespace;\n    }\n\n    this.dpr = dpr;\n  }\n\n  // @ts-ignore\n  getDomElement() {\n    return this.$namespace;\n  }\n\n  getContext() {\n    return this.$namespace;\n  }\n\n  getDPR() {\n    return this.dpr;\n  }\n\n  getBoundingClientRect() {\n    return this.$namespace?.getBoundingClientRect();\n  }\n\n  destroy() {\n    // destroy context\n    if (this.$container && this.$namespace && this.$namespace.parentNode) {\n      this.$container.removeChild(this.$namespace);\n    }\n  }\n\n  resize(width: number, height: number) {\n    // SVG should ignore DPR\n    if (this.$namespace) {\n      this.$namespace.setAttribute('width', `${width}`);\n      this.$namespace.setAttribute('height', `${height}`);\n    }\n  }\n\n  applyCursorStyle(cursor: string) {\n    if (this.$container) {\n      this.$container.style.cursor = cursor;\n    }\n  }\n\n  private generateCSSText(\n    animationName: string,\n    selector: string,\n    keyframes: ComputedKeyframe[],\n    timing: ComputedEffectTiming,\n    prefixes: Record<string, string> = {},\n  ) {\n    const { duration, easing, delay, direction, iterations, fill } = timing;\n\n    return (\n      `@keyframes ${animationName}{${keyframes\n        .map((keyframe) => {\n          const { offset, composite, computedOffset, easing, ...rest } =\n            keyframe;\n          const rules = Object.keys(rest)\n            .map((attributeName) => {\n              return `${attributeName}:${prefixes[attributeName] || ''}${\n                rest[attributeName]\n              };`;\n            })\n            .join('');\n          return `${computedOffset * 100}%{${rules}}`;\n        })\n        .join('')}}` +\n      `${selector} {animation: ${animationName} ${duration}ms ${easing} ${delay}ms ${\n        iterations === Infinity ? 'infinite' : iterations\n      } ${direction} ${fill};}`\n    );\n  }\n\n  async toDataURL(options: Partial<DataURLOptions> = {}) {\n    const cloneNode = this.$namespace.cloneNode(true);\n\n    const { document: doc } = this.canvasConfig;\n    let animationCounter = 0;\n    let $style: HTMLStyleElement | null = null;\n\n    this.context.renderingContext.root.forEach((object: DisplayObject) => {\n      const animations = object.getAnimations();\n      if (animations.length) {\n        if (!$style) {\n          // export animations to <style>, using CSS Transformation\n          $style = (doc || document).createElement('style');\n          cloneNode.appendChild($style);\n        }\n\n        // @ts-ignore\n        const svgElement = object.elementSVG;\n        const selfSelector = `#${svgElement.$el.id}`;\n        const groupSelector = `#${svgElement.$groupEl.id}`;\n        let selfCssText = '';\n        let groupCssText = '';\n\n        animations.forEach((animation) => {\n          const keyframes = animation.effect.getKeyframes();\n\n          // split attributes into self and group\n          if (keyframes.length) {\n            const selfAttributes = [];\n            const groupAttributes = [];\n            const {\n              offset,\n              composite,\n              computedOffset,\n              easing,\n              transformOrigin,\n              ...rest\n            } = keyframes[0];\n            Object.keys(rest).forEach((attributeName) => {\n              if (attributeName === 'transform') {\n                groupAttributes.push(attributeName);\n              }\n\n              const inherited = !!propertyMetadataCache[attributeName]?.inh;\n              if (inherited) {\n                groupAttributes.push(attributeName);\n              } else if (attributeName !== 'transform') {\n                selfAttributes.push(attributeName);\n              }\n            });\n\n            if (groupAttributes.length) {\n              const keyframesWithGroup = keyframes.map((keyframe) => {\n                const {\n                  offset,\n                  composite,\n                  computedOffset,\n                  easing,\n                  transformOrigin,\n                  ...rest\n                } = keyframe;\n\n                const ret = { offset, composite, computedOffset, easing };\n                Object.keys(rest).forEach((attributeName) => {\n                  if (groupAttributes.includes(attributeName)) {\n                    ret[attributeName] = keyframe[attributeName];\n                  }\n                });\n                return ret;\n              });\n              groupCssText += this.generateCSSText(\n                `a${animationCounter++}`,\n                groupSelector,\n                keyframesWithGroup,\n                animation.effect.getComputedTiming(),\n                { transform: svgElement.$groupEl.getAttribute('transform') },\n              );\n            }\n\n            if (selfAttributes.length) {\n              const keyframesWithSelf = keyframes.map((keyframe) => {\n                const {\n                  offset,\n                  composite,\n                  computedOffset,\n                  easing,\n                  transformOrigin,\n                  ...rest\n                } = keyframe;\n\n                const ret = { offset, composite, computedOffset, easing };\n                Object.keys(rest).forEach((attributeName) => {\n                  if (selfAttributes.includes(attributeName)) {\n                    ret[attributeName] = keyframe[attributeName];\n                  }\n                });\n                return ret;\n              });\n\n              selfCssText += this.generateCSSText(\n                `a${animationCounter++}`,\n                selfSelector,\n                keyframesWithSelf,\n                animation.effect.getComputedTiming(),\n              );\n            }\n          }\n        });\n\n        $style.textContent += selfCssText + groupCssText;\n      }\n    });\n\n    const svgDocType = document.implementation.createDocumentType(\n      'svg',\n      '-//W3C//DTD SVG 1.1//EN',\n      'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd',\n    );\n    const svgDoc = document.implementation.createDocument(\n      'http://www.w3.org/2000/svg',\n      'svg',\n      svgDocType,\n    );\n    svgDoc.replaceChild(cloneNode, svgDoc.documentElement);\n    return `data:image/svg+xml;charset=utf8,${encodeURIComponent(\n      new XMLSerializer().serializeToString(svgDoc),\n    )}`;\n  }\n}\n","import { AbstractRendererPlugin } from '@antv/g-lite';\nimport { SVGContextService } from './SVGContextService';\n\nexport class ContextRegisterPlugin extends AbstractRendererPlugin {\n  name = 'svg-context-register';\n  init(): void {\n    // @ts-ignore\n    this.context.ContextService = SVGContextService;\n  }\n  destroy(): void {\n    delete this.context.ContextService;\n  }\n}\n","import type { RendererConfig } from '@antv/g-lite';\nimport { AbstractRenderer, DomInteraction } from '@antv/g-lite';\nimport * as SVGRenderer from './plugins/svg-renderer';\nimport * as SVGPicker from './plugins/picker';\nimport { ContextRegisterPlugin } from './ContextRegisterPlugin';\n\nexport interface SVGRendererConfig extends RendererConfig {\n  /**\n   * Whether to output id on SVGElement with `setAttribute` like: <circle id=\"g-circle-123\">.\n   */\n  outputSVGElementId: boolean;\n}\n\nexport class Renderer extends AbstractRenderer {\n  constructor(config: Partial<SVGRendererConfig> = {}) {\n    super(config);\n\n    this.registerPlugin(new ContextRegisterPlugin());\n    this.registerPlugin(\n      new SVGRenderer.Plugin({\n        outputSVGElementId: config.outputSVGElementId,\n      }),\n    );\n    this.registerPlugin(new DomInteraction.Plugin());\n    this.registerPlugin(new SVGPicker.Plugin());\n  }\n}\n\n// plugins\nexport { createSVGElement, G_SVG_PREFIX } from './plugins/svg-renderer';\nexport { SVGRenderer, SVGPicker };\nexport { DomInteraction };\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","_classCallCheck","a","n","_getPrototypeOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_isNativeReflectConstruct","Boolean","valueOf","Reflect","construct","_possibleConstructorReturn","ReferenceError","assertThisInitialized","_callSuper","possibleConstructorReturn","isNativeReflectConstruct","apply","_setPrototypeOf","_inherits","create","value","isNil","isString","clamp$1","min","max","ARRAY_TYPE","Float32Array","Array","out","glMatrix.ARRAY_TYPE","invert","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","ElementSVG","_defineProperty","updateImageElementAttribute","$el","parsedStyle","_parsedStyle$src","src","_parsedStyle$x","x","_parsedStyle$y","y","width","height","setAttribute","concat","Image","HTMLElement","nodeName","toUpperCase","toDataURL","ImageData","canvas","document","createElement","context","getContext","putImageData","updateLineElementAttribute","x1","y1","x2","y2","markerStart","markerEnd","markerStartOffset","markerEndOffset","startOffsetX","startOffsetY","endOffsetX","endOffsetY","rad","isDisplayObject","Math","cos","atan2","sin","_arrayLikeToArray","_unsupportedIterableToArray","arrayLikeToArray","toString","slice","name","from","test","_slicedToArray","isArray","arrayWithHoles","l","u","f","next","done","push","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","updatePathElementAttribute","d","_getStartTangent2","parentNode","getStartTangent","p1","p2","_getEndTangent2","getEndTangent","translatePathToString","absolutePath","updatePolylineElementAttribute","points","map","point","offsetX","offsetY","join","updateRectElementAttribute","radius","isFinite","some","_radius$map2","clamp","abs","tlr","trr","brr","blr","signX","signY","sweepFlag","createSVGElement","type","doc","createElementNS","tag","FILTER_PREFIX","createOrUpdateFilter","$def","object","filters","filterName","entity","$existedFilters","querySelectorAll","forEach","$filter","removeChild","removeAttribute","filterIds","_ref","params","$feGaussianBlur","appendChild","createBlur","slope","convertToAbsoluteValue","createFeComponentTransfer","intercept","createBrightness","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","formatted","$feOffset","$feFlood","$feComposite","$feMerge","$feMergeNode1","$feMergeNode2","createDropShadow","createContrast","amount","createFeColorMatrix","createGrayscale","createSepia","$feColorMatrix","createSaturate","createHueRotate","tableValues","createInvert","id","setTimeout","filterId","param","unit","UnitType","kPercentage","_ref2","$feComponentTransfer","$feFunc","matrix","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","_objectSpread2","arguments","getOwnPropertyDescriptors","defineProperties","cacheKey2IDMap","counter","createOrUpdateGradientAndPattern","parsedColor","createImage","plugin","isCSSRGB","isPattern","patternId","pattern","generateCacheKey","$existed","querySelector","image","imageURL","isBrowser","HTMLImageElement","HTMLCanvasElement","$image","img","match","crossOrigin","onload","$pattern","create$Pattern","complete","_parsedStyle","createSVGDom","svgElement","elementSVG","localTransform","getLocalTransform","applyTransform","$groupEl","createOrUpdatePattern","style","gradientId","createOrUpdateGradient","gradients","blended","gradient","rectId","$rect","$feImage","$feBlend","createOrUpdateMultiGradient","isNone","options","undefined","cacheKey","isCSSGradientValue","GradientType","LinearGradient","RadialGradient","_value$options","_objectSpread","steps","angle","cx","cy","size","color","offset","repetition","transform","parseTransform","parsed","newScale","s","newSkew","_d$map2","b","c","dd","tx","ty","item","formatTransform","_object$getGeometryBo","getGeometryBounds","halfExtents","patternWidth","patternHeight","bounds","innerHTML","sort","_computeLinearGradien","computeLinearGradient","_ref4","_computeRadialGradien","computeRadialGradient","urlRegexp","DefElementManager","this","gradientCache","config","$svg","contextService","_this","clearUnusedDefElement","cache","has","targetElement","_this$context$config","matches","getAttribute","replace","newDefElementId","Set","add","_object$parsedStyle","_object$parsedStyle$s","shadowType","hasShadow","shadowId","$existedFilter","remove","$feDropShadow","$feFuncA","$feComposite2","$feMergeNode","children","createOrUpdateShadow","numberToLongString","toFixed","convertHTML","str","SVG_ATTR_MAP","opacity","fillStyle","fill","fillRule","fillOpacity","strokeStyle","strokeOpacity","stroke","clipPath","textPath","rx","ry","lineCap","lineJoin","lineWidth","lineDash","lineDashOffset","miterLimit","font","fontSize","fontStyle","fontVariant","fontWeight","fontFamily","letterSpacing","startArrow","endArrow","class","preserveAspectRatio","visibility","textAlign","pointerEvents","FORMAT_VALUE_MAP","inherit","left","start","center","right","end","DEFAULT_VALUE_MAP","strokeWidth","strokeMiterLimit","G_SVG_PREFIX","CLIP_PATH_PREFIX","TEXT_PATH_PREFIX","SVGRendererPlugin","pluginOptions","defElementManager","svgElementMap","WeakMap","renderQueue","dirtyAttributes","pendingReorderQueue","clipPathUseMap","renderingService","renderingContext","root","ownerDocument","defaultView","handleMounted","target","get","existed","getDefElement","getId","$camera","handleUnmounted","clear","removeSVGDom","reorderChildren","_object$parentNode","parent","handleReparent","handleAttributeChanged","attrName","attribtues","set","handleGeometryBoundsChanged","records","detail","_loop","Shape","FRAGMENT","childNodes","node","_object$elementSVG","parentInvert","mat4","getWorldTransform","clipPathId","hooks","init","tap","background","camera","getOrthoMatrix","addEventListener","ElementEvent","MOUNTED","UNMOUNTED","REPARENT","ATTR_MODIFIED","BOUNDS_CHANGED","destroy","removeEventListener","render","beginFrame","_object$elementSVG2","$parentGroupEl","endFrame","renderReasons","RenderReason","CAMERA_CHANGED","_elementSVG","_elementSVG2","$useRefs","$use","renderable","dirty","attributes","createOrUpdateHitArea","updateAttribute","sortable","renderOrder","fragment","createDocumentFragment","child","isConnected","rts","HTML","IMAGE","_this2","$hitTestingEl","SVGElementLifeCycleContribution","shouldUpdateElementAttribute","updateElementAttribute","_FORMAT_VALUE_MAP$nam","_propertyMetadataCach","usedName","computedValue","computedValueStr","formattedValueStr","usedValue","inherited","propertyMetadataCache","inh","createOrUpdateInnerHTML","GROUP","isCustomElement","createOrUpdateClipOrTextPath","noWrapWithGroup","_object$parentNode$el","outputSVGElementId","outputSVGElementName","hasAttribute","applyAttributes","_object$elementSVG3","destroyElement","increasedLineWidthForHitTesting","cloneNode","attribute","hasFill","$div","isTextPath","attributeNameCamel","attributeNameHyphen","$clipPath","BASELINE_MAP","top","middle","bottom","alphabetic","ideographic","hanging","updateTextElementAttribute","text","runtime","getBounds","_parsedStyle$lineWidt","_parsedStyle$dx","dx","_parsedStyle$dy","dy","_parsedStyle$textPath","textPathSide","_parsedStyle$textPath2","textPathStartOffset","_parsedStyle$textDeco","textDecorationLine","_parsedStyle$textDeco2","textDecorationColor","_parsedStyle$textDeco3","textDecorationStyle","_parsedStyle$textDeco4","textDecorationThickness","metrics","_parsedStyle$textBase","textBaseline","lines","lineHeight","lineNum","styleCSSText","textContent","$textPath","line","SHAPE2TAGS","_SHAPE2TAGS","RECT","CIRCLE","ELLIPSE","LINE","POLYLINE","POLYGON","TEXT","PATH","SHAPE_UPDATE_DEPS","DefaultElementLifeCycleContribution","attributeName","indexOf","Plugin","_AbstractRendererPlug","_this$options","defaultElementLifeCycleContribution","SVGRendererPluginOptions","addRenderingPlugin","removeAllRenderingPlugins","AbstractRendererPlugin","_OverloadYield","v","k","_regeneratorDefine","_invoke","_regenerator","toStringTag","Generator","regeneratorDefine","p","G","GeneratorFunction","GeneratorFunctionPrototype","displayName","w","m","AsyncIterator","OverloadYield","resolve","then","asyncIterator","_regeneratorAsyncGen","regeneratorAsyncIterator","regenerator","Promise","_regeneratorAsync","regeneratorAsyncGen","_regeneratorKeys","unshift","pop","_regeneratorValues","isNaN","_regeneratorRuntime","throw","return","break","continue","stop","catch","abrupt","delegateYield","resultName","regeneratorValues","finish","_t","prev","sent","wrap","reverse","isGeneratorFunction","mark","awrap","async","regeneratorAsync","regeneratorKeys","values","asyncGeneratorStep","_asyncToGenerator","_next","_throw","SVGPickerPlugin","pick","tapPromise","_callee","result","_context","_x","pickSync","topmost","_result$position","position","clientX","clientY","_step","targets","_iterator","_n","F","_createForOfIteratorHelper","elementsFromPoint","element","shadowRoot","isInteractive","picked","err","_unused","_len","args","_key","_objectWithoutProperties","hasOwnProperty","objectWithoutPropertiesLoose","propertyIsEnumerable","SVGContextService","canvasConfig","_this$canvasConfig","container","dpr","devicePixelRatio","$container","getElementById","$namespace","_this$$namespace","getBoundingClientRect","cursor","animationName","selector","keyframes","timing","prefixes","duration","easing","delay","direction","iterations","keyframe","computedOffset","rest","_excluded","rules","Infinity","_toDataURL","animationCounter","$style","svgDocType","svgDoc","animations","getAnimations","selfSelector","groupSelector","selfCssText","groupCssText","animation","effect","getKeyframes","selfAttributes","groupAttributes","_keyframes$","_excluded2","keyframesWithGroup","composite","_excluded3","ret","includes","generateCSSText","getComputedTiming","keyframesWithSelf","_excluded4","implementation","createDocumentType","createDocument","replaceChild","documentElement","encodeURIComponent","XMLSerializer","serializeToString","ContextRegisterPlugin","ContextService","Renderer","_AbstractRenderer","registerPlugin","SVGRenderer","DomInteraction","SVGPicker","AbstractRenderer"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,21,22,23,24,25,26,32,41,42,43,44,45,46,47,48,49,50,52,54,55]}