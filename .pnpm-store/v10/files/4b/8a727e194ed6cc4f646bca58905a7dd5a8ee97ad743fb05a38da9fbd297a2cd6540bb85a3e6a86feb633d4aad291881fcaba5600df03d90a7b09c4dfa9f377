{"version":3,"file":"index.umd.min.js","sources":["../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/typeof.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/createClass.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/callSuper.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/inherits.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/common.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/mat4.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/vec3.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/is-nil.js","../../../node_modules/.pnpm/gl-matrix@3.4.4/node_modules/gl-matrix/esm/vec2.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/clamp.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/path/util/rotate-vector.js","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/path/process/arc-2-cubic.js","../src/plugins/canvas-renderer/CanvasRendererPlugin.ts","../src/plugins/canvas-renderer/shapes/styles/helper.ts","../src/plugins/canvas-renderer/shapes/styles/OptimizedDefault.ts","../src/plugins/canvas-renderer/shapes/styles/Default.ts","../src/plugins/canvas-renderer/shapes/styles/Image.ts","../src/plugins/canvas-renderer/utils/math.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","../src/plugins/canvas-renderer/shapes/styles/Text.ts","../src/plugins/canvas-renderer/index.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/OverloadYield.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorDefine.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regenerator.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorAsyncIterator.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorAsyncGen.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorAsync.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorKeys.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorValues.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","../src/plugins/picker/CanvasPickerPlugin.ts","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../../../node_modules/.pnpm/@babel+runtime@7.28.4/node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../../g-math/dist/index.esm.js","../src/plugins/picker/Circle.ts","../src/plugins/picker/Ellipse.ts","../src/plugins/picker/utils/math.ts","../src/plugins/picker/Line.ts","../src/plugins/picker/Path.ts","../src/plugins/picker/Polygon.ts","../src/plugins/picker/Polyline.ts","../src/plugins/picker/Rect.ts","../src/plugins/picker/Image.ts","../src/plugins/picker/Text.ts","../src/plugins/picker/index.ts","../src/plugins/path-generator/paths/Circle.ts","../src/plugins/path-generator/paths/Ellipse.ts","../src/plugins/path-generator/paths/Line.ts","../src/plugins/path-generator/paths/Path.ts","../src/plugins/path-generator/paths/Polygon.ts","../src/plugins/path-generator/paths/Polyline.ts","../src/plugins/path-generator/paths/Rect.ts","../src/plugins/path-generator/index.ts","../src/Canvas2DContextService.ts","../../../node_modules/.pnpm/@antv+util@3.3.11/node_modules/@antv/util/esm/lodash/is-string.js","../src/ContextRegisterPlugin.ts","../src/index.ts"],"sourcesContent":["function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(e, r) {\n  for (var t = 0; t < r.length; t++) {\n    var o = r[t];\n    o.enumerable = o.enumerable || !1, o.configurable = !0, \"value\" in o && (o.writable = !0), Object.defineProperty(e, toPropertyKey(o.key), o);\n  }\n}\nfunction _createClass(e, r, t) {\n  return r && _defineProperties(e.prototype, r), t && _defineProperties(e, t), Object.defineProperty(e, \"prototype\", {\n    writable: !1\n  }), e;\n}\nexport { _createClass as default };","function _classCallCheck(a, n) {\n  if (!(a instanceof n)) throw new TypeError(\"Cannot call a class as a function\");\n}\nexport { _classCallCheck as default };","function _getPrototypeOf(t) {\n  return _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function (t) {\n    return t.__proto__ || Object.getPrototypeOf(t);\n  }, _getPrototypeOf(t);\n}\nexport { _getPrototypeOf as default };","function _isNativeReflectConstruct() {\n  try {\n    var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n  } catch (t) {}\n  return (_isNativeReflectConstruct = function _isNativeReflectConstruct() {\n    return !!t;\n  })();\n}\nexport { _isNativeReflectConstruct as default };","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nfunction _possibleConstructorReturn(t, e) {\n  if (e && (\"object\" == _typeof(e) || \"function\" == typeof e)) return e;\n  if (void 0 !== e) throw new TypeError(\"Derived constructors may only return object or undefined\");\n  return assertThisInitialized(t);\n}\nexport { _possibleConstructorReturn as default };","function _assertThisInitialized(e) {\n  if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  return e;\n}\nexport { _assertThisInitialized as default };","import getPrototypeOf from \"./getPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nimport possibleConstructorReturn from \"./possibleConstructorReturn.js\";\nfunction _callSuper(t, o, e) {\n  return o = getPrototypeOf(o), possibleConstructorReturn(t, isNativeReflectConstruct() ? Reflect.construct(o, e || [], getPrototypeOf(t).constructor) : o.apply(t, e));\n}\nexport { _callSuper as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inherits(t, e) {\n  if (\"function\" != typeof e && null !== e) throw new TypeError(\"Super expression must either be null or a function\");\n  t.prototype = Object.create(e && e.prototype, {\n    constructor: {\n      value: t,\n      writable: !0,\n      configurable: !0\n    }\n  }), Object.defineProperty(t, \"prototype\", {\n    writable: !1\n  }), e && setPrototypeOf(t, e);\n}\nexport { _inherits as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nexport { _objectSpread2 as default };","function _arrayLikeToArray(r, a) {\n  (null == a || a > r.length) && (a = r.length);\n  for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e];\n  return n;\n}\nexport { _arrayLikeToArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _unsupportedIterableToArray(r, a) {\n  if (r) {\n    if (\"string\" == typeof r) return arrayLikeToArray(r, a);\n    var t = {}.toString.call(r).slice(8, -1);\n    return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? arrayLikeToArray(r, a) : void 0;\n  }\n}\nexport { _unsupportedIterableToArray as default };","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nfunction _slicedToArray(r, e) {\n  return arrayWithHoles(r) || iterableToArrayLimit(r, e) || unsupportedIterableToArray(r, e) || nonIterableRest();\n}\nexport { _slicedToArray as default };","function _arrayWithHoles(r) {\n  if (Array.isArray(r)) return r;\n}\nexport { _arrayWithHoles as default };","function _iterableToArrayLimit(r, l) {\n  var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (null != t) {\n    var e,\n      n,\n      i,\n      u,\n      a = [],\n      f = !0,\n      o = !1;\n    try {\n      if (i = (t = t.call(r)).next, 0 === l) {\n        if (Object(t) !== t) return;\n        f = !1;\n      } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0);\n    } catch (r) {\n      o = !0, n = r;\n    } finally {\n      try {\n        if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return;\n      } finally {\n        if (o) throw n;\n      }\n    }\n    return a;\n  }\n}\nexport { _iterableToArrayLimit as default };","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableRest as default };","function _classPrivateFieldBase(e, t) {\n  if (!{}.hasOwnProperty.call(e, t)) throw new TypeError(\"attempted to use private field on non-instance\");\n  return e;\n}\nexport { _classPrivateFieldBase as default };","var id = 0;\nfunction _classPrivateFieldKey(e) {\n  return \"__private_\" + id++ + \"_\" + e;\n}\nexport { _classPrivateFieldKey as default };","/**\n * Common utilities\n * @module glMatrix\n */\n\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== \"undefined\" ? Float32Array : Array;\nexport var RANDOM = Math.random;\nexport var ANGLE_ORDER = \"zyx\";\n\n/**\n * Symmetric round\n * see https://www.npmjs.com/package/round-half-up-symmetric#user-content-detailed-background\n *\n * @param {Number} a value to round\n */\nexport function round(a) {\n  if (a >= 0) return Math.round(a);\n  return a % 0.5 === 0 ? Math.floor(a) : Math.round(a);\n}\n\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\nvar radian = 180 / Math.PI;\n\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\nexport function toRadian(a) {\n  return a * degree;\n}\n\n/**\n * Convert Radian To Degree\n *\n * @param {Number} a Angle in Radians\n */\nexport function toDegree(a) {\n  return a * radian;\n}\n\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a          The first number to test.\n * @param {Number} b          The second number to test.\n * @param {Number} tolerance  Absolute or relative tolerance (default glMatrix.EPSILON)\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\nexport function equals(a, b) {\n  var tolerance = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : EPSILON;\n  return Math.abs(a - b) <= tolerance * Math.max(1, Math.abs(a), Math.abs(b));\n}","import * as glMatrix from \"./common.js\";\n\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n    var a12 = a[6],\n      a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4 | null} out, or null if source matrix is not invertible\n */\nexport function invert(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n\n  // Calculate the determinant\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\nexport function adjoint(out, a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32;\n  out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n  out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n  out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n  out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n  out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n  out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n  out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n  out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n  out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n  out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n  out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n  out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n  out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n  out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n  out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n  out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n  return out;\n}\n\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\nexport function determinant(a) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n  var b0 = a00 * a11 - a01 * a10;\n  var b1 = a00 * a12 - a02 * a10;\n  var b2 = a01 * a12 - a02 * a11;\n  var b3 = a20 * a31 - a21 * a30;\n  var b4 = a20 * a32 - a22 * a30;\n  var b5 = a21 * a32 - a22 * a31;\n  var b6 = a00 * b5 - a01 * b4 + a02 * b3;\n  var b7 = a10 * b5 - a11 * b4 + a12 * b3;\n  var b8 = a20 * b2 - a21 * b1 + a22 * b0;\n  var b9 = a30 * b2 - a31 * b1 + a32 * b0;\n\n  // Calculate the determinant\n  return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n}\n\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n    a01 = a[1],\n    a02 = a[2],\n    a03 = a[3];\n  var a10 = a[4],\n    a11 = a[5],\n    a12 = a[6],\n    a13 = a[7];\n  var a20 = a[8],\n    a21 = a[9],\n    a22 = a[10],\n    a23 = a[11];\n  var a30 = a[12],\n    a31 = a[13],\n    a32 = a[14],\n    a33 = a[15];\n\n  // Cache only the current line of the second matrix\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\nexport function translate(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n  return out;\n}\n\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\nexport function scale(out, a, v) {\n  var x = v[0],\n    y = v[1],\n    z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11];\n\n  // Construct the elements of the rotation matrix\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  // Perform axis-specific matrix multiplication\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n    y = axis[1],\n    z = axis[2];\n  var len = Math.sqrt(x * x + y * y + z * z);\n  var s, c, t;\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n\n  // Perform rotation-specific matrix multiplication\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n\n  // Perform axis-specific matrix multiplication\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n    by = -a[1],\n    bz = -a[2],\n    bw = a[3],\n    ax = a[4],\n    ay = a[5],\n    az = a[6],\n    aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw;\n  //Only scale if it makes sense\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion parameter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  return out;\n}\n\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n  return out;\n}\n\n/**\n * Decomposes a transformation matrix into its rotation, translation\n * and scale components. Returns only the rotation component\n * @param  {quat} out_r Quaternion to receive the rotation component\n * @param  {vec3} out_t Vector to receive the translation vector\n * @param  {vec3} out_s Vector to receive the scaling factor\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @returns {quat} out_r\n */\nexport function decompose(out_r, out_t, out_s, mat) {\n  out_t[0] = mat[12];\n  out_t[1] = mat[13];\n  out_t[2] = mat[14];\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n  out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n  out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n  var is1 = 1 / out_s[0];\n  var is2 = 1 / out_s[1];\n  var is3 = 1 / out_s[2];\n  var sm11 = m11 * is1;\n  var sm12 = m12 * is2;\n  var sm13 = m13 * is3;\n  var sm21 = m21 * is1;\n  var sm22 = m22 * is2;\n  var sm23 = m23 * is3;\n  var sm31 = m31 * is1;\n  var sm32 = m32 * is2;\n  var sm33 = m33 * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out_r[3] = 0.25 * S;\n    out_r[0] = (sm23 - sm32) / S;\n    out_r[1] = (sm31 - sm13) / S;\n    out_r[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out_r[3] = (sm23 - sm32) / S;\n    out_r[0] = 0.25 * S;\n    out_r[1] = (sm12 + sm21) / S;\n    out_r[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out_r[3] = (sm31 - sm13) / S;\n    out_r[0] = (sm12 + sm21) / S;\n    out_r[1] = 0.25 * S;\n    out_r[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out_r[3] = (sm12 - sm21) / S;\n    out_r[0] = (sm31 + sm13) / S;\n    out_r[1] = (sm23 + sm32) / S;\n    out_r[2] = 0.25 * S;\n  }\n  return out_r;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *     mat4.translate(dest, dest, origin);\n *     let quatMat = mat4.create();\n *     mat4.fromQuat(quatMat, quat);\n *     mat4.multiply(dest, dest, quatMat);\n *     mat4.scale(dest, dest, scale)\n *     mat4.translate(dest, dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\nexport function fromQuat(out, q) {\n  var x = q[0],\n    y = q[1],\n    z = q[2],\n    w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n  return out;\n}\n\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\nexport var perspective = perspectiveNO;\n\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2);\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    var nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n  return out;\n}\n\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\nexport var ortho = orthoNO;\n\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} target Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n    eyey = eye[1],\n    eyez = eye[2],\n    upx = up[0],\n    upy = up[1],\n    upz = up[2];\n  var z0 = eyex - target[0],\n    z1 = eyey - target[1],\n    z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n  var x0 = upy * z2 - upz * z1,\n    x1 = upz * z0 - upx * z2,\n    x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\nexport function frob(a) {\n  return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + a[6] * a[6] + a[7] * a[7] + a[8] * a[8] + a[9] * a[9] + a[10] * a[10] + a[11] * a[11] + a[12] * a[12] + a[13] * a[13] + a[14] * a[14] + a[15] * a[15]);\n}\n\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2],\n    a3 = a[3];\n  var a4 = a[4],\n    a5 = a[5],\n    a6 = a[6],\n    a7 = a[7];\n  var a8 = a[8],\n    a9 = a[9],\n    a10 = a[10],\n    a11 = a[11];\n  var a12 = a[12],\n    a13 = a[13],\n    a14 = a[14],\n    a15 = a[15];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3];\n  var b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7];\n  var b8 = b[8],\n    b9 = b[9],\n    b10 = b[10],\n    b11 = b[11];\n  var b12 = b[12],\n    b13 = b[13],\n    b14 = b[14],\n    b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  out[2] = glMatrix.round(a[2]);\n  return out;\n}\n\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2];\n  var bx = b[0],\n    by = b[1],\n    bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n\n/**\n * Performs a spherical linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function slerp(out, a, b, t) {\n  var angle = Math.acos(Math.min(Math.max(dot(a, b), -1), 1));\n  var sinTotal = Math.sin(angle);\n  var ratioA = Math.sin((1 - t) * angle) / sinTotal;\n  var ratioB = Math.sin(t * angle) / sinTotal;\n  out[0] = ratioA * a[0] + ratioB * b[0];\n  out[1] = ratioA * a[1] + ratioB * b[1];\n  out[2] = ratioA * a[2] + ratioB * b[2];\n  return out;\n}\n\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec3} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n    y = a[1],\n    z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q normalized quaternion to transform with\n * @returns {vec3} out\n */\nexport function transformQuat(out, a, q) {\n  // Fast Vector Rotation using Quaternions by Robert Eisele\n  // https://raw.org/proof/vector-rotation-using-quaternions/\n\n  var qx = q[0],\n    qy = q[1],\n    qz = q[2],\n    qw = q[3];\n  var vx = a[0],\n    vy = a[1],\n    vz = a[2];\n\n  // t = q x v\n  var tx = qy * vz - qz * vy;\n  var ty = qz * vx - qx * vz;\n  var tz = qx * vy - qy * vx;\n\n  // t = 2t\n  tx = tx + tx;\n  ty = ty + ty;\n  tz = tz + tz;\n\n  // v + w t + q x t\n  out[0] = vx + qw * tx + qy * tz - qz * ty;\n  out[1] = vy + qw * ty + qz * tx - qx * tz;\n  out[2] = vz + qw * tz + qx * ty - qy * tx;\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad);\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad);\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n    r = [];\n  //Translate point to the origin\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2];\n\n  //perform rotation\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2];\n\n  //translate to correct position\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    az = a[2],\n    bx = b[0],\n    by = b[1],\n    bz = b[2],\n    mag = Math.sqrt((ax * ax + ay * ay + az * az) * (bx * bx + by * by + bz * bz)),\n    cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1],\n    a2 = a[2];\n  var b0 = b[0],\n    b1 = b[1],\n    b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec3.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 3;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n    return a;\n  };\n}();","/**\n *  null  undefined\n * @return  null  undefined\n */\nexport default function isNil(value) {\n    return value === null || value === undefined;\n}\n//# sourceMappingURL=is-nil.js.map","import * as glMatrix from \"./common.js\";\n\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n\n/**\n * symmetric round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\nexport function round(out, a) {\n  out[0] = glMatrix.round(a[0]);\n  out[1] = glMatrix.round(a[1]);\n  return out;\n}\n\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n    y = b[1] - a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n    y = b[1] - a[1];\n  return x * x + y * y;\n}\n\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\nexport function length(a) {\n  var x = a[0],\n    y = a[1];\n  return Math.sqrt(x * x + y * y);\n}\n\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\nexport function squaredLength(a) {\n  var x = a[0],\n    y = a[1];\n  return x * x + y * y;\n}\n\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\nexport function normalize(out, a) {\n  var x = a[0],\n    y = a[1];\n  var len = x * x + y * y;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n    ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n * @returns {vec2} out\n */\nexport function random(out, scale) {\n  scale = scale === undefined ? 1.0 : scale;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n    y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n    p1 = a[1] - b[1],\n    sinC = Math.sin(rad),\n    cosC = Math.cos(rad);\n\n  //perform rotation and translate to correct position\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n\n/**\n * Get the smallest angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\nexport function angle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    bx = b[0],\n    by = b[1];\n  return Math.abs(Math.atan2(ay * bx - ax * by, ax * bx + ay * by));\n}\n\n/**\n * Get the signed angle in the interval [-pi,pi] between two 2D vectors (positive if `a` is to the right of `b`)\n * \n * @param {ReadonlyVec2} a The first vector\n * @param {ReadonlyVec2} b The second vector\n * @returns {number} The signed angle in radians\n */\nexport function signedAngle(a, b) {\n  var ax = a[0],\n    ay = a[1],\n    bx = b[0],\n    by = b[1];\n  return Math.atan2(ax * by - ay * bx, ax * bx + ay * by);\n}\n\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\nexport function equals(a, b) {\n  var a0 = a[0],\n    a1 = a[1];\n  var b0 = b[0],\n    b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n\n/**\n * Alias for {@link vec2.length}\n * @function\n */\nexport var len = length;\n\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\nexport var sub = subtract;\n\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\nexport var mul = multiply;\n\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\nexport var div = divide;\n\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\nexport var dist = distance;\n\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\nexport var sqrDist = squaredDistance;\n\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\nexport var sqrLen = squaredLength;\n\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n    if (!stride) {\n      stride = 2;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n    return a;\n  };\n}();","var clamp = function (a, min, max) {\n    if (a < min) {\n        return min;\n    }\n    else if (a > max) {\n        return max;\n    }\n    return a;\n};\nexport default clamp;\n//# sourceMappingURL=clamp.js.map","export function rotateVector(x, y, rad) {\n    var X = x * Math.cos(rad) - y * Math.sin(rad);\n    var Y = x * Math.sin(rad) + y * Math.cos(rad);\n    return { x: X, y: Y };\n}\n//# sourceMappingURL=rotate-vector.js.map","import { rotateVector } from '../util/rotate-vector';\n/**\n * Converts A (arc-to) segments to C (cubic-bezier-to).\n *\n * For more information of where this math came from visit:\n * http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n */\nexport function arcToCubic(X1, Y1, RX, RY, angle, LAF, SF, X2, Y2, recursive) {\n    var x1 = X1;\n    var y1 = Y1;\n    var rx = RX;\n    var ry = RY;\n    var x2 = X2;\n    var y2 = Y2;\n    // for more information of where this Math came from visit:\n    // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n    var d120 = (Math.PI * 120) / 180;\n    var rad = (Math.PI / 180) * (+angle || 0);\n    /** @type {number[]} */\n    var res = [];\n    var xy;\n    var f1;\n    var f2;\n    var cx;\n    var cy;\n    if (!recursive) {\n        xy = rotateVector(x1, y1, -rad);\n        x1 = xy.x;\n        y1 = xy.y;\n        xy = rotateVector(x2, y2, -rad);\n        x2 = xy.x;\n        y2 = xy.y;\n        var x = (x1 - x2) / 2;\n        var y = (y1 - y2) / 2;\n        var h = (x * x) / (rx * rx) + (y * y) / (ry * ry);\n        if (h > 1) {\n            h = Math.sqrt(h);\n            rx *= h;\n            ry *= h;\n        }\n        var rx2 = rx * rx;\n        var ry2 = ry * ry;\n        var k = (LAF === SF ? -1 : 1) *\n            Math.sqrt(Math.abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x)));\n        cx = (k * rx * y) / ry + (x1 + x2) / 2;\n        cy = (k * -ry * x) / rx + (y1 + y2) / 2;\n        // eslint-disable-next-line no-bitwise -- Impossible to satisfy no-bitwise\n        f1 = Math.asin(((((y1 - cy) / ry) * Math.pow(10, 9)) >> 0) / Math.pow(10, 9));\n        // eslint-disable-next-line no-bitwise -- Impossible to satisfy no-bitwise\n        f2 = Math.asin(((((y2 - cy) / ry) * Math.pow(10, 9)) >> 0) / Math.pow(10, 9));\n        f1 = x1 < cx ? Math.PI - f1 : f1;\n        f2 = x2 < cx ? Math.PI - f2 : f2;\n        if (f1 < 0)\n            f1 = Math.PI * 2 + f1;\n        if (f2 < 0)\n            f2 = Math.PI * 2 + f2;\n        if (SF && f1 > f2) {\n            f1 -= Math.PI * 2;\n        }\n        if (!SF && f2 > f1) {\n            f2 -= Math.PI * 2;\n        }\n    }\n    else {\n        f1 = recursive[0], f2 = recursive[1], cx = recursive[2], cy = recursive[3];\n    }\n    var df = f2 - f1;\n    if (Math.abs(df) > d120) {\n        var f2old = f2;\n        var x2old = x2;\n        var y2old = y2;\n        f2 = f1 + d120 * (SF && f2 > f1 ? 1 : -1);\n        x2 = cx + rx * Math.cos(f2);\n        y2 = cy + ry * Math.sin(f2);\n        res = arcToCubic(x2, y2, rx, ry, angle, 0, SF, x2old, y2old, [f2, f2old, cx, cy]);\n    }\n    df = f2 - f1;\n    var c1 = Math.cos(f1);\n    var s1 = Math.sin(f1);\n    var c2 = Math.cos(f2);\n    var s2 = Math.sin(f2);\n    var t = Math.tan(df / 4);\n    var hx = (4 / 3) * rx * t;\n    var hy = (4 / 3) * ry * t;\n    var m1 = [x1, y1];\n    var m2 = [x1 + hx * s1, y1 - hy * c1];\n    var m3 = [x2 + hx * s2, y2 - hy * c2];\n    var m4 = [x2, y2];\n    m2[0] = 2 * m1[0] - m2[0];\n    m2[1] = 2 * m1[1] - m2[1];\n    if (recursive) {\n        return m2.concat(m3, m4, res);\n        // return [...m2, ...m3, ...m4, ...res];\n    }\n    res = m2.concat(m3, m4, res);\n    // res = [...m2, ...m3, ...m4, ...res];\n    var newres = [];\n    for (var i = 0, ii = res.length; i < ii; i += 1) {\n        newres[i] = i % 2 ? rotateVector(res[i - 1], res[i], rad).y : rotateVector(res[i], res[i + 1], rad).x;\n    }\n    return newres;\n}\n// const TAU = Math.PI * 2;\n// const mapToEllipse = (\n//   { x, y }: { x: number; y: number },\n//   rx: number,\n//   ry: number,\n//   cosphi: number,\n//   sinphi: number,\n//   centerx: number,\n//   centery: number,\n// ) => {\n//   x *= rx;\n//   y *= ry;\n//   const xp = cosphi * x - sinphi * y;\n//   const yp = sinphi * x + cosphi * y;\n//   return {\n//     x: xp + centerx,\n//     y: yp + centery,\n//   };\n// };\n// const approxUnitArc = (ang1: number, ang2: number) => {\n//   // If 90 degree circular arc, use a constant\n//   // as derived from http://spencermortensen.com/articles/bezier-circle\n//   const a =\n//     ang2 === 1.5707963267948966\n//       ? 0.551915024494\n//       : ang2 === -1.5707963267948966\n//       ? -0.551915024494\n//       : (4 / 3) * Math.tan(ang2 / 4);\n//   const x1 = Math.cos(ang1);\n//   const y1 = Math.sin(ang1);\n//   const x2 = Math.cos(ang1 + ang2);\n//   const y2 = Math.sin(ang1 + ang2);\n//   return [\n//     {\n//       x: x1 - y1 * a,\n//       y: y1 + x1 * a,\n//     },\n//     {\n//       x: x2 + y2 * a,\n//       y: y2 - x2 * a,\n//     },\n//     {\n//       x: x2,\n//       y: y2,\n//     },\n//   ];\n// };\n// const vectorAngle = (ux: number, uy: number, vx: number, vy: number) => {\n//   const sign = ux * vy - uy * vx < 0 ? -1 : 1;\n//   let dot = ux * vx + uy * vy;\n//   if (dot > 1) {\n//     dot = 1;\n//   }\n//   if (dot < -1) {\n//     dot = -1;\n//   }\n//   return sign * Math.acos(dot);\n// };\n// const getArcCenter = (\n//   px: any,\n//   py: any,\n//   cx: any,\n//   cy: any,\n//   rx: number,\n//   ry: number,\n//   largeArcFlag: number,\n//   sweepFlag: number,\n//   sinphi: number,\n//   cosphi: number,\n//   pxp: number,\n//   pyp: number,\n// ) => {\n//   const rxsq = Math.pow(rx, 2);\n//   const rysq = Math.pow(ry, 2);\n//   const pxpsq = Math.pow(pxp, 2);\n//   const pypsq = Math.pow(pyp, 2);\n//   let radicant = rxsq * rysq - rxsq * pypsq - rysq * pxpsq;\n//   if (radicant < 0) {\n//     radicant = 0;\n//   }\n//   radicant /= rxsq * pypsq + rysq * pxpsq;\n//   radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n//   const centerxp = ((radicant * rx) / ry) * pyp;\n//   const centeryp = ((radicant * -ry) / rx) * pxp;\n//   const centerx = cosphi * centerxp - sinphi * centeryp + (px + cx) / 2;\n//   const centery = sinphi * centerxp + cosphi * centeryp + (py + cy) / 2;\n//   const vx1 = (pxp - centerxp) / rx;\n//   const vy1 = (pyp - centeryp) / ry;\n//   const vx2 = (-pxp - centerxp) / rx;\n//   const vy2 = (-pyp - centeryp) / ry;\n//   const ang1 = vectorAngle(1, 0, vx1, vy1);\n//   let ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n//   if (sweepFlag === 0 && ang2 > 0) {\n//     ang2 -= TAU;\n//   }\n//   if (sweepFlag === 1 && ang2 < 0) {\n//     ang2 += TAU;\n//   }\n//   return [centerx, centery, ang1, ang2];\n// };\n// const arcToBezier = ({ px, py, cx, cy, rx, ry, xAxisRotation = 0, largeArcFlag = 0, sweepFlag = 0 }) => {\n//   const curves = [];\n//   if (rx === 0 || ry === 0) {\n//     return [{ x1: 0, y1: 0, x2: 0, y2: 0, x: cx, y: cy }];\n//   }\n//   const sinphi = Math.sin((xAxisRotation * TAU) / 360);\n//   const cosphi = Math.cos((xAxisRotation * TAU) / 360);\n//   const pxp = (cosphi * (px - cx)) / 2 + (sinphi * (py - cy)) / 2;\n//   const pyp = (-sinphi * (px - cx)) / 2 + (cosphi * (py - cy)) / 2;\n//   if (pxp === 0 && pyp === 0) {\n//     return [{ x1: 0, y1: 0, x2: 0, y2: 0, x: cx, y: cy }];\n//   }\n//   rx = Math.abs(rx);\n//   ry = Math.abs(ry);\n//   const lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n//   if (lambda > 1) {\n//     rx *= Math.sqrt(lambda);\n//     ry *= Math.sqrt(lambda);\n//   }\n//   let [centerx, centery, ang1, ang2] = getArcCenter(\n//     px,\n//     py,\n//     cx,\n//     cy,\n//     rx,\n//     ry,\n//     largeArcFlag,\n//     sweepFlag,\n//     sinphi,\n//     cosphi,\n//     pxp,\n//     pyp,\n//   );\n//   // If 'ang2' == 90.0000000001, then `ratio` will evaluate to\n//   // 1.0000000001. This causes `segments` to be greater than one, which is an\n//   // unecessary split, and adds extra points to the bezier curve. To alleviate\n//   // this issue, we round to 1.0 when the ratio is close to 1.0.\n//   let ratio = Math.abs(ang2) / (TAU / 4);\n//   if (Math.abs(1.0 - ratio) < 0.0000001) {\n//     ratio = 1.0;\n//   }\n//   const segments = Math.max(Math.ceil(ratio), 1);\n//   ang2 /= segments;\n//   for (let i = 0; i < segments; i++) {\n//     curves.push(approxUnitArc(ang1, ang2));\n//     ang1 += ang2;\n//   }\n//   return curves.map((curve) => {\n//     const { x: x1, y: y1 } = mapToEllipse(curve[0], rx, ry, cosphi, sinphi, centerx, centery);\n//     const { x: x2, y: y2 } = mapToEllipse(curve[1], rx, ry, cosphi, sinphi, centerx, centery);\n//     const { x, y } = mapToEllipse(curve[2], rx, ry, cosphi, sinphi, centerx, centery);\n//     return { x1, y1, x2, y2, x, y };\n//   });\n// };\n// export function arcToCubic(\n//   x1: number,\n//   y1: number,\n//   rx: number,\n//   ry: number,\n//   angle: number,\n//   LAF: number,\n//   SF: number,\n//   x2: number,\n//   y2: number,\n// ) {\n//   const curves = arcToBezier({\n//     px: x1,\n//     py: y1,\n//     cx: x2,\n//     cy: y2,\n//     rx,\n//     ry,\n//     xAxisRotation: angle,\n//     largeArcFlag: LAF,\n//     sweepFlag: SF,\n//   });\n//   return curves.reduce((prev, cur) => {\n//     const { x1, y1, x2, y2, x, y } = cur;\n//     prev.push(x1, y1, x2, y2, x, y);\n//     return prev;\n//   }, [] as number[]);\n// }\n//# sourceMappingURL=arc-2-cubic.js.map","import type {\n  DisplayObject,\n  RenderingPlugin,\n  RenderingPluginContext,\n  ContextService,\n  CanvasContext,\n  GlobalRuntime,\n  ParsedBaseStyleProps,\n  CSSRGB,\n} from '@antv/g-lite';\nimport { AABB, CanvasEvent, CustomEvent, Shape, Node } from '@antv/g-lite';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { isNil } from '@antv/util';\nimport type { CanvasRendererPluginOptions } from './interfaces';\nimport type { Plugin } from '.';\n\ninterface Rect {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\nexport interface RenderState {\n  restoreStack: DisplayObject[];\n  prevObject: DisplayObject;\n  currentContext: Map<keyof CanvasRenderingContext2D | 'lineDash', unknown>;\n}\n\n/**\n * support 2 modes in rendering:\n * * immediate\n * * delayed: render at the end of frame with dirty-rectangle\n */\nexport class CanvasRendererPlugin implements RenderingPlugin {\n  static tag = 'CanvasRenderer';\n\n  private context: Plugin['context'];\n\n  private pathGeneratorFactory: Plugin['context']['pathGeneratorFactory'];\n\n  constructor(\n    private canvasRendererPluginOptions: CanvasRendererPluginOptions, // private styleRendererFactory: Record<Shape, StyleRenderer>,\n  ) {}\n\n  private renderQueue: DisplayObject[] = [];\n\n  #renderState: RenderState = {\n    restoreStack: [],\n    prevObject: null,\n    currentContext: new Map(),\n  };\n\n  private clearFullScreenLastFrame = false;\n  private clearFullScreen = false;\n\n  /**\n   * view projection matrix\n   */\n  private vpMatrix = mat4.create();\n  private dprMatrix = mat4.create();\n  private tmpMat4 = mat4.create();\n  private vec3a = vec3.create();\n  private vec3b = vec3.create();\n  private vec3c = vec3.create();\n  private vec3d = vec3.create();\n\n  apply(context: RenderingPluginContext, runtime: GlobalRuntime) {\n    this.context = context as unknown as Plugin['context'];\n\n    const {\n      config,\n      camera,\n      renderingService,\n      renderingContext,\n      // @ts-ignore\n      pathGeneratorFactory,\n    } = this.context;\n    let enableRenderingOptimization =\n      config.renderer.getConfig().enableRenderingOptimization;\n\n    config.renderer.getConfig().enableDirtyCheck = false;\n    config.renderer.getConfig().enableDirtyRectangleRendering = false;\n\n    this.pathGeneratorFactory = pathGeneratorFactory;\n\n    const contextService =\n      context.contextService as ContextService<CanvasRenderingContext2D>;\n\n    const canvas = renderingContext.root.ownerDocument.defaultView;\n\n    renderingService.hooks.init.tap(CanvasRendererPlugin.tag, () => {\n      // clear fullscreen\n      const dpr = contextService.getDPR();\n      const { width, height } = config;\n      const context = contextService.getContext();\n      this.clearRect(\n        context,\n        0,\n        0,\n        width * dpr,\n        height * dpr,\n        config.background,\n      );\n    });\n\n    renderingService.hooks.destroy.tap(CanvasRendererPlugin.tag, () => {\n      this.renderQueue = [];\n      this.#renderState = {\n        restoreStack: [],\n        prevObject: null,\n        currentContext: null,\n      };\n    });\n\n    const beforeDraw = () => {\n      const context = contextService.getContext();\n      const dpr = contextService.getDPR();\n      const { width, height } = config;\n      const { dirtyObjectNumThreshold, dirtyObjectRatioThreshold } =\n        this.canvasRendererPluginOptions;\n\n      // some heuristic conditions such as 80% object changed\n      const { total, rendered } = renderingService.getStats();\n      const ratio = rendered / total;\n\n      this.clearFullScreen =\n        this.clearFullScreenLastFrame ||\n        // @ts-ignore\n        !canvas.context.renderingPlugins[1]?.isFirstTimeRenderingFinished ||\n        renderingService.disableDirtyRectangleRendering() ||\n        (rendered > dirtyObjectNumThreshold &&\n          ratio > dirtyObjectRatioThreshold);\n\n      if (!context) {\n        return;\n      }\n\n      if (typeof context.resetTransform === 'function') {\n        context.resetTransform();\n      } else {\n        context.setTransform(1, 0, 0, 1, 0, 0);\n      }\n\n      if (this.clearFullScreen) {\n        this.clearRect(\n          context,\n          0,\n          0,\n          width * dpr,\n          height * dpr,\n          config.background,\n        );\n      }\n    };\n\n    /**\n     * render objects by z-index\n     *\n     * - The level of the child node will be affected by the level of the parent node\n     */\n    const renderByZIndex = (\n      object: DisplayObject,\n      context: CanvasRenderingContext2D,\n    ) => {\n      const stack = [object];\n\n      while (stack.length > 0) {\n        const currentObject = stack.pop();\n\n        if (currentObject.isVisible() && !currentObject.isCulled()) {\n          if (enableRenderingOptimization) {\n            this.renderDisplayObjectOptimized(\n              currentObject,\n              context,\n              this.context,\n              this.#renderState,\n              runtime,\n            );\n          } else {\n            this.renderDisplayObject(\n              currentObject,\n              context,\n              this.context,\n              this.#renderState,\n              runtime,\n            );\n          }\n        }\n\n        const objects =\n          currentObject.sortable?.sorted?.length > 0\n            ? currentObject.sortable.sorted\n            : currentObject.childNodes;\n        // should account for z-index\n        for (let i = objects.length - 1; i >= 0; i--) {\n          stack.push(objects[i] as unknown as DisplayObject);\n        }\n      }\n    };\n\n    // render at the end of frame\n    renderingService.hooks.endFrame.tap(CanvasRendererPlugin.tag, () => {\n      beforeDraw();\n\n      // Skip rendering.\n      if (renderingContext.root.childNodes.length === 0) {\n        this.clearFullScreenLastFrame = true;\n        return;\n      }\n\n      enableRenderingOptimization =\n        config.renderer.getConfig().enableRenderingOptimization;\n\n      // init\n      this.#renderState = {\n        restoreStack: [],\n        prevObject: null,\n        currentContext: this.#renderState.currentContext,\n      };\n      this.#renderState.currentContext.clear();\n      this.clearFullScreenLastFrame = false;\n\n      const context = contextService.getContext();\n      // clear & clip dirty rectangle\n      const dpr = contextService.getDPR();\n      mat4.fromScaling(this.dprMatrix, [dpr, dpr, 1]);\n      mat4.multiply(this.vpMatrix, this.dprMatrix, camera.getOrthoMatrix());\n\n      if (this.clearFullScreen) {\n        // console.time('renderByZIndex');\n        if (enableRenderingOptimization) {\n          context.save();\n          renderByZIndex(renderingContext.root, context);\n          context.restore();\n        } else {\n          renderByZIndex(renderingContext.root, context);\n        }\n        // console.timeEnd('renderByZIndex');\n      } else {\n        // console.log('canvas renderer next...', this.renderQueue);\n        // merge removed AABB\n        const dirtyRenderBounds = this.safeMergeAABB(\n          this.mergeDirtyAABBs(this.renderQueue),\n        );\n\n        if (AABB.isEmpty(dirtyRenderBounds)) {\n          this.renderQueue = [];\n          return;\n        }\n\n        const dirtyRect = this.convertAABB2Rect(dirtyRenderBounds);\n        const { x, y, width, height } = dirtyRect;\n\n        const tl = vec3.transformMat4(this.vec3a, [x, y, 0], this.vpMatrix);\n        const tr = vec3.transformMat4(\n          this.vec3b,\n          [x + width, y, 0],\n          this.vpMatrix,\n        );\n        const bl = vec3.transformMat4(\n          this.vec3c,\n          [x, y + height, 0],\n          this.vpMatrix,\n        );\n        const br = vec3.transformMat4(\n          this.vec3d,\n          [x + width, y + height, 0],\n          this.vpMatrix,\n        );\n\n        const minx = Math.min(tl[0], tr[0], br[0], bl[0]);\n        const miny = Math.min(tl[1], tr[1], br[1], bl[1]);\n        const maxx = Math.max(tl[0], tr[0], br[0], bl[0]);\n        const maxy = Math.max(tl[1], tr[1], br[1], bl[1]);\n\n        const ix = Math.floor(minx);\n        const iy = Math.floor(miny);\n        const iwidth = Math.ceil(maxx - minx);\n        const iheight = Math.ceil(maxy - miny);\n\n        context.save();\n        this.clearRect(context, ix, iy, iwidth, iheight, config.background);\n        context.beginPath();\n        context.rect(ix, iy, iwidth, iheight);\n        context.clip();\n\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n        context.setTransform(\n          this.vpMatrix[0],\n          this.vpMatrix[1],\n          this.vpMatrix[4],\n          this.vpMatrix[5],\n          this.vpMatrix[12],\n          this.vpMatrix[13],\n        );\n\n        // draw dirty rectangle\n        const { enableDirtyRectangleRenderingDebug } =\n          config.renderer.getConfig();\n        if (enableDirtyRectangleRenderingDebug) {\n          canvas.dispatchEvent(\n            new CustomEvent(CanvasEvent.DIRTY_RECTANGLE, {\n              dirtyRect: {\n                x: ix,\n                y: iy,\n                width: iwidth,\n                height: iheight,\n              },\n            }),\n          );\n        }\n\n        // search objects intersect with dirty rectangle\n        const [minX, minY] = dirtyRenderBounds.getMin();\n        const [maxX, maxY] = dirtyRenderBounds.getMax();\n        const dirtyObjects =\n          renderingContext.root.ownerDocument.elementsFromBBox(\n            minX,\n            minY,\n            maxX,\n            maxY,\n          );\n\n        // do rendering\n        dirtyObjects\n          // sort by z-index\n          .sort((a, b) => a.sortable.renderOrder - b.sortable.renderOrder)\n          .forEach((object) => {\n            // culled object should not be rendered\n            if (object && object.isVisible() && !object.isCulled()) {\n              this.renderDisplayObject(\n                object,\n                context,\n                this.context,\n                this.#renderState,\n                runtime,\n              );\n            }\n          });\n\n        context.restore();\n\n        // save dirty AABBs in last frame\n        this.renderQueue.forEach((object) => {\n          this.saveDirtyAABB(object);\n        });\n\n        // clear queue\n        this.renderQueue = [];\n      }\n\n      // pop restore stack, eg. root -> parent -> child\n      this.#renderState.restoreStack.forEach(() => {\n        context.restore();\n      });\n      // clear restore stack\n      this.#renderState.restoreStack = [];\n    });\n\n    renderingService.hooks.render.tap(\n      CanvasRendererPlugin.tag,\n      (object: DisplayObject) => {\n        if (!this.clearFullScreen) {\n          // render at the end of frame\n          this.renderQueue.push(object);\n        }\n      },\n    );\n  }\n\n  private clearRect(\n    context: CanvasRenderingContext2D,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n    background: string,\n  ) {\n    // clearRect is faster than fillRect @see https://stackoverflow.com/a/30830253\n    context.clearRect(x, y, width, height);\n    if (background) {\n      context.fillStyle = background;\n      context.fillRect(x, y, width, height);\n    }\n  }\n\n  renderDisplayObjectOptimized(\n    object: DisplayObject,\n    context: CanvasRenderingContext2D,\n    canvasContext: CanvasContext,\n    renderState: RenderState,\n    runtime: GlobalRuntime,\n  ) {\n    const nodeName = object.nodeName as Shape;\n    let updateTransform = false;\n    let clipDraw = false;\n\n    // @ts-ignore\n    const styleRenderer = this.context.styleRendererFactory[nodeName];\n    const generatePath = this.pathGeneratorFactory[nodeName];\n\n    // clip path\n    const { clipPath } = object.parsedStyle;\n    if (clipPath) {\n      updateTransform =\n        !renderState.prevObject ||\n        !mat4.exactEquals(\n          clipPath.getWorldTransform(),\n          renderState.prevObject.getWorldTransform(),\n        );\n\n      if (updateTransform) {\n        this.applyWorldTransform(context, clipPath);\n        renderState.prevObject = null;\n      }\n\n      // generate path in local space\n      const generatePath =\n        this.pathGeneratorFactory[clipPath.nodeName as Shape];\n      if (generatePath) {\n        context.save();\n        clipDraw = true;\n\n        context.beginPath();\n        generatePath(context, clipPath.parsedStyle);\n        context.closePath();\n        context.clip();\n      }\n    }\n\n    // fill & stroke\n\n    if (styleRenderer) {\n      updateTransform =\n        !renderState.prevObject ||\n        !mat4.exactEquals(\n          object.getWorldTransform(),\n          renderState.prevObject.getWorldTransform(),\n        );\n\n      if (updateTransform) {\n        this.applyWorldTransform(context, object);\n      }\n\n      let forceUpdateStyle = !renderState.prevObject;\n      if (!forceUpdateStyle) {\n        const prevNodeName = renderState.prevObject.nodeName as Shape;\n\n        if (nodeName === Shape.TEXT) {\n          forceUpdateStyle = prevNodeName !== Shape.TEXT;\n        } else if (nodeName === Shape.IMAGE) {\n          forceUpdateStyle = prevNodeName !== Shape.IMAGE;\n        } else {\n          forceUpdateStyle =\n            prevNodeName === Shape.TEXT || prevNodeName === Shape.IMAGE;\n        }\n      }\n\n      styleRenderer.applyStyleToContext(\n        context,\n        object,\n        forceUpdateStyle,\n        renderState,\n      );\n\n      renderState.prevObject = object;\n    }\n\n    if (generatePath) {\n      context.beginPath();\n      generatePath(context, object.parsedStyle);\n      if (\n        nodeName !== Shape.LINE &&\n        nodeName !== Shape.PATH &&\n        nodeName !== Shape.POLYLINE\n      ) {\n        context.closePath();\n      }\n    }\n\n    // fill & stroke\n    if (styleRenderer) {\n      styleRenderer.drawToContext(\n        context,\n        object,\n        this.#renderState,\n        this,\n        runtime,\n      );\n    }\n\n    if (clipDraw) {\n      context.restore();\n    }\n\n    // finish rendering, clear dirty flag\n    object.dirty(false);\n  }\n\n  renderDisplayObject(\n    object: DisplayObject,\n    context: CanvasRenderingContext2D,\n    canvasContext: CanvasContext,\n    renderState: RenderState,\n    runtime: GlobalRuntime,\n  ) {\n    const nodeName = object.nodeName as Shape;\n\n    // restore to its ancestor\n\n    const parent =\n      renderState.restoreStack[renderState.restoreStack.length - 1];\n    if (\n      parent &&\n      !(\n        object.compareDocumentPosition(parent) & Node.DOCUMENT_POSITION_CONTAINS\n      )\n    ) {\n      context.restore();\n      renderState.restoreStack.pop();\n    }\n\n    // @ts-ignore\n    const styleRenderer = this.context.styleRendererFactory[nodeName];\n    const generatePath = this.pathGeneratorFactory[nodeName];\n\n    // clip path\n    const { clipPath } = object.parsedStyle;\n    if (clipPath) {\n      this.applyWorldTransform(context, clipPath);\n\n      // generate path in local space\n      const generatePath =\n        this.pathGeneratorFactory[clipPath.nodeName as Shape];\n      if (generatePath) {\n        context.save();\n\n        // save clip\n        renderState.restoreStack.push(object);\n\n        context.beginPath();\n        generatePath(context, clipPath.parsedStyle);\n        context.closePath();\n        context.clip();\n      }\n    }\n\n    // fill & stroke\n\n    if (styleRenderer) {\n      this.applyWorldTransform(context, object);\n\n      context.save();\n\n      // apply attributes to context\n      this.applyAttributesToContext(context, object);\n    }\n\n    if (generatePath) {\n      context.beginPath();\n      generatePath(context, object.parsedStyle);\n      if (\n        nodeName !== Shape.LINE &&\n        nodeName !== Shape.PATH &&\n        nodeName !== Shape.POLYLINE\n      ) {\n        context.closePath();\n      }\n    }\n\n    // fill & stroke\n    if (styleRenderer) {\n      styleRenderer.render(\n        context,\n        object.parsedStyle,\n        object,\n        canvasContext,\n        this,\n        runtime,\n      );\n\n      // restore applied attributes, eg. shadowBlur shadowColor...\n      context.restore();\n    }\n\n    // finish rendering, clear dirty flag\n    object.dirty(false);\n  }\n\n  private applyAttributesToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n  ) {\n    const { stroke, fill, opacity, lineDash, lineDashOffset } =\n      object.parsedStyle as ParsedBaseStyleProps;\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setLineDash\n    if (lineDash) {\n      context.setLineDash(lineDash);\n    }\n\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineDashOffset\n    if (!isNil(lineDashOffset)) {\n      context.lineDashOffset = lineDashOffset;\n    }\n\n    if (!isNil(opacity)) {\n      context.globalAlpha *= opacity;\n    }\n\n    if (\n      !isNil(stroke) &&\n      !Array.isArray(stroke) &&\n      !(stroke as CSSRGB).isNone\n    ) {\n      context.strokeStyle = object.attributes.stroke as string;\n    }\n\n    if (!isNil(fill) && !Array.isArray(fill) && !(fill as CSSRGB).isNone) {\n      context.fillStyle = object.attributes.fill as string;\n    }\n  }\n\n  private convertAABB2Rect(aabb: AABB): Rect {\n    const min = aabb.getMin();\n    const max = aabb.getMax();\n    // expand the rectangle a bit to avoid artifacts\n    // @see https://www.yuque.com/antv/ou292n/bi8nix#ExvCu\n    const minX = Math.floor(min[0]);\n    const minY = Math.floor(min[1]);\n    const maxX = Math.ceil(max[0]);\n    const maxY = Math.ceil(max[1]);\n    const width = maxX - minX;\n    const height = maxY - minY;\n\n    return { x: minX, y: minY, width, height };\n  }\n\n  /**\n   * TODO: merge dirty rectangles with some strategies.\n   * For now, we just simply merge all the rectangles into one.\n   * @see https://idom.me/articles/841.html\n   */\n  private mergeDirtyAABBs(dirtyObjects: DisplayObject[]): AABB {\n    // merge into a big AABB\n    // TODO: skip descendant if ancestor is caculated, but compareNodePosition is really slow\n    const aabb = new AABB();\n    dirtyObjects.forEach((object) => {\n      const renderBounds = object.getRenderBounds();\n      aabb.add(renderBounds);\n\n      const { dirtyRenderBounds } = object.renderable;\n      if (dirtyRenderBounds) {\n        aabb.add(dirtyRenderBounds);\n      }\n    });\n\n    return aabb;\n  }\n\n  private saveDirtyAABB(object: DisplayObject) {\n    const { renderable } = object;\n    if (!renderable.dirtyRenderBounds) {\n      renderable.dirtyRenderBounds = new AABB();\n    }\n    const renderBounds = object.getRenderBounds();\n    if (renderBounds) {\n      // save last dirty aabb\n      renderable.dirtyRenderBounds.update(\n        renderBounds.center,\n        renderBounds.halfExtents,\n      );\n    }\n  }\n\n  private applyWorldTransform(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    matrix?: mat4,\n  ) {\n    // apply clip shape's RTS\n    if (matrix) {\n      mat4.copy(this.tmpMat4, object.getLocalTransform());\n      mat4.multiply(this.tmpMat4, matrix, this.tmpMat4);\n      mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n    } else {\n      // apply RTS transformation in world space\n      mat4.copy(this.tmpMat4, object.getWorldTransform());\n      mat4.multiply(this.tmpMat4, this.vpMatrix, this.tmpMat4);\n    }\n\n    // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n    context.setTransform(\n      this.tmpMat4[0],\n      this.tmpMat4[1],\n      this.tmpMat4[4],\n      this.tmpMat4[5],\n      this.tmpMat4[12],\n      this.tmpMat4[13],\n    );\n  }\n\n  private safeMergeAABB(...aabbs: AABB[]): AABB {\n    const merged = new AABB();\n    aabbs.forEach((aabb) => {\n      merged.add(aabb);\n    });\n    return merged;\n  }\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  DisplayObject,\n  GlobalRuntime,\n  LinearGradient,\n  Pattern,\n  RadialGradient,\n  Rect,\n  GradientType,\n  ImagePool,\n} from '@antv/g-lite';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\n\nexport function getPattern(\n  pattern: Pattern,\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n): CanvasPattern {\n  let $offscreenCanvas: HTMLCanvasElement;\n  let dpr: number;\n  if ((pattern.image as Rect).nodeName === 'rect') {\n    const { width, height } = (pattern.image as Rect).parsedStyle;\n    dpr = canvasContext.contextService.getDPR();\n    const { offscreenCanvas } = canvasContext.config;\n    $offscreenCanvas = runtime.offscreenCanvasCreator.getOrCreateCanvas(\n      offscreenCanvas,\n    ) as HTMLCanvasElement;\n\n    $offscreenCanvas.width = width * dpr;\n    $offscreenCanvas.height = height * dpr;\n\n    const offscreenCanvasContext =\n      runtime.offscreenCanvasCreator.getOrCreateContext(\n        offscreenCanvas,\n      ) as CanvasRenderingContext2D;\n\n    const renderState: RenderState = {\n      restoreStack: [],\n      prevObject: null,\n      currentContext: new Map(),\n    };\n\n    // offscreenCanvasContext.scale(1 / dpr, 1 / dpr);\n\n    (pattern.image as Rect).forEach((object: DisplayObject) => {\n      plugin.renderDisplayObject(\n        object,\n        offscreenCanvasContext,\n        canvasContext,\n        renderState,\n        runtime,\n      );\n    });\n\n    renderState.restoreStack.forEach(() => {\n      offscreenCanvasContext.restore();\n    });\n  }\n\n  const canvasPattern = imagePool.getOrCreatePatternSync(\n    object,\n    pattern,\n    context,\n    $offscreenCanvas,\n    dpr,\n    object.getGeometryBounds().min,\n    () => {\n      // set dirty rectangle flag\n      object.dirty();\n      canvasContext.renderingService.dirty();\n    },\n  );\n\n  return canvasPattern;\n}\n\nexport function getColor(\n  parsedColor: CSSGradientValue,\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  imagePool: ImagePool,\n) {\n  let color: CanvasGradient | string;\n\n  if (\n    parsedColor.type === GradientType.LinearGradient ||\n    parsedColor.type === GradientType.RadialGradient\n  ) {\n    const bounds = object.getGeometryBounds();\n    const width = (bounds && bounds.halfExtents[0] * 2) || 1;\n    const height = (bounds && bounds.halfExtents[1] * 2) || 1;\n    const min = (bounds && bounds.min) || [0, 0];\n    color = imagePool.getOrCreateGradient(\n      {\n        type: parsedColor.type,\n        ...(parsedColor.value as LinearGradient & RadialGradient),\n        min: min as [number, number],\n        width,\n        height,\n      },\n      context,\n    );\n  }\n\n  return color;\n}\n","import {\n  CanvasContext,\n  CSSRGB,\n  DisplayObject,\n  GlobalRuntime,\n  ParsedBaseStyleProps,\n  isPattern,\n  Shape,\n  type ImagePool,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\nimport type { StyleRenderer } from './interfaces';\nimport { getColor, getPattern } from './helper';\n\nconst SHADOW_NUMBER_STYLE = [\n  'shadowBlur',\n  'shadowOffsetX',\n  'shadowOffsetY',\n] as const;\nconst STROKE_STYLE = ['lineCap', 'lineJoin', 'miterLimit'] as const;\nexport const DEFAULT_STYLE = {\n  // common\n  globalAlpha: 1,\n  shadowBlur: 0,\n  shadowOffsetX: 0,\n  shadowOffsetY: 0,\n  shadowColor: '#000',\n  filter: 'none' as const,\n  globalCompositeOperation: 'source-over' as const,\n\n  // stroke/fill\n  strokeStyle: '#000',\n  strokeOpacity: 1,\n  lineWidth: 1,\n  lineDash: [],\n  lineDashOffset: 0,\n  lineCap: 'butt' as const,\n  lineJoin: 'miter' as const,\n  miterLimit: 10,\n  fillStyle: '#000',\n  fillOpacity: 1,\n\n  // image\n};\n\nconst defaultParsedStyle = {} as ParsedBaseStyleProps;\n\n/**\n * Updating the canvas context is an expensive operation. The state of the context is cached and the actual update operation is performed only when the cache is not hit.\n *\n * In any case, the previous value is returned, which is convenient for temporarily updating the context and restoring it later.\n */\nfunction updateContextIfNotHitCache<\n  K extends keyof CanvasRenderingContext2D | 'lineDash',\n  V = unknown,\n>(context: CanvasRenderingContext2D, key: K, value: V, cache: Map<K, unknown>) {\n  const prevValue = (\n    cache.has(key)\n      ? cache.get(key)\n      : DEFAULT_STYLE[key as keyof typeof DEFAULT_STYLE]\n  ) as V;\n\n  if (prevValue !== value) {\n    // console.log('not hit cache', key, value, prevValue, cache);\n    if (key === 'lineDash') {\n      context.setLineDash(value as number[]);\n    } else {\n      // @ts-ignore\n      context[key] = value;\n    }\n    cache.set(key, value);\n  }\n\n  return prevValue;\n}\n\nexport class OptimizedDefaultRenderer implements StyleRenderer {\n  constructor(public imagePool: ImagePool) {}\n\n  applyAttributesToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n  ) {}\n\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedBaseStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {}\n\n  // #region common style\n  private applyCommonStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    forceUpdate: boolean,\n    renderState: RenderState,\n  ) {\n    // const dpr = object.ownerDocument.defaultView.getContextService().getDPR();\n    const prevStyle = forceUpdate\n      ? defaultParsedStyle\n      : renderState.prevObject.parsedStyle;\n    const style = object.parsedStyle;\n\n    if (forceUpdate || style.opacity !== prevStyle.opacity) {\n      updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        !isNil(style.opacity) ? style.opacity : DEFAULT_STYLE.globalAlpha,\n        renderState.currentContext,\n      );\n    }\n\n    // TODO blend prop\n    // @ts-ignore\n    if (forceUpdate || style.blend !== prevStyle.blend) {\n      updateContextIfNotHitCache(\n        context,\n        'globalCompositeOperation',\n        // @ts-ignore\n        !isNil(style.blend)\n          ? // @ts-ignore\n            style.blend\n          : DEFAULT_STYLE.globalCompositeOperation,\n        renderState.currentContext,\n      );\n    }\n  }\n  // #endregion common style\n\n  // #region stroke/fill style\n  private applyStrokeFillStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    forceUpdate: boolean,\n    renderState: RenderState,\n  ) {\n    const prevStyle = forceUpdate\n      ? defaultParsedStyle\n      : renderState.prevObject.parsedStyle;\n    const style = object.parsedStyle;\n    const { lineWidth = DEFAULT_STYLE.lineWidth } = style;\n    const hasFill = style.fill && !(style.fill as CSSRGB).isNone;\n    const hasStroke =\n      style.stroke && !(style.stroke as CSSRGB).isNone && lineWidth > 0;\n\n    if (hasStroke) {\n      if (\n        forceUpdate ||\n        object.attributes.stroke !== renderState.prevObject.attributes.stroke\n      ) {\n        const value =\n          !isNil(style.stroke) &&\n          !Array.isArray(style.stroke) &&\n          !(style.stroke as CSSRGB).isNone\n            ? object.attributes.stroke\n            : DEFAULT_STYLE.strokeStyle;\n\n        updateContextIfNotHitCache(\n          context,\n          'strokeStyle',\n          value,\n          renderState.currentContext,\n        );\n      }\n\n      if (forceUpdate || style.lineWidth !== prevStyle.lineWidth) {\n        updateContextIfNotHitCache(\n          context,\n          'lineWidth',\n          !isNil(style.lineWidth) ? style.lineWidth : DEFAULT_STYLE.lineWidth,\n          renderState.currentContext,\n        );\n      }\n\n      if (forceUpdate || style.lineDash !== prevStyle.lineDash) {\n        updateContextIfNotHitCache(\n          context,\n          'lineDash',\n          style.lineDash || DEFAULT_STYLE.lineDash,\n          renderState.currentContext,\n        );\n      }\n\n      if (forceUpdate || style.lineDashOffset !== prevStyle.lineDashOffset) {\n        updateContextIfNotHitCache(\n          context,\n          'lineDashOffset',\n          !isNil(style.lineDashOffset)\n            ? style.lineDashOffset\n            : DEFAULT_STYLE.lineDashOffset,\n          renderState.currentContext,\n        );\n      }\n\n      for (let i = 0; i < STROKE_STYLE.length; i++) {\n        const styleName = STROKE_STYLE[i];\n        if (forceUpdate || style[styleName] !== prevStyle[styleName]) {\n          updateContextIfNotHitCache(\n            context,\n            styleName,\n            !isNil(style[styleName])\n              ? style[styleName]\n              : DEFAULT_STYLE[styleName],\n            renderState.currentContext,\n          );\n        }\n      }\n    }\n\n    if (\n      hasFill &&\n      (forceUpdate ||\n        object.attributes.fill !== renderState.prevObject.attributes.fill)\n    ) {\n      const value =\n        !isNil(style.fill) &&\n        !Array.isArray(style.fill) &&\n        !(style.fill as CSSRGB).isNone\n          ? object.attributes.fill\n          : DEFAULT_STYLE.fillStyle;\n\n      updateContextIfNotHitCache(\n        context,\n        'fillStyle',\n        value,\n        renderState.currentContext,\n      );\n    }\n  }\n  // #endregion stroke/fill style\n\n  applyStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    forceUpdate: boolean,\n    renderState: RenderState,\n  ) {\n    const nodeName = object.nodeName as Shape;\n\n    this.applyCommonStyleToContext(context, object, forceUpdate, renderState);\n\n    if (nodeName === Shape.IMAGE) {\n      //\n    } else {\n      this.applyStrokeFillStyleToContext(\n        context,\n        object,\n        forceUpdate,\n        renderState,\n      );\n    }\n  }\n\n  applyShadowAndFilterStyleToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    hasShadow: boolean,\n    renderState: RenderState,\n  ) {\n    const style = object.parsedStyle;\n\n    if (hasShadow) {\n      updateContextIfNotHitCache(\n        context,\n        'shadowColor',\n        style.shadowColor.toString(),\n        renderState.currentContext,\n      );\n      for (let i = 0; i < SHADOW_NUMBER_STYLE.length; i++) {\n        const styleName = SHADOW_NUMBER_STYLE[i];\n        updateContextIfNotHitCache(\n          context,\n          styleName,\n          style[styleName] || DEFAULT_STYLE[styleName],\n          renderState.currentContext,\n        );\n      }\n    }\n\n    if (style.filter && style.filter.length) {\n      updateContextIfNotHitCache(\n        context,\n        'filter',\n        // use raw filter string\n        object.attributes.filter,\n        renderState.currentContext,\n      );\n    }\n  }\n\n  clearShadowAndFilterStyleForContext(\n    context: CanvasRenderingContext2D,\n    hasShadow: boolean,\n    hasFilter: boolean,\n    renderState: RenderState,\n    onlyClearShadowFilter = false,\n  ) {\n    if (hasShadow) {\n      updateContextIfNotHitCache(\n        context,\n        'shadowColor',\n        DEFAULT_STYLE.shadowColor,\n        renderState.currentContext,\n      );\n      for (let i = 0; i < SHADOW_NUMBER_STYLE.length; i++) {\n        const styleName = SHADOW_NUMBER_STYLE[i];\n        updateContextIfNotHitCache(\n          context,\n          styleName,\n          DEFAULT_STYLE[styleName],\n          renderState.currentContext,\n        );\n      }\n    }\n\n    if (hasFilter) {\n      if (hasShadow && onlyClearShadowFilter) {\n        // save drop-shadow filter\n        const oldFilter = context.filter;\n        if (!isNil(oldFilter) && oldFilter.indexOf('drop-shadow') > -1) {\n          updateContextIfNotHitCache(\n            context,\n            'filter',\n            oldFilter.replace(/drop-shadow\\([^)]*\\)/, '').trim() ||\n              DEFAULT_STYLE.filter,\n            renderState.currentContext,\n          );\n        }\n      } else {\n        updateContextIfNotHitCache(\n          context,\n          'filter',\n          DEFAULT_STYLE.filter,\n          renderState.currentContext,\n        );\n      }\n    }\n  }\n\n  fillToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const { fill, fillRule } = object.parsedStyle;\n    let resetStyle = null as unknown;\n\n    if (Array.isArray(fill) && fill.length > 0) {\n      fill.forEach((gradient) => {\n        const prevStyle = updateContextIfNotHitCache(\n          context,\n          'fillStyle',\n          getColor(gradient, object, context, this.imagePool),\n          renderState.currentContext,\n        );\n        resetStyle = resetStyle ?? prevStyle;\n\n        if (fillRule) {\n          context.fill(fillRule);\n        } else {\n          context.fill();\n        }\n      });\n    } else {\n      if (isPattern(fill)) {\n        const pattern = getPattern(\n          fill,\n          object,\n          context,\n          object.ownerDocument.defaultView.context,\n          plugin,\n          runtime,\n          this.imagePool,\n        );\n        if (pattern) {\n          context.fillStyle = pattern;\n          resetStyle = true;\n        }\n      }\n\n      if (fillRule) {\n        context.fill(fillRule);\n      } else {\n        context.fill();\n      }\n    }\n\n    if (resetStyle !== null) {\n      updateContextIfNotHitCache(\n        context,\n        'fillStyle',\n        resetStyle,\n        renderState.currentContext,\n      );\n    }\n  }\n\n  strokeToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const { stroke } = object.parsedStyle;\n    let resetStyle = null as unknown;\n\n    if (Array.isArray(stroke) && stroke.length > 0) {\n      stroke.forEach((gradient) => {\n        const prevStyle = updateContextIfNotHitCache(\n          context,\n          'strokeStyle',\n          getColor(gradient, object, context, this.imagePool),\n          renderState.currentContext,\n        );\n        resetStyle = resetStyle ?? prevStyle;\n\n        context.stroke();\n      });\n    } else {\n      if (isPattern(stroke)) {\n        const pattern = getPattern(\n          stroke,\n          object,\n          context,\n          object.ownerDocument.defaultView.context,\n          plugin,\n          runtime,\n          this.imagePool,\n        );\n        if (pattern) {\n          const prevStyle = updateContextIfNotHitCache(\n            context,\n            'strokeStyle',\n            pattern,\n            renderState.currentContext,\n          );\n          resetStyle = resetStyle ?? prevStyle;\n        }\n      }\n\n      context.stroke();\n    }\n\n    if (resetStyle !== null) {\n      updateContextIfNotHitCache(\n        context,\n        'strokeStyle',\n        resetStyle,\n        renderState.currentContext,\n      );\n    }\n  }\n\n  drawToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const nodeName = object.nodeName as Shape;\n    const style = object.parsedStyle;\n    const {\n      opacity = DEFAULT_STYLE.globalAlpha,\n      fillOpacity = DEFAULT_STYLE.fillOpacity,\n      strokeOpacity = DEFAULT_STYLE.strokeOpacity,\n      lineWidth = DEFAULT_STYLE.lineWidth,\n    } = style;\n\n    const hasFill = style.fill && !(style.fill as CSSRGB).isNone;\n    const hasStroke =\n      style.stroke && !(style.stroke as CSSRGB).isNone && lineWidth > 0;\n\n    if (!hasFill && !hasStroke) {\n      return;\n    }\n\n    const hasShadow = !isNil(style.shadowColor) && style.shadowBlur > 0;\n    const isInnerShadow = style.shadowType === 'inner';\n    const isFillTransparent = (style.fill as CSSRGB)?.alpha === 0;\n    const hasFilter = !!(style.filter && style.filter.length);\n    // Shadows can only be applied to fill() or stroke(), the default is fill()\n    const shouldDrawShadowWithStroke =\n      hasShadow &&\n      hasStroke &&\n      (nodeName === Shape.PATH ||\n        nodeName === Shape.LINE ||\n        nodeName === Shape.POLYLINE ||\n        isFillTransparent ||\n        isInnerShadow);\n\n    // TODO https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/paint-order\n\n    let originGlobalAlpha: number | null = null;\n\n    if (hasFill) {\n      if (!shouldDrawShadowWithStroke) {\n        this.applyShadowAndFilterStyleToContext(\n          context,\n          object,\n          hasShadow,\n          renderState,\n        );\n      }\n\n      const updateOpacity = opacity * fillOpacity;\n\n      originGlobalAlpha = updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        updateOpacity,\n        renderState.currentContext,\n      );\n\n      this.fillToContext(context, object, renderState, plugin, runtime);\n\n      if (!shouldDrawShadowWithStroke) {\n        this.clearShadowAndFilterStyleForContext(\n          context,\n          hasShadow,\n          hasFilter,\n          renderState,\n        );\n      }\n    }\n    if (hasStroke) {\n      let clearShadowAndFilter = false;\n      const updateOpacity = opacity * strokeOpacity;\n      const prevOpacity = updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        updateOpacity,\n        renderState.currentContext,\n      );\n      originGlobalAlpha = hasFill ? originGlobalAlpha : prevOpacity;\n\n      if (shouldDrawShadowWithStroke) {\n        this.applyShadowAndFilterStyleToContext(\n          context,\n          object,\n          hasShadow,\n          renderState,\n        );\n        clearShadowAndFilter = true;\n\n        if (isInnerShadow) {\n          const originBlend = context.globalCompositeOperation;\n          context.globalCompositeOperation = 'source-atop';\n\n          this.strokeToContext(context, object, renderState, plugin, runtime);\n\n          context.globalCompositeOperation = originBlend;\n          this.clearShadowAndFilterStyleForContext(\n            context,\n            hasShadow,\n            hasFilter,\n            renderState,\n            true,\n          );\n        }\n      }\n\n      this.strokeToContext(context, object, renderState, plugin, runtime);\n\n      if (clearShadowAndFilter) {\n        this.clearShadowAndFilterStyleForContext(\n          context,\n          hasShadow,\n          hasFilter,\n          renderState,\n        );\n      }\n    }\n\n    // clear\n    if (originGlobalAlpha !== null) {\n      updateContextIfNotHitCache(\n        context,\n        'globalAlpha',\n        originGlobalAlpha,\n        renderState.currentContext,\n      );\n    }\n  }\n}\n","import {\n  CanvasContext,\n  CSSGradientValue,\n  CSSRGB,\n  DisplayObject,\n  GlobalRuntime,\n  ParsedBaseStyleProps,\n  Pattern,\n  isPattern,\n  Shape,\n  ImagePool,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { CanvasRendererPlugin } from '../../CanvasRendererPlugin';\nimport { OptimizedDefaultRenderer, DEFAULT_STYLE } from './OptimizedDefault';\nimport { getColor, getPattern } from './helper';\n\nexport class DefaultRenderer extends OptimizedDefaultRenderer {\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedBaseStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const {\n      fill,\n      fillRule,\n      opacity = 1,\n      fillOpacity = 1,\n      stroke,\n      strokeOpacity = 1,\n      lineWidth = 1,\n      lineCap,\n      lineJoin,\n      shadowType,\n      shadowColor,\n      shadowBlur,\n      filter,\n      miterLimit,\n    } = parsedStyle;\n    const hasFill = fill && !(fill as CSSRGB).isNone;\n    const hasStroke = stroke && !(stroke as CSSRGB).isNone && lineWidth > 0;\n\n    const isFillTransparent = (fill as CSSRGB)?.alpha === 0;\n    const hasFilter = !!(filter && filter.length);\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    const nodeName = object.nodeName as Shape;\n    const isInnerShadow = shadowType === 'inner';\n    const shouldDrawShadowWithStroke =\n      hasStroke &&\n      hasShadow &&\n      (nodeName === Shape.PATH ||\n        nodeName === Shape.LINE ||\n        nodeName === Shape.POLYLINE ||\n        isFillTransparent ||\n        isInnerShadow);\n\n    if (hasFill) {\n      context.globalAlpha = opacity * fillOpacity;\n\n      if (!shouldDrawShadowWithStroke) {\n        setShadowAndFilter(object, context, hasShadow);\n      }\n\n      applyFill(\n        context,\n        object,\n        fill,\n        fillRule,\n        canvasContext,\n        plugin,\n        runtime,\n        this.imagePool,\n      );\n\n      if (!shouldDrawShadowWithStroke) {\n        this.clearShadowAndFilter(context, hasFilter, hasShadow);\n      }\n    }\n\n    if (hasStroke) {\n      context.globalAlpha = opacity * strokeOpacity;\n      context.lineWidth = lineWidth;\n      if (!isNil(miterLimit)) {\n        context.miterLimit = miterLimit;\n      }\n\n      if (!isNil(lineCap)) {\n        context.lineCap = lineCap;\n      }\n\n      if (!isNil(lineJoin)) {\n        context.lineJoin = lineJoin;\n      }\n\n      if (shouldDrawShadowWithStroke) {\n        if (isInnerShadow) {\n          context.globalCompositeOperation = 'source-atop';\n        }\n        setShadowAndFilter(object, context, true);\n\n        if (isInnerShadow) {\n          applyStroke(\n            context,\n            object,\n            stroke,\n            canvasContext,\n            plugin,\n            runtime,\n            this.imagePool,\n          );\n          context.globalCompositeOperation =\n            DEFAULT_STYLE.globalCompositeOperation;\n          this.clearShadowAndFilter(context, hasFilter, true);\n        }\n      }\n\n      applyStroke(\n        context,\n        object,\n        stroke,\n        canvasContext,\n        plugin,\n        runtime,\n        this.imagePool,\n      );\n    }\n  }\n\n  private clearShadowAndFilter(\n    context: CanvasRenderingContext2D,\n    hasFilter: boolean,\n    hasShadow: boolean,\n  ) {\n    if (hasShadow) {\n      context.shadowColor = 'transparent';\n      context.shadowBlur = 0;\n    }\n\n    if (hasFilter) {\n      // save drop-shadow filter\n      const oldFilter = context.filter;\n      if (!isNil(oldFilter) && oldFilter.indexOf('drop-shadow') > -1) {\n        context.filter =\n          oldFilter.replace(/drop-shadow\\([^)]*\\)/, '').trim() || 'none';\n      }\n    }\n  }\n}\n\n/**\n * apply before fill and stroke but only once\n */\nexport function setShadowAndFilter(\n  object: DisplayObject,\n  context: CanvasRenderingContext2D,\n  hasShadow: boolean,\n) {\n  const { filter, shadowColor, shadowBlur, shadowOffsetX, shadowOffsetY } =\n    object.parsedStyle;\n\n  if (filter && filter.length) {\n    // use raw filter string\n    context.filter = object.style.filter;\n  }\n\n  if (hasShadow) {\n    context.shadowColor = shadowColor.toString();\n    context.shadowBlur = shadowBlur || 0;\n    context.shadowOffsetX = shadowOffsetX || 0;\n    context.shadowOffsetY = shadowOffsetY || 0;\n  }\n}\n\nexport function applyFill(\n  context: CanvasRenderingContext2D,\n  object: DisplayObject,\n  fill: CSSRGB | CSSGradientValue[] | Pattern,\n  fillRule: 'nonzero' | 'evenodd',\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n  skipFill = false,\n) {\n  if (Array.isArray(fill)) {\n    fill.forEach((gradient) => {\n      context.fillStyle = getColor(gradient, object, context, imagePool);\n      if (!skipFill) {\n        fillRule ? context.fill(fillRule) : context.fill();\n      }\n    });\n  } else {\n    if (isPattern(fill)) {\n      context.fillStyle = getPattern(\n        fill,\n        object,\n        context,\n        canvasContext,\n        plugin,\n        runtime,\n        imagePool,\n      );\n    }\n    if (!skipFill) {\n      fillRule ? context.fill(fillRule) : context.fill();\n    }\n  }\n}\n\nexport function applyStroke(\n  context: CanvasRenderingContext2D,\n  object: DisplayObject,\n  stroke: CSSRGB | CSSGradientValue[] | Pattern,\n  canvasContext: CanvasContext,\n  plugin: CanvasRendererPlugin,\n  runtime: GlobalRuntime,\n  imagePool: ImagePool,\n  skipStroke = false,\n) {\n  if (Array.isArray(stroke)) {\n    stroke.forEach((gradient) => {\n      context.strokeStyle = getColor(gradient, object, context, imagePool);\n      if (!skipStroke) {\n        context.stroke();\n      }\n    });\n  } else {\n    if (isPattern(stroke)) {\n      context.strokeStyle = getPattern(\n        stroke,\n        object,\n        context,\n        canvasContext,\n        plugin,\n        runtime,\n        imagePool,\n      );\n    }\n    if (!skipStroke) {\n      context.stroke();\n    }\n  }\n}\n","import type {\n  DisplayObject,\n  ParsedImageStyleProps,\n  GlobalRuntime,\n  ImagePool,\n  ImageCache,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\nimport { transformRect, calculateOverlapRect } from '../../utils/math';\nimport { DefaultRenderer, setShadowAndFilter } from './Default';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\n\nexport class ImageRenderer extends DefaultRenderer {\n  static renderFull(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      image: HTMLImageElement;\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    context.drawImage(\n      data.image,\n      Math.floor(data.drawRect[0]),\n      Math.floor(data.drawRect[1]),\n      Math.ceil(data.drawRect[2]),\n      Math.ceil(data.drawRect[3]),\n    );\n  }\n\n  private renderDownSampled(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      src: string | HTMLImageElement;\n      imageCache: ImageCache;\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    const { src, imageCache } = data;\n\n    if (!imageCache.downSampled) {\n      this.imagePool\n        .createDownSampledImage(src, object)\n        .then(() => {\n          // be removed from dom tree\n          if (!object.ownerDocument) {\n            return;\n          }\n\n          // rerender\n          object.dirty();\n          object.ownerDocument.defaultView.context.renderingService.dirty();\n        })\n        .catch((reason) => {\n          console.error(reason);\n        });\n\n      return;\n    }\n\n    context.drawImage(\n      imageCache.downSampled,\n      Math.floor(data.drawRect[0]),\n      Math.floor(data.drawRect[1]),\n      Math.ceil(data.drawRect[2]),\n      Math.ceil(data.drawRect[3]),\n    );\n  }\n\n  renderTile(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n    data: {\n      src: string | HTMLImageElement;\n      imageCache: ImageCache;\n      imageRect: [number, number, number, number];\n      drawRect: [number, number, number, number];\n    },\n  ) {\n    const { src, imageCache, imageRect, drawRect } = data;\n    const { size: originalSize } = imageCache;\n    const { a, b, c, d, e, f } = context.getTransform();\n\n    context.resetTransform();\n\n    if (!imageCache?.gridSize) {\n      this.imagePool\n        .createImageTiles(\n          src,\n          [],\n          () => {\n            // be removed from dom tree\n            if (!object.ownerDocument) {\n              return;\n            }\n\n            // rerender\n            object.dirty();\n            object.ownerDocument.defaultView.context.renderingService.dirty();\n          },\n          object,\n        )\n        .catch((reason) => {\n          console.error(reason);\n        });\n\n      return;\n    }\n\n    const scaleToOrigin = [\n      originalSize[0] / imageRect[2],\n      originalSize[1] / imageRect[3],\n    ];\n    const scaledTileSize = [\n      imageCache.tileSize[0] / scaleToOrigin[0],\n      imageCache.tileSize[1] / scaleToOrigin[1],\n    ];\n    const [startTileX, endTileX] = [\n      Math.floor((drawRect[0] - imageRect[0]) / scaledTileSize[0]),\n      Math.ceil((drawRect[0] + drawRect[2] - imageRect[0]) / scaledTileSize[0]),\n    ];\n    const [startTileY, endTileY] = [\n      Math.floor((drawRect[1] - imageRect[1]) / scaledTileSize[1]),\n      Math.ceil((drawRect[1] + drawRect[3] - imageRect[1]) / scaledTileSize[1]),\n    ];\n\n    for (let tileY = startTileY; tileY <= endTileY; tileY++) {\n      for (let tileX = startTileX; tileX <= endTileX; tileX++) {\n        const item = imageCache.tiles[tileY][tileX];\n\n        if (item) {\n          const tileRect = [\n            Math.floor(imageRect[0] + item.tileX * scaledTileSize[0]),\n            Math.floor(imageRect[1] + item.tileY * scaledTileSize[1]),\n            Math.ceil(scaledTileSize[0]),\n            Math.ceil(scaledTileSize[1]),\n          ];\n\n          context.drawImage(\n            item.data,\n            tileRect[0],\n            tileRect[1],\n            tileRect[2],\n            tileRect[3],\n          );\n        }\n      }\n    }\n\n    context.setTransform(a, b, c, d, e, f);\n  }\n\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedImageStyleProps,\n    object: DisplayObject,\n  ) {\n    const {\n      x = 0,\n      y = 0,\n      width,\n      height,\n      src,\n      shadowColor,\n      shadowBlur,\n    } = parsedStyle;\n\n    const imageCache = this.imagePool.getImageSync(src, object);\n    const image = imageCache?.img;\n    let iw = width;\n    let ih = height;\n\n    if (!image) {\n      return;\n    }\n\n    iw ||= image.width;\n    ih ||= image.height;\n\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    setShadowAndFilter(object, context, hasShadow);\n\n    // node-canvas will throw the following err:\n    // Error: Image given has not completed loading\n    try {\n      const { width: viewWidth, height: viewHeight } =\n        object.ownerDocument.defaultView.getContextService().getDomElement();\n\n      const currentTransform = context.getTransform();\n      const { a, b, c, d, e, f } = currentTransform;\n      //  mat4 \n      // prettier-ignore\n      const transformMatrix = mat4.fromValues(\n          a, c, 0, 0,\n          b, d, 0, 0,\n          0, 0, 1, 0,\n          e, f, 0, 1,\n        );\n      const imageRect = transformRect([x, y, iw, ih], transformMatrix);\n      const drawRect = calculateOverlapRect(\n        [0, 0, viewWidth, viewHeight],\n        imageRect,\n      );\n\n      if (!drawRect) {\n        return;\n      }\n\n      if (\n        !object.ownerDocument.defaultView.getConfig()\n          .enableLargeImageOptimization\n      ) {\n        ImageRenderer.renderFull(context, parsedStyle, object, {\n          image,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      const sizeOfOrigin = imageRect[2] / imageCache.size[0];\n\n      if (sizeOfOrigin < (imageCache.downSamplingRate || 0.5)) {\n        this.renderDownSampled(context, parsedStyle, object, {\n          src,\n          imageCache,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      if (!ImagePool.isSupportTile) {\n        ImageRenderer.renderFull(context, parsedStyle, object, {\n          image,\n          drawRect: [x, y, iw, ih],\n        });\n\n        return;\n      }\n\n      this.renderTile(context, parsedStyle, object, {\n        src,\n        imageCache,\n        imageRect,\n        drawRect,\n      });\n    } catch {\n      // expected error\n    }\n  }\n\n  // ---\n\n  drawToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    this.render(context, object.parsedStyle as ParsedImageStyleProps, object);\n  }\n}\n","import { vec3, mat4 } from 'gl-matrix';\n\n/**\n *  [x, y]\n */\nexport function isSamePoint(\n  point1: [number, number],\n  point2: [number, number],\n) {\n  return point1[0] === point2[0] && point1[1] === point2[1];\n}\n\nexport function calculateOverlapRect<\n  Rect extends [number, number, number, number],\n>(rect1: Rect, rect2: Rect): null | Rect {\n  const [x1, y1, w1, h1] = rect1;\n  const [x2, y2, w2, h2] = rect2;\n\n  // \n  const overlapLeft = Math.max(x1, x2);\n  const overlapTop = Math.max(y1, y2);\n  const overlapRight = Math.min(x1 + w1, x2 + w2);\n  const overlapBottom = Math.min(y1 + h1, y2 + h2);\n\n  if (overlapRight <= overlapLeft || overlapBottom <= overlapTop) {\n    return null;\n  }\n\n  return [\n    overlapLeft,\n    overlapTop,\n    overlapRight - overlapLeft,\n    overlapBottom - overlapTop,\n  ] as Rect;\n}\n\nexport function transformRect<Rect extends [number, number, number, number]>(\n  rect: Rect,\n  matrix: mat4,\n): Rect {\n  const tl = vec3.transformMat4(vec3.create(), [rect[0], rect[1], 0], matrix);\n  const tr = vec3.transformMat4(\n    vec3.create(),\n    [rect[0] + rect[2], rect[1], 0],\n    matrix,\n  );\n  const bl = vec3.transformMat4(\n    vec3.create(),\n    [rect[0], rect[1] + rect[3], 0],\n    matrix,\n  );\n  const br = vec3.transformMat4(\n    vec3.create(),\n    [rect[0] + rect[2], rect[1] + rect[3], 0],\n    matrix,\n  );\n\n  return [\n    Math.min(tl[0], tr[0], bl[0], br[0]),\n    Math.min(tl[1], tr[1], bl[1], br[1]),\n    Math.max(tl[0], tr[0], bl[0], br[0]) - Math.min(tl[0], tr[0], bl[0], br[0]),\n    Math.max(tl[1], tr[1], bl[1], br[1]) - Math.min(tl[1], tr[1], bl[1], br[1]),\n  ] as Rect;\n}\n","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nfunction _createForOfIteratorHelper(r, e) {\n  var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"];\n  if (!t) {\n    if (Array.isArray(r) || (t = unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) {\n      t && (r = t);\n      var _n = 0,\n        F = function F() {};\n      return {\n        s: F,\n        n: function n() {\n          return _n >= r.length ? {\n            done: !0\n          } : {\n            done: !1,\n            value: r[_n++]\n          };\n        },\n        e: function e(r) {\n          throw r;\n        },\n        f: F\n      };\n    }\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n  var o,\n    a = !0,\n    u = !1;\n  return {\n    s: function s() {\n      t = t.call(r);\n    },\n    n: function n() {\n      var r = t.next();\n      return a = r.done, r;\n    },\n    e: function e(r) {\n      u = !0, o = r;\n    },\n    f: function f() {\n      try {\n        a || null == t[\"return\"] || t[\"return\"]();\n      } finally {\n        if (u) throw o;\n      }\n    }\n  };\n}\nexport { _createForOfIteratorHelper as default };","import {\n  type CSSRGB,\n  type CanvasContext,\n  type DisplayObject,\n  type GlobalRuntime,\n  type ParsedTextStyleProps,\n  type Rectangle,\n  CSSGradientValue,\n  Pattern,\n} from '@antv/g-lite';\nimport { isNil } from '@antv/util';\nimport {\n  DefaultRenderer,\n  applyFill,\n  applyStroke,\n  setShadowAndFilter,\n} from './Default';\nimport {\n  CanvasRendererPlugin,\n  type RenderState,\n} from '../../CanvasRendererPlugin';\n\nexport class TextRenderer extends DefaultRenderer {\n  render(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedTextStyleProps,\n    object: DisplayObject,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    // Trigger text geometry calculation.\n    object.getBounds();\n    const {\n      lineWidth = 1,\n      textAlign = 'start',\n      textBaseline = 'alphabetic',\n      lineJoin = 'miter',\n      miterLimit = 10,\n      letterSpacing = 0,\n      stroke,\n      fill,\n      fillRule,\n      fillOpacity = 1,\n      strokeOpacity = 1,\n      opacity = 1,\n      metrics,\n      x = 0,\n      y = 0,\n      dx,\n      dy,\n      shadowColor,\n      shadowBlur,\n      textDecorationLine,\n    } = parsedStyle;\n\n    const { font, lines, height, lineHeight, lineMetrics } = metrics;\n\n    context.font = font;\n    context.lineWidth = lineWidth;\n    context.textAlign = textAlign === 'middle' ? 'center' : textAlign;\n\n    let formattedTextBaseline = textBaseline;\n    if (formattedTextBaseline === 'alphabetic') {\n      formattedTextBaseline = 'bottom';\n    }\n\n    context.lineJoin = lineJoin;\n    if (!isNil(miterLimit)) {\n      context.miterLimit = miterLimit;\n    }\n\n    let linePositionY = y;\n    // handle vertical text baseline\n    if (textBaseline === 'middle') {\n      linePositionY += -height / 2 - lineHeight / 2;\n    } else if (\n      textBaseline === 'bottom' ||\n      textBaseline === 'alphabetic' ||\n      textBaseline === 'ideographic'\n    ) {\n      linePositionY += -height;\n    } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n      linePositionY += -lineHeight;\n    }\n\n    // account for dx & dy\n    const offsetX = x + (dx || 0);\n    linePositionY += dy || 0;\n\n    if (lines.length === 1) {\n      if (formattedTextBaseline === 'bottom') {\n        formattedTextBaseline = 'middle';\n        linePositionY -= 0.5 * height;\n      } else if (formattedTextBaseline === 'top') {\n        formattedTextBaseline = 'middle';\n        linePositionY += 0.5 * height;\n      }\n    }\n    context.textBaseline = formattedTextBaseline;\n\n    const hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    setShadowAndFilter(object, context, hasShadow);\n\n    // draw lines line by line\n    for (let i = 0; i < lines.length; i++) {\n      const linePositionX = lineWidth / 2 + offsetX;\n      linePositionY += lineHeight;\n\n      // no need to re-position X, cause we already set text align\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textAlign\n      if (!isNil(stroke) && !(stroke as CSSRGB).isNone && lineWidth) {\n        this.drawLetterSpacing(\n          context,\n          object,\n          lines[i],\n          lineMetrics[i],\n          textAlign,\n          linePositionX,\n          linePositionY,\n          letterSpacing,\n          fill,\n          fillRule,\n          fillOpacity,\n          stroke,\n          strokeOpacity,\n          opacity,\n          true,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      if (!isNil(fill)) {\n        this.drawLetterSpacing(\n          context,\n          object,\n          lines[i],\n          lineMetrics[i],\n          textAlign,\n          linePositionX,\n          linePositionY,\n          letterSpacing,\n          fill,\n          fillRule,\n          fillOpacity,\n          stroke,\n          strokeOpacity,\n          opacity,\n          false,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n    }\n\n    // Draw text decoration lines\n    if (textDecorationLine && textDecorationLine !== 'none') {\n      this.drawTextDecorations(\n        context,\n        parsedStyle,\n        object,\n        lines,\n        lineHeight,\n        offsetX,\n        y + (dy || 0),\n        canvasContext,\n        plugin,\n        runtime,\n      );\n    }\n  }\n\n  private drawLetterSpacing(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    lineMetrics: Rectangle,\n    textAlign: CanvasTextAlign | 'middle',\n    x: number,\n    y: number,\n    letterSpacing: number,\n    fill: CSSRGB | CSSGradientValue[] | Pattern,\n    fillRule: 'nonzero' | 'evenodd',\n    fillOpacity: number | undefined,\n    stroke: CSSRGB | CSSGradientValue[] | Pattern,\n    strokeOpacity: number | undefined,\n    opacity: number | undefined,\n    isStroke: boolean,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ): void {\n    // letterSpacing of 0 means normal, render all texts directly\n    if (letterSpacing === 0) {\n      if (isStroke) {\n        this.strokeText(\n          context,\n          object,\n          text,\n          x,\n          y,\n          stroke,\n          strokeOpacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      } else {\n        this.fillText(\n          context,\n          object,\n          text,\n          x,\n          y,\n          fill,\n          fillRule,\n          fillOpacity,\n          opacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      return;\n    }\n\n    // draw text using left align\n    const currentTextAlign = context.textAlign;\n    context.textAlign = 'left';\n\n    let currentPosition = x;\n    if (textAlign === 'center' || textAlign === 'middle') {\n      currentPosition = x - lineMetrics.width / 2;\n    } else if (textAlign === 'right' || textAlign === 'end') {\n      currentPosition = x - lineMetrics.width;\n    }\n\n    const stringArray = Array.from(text);\n    let previousWidth = context.measureText(text).width;\n    let currentWidth = 0;\n    for (let i = 0; i < stringArray.length; ++i) {\n      const currentChar = stringArray[i];\n      if (isStroke) {\n        this.strokeText(\n          context,\n          object,\n          currentChar,\n          currentPosition,\n          y,\n          stroke,\n          strokeOpacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      } else {\n        this.fillText(\n          context,\n          object,\n          currentChar,\n          currentPosition,\n          y,\n          fill,\n          fillRule,\n          fillOpacity,\n          opacity,\n          canvasContext,\n          plugin,\n          runtime,\n        );\n      }\n      currentWidth = context.measureText(text.substring(i + 1)).width;\n      currentPosition += previousWidth - currentWidth + letterSpacing;\n      previousWidth = currentWidth;\n    }\n\n    context.textAlign = currentTextAlign;\n  }\n\n  private fillText(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    x: number,\n    y: number,\n    fill: CSSRGB | CSSGradientValue[] | Pattern,\n    fillRule: 'nonzero' | 'evenodd',\n    fillOpacity: number | undefined,\n    opacity: number | undefined,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    applyFill(\n      context,\n      object,\n      fill,\n      fillRule,\n      canvasContext,\n      plugin,\n      runtime,\n      this.imagePool,\n      true,\n    );\n\n    let currentGlobalAlpha: number;\n    const applyOpacity = !isNil(fillOpacity) && fillOpacity !== 1;\n    if (applyOpacity) {\n      currentGlobalAlpha = context.globalAlpha;\n      context.globalAlpha = fillOpacity * opacity;\n    }\n    context.fillText(text, x, y);\n    if (applyOpacity) {\n      context.globalAlpha = currentGlobalAlpha;\n    }\n  }\n\n  private strokeText(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    text: string,\n    x: number,\n    y: number,\n    stroke: CSSRGB | CSSGradientValue[] | Pattern,\n    strokeOpacity: number | undefined,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    applyStroke(\n      context,\n      object,\n      stroke,\n      canvasContext,\n      plugin,\n      runtime,\n      this.imagePool,\n      true,\n    );\n\n    let currentGlobalAlpha: number;\n    const applyOpacity = !isNil(strokeOpacity) && strokeOpacity !== 1;\n    if (applyOpacity) {\n      currentGlobalAlpha = context.globalAlpha;\n      context.globalAlpha = strokeOpacity!;\n    }\n    context.strokeText(text, x, y);\n    if (applyOpacity) {\n      context.globalAlpha = currentGlobalAlpha;\n    }\n  }\n\n  /**\n   * Draw text decoration lines (underline, overline, line-through)\n   */\n  private drawTextDecorations(\n    context: CanvasRenderingContext2D,\n    parsedStyle: ParsedTextStyleProps,\n    object: DisplayObject,\n    lines: string[],\n    lineHeight: number,\n    offsetX: number,\n    baseY: number,\n    canvasContext: CanvasContext,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    const {\n      textDecorationLine,\n      textDecorationColor,\n      textDecorationStyle,\n      textDecorationThickness = 1,\n      textAlign = 'start',\n      lineWidth = 1,\n      metrics,\n    } = parsedStyle;\n\n    if (!textDecorationLine || textDecorationLine === 'none') {\n      return;\n    }\n\n    const { lineMetrics } = metrics;\n    const decorations = textDecorationLine.split(' ');\n\n    // Set decoration style\n    context.lineWidth = textDecorationThickness;\n\n    if (textDecorationColor) {\n      context.strokeStyle = `rgba(${textDecorationColor.r}, ${textDecorationColor.g}, ${textDecorationColor.b}, ${textDecorationColor.alpha})`;\n    }\n\n    // Set line style based on textDecorationStyle\n    switch (textDecorationStyle) {\n      case 'dashed':\n        context.setLineDash([5, 5]);\n        break;\n      case 'dotted':\n        context.setLineDash([2, 2]);\n        break;\n      case 'wavy':\n        // For wavy, we'll use a simple approximation with bezier curves\n        // A full implementation would be more complex\n        context.setLineDash([]);\n        break;\n      default:\n        context.setLineDash([]);\n        break;\n    }\n\n    let linePositionY = baseY;\n\n    // Adjust for text baseline\n    const { textBaseline = 'alphabetic' } = parsedStyle;\n    if (textBaseline === 'middle') {\n      linePositionY += -metrics.height / 2 - lineHeight / 2;\n    } else if (\n      textBaseline === 'bottom' ||\n      textBaseline === 'alphabetic' ||\n      textBaseline === 'ideographic'\n    ) {\n      linePositionY += -metrics.height;\n    } else if (textBaseline === 'top' || textBaseline === 'hanging') {\n      linePositionY += -lineHeight;\n    }\n\n    // Draw each decoration for each line\n    for (let i = 0; i < lines.length; i++) {\n      linePositionY += lineHeight;\n\n      const lineMetric = lineMetrics[i];\n      if (!lineMetric) continue;\n\n      const lineWidthOffset = lineWidth / 2;\n      let startX = offsetX;\n      let endX = offsetX + lineMetric.width;\n\n      // Adjust for text alignment\n      if (textAlign === 'center' || textAlign === 'middle') {\n        startX = offsetX - lineMetric.width / 2;\n        endX = offsetX + lineMetric.width / 2;\n      } else if (textAlign === 'right' || textAlign === 'end') {\n        startX = offsetX - lineMetric.width;\n        endX = offsetX;\n      }\n\n      // Add lineWidth offset\n      startX += lineWidthOffset;\n      endX += lineWidthOffset;\n\n      // Draw each type of decoration\n      for (const decoration of decorations) {\n        let decorationY = linePositionY;\n\n        switch (decoration) {\n          case 'underline':\n            decorationY += 2; // Small offset below baseline\n            break;\n          case 'overline':\n            decorationY -= lineHeight - 2; // Small offset above line\n            break;\n          case 'line-through':\n            decorationY -= lineHeight / 2; // Middle of line\n            break;\n          default:\n            continue; // Unknown decoration type\n        }\n\n        if (textDecorationStyle === 'wavy') {\n          this.drawWavyLine(context, startX, endX, decorationY);\n        } else {\n          context.beginPath();\n          context.moveTo(startX, decorationY);\n          context.lineTo(endX, decorationY);\n          context.stroke();\n        }\n      }\n    }\n\n    // Reset line dash\n    context.setLineDash([]);\n  }\n\n  /**\n   * Draw a wavy line as an approximation of the wavy text decoration style\n   */\n  private drawWavyLine(\n    context: CanvasRenderingContext2D,\n    startX: number,\n    endX: number,\n    y: number,\n  ) {\n    const amplitude = 2; // Height of the wave\n    const wavelength = 10; // Length of one wave cycle\n    const numWaves = Math.floor((endX - startX) / wavelength);\n\n    context.beginPath();\n    context.moveTo(startX, y);\n\n    for (let i = 0; i < numWaves; i++) {\n      const x1 = startX + i * wavelength + wavelength / 4;\n      const y1 = y + amplitude;\n      const x2 = startX + i * wavelength + wavelength / 2;\n      const y2 = y;\n      context.quadraticCurveTo(x1, y1, x2, y2);\n\n      const x3 = startX + i * wavelength + (wavelength * 3) / 4;\n      const y3 = y - amplitude;\n      const x4 = startX + (i + 1) * wavelength;\n      const y4 = y;\n      context.quadraticCurveTo(x3, y3, x4, y4);\n    }\n\n    context.stroke();\n  }\n\n  // ---\n\n  drawToContext(\n    context: CanvasRenderingContext2D,\n    object: DisplayObject,\n    renderState: RenderState,\n    plugin: CanvasRendererPlugin,\n    runtime: GlobalRuntime,\n  ) {\n    this.render(\n      context,\n      object.parsedStyle as ParsedTextStyleProps,\n      object,\n      object.ownerDocument.defaultView.context,\n      plugin,\n      runtime,\n    );\n  }\n}\n","import { AbstractRendererPlugin, Shape } from '@antv/g-lite';\nimport type { PathGenerator } from '../..';\nimport { CanvasRendererPlugin } from './CanvasRendererPlugin';\nimport {\n  type StyleRenderer,\n  DefaultRenderer,\n  TextRenderer,\n  ImageRenderer,\n} from './shapes/styles';\nimport type { CanvasRendererPluginOptions } from './interfaces';\n\nexport * from './shapes/styles';\n\nexport class Plugin extends AbstractRendererPlugin<{\n  defaultStyleRendererFactory: Record<Shape, StyleRenderer>;\n  styleRendererFactory: Record<Shape, StyleRenderer>;\n  pathGeneratorFactory: Record<Shape, PathGenerator<any>>;\n}> {\n  name = 'canvas-renderer';\n\n  constructor(private options: Partial<CanvasRendererPluginOptions> = {}) {\n    super();\n  }\n\n  init(): void {\n    const canvasRendererPluginOptions: CanvasRendererPluginOptions = {\n      dirtyObjectNumThreshold: 500,\n      dirtyObjectRatioThreshold: 0.8,\n      ...this.options,\n    };\n\n    // @ts-ignore\n    const { imagePool } = this.context;\n\n    const defaultRenderer = new DefaultRenderer(imagePool);\n\n    const defaultStyleRendererFactory: Record<Shape, StyleRenderer> = {\n      [Shape.CIRCLE]: defaultRenderer,\n      [Shape.ELLIPSE]: defaultRenderer,\n      [Shape.RECT]: defaultRenderer,\n      [Shape.IMAGE]: new ImageRenderer(imagePool),\n      [Shape.TEXT]: new TextRenderer(imagePool),\n      [Shape.LINE]: defaultRenderer,\n      [Shape.POLYLINE]: defaultRenderer,\n      [Shape.POLYGON]: defaultRenderer,\n      [Shape.PATH]: defaultRenderer,\n      [Shape.GROUP]: undefined,\n      [Shape.HTML]: undefined,\n      [Shape.MESH]: undefined,\n      [Shape.FRAGMENT]: undefined,\n    };\n\n    this.context.defaultStyleRendererFactory = defaultStyleRendererFactory;\n    this.context.styleRendererFactory = defaultStyleRendererFactory;\n\n    this.addRenderingPlugin(\n      new CanvasRendererPlugin(canvasRendererPluginOptions),\n    );\n  }\n  destroy(): void {\n    this.removeAllRenderingPlugins();\n\n    delete this.context.defaultStyleRendererFactory;\n    delete this.context.styleRendererFactory;\n  }\n}\n","function _OverloadYield(e, d) {\n  this.v = e, this.k = d;\n}\nexport { _OverloadYield as default };","function _regeneratorDefine(e, r, n, t) {\n  var i = Object.defineProperty;\n  try {\n    i({}, \"\", {});\n  } catch (e) {\n    i = 0;\n  }\n  _regeneratorDefine = function regeneratorDefine(e, r, n, t) {\n    function o(r, n) {\n      _regeneratorDefine(e, r, function (e) {\n        return this._invoke(r, n, e);\n      });\n    }\n    r ? i ? i(e, r, {\n      value: n,\n      enumerable: !t,\n      configurable: !t,\n      writable: !t\n    }) : e[r] = n : (o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2));\n  }, _regeneratorDefine(e, r, n, t);\n}\nexport { _regeneratorDefine as default };","import regeneratorDefine from \"./regeneratorDefine.js\";\nfunction _regenerator() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */\n  var e,\n    t,\n    r = \"function\" == typeof Symbol ? Symbol : {},\n    n = r.iterator || \"@@iterator\",\n    o = r.toStringTag || \"@@toStringTag\";\n  function i(r, n, o, i) {\n    var c = n && n.prototype instanceof Generator ? n : Generator,\n      u = Object.create(c.prototype);\n    return regeneratorDefine(u, \"_invoke\", function (r, n, o) {\n      var i,\n        c,\n        u,\n        f = 0,\n        p = o || [],\n        y = !1,\n        G = {\n          p: 0,\n          n: 0,\n          v: e,\n          a: d,\n          f: d.bind(e, 4),\n          d: function d(t, r) {\n            return i = t, c = 0, u = e, G.n = r, a;\n          }\n        };\n      function d(r, n) {\n        for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) {\n          var o,\n            i = p[t],\n            d = G.p,\n            l = i[2];\n          r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0));\n        }\n        if (o || r > 1) return a;\n        throw y = !0, n;\n      }\n      return function (o, p, l) {\n        if (f > 1) throw TypeError(\"Generator is already running\");\n        for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) {\n          i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u);\n          try {\n            if (f = 2, i) {\n              if (c || (o = \"next\"), t = i[o]) {\n                if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\");\n                if (!t.done) return t;\n                u = t.value, c < 2 && (c = 0);\n              } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1);\n              i = e;\n            } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break;\n          } catch (t) {\n            i = e, c = 1, u = t;\n          } finally {\n            f = 1;\n          }\n        }\n        return {\n          value: t,\n          done: y\n        };\n      };\n    }(r, o, i), !0), u;\n  }\n  var a = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  t = Object.getPrototypeOf;\n  var c = [][n] ? t(t([][n]())) : (regeneratorDefine(t = {}, n, function () {\n      return this;\n    }), t),\n    u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c);\n  function f(e) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, regeneratorDefine(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e;\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, regeneratorDefine(u, \"constructor\", GeneratorFunctionPrototype), regeneratorDefine(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", regeneratorDefine(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), regeneratorDefine(u), regeneratorDefine(u, o, \"Generator\"), regeneratorDefine(u, n, function () {\n    return this;\n  }), regeneratorDefine(u, \"toString\", function () {\n    return \"[object Generator]\";\n  }), (_regenerator = function _regenerator() {\n    return {\n      w: i,\n      m: f\n    };\n  })();\n}\nexport { _regenerator as default };","import OverloadYield from \"./OverloadYield.js\";\nimport regeneratorDefine from \"./regeneratorDefine.js\";\nfunction AsyncIterator(t, e) {\n  function n(r, o, i, f) {\n    try {\n      var c = t[r](o),\n        u = c.value;\n      return u instanceof OverloadYield ? e.resolve(u.v).then(function (t) {\n        n(\"next\", t, i, f);\n      }, function (t) {\n        n(\"throw\", t, i, f);\n      }) : e.resolve(u).then(function (t) {\n        c.value = t, i(c);\n      }, function (t) {\n        return n(\"throw\", t, i, f);\n      });\n    } catch (t) {\n      f(t);\n    }\n  }\n  var r;\n  this.next || (regeneratorDefine(AsyncIterator.prototype), regeneratorDefine(AsyncIterator.prototype, \"function\" == typeof Symbol && Symbol.asyncIterator || \"@asyncIterator\", function () {\n    return this;\n  })), regeneratorDefine(this, \"_invoke\", function (t, o, i) {\n    function f() {\n      return new e(function (e, r) {\n        n(t, i, e, r);\n      });\n    }\n    return r = r ? r.then(f, f) : f();\n  }, !0);\n}\nexport { AsyncIterator as default };","import regenerator from \"./regenerator.js\";\nimport regeneratorAsyncIterator from \"./regeneratorAsyncIterator.js\";\nfunction _regeneratorAsyncGen(r, e, t, o, n) {\n  return new regeneratorAsyncIterator(regenerator().w(r, e, t, o), n || Promise);\n}\nexport { _regeneratorAsyncGen as default };","import regeneratorAsyncGen from \"./regeneratorAsyncGen.js\";\nfunction _regeneratorAsync(n, e, r, t, o) {\n  var a = regeneratorAsyncGen(n, e, r, t, o);\n  return a.next().then(function (n) {\n    return n.done ? n.value : a.next();\n  });\n}\nexport { _regeneratorAsync as default };","function _regeneratorKeys(e) {\n  var n = Object(e),\n    r = [];\n  for (var t in n) r.unshift(t);\n  return function e() {\n    for (; r.length;) if ((t = r.pop()) in n) return e.value = t, e.done = !1, e;\n    return e.done = !0, e;\n  };\n}\nexport { _regeneratorKeys as default };","import _typeof from \"./typeof.js\";\nfunction _regeneratorValues(e) {\n  if (null != e) {\n    var t = e[\"function\" == typeof Symbol && Symbol.iterator || \"@@iterator\"],\n      r = 0;\n    if (t) return t.call(e);\n    if (\"function\" == typeof e.next) return e;\n    if (!isNaN(e.length)) return {\n      next: function next() {\n        return e && r >= e.length && (e = void 0), {\n          value: e && e[r++],\n          done: !e\n        };\n      }\n    };\n  }\n  throw new TypeError(_typeof(e) + \" is not iterable\");\n}\nexport { _regeneratorValues as default };","import OverloadYield from \"./OverloadYield.js\";\nimport regenerator from \"./regenerator.js\";\nimport regeneratorAsync from \"./regeneratorAsync.js\";\nimport regeneratorAsyncGen from \"./regeneratorAsyncGen.js\";\nimport regeneratorAsyncIterator from \"./regeneratorAsyncIterator.js\";\nimport regeneratorKeys from \"./regeneratorKeys.js\";\nimport regeneratorValues from \"./regeneratorValues.js\";\nfunction _regeneratorRuntime() {\n  \"use strict\";\n\n  var r = regenerator(),\n    e = r.m(_regeneratorRuntime),\n    t = (Object.getPrototypeOf ? Object.getPrototypeOf(e) : e.__proto__).constructor;\n  function n(r) {\n    var e = \"function\" == typeof r && r.constructor;\n    return !!e && (e === t || \"GeneratorFunction\" === (e.displayName || e.name));\n  }\n  var o = {\n    \"throw\": 1,\n    \"return\": 2,\n    \"break\": 3,\n    \"continue\": 3\n  };\n  function a(r) {\n    var e, t;\n    return function (n) {\n      e || (e = {\n        stop: function stop() {\n          return t(n.a, 2);\n        },\n        \"catch\": function _catch() {\n          return n.v;\n        },\n        abrupt: function abrupt(r, e) {\n          return t(n.a, o[r], e);\n        },\n        delegateYield: function delegateYield(r, o, a) {\n          return e.resultName = o, t(n.d, regeneratorValues(r), a);\n        },\n        finish: function finish(r) {\n          return t(n.f, r);\n        }\n      }, t = function t(r, _t, o) {\n        n.p = e.prev, n.n = e.next;\n        try {\n          return r(_t, o);\n        } finally {\n          e.next = n.n;\n        }\n      }), e.resultName && (e[e.resultName] = n.v, e.resultName = void 0), e.sent = n.v, e.next = n.n;\n      try {\n        return r.call(this, e);\n      } finally {\n        n.p = e.prev, n.n = e.next;\n      }\n    };\n  }\n  return (_regeneratorRuntime = function _regeneratorRuntime() {\n    return {\n      wrap: function wrap(e, t, n, o) {\n        return r.w(a(e), t, n, o && o.reverse());\n      },\n      isGeneratorFunction: n,\n      mark: r.m,\n      awrap: function awrap(r, e) {\n        return new OverloadYield(r, e);\n      },\n      AsyncIterator: regeneratorAsyncIterator,\n      async: function async(r, e, t, o, u) {\n        return (n(e) ? regeneratorAsyncGen : regeneratorAsync)(a(r), e, t, o, u);\n      },\n      keys: regeneratorKeys,\n      values: regeneratorValues\n    };\n  })();\n}\nexport { _regeneratorRuntime as default };","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","import type {\n  BaseStyleProps,\n  DisplayObject,\n  PickingResult,\n  RenderingPlugin,\n  Shape,\n  IDocument,\n  RenderingPluginContext,\n  GlobalRuntime,\n} from '@antv/g-lite';\nimport { findClosestClipPathTarget, Point } from '@antv/g-lite';\nimport { mat4, vec3 } from 'gl-matrix';\nimport type { PathGenerator } from '../..';\n\nexport type PointInPathPicker<T extends BaseStyleProps> = (\n  displayObject: DisplayObject<T>,\n  point: Point,\n  isClipPath: boolean,\n  isPointInPath: (displayObject: DisplayObject<T>, point: Point) => boolean,\n  context: RenderingPluginContext,\n  runtime: GlobalRuntime,\n) => boolean;\n\nconst tmpVec3a = vec3.create();\nconst tmpVec3b = vec3.create();\nconst tmpVec3c = vec3.create();\nconst tmpMat4 = mat4.create();\n\ninterface Extended {\n  pathGeneratorFactory: Record<Shape, PathGenerator<any>>;\n  pointInPathPickerFactory: Record<Shape, PointInPathPicker<any>>;\n}\n\n/**\n * pick shape(s) with Mouse/Touch event\n *\n * 1. find AABB with r-tree\n * 2. do math calculation with geometry in an accurate way\n */\nexport class CanvasPickerPlugin implements RenderingPlugin {\n  static tag = 'CanvasPicker';\n\n  private context: RenderingPluginContext & Extended;\n  private runtime: GlobalRuntime;\n\n  apply(context: RenderingPluginContext, runtime: GlobalRuntime) {\n    const { renderingService, renderingContext } = context;\n    this.context = context as RenderingPluginContext & Extended;\n    this.runtime = runtime;\n\n    const document = renderingContext.root?.ownerDocument;\n\n    renderingService.hooks.pick.tapPromise(\n      CanvasPickerPlugin.tag,\n      async (result: PickingResult) => {\n        return this.pick(document, result);\n      },\n    );\n\n    renderingService.hooks.pickSync.tap(\n      CanvasPickerPlugin.tag,\n      (result: PickingResult) => {\n        return this.pick(document, result);\n      },\n    );\n  }\n\n  private pick(document: IDocument, result: PickingResult) {\n    const {\n      topmost,\n      position: { x, y },\n    } = result;\n\n    // position in world space\n    const position = vec3.set(tmpVec3a, x, y, 0);\n\n    // query by AABB\n    const hitTestList = document.elementsFromBBox(\n      position[0],\n      position[1],\n      position[0],\n      position[1],\n    );\n\n    // test with clip path & origin shape\n    // @see https://github.com/antvis/g/issues/1064\n    const pickedDisplayObjects: DisplayObject[] = [];\n    for (const displayObject of hitTestList) {\n      const worldTransform = displayObject.getWorldTransform();\n      const isHitOriginShape = this.isHit(\n        displayObject,\n        position,\n        worldTransform,\n        false,\n      );\n      if (isHitOriginShape) {\n        // should look up in the ancestor node\n        const clipped = findClosestClipPathTarget(displayObject);\n        if (clipped) {\n          const { clipPath } = clipped.parsedStyle;\n          const isHitClipPath = this.isHit(\n            clipPath,\n            position,\n            clipPath.getWorldTransform(),\n            true,\n          );\n          if (isHitClipPath) {\n            if (topmost) {\n              result.picked = [displayObject];\n              return result;\n            }\n            pickedDisplayObjects.push(displayObject);\n          }\n        } else {\n          if (topmost) {\n            result.picked = [displayObject];\n            return result;\n          }\n          pickedDisplayObjects.push(displayObject);\n        }\n      }\n    }\n\n    result.picked = pickedDisplayObjects;\n    return result;\n  }\n\n  private isHit = (\n    displayObject: DisplayObject,\n    position: vec3,\n    worldTransform: mat4,\n    isClipPath: boolean,\n  ) => {\n    // use picker for current shape's type\n    const pick =\n      this.context.pointInPathPickerFactory[displayObject.nodeName as Shape];\n    if (pick) {\n      // invert with world matrix\n      const invertWorldMat = mat4.invert(tmpMat4, worldTransform);\n\n      // transform client position to local space, do picking in local space\n      const localPosition = vec3.transformMat4(\n        tmpVec3b,\n        vec3.set(tmpVec3c, position[0], position[1], 0),\n        invertWorldMat,\n      );\n\n      if (\n        pick(\n          displayObject,\n          new Point(localPosition[0], localPosition[1]),\n          isClipPath,\n          this.isPointInPath,\n          this.context,\n          this.runtime,\n        )\n      ) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  /**\n   * use native picking method\n   * @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/isPointInPath\n   */\n  private isPointInPath = (displayObject: DisplayObject, position: Point) => {\n    const context = this.runtime.offscreenCanvasCreator.getOrCreateContext(\n      this.context.config.offscreenCanvas,\n    ) as CanvasRenderingContext2D;\n\n    const generatePath =\n      this.context.pathGeneratorFactory[displayObject.nodeName];\n    if (generatePath) {\n      context.beginPath();\n      generatePath(context, displayObject.parsedStyle);\n      context.closePath();\n    }\n\n    return context.isPointInPath(position.x, position.y);\n  };\n}\n","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nfunction _toConsumableArray(r) {\n  return arrayWithoutHoles(r) || iterableToArray(r) || unsupportedIterableToArray(r) || nonIterableSpread();\n}\nexport { _toConsumableArray as default };","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nfunction _arrayWithoutHoles(r) {\n  if (Array.isArray(r)) return arrayLikeToArray(r);\n}\nexport { _arrayWithoutHoles as default };","function _iterableToArray(r) {\n  if (\"undefined\" != typeof Symbol && null != r[Symbol.iterator] || null != r[\"@@iterator\"]) return Array.from(r);\n}\nexport { _iterableToArray as default };","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nexport { _nonIterableSpread as default };","/*!\n * @antv/g-math\n * @description Geometry util\n * @version 3.1.0\n * @date 12/24/2025, 11:55:15 AM\n * @author AntVis\n * @docs https://g.antv.antgroup.com/\n */\nimport _slicedToArray from '@babel/runtime/helpers/slicedToArray';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport { isNumberEqual } from '@antv/util';\nimport { vec2 } from 'gl-matrix';\n\nfunction distance(x1, y1, x2, y2) {\n  var dx = x1 - x2;\n  var dy = y1 - y2;\n  return Math.sqrt(dx * dx + dy * dy);\n}\nfunction getBBoxByArray(xArr, yArr) {\n  var minX = Math.min.apply(Math, _toConsumableArray(xArr));\n  var minY = Math.min.apply(Math, _toConsumableArray(yArr));\n  var maxX = Math.max.apply(Math, _toConsumableArray(xArr));\n  var maxY = Math.max.apply(Math, _toConsumableArray(yArr));\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction piMod(angle) {\n  return (angle + Math.PI * 2) % (Math.PI * 2);\n}\n\nfunction copysign(v1, v2) {\n  var absv = Math.abs(v1);\n  return v2 > 0 ? absv : absv * -1;\n}\nfunction nearestPoint$4(x, y, rx, ry, x0, y0) {\n  var a = rx;\n  var b = ry;\n  // 0\n  if (a === 0 || b === 0) {\n    return {\n      x: x,\n      y: y\n    };\n  }\n  //  0 0 \n  var relativeX = x0 - x;\n  var relativeY = y0 - y;\n  var px = Math.abs(relativeX);\n  var py = Math.abs(relativeY);\n  var squareA = a * a;\n  var squareB = b * b;\n  // const angle0 = Math.atan2(relativeY, relativeX);\n  var t = Math.PI / 4;\n  var nearestX = 0; // \n  var nearestY = 0;\n  //  4 \n  for (var i = 0; i < 4; i++) {\n    nearestX = a * Math.cos(t);\n    nearestY = b * Math.sin(t);\n    var ex = (squareA - squareB) * Math.pow(Math.cos(t), 3) / a;\n    var ey = (squareB - squareA) * Math.pow(Math.sin(t), 3) / b;\n    var rx1 = nearestX - ex;\n    var ry1 = nearestY - ey;\n    var qx = px - ex;\n    var qy = py - ey;\n    var r = Math.hypot(ry1, rx1);\n    var q = Math.hypot(qy, qx);\n    var delta_c = r * Math.asin((rx1 * qy - ry1 * qx) / (r * q));\n    var delta_t = delta_c / Math.sqrt(squareA + squareB - nearestX * nearestX - nearestY * nearestY);\n    t += delta_t;\n    t = Math.min(Math.PI / 2, Math.max(0, t));\n  }\n  return {\n    x: x + copysign(nearestX, relativeX),\n    y: y + copysign(nearestY, relativeY)\n  };\n}\n\n//  x\nfunction derivativeXAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle) {\n  return -1 * rx * Math.cos(xRotation) * Math.sin(angle) - ry * Math.sin(xRotation) * Math.cos(angle);\n}\n\n//  y\nfunction derivativeYAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle) {\n  return -1 * rx * Math.sin(xRotation) * Math.sin(angle) + ry * Math.cos(xRotation) * Math.cos(angle);\n}\n\n// x \nfunction xExtrema(rx, ry, xRotation) {\n  return Math.atan(-ry / rx * Math.tan(xRotation));\n}\n\n// y \nfunction yExtrema(rx, ry, xRotation) {\n  return Math.atan(ry / (rx * Math.tan(xRotation)));\n}\n\n//  x \nfunction xAt(cx, cy, rx, ry, xRotation, angle) {\n  return rx * Math.cos(xRotation) * Math.cos(angle) - ry * Math.sin(xRotation) * Math.sin(angle) + cx;\n}\n\n//  y \nfunction yAt(cx, cy, rx, ry, xRotation, angle) {\n  return rx * Math.sin(xRotation) * Math.cos(angle) + ry * Math.cos(xRotation) * Math.sin(angle) + cy;\n}\n\n// \nfunction getAngle(rx, ry, x0, y0) {\n  var angle = Math.atan2(y0 * rx, x0 * ry);\n  //  0 - 2PI \n  return (angle + Math.PI * 2) % (Math.PI * 2);\n}\n\n// x,y\nfunction getPoint(rx, ry, angle) {\n  return {\n    x: rx * Math.cos(angle),\n    y: ry * Math.sin(angle)\n  };\n}\n\n// \nfunction rotate(x, y, angle) {\n  var cos = Math.cos(angle);\n  var sin = Math.sin(angle);\n  return [x * cos - y * sin, x * sin + y * cos];\n}\nfunction box$5(cx, cy, rx, ry, xRotation, startAngle, endAngle) {\n  var xDim = xExtrema(rx, ry, xRotation);\n  var minX = Infinity;\n  var maxX = -Infinity;\n  var xs = [startAngle, endAngle];\n  for (var i = -Math.PI * 2; i <= Math.PI * 2; i += Math.PI) {\n    var xAngle = xDim + i;\n    if (startAngle < endAngle) {\n      if (startAngle < xAngle && xAngle < endAngle) {\n        xs.push(xAngle);\n      }\n    } else if (endAngle < xAngle && xAngle < startAngle) {\n      xs.push(xAngle);\n    }\n  }\n  for (var _i = 0; _i < xs.length; _i++) {\n    var x = xAt(cx, cy, rx, ry, xRotation, xs[_i]);\n    if (x < minX) {\n      minX = x;\n    }\n    if (x > maxX) {\n      maxX = x;\n    }\n  }\n  var yDim = yExtrema(rx, ry, xRotation);\n  var minY = Infinity;\n  var maxY = -Infinity;\n  var ys = [startAngle, endAngle];\n  for (var _i2 = -Math.PI * 2; _i2 <= Math.PI * 2; _i2 += Math.PI) {\n    var yAngle = yDim + _i2;\n    if (startAngle < endAngle) {\n      if (startAngle < yAngle && yAngle < endAngle) {\n        ys.push(yAngle);\n      }\n    } else if (endAngle < yAngle && yAngle < startAngle) {\n      ys.push(yAngle);\n    }\n  }\n  for (var _i3 = 0; _i3 < ys.length; _i3++) {\n    var y = yAt(cx, cy, rx, ry, xRotation, ys[_i3]);\n    if (y < minY) {\n      minY = y;\n    }\n    if (y > maxY) {\n      maxY = y;\n    }\n  }\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction nearestPoint$3(cx, cy, rx, ry, xRotation, startAngle, endAngle, x0, y0) {\n  //  0,0 \n  var relativeVector = rotate(x0 - cx, y0 - cy, -xRotation);\n  var _relativeVector = _slicedToArray(relativeVector, 2),\n    x1 = _relativeVector[0],\n    y1 = _relativeVector[1];\n  // \n  var relativePoint = nearestPoint$4(0, 0, rx, ry, x1, y1);\n  // \n  var angle = getAngle(rx, ry, relativePoint.x, relativePoint.y);\n  // \n  if (angle < startAngle) {\n    // \n    relativePoint = getPoint(rx, ry, startAngle);\n  } else if (angle > endAngle) {\n    // \n    relativePoint = getPoint(rx, ry, endAngle);\n  }\n  //  xRotation \n  var vector = rotate(relativePoint.x, relativePoint.y, xRotation);\n  return {\n    x: vector[0] + cx,\n    y: vector[1] + cy\n  };\n}\nfunction tangentAngle$4(cx, cy, rx, ry, xRotation, startAngle, endAngle, t) {\n  var angle = (endAngle - startAngle) * t + startAngle;\n  var dx = derivativeXAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle);\n  var dy = derivativeYAt(cx, cy, rx, ry, xRotation, startAngle, endAngle, angle);\n  return piMod(Math.atan2(dy, dx));\n}\n\nvar EPSILON = 0.0001;\n/**\n * \n * @param {number[]} xArr       x \n * @param {number[]} yArr       y \n * @param {number}   x          x\n * @param {number}   y          y\n * @param {Function} tCallback \n */\nfunction nearestPoint$2(xArr, yArr, x, y, tCallback, length) {\n  var t = -1;\n  var d = Infinity;\n  var v0 = [x, y];\n  var segNum = 20;\n  if (length && length > 200) {\n    segNum = length / 10;\n  }\n  var increaseRate = 1 / segNum;\n  var interval = increaseRate / 10;\n  for (var i = 0; i <= segNum; i++) {\n    var _t = i * increaseRate;\n    var v1 = [tCallback.apply(void 0, _toConsumableArray(xArr.concat([_t]))), tCallback.apply(void 0, _toConsumableArray(yArr.concat([_t])))];\n    var d1 = distance(v0[0], v0[1], v1[0], v1[1]);\n    if (d1 < d) {\n      t = _t;\n      d = d1;\n    }\n  }\n  // \n  if (t === 0) {\n    return {\n      x: xArr[0],\n      y: yArr[0]\n    };\n  }\n  if (t === 1) {\n    var count = xArr.length;\n    return {\n      x: xArr[count - 1],\n      y: yArr[count - 1]\n    };\n  }\n  d = Infinity;\n  for (var _i = 0; _i < 32; _i++) {\n    if (interval < EPSILON) {\n      break;\n    }\n    var prev = t - interval;\n    var next = t + interval;\n    var _v = [tCallback.apply(void 0, _toConsumableArray(xArr.concat([prev]))), tCallback.apply(void 0, _toConsumableArray(yArr.concat([prev])))];\n    var _d = distance(v0[0], v0[1], _v[0], _v[1]);\n    if (prev >= 0 && _d < d) {\n      t = prev;\n      d = _d;\n    } else {\n      var v2 = [tCallback.apply(void 0, _toConsumableArray(xArr.concat([next]))), tCallback.apply(void 0, _toConsumableArray(yArr.concat([next])))];\n      var d2 = distance(v0[0], v0[1], v2[0], v2[1]);\n      if (next <= 1 && d2 < d) {\n        t = next;\n        d = d2;\n      } else {\n        interval *= 0.5;\n      }\n    }\n  }\n  return {\n    x: tCallback.apply(void 0, _toConsumableArray(xArr.concat([t]))),\n    y: tCallback.apply(void 0, _toConsumableArray(yArr.concat([t])))\n  };\n}\n\n//  https://community.khronos.org/t/3d-cubic-bezier-segment-length/62363/2\nfunction snapLength(xArr, yArr) {\n  var totalLength = 0;\n  var count = xArr.length;\n  for (var i = 0; i < count; i++) {\n    var x = xArr[i];\n    var y = yArr[i];\n    var nextX = xArr[(i + 1) % count];\n    var nextY = yArr[(i + 1) % count];\n    totalLength += distance(x, y, nextX, nextY);\n  }\n  return totalLength / 2;\n}\n\nfunction box$4(x1, y1, x2, y2) {\n  return getBBoxByArray([x1, x2], [y1, y2]);\n}\nfunction length$4(x1, y1, x2, y2) {\n  return distance(x1, y1, x2, y2);\n}\nfunction pointAt$3(x1, y1, x2, y2, t) {\n  return {\n    x: (1 - t) * x1 + t * x2,\n    y: (1 - t) * y1 + t * y2\n  };\n}\nfunction pointDistance$4(x1, y1, x2, y2, x, y) {\n  //  x1, y1  p, p1, p2  a\n  // p1a = p1p.p1p2/|p1p2| * (p1p )\n  var cross = (x2 - x1) * (x - x1) + (y2 - y1) * (y - y1);\n  if (cross < 0) {\n    return distance(x1, y1, x, y);\n  }\n  var lengthSquare = (x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1);\n  if (cross > lengthSquare) {\n    return distance(x2, y2, x, y);\n  }\n  return pointToLine(x1, y1, x2, y2, x, y);\n}\nfunction pointToLine(x1, y1, x2, y2, x, y) {\n  var d = [x2 - x1, y2 - y1];\n  // \n  if (vec2.exactEquals(d, [0, 0])) {\n    return Math.sqrt((x - x1) * (x - x1) + (y - y1) * (y - y1));\n  }\n  var u = [-d[1], d[0]];\n  vec2.normalize(u, u);\n  var a = [x - x1, y - y1];\n  return Math.abs(vec2.dot(a, u));\n}\nfunction tangentAngle$3(x1, y1, x2, y2) {\n  return Math.atan2(y2 - y1, x2 - x1);\n}\n\nfunction cubicAt(p0, p1, p2, p3, t) {\n  var onet = 1 - t; // t * t * t  Math.pow(t, 3) \n  return onet * onet * onet * p0 + 3 * p1 * t * onet * onet + 3 * p2 * t * t * onet + p3 * t * t * t;\n}\nfunction derivativeAt(p0, p1, p2, p3, t) {\n  var onet = 1 - t;\n  return 3 * (onet * onet * (p1 - p0) + 2 * onet * t * (p2 - p1) + t * t * (p3 - p2));\n}\nfunction extrema$1(p0, p1, p2, p3) {\n  var a = -3 * p0 + 9 * p1 - 9 * p2 + 3 * p3;\n  var b = 6 * p0 - 12 * p1 + 6 * p2;\n  var c = 3 * p1 - 3 * p0;\n  var extremas = [];\n  var t1;\n  var t2;\n  var discSqrt;\n  if (isNumberEqual(a, 0)) {\n    if (!isNumberEqual(b, 0)) {\n      t1 = -c / b;\n      if (t1 >= 0 && t1 <= 1) {\n        extremas.push(t1);\n      }\n    }\n  } else {\n    var disc = b * b - 4 * a * c;\n    if (isNumberEqual(disc, 0)) {\n      extremas.push(-b / (2 * a));\n    } else if (disc > 0) {\n      discSqrt = Math.sqrt(disc);\n      t1 = (-b + discSqrt) / (2 * a);\n      t2 = (-b - discSqrt) / (2 * a);\n      if (t1 >= 0 && t1 <= 1) {\n        extremas.push(t1);\n      }\n      if (t2 >= 0 && t2 <= 1) {\n        extremas.push(t2);\n      }\n    }\n  }\n  return extremas;\n}\n\n// \nfunction divideCubic(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n  // \n  var xt = cubicAt(x1, x2, x3, x4, t);\n  var yt = cubicAt(y1, y2, y3, y4, t);\n  // \n  var c1 = pointAt$3(x1, y1, x2, y2, t);\n  var c2 = pointAt$3(x2, y2, x3, y3, t);\n  var c3 = pointAt$3(x3, y3, x4, y4, t);\n  var c12 = pointAt$3(c1.x, c1.y, c2.x, c2.y, t);\n  var c23 = pointAt$3(c2.x, c2.y, c3.x, c3.y, t);\n  return [[x1, y1, c1.x, c1.y, c12.x, c12.y, xt, yt], [xt, yt, c23.x, c23.y, c3.x, c3.y, x4, y4]];\n}\n\n// \nfunction cubicLength(x1, y1, x2, y2, x3, y3, x4, y4, iterationCount) {\n  if (iterationCount === 0) {\n    return snapLength([x1, x2, x3, x4], [y1, y2, y3, y4]);\n  }\n  var cubics = divideCubic(x1, y1, x2, y2, x3, y3, x4, y4, 0.5);\n  var left = [].concat(_toConsumableArray(cubics[0]), [iterationCount - 1]);\n  var right = [].concat(_toConsumableArray(cubics[1]), [iterationCount - 1]);\n  return cubicLength.apply(void 0, _toConsumableArray(left)) + cubicLength.apply(void 0, _toConsumableArray(right));\n}\nfunction box$3(x1, y1, x2, y2, x3, y3, x4, y4) {\n  var xArr = [x1, x4];\n  var yArr = [y1, y4];\n  var xExtrema = extrema$1(x1, x2, x3, x4);\n  var yExtrema = extrema$1(y1, y2, y3, y4);\n  for (var i = 0; i < xExtrema.length; i++) {\n    xArr.push(cubicAt(x1, x2, x3, x4, xExtrema[i]));\n  }\n  for (var _i = 0; _i < yExtrema.length; _i++) {\n    yArr.push(cubicAt(y1, y2, y3, y4, yExtrema[_i]));\n  }\n  return getBBoxByArray(xArr, yArr);\n}\nfunction length$3(x1, y1, x2, y2, x3, y3, x4, y4) {\n  //  8 \n  return cubicLength(x1, y1, x2, y2, x3, y3, x4, y4, 3);\n}\nfunction nearestPoint$1(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length) {\n  return nearestPoint$2([x1, x2, x3, x4], [y1, y2, y3, y4], x0, y0, cubicAt, length);\n}\nfunction pointDistance$3(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length) {\n  var point = nearestPoint$1(x1, y1, x2, y2, x3, y3, x4, y4, x0, y0, length);\n  return distance(point.x, point.y, x0, y0);\n}\nfunction pointAt$2(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n  return {\n    x: cubicAt(x1, x2, x3, x4, t),\n    y: cubicAt(y1, y2, y3, y4, t)\n  };\n}\nfunction tangentAngle$2(x1, y1, x2, y2, x3, y3, x4, y4, t) {\n  var dx = derivativeAt(x1, x2, x3, x4, t);\n  var dy = derivativeAt(y1, y2, y3, y4, t);\n  return piMod(Math.atan2(dy, dx));\n}\n\nfunction analyzePoints(points) {\n  // \n  var totalLength = 0;\n  var segments = [];\n  for (var i = 0; i < points.length - 1; i++) {\n    var from = points[i];\n    var to = points[i + 1];\n    var length = distance(from[0], from[1], to[0], to[1]);\n    var seg = {\n      from: from,\n      to: to,\n      length: length\n    };\n    segments.push(seg);\n    totalLength += length;\n  }\n  return {\n    segments: segments,\n    totalLength: totalLength\n  };\n}\nfunction lengthOfSegment(points) {\n  if (points.length < 2) {\n    return 0;\n  }\n  var totalLength = 0;\n  for (var i = 0; i < points.length - 1; i++) {\n    var from = points[i];\n    var to = points[i + 1];\n    totalLength += distance(from[0], from[1], to[0], to[1]);\n  }\n  return totalLength;\n}\n\n/**\n * \n * @param {array} points \n * @param {number} t  0-1\n * @return {object} \n */\nfunction pointAtSegments(points, t) {\n  // \n  if (t > 1 || t < 0 || points.length < 2) {\n    return null;\n  }\n  var _analyzePoints = analyzePoints(points),\n    segments = _analyzePoints.segments,\n    totalLength = _analyzePoints.totalLength;\n  // \n  if (totalLength === 0) {\n    return {\n      x: points[0][0],\n      y: points[0][1]\n    };\n  }\n  // \n  var startRatio = 0;\n  var point = null;\n  for (var i = 0; i < segments.length; i++) {\n    var seg = segments[i];\n    var from = seg.from,\n      to = seg.to;\n    var currentRatio = seg.length / totalLength;\n    if (t >= startRatio && t <= startRatio + currentRatio) {\n      var localRatio = (t - startRatio) / currentRatio;\n      point = pointAt$3(from[0], from[1], to[0], to[1], localRatio);\n      break;\n    }\n    startRatio += currentRatio;\n  }\n  return point;\n}\n\n/**\n * \n * @param {array} points \n * @param {number} t  0-1\n */\nfunction angleAtSegments(points, t) {\n  // \n  if (t > 1 || t < 0 || points.length < 2) {\n    return 0;\n  }\n  var _analyzePoints2 = analyzePoints(points),\n    segments = _analyzePoints2.segments,\n    totalLength = _analyzePoints2.totalLength;\n  // \n  var startRatio = 0;\n  var angle = 0;\n  for (var i = 0; i < segments.length; i++) {\n    var seg = segments[i];\n    var from = seg.from,\n      to = seg.to;\n    var currentRatio = seg.length / totalLength;\n    if (t >= startRatio && t <= startRatio + currentRatio) {\n      angle = Math.atan2(to[1] - from[1], to[0] - from[0]);\n      break;\n    }\n    startRatio += currentRatio;\n  }\n  return angle;\n}\nfunction distanceAtSegment(points, x, y) {\n  var minDistance = Infinity;\n  for (var i = 0; i < points.length - 1; i++) {\n    var point = points[i];\n    var nextPoint = points[i + 1];\n    var _distance = pointDistance$4(point[0], point[1], nextPoint[0], nextPoint[1], x, y);\n    if (_distance < minDistance) {\n      minDistance = _distance;\n    }\n  }\n  return minDistance;\n}\n\nfunction box$2(points) {\n  var xArr = [];\n  var yArr = [];\n  for (var i = 0; i < points.length; i++) {\n    var point = points[i];\n    xArr.push(point[0]);\n    yArr.push(point[1]);\n  }\n  return getBBoxByArray(xArr, yArr);\n}\nfunction length$2(points) {\n  return lengthOfSegment(points);\n}\nfunction pointAt$1(points, t) {\n  return pointAtSegments(points, t);\n}\nfunction pointDistance$2(points, x, y) {\n  return distanceAtSegment(points, x, y);\n}\nfunction tangentAngle$1(points, t) {\n  return angleAtSegments(points, t);\n}\n\nfunction getAllPoints(points) {\n  var tmp = points.slice(0);\n  if (points.length) {\n    tmp.push(points[0]);\n  }\n  return tmp;\n}\nfunction box$1(points) {\n  return box$2(points);\n}\nfunction length$1(points) {\n  return lengthOfSegment(getAllPoints(points));\n}\nfunction pointAt(points, t) {\n  return pointAtSegments(getAllPoints(points), t);\n}\nfunction pointDistance$1(points, x, y) {\n  return distanceAtSegment(getAllPoints(points), x, y);\n}\nfunction tangentAngle(points, t) {\n  return angleAtSegments(getAllPoints(points), t);\n}\n\n// \nfunction quadraticAt(p0, p1, p2, t) {\n  var onet = 1 - t;\n  return onet * onet * p0 + 2 * t * onet * p1 + t * t * p2;\n}\n\n// \nfunction extrema(p0, p1, p2) {\n  var a = p0 + p2 - 2 * p1;\n  if (isNumberEqual(a, 0)) {\n    return [0.5];\n  }\n  var rst = (p0 - p1) / a;\n  if (rst <= 1 && rst >= 0) {\n    return [rst];\n  }\n  return [];\n}\n\n// \nfunction divideQuadratic(x1, y1, x2, y2, x3, y3, t) {\n  // \n  var xt = quadraticAt(x1, x2, x3, t);\n  var yt = quadraticAt(y1, y2, y3, t);\n\n  // \n  var controlPoint1 = pointAt$3(x1, y1, x2, y2, t);\n  // \n  var controlPoint2 = pointAt$3(x2, y2, x3, y3, t);\n  return [[x1, y1, controlPoint1.x, controlPoint1.y, xt, yt], [xt, yt, controlPoint2.x, controlPoint2.y, x3, y3]];\n}\n\n// \nfunction quadraticLength(x1, y1, x2, y2, x3, y3, iterationCount) {\n  if (iterationCount === 0) {\n    return (distance(x1, y1, x2, y2) + distance(x2, y2, x3, y3) + distance(x1, y1, x3, y3)) / 2;\n  }\n  var quadratics = divideQuadratic(x1, y1, x2, y2, x3, y3, 0.5);\n  var left = quadratics[0];\n  var right = quadratics[1];\n  left.push(iterationCount - 1);\n  right.push(iterationCount - 1);\n  return quadraticLength.apply(void 0, _toConsumableArray(left)) + quadraticLength.apply(void 0, _toConsumableArray(right));\n}\nfunction box(x1, y1, x2, y2, x3, y3) {\n  var xExtrema = extrema(x1, x2, x3)[0];\n  var yExtrema = extrema(y1, y2, y3)[0];\n  //  box \n  var xArr = [x1, x3];\n  var yArr = [y1, y3];\n  if (xExtrema !== undefined) {\n    xArr.push(quadraticAt(x1, x2, x3, xExtrema));\n  }\n  if (yExtrema !== undefined) {\n    yArr.push(quadraticAt(y1, y2, y3, yExtrema));\n  }\n  return getBBoxByArray(xArr, yArr);\n}\nfunction length(x1, y1, x2, y2, x3, y3) {\n  return quadraticLength(x1, y1, x2, y2, x3, y3, 3);\n}\nfunction nearestPoint(x1, y1, x2, y2, x3, y3, x0, y0) {\n  return nearestPoint$2([x1, x2, x3], [y1, y2, y3], x0, y0, quadraticAt);\n}\nfunction pointDistance(x1, y1, x2, y2, x3, y3, x0, y0) {\n  var point = nearestPoint(x1, y1, x2, y2, x3, y3, x0, y0);\n  return distance(point.x, point.y, x0, y0);\n}\n\nexport { box$5 as arcBox, nearestPoint$3 as arcNearestPoint, tangentAngle$4 as arcTangentAngle, box$3 as cubicBox, length$3 as cubicLength, nearestPoint$1 as cubicNearestPoint, pointAt$2 as cubicPointAt, pointDistance$3 as cubicPointDistance, tangentAngle$2 as cubicTangentAngle, distance, box$4 as lineBox, length$4 as lineLength, pointAt$3 as linePointAt, pointDistance$4 as linePointDistance, pointToLine as linePointToLine, tangentAngle$3 as lineTangentAngle, box$1 as polygonBox, length$1 as polygonLength, pointAt as polygonPointAt, pointDistance$1 as polygonPointDistance, tangentAngle as polygonTangentAngle, box$2 as polylineBox, length$2 as polylineLength, pointAt$1 as polylinePointAt, pointDistance$2 as polylinePointDistance, tangentAngle$1 as polylineTangentAngle, box as quadBox, length as quadLength, nearestPoint as quadNearestPoint, pointDistance as quadPointDistance };\n//# sourceMappingURL=index.esm.js.map\n","import type {\n  CircleStyleProps,\n  DisplayObject,\n  ParsedCircleStyleProps,\n  Point,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { distance } from '@antv/g-math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<CircleStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    cx = 0,\n    cy = 0,\n    r,\n    fill,\n    stroke,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedCircleStyleProps;\n  const halfLineWidth = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  const absDistance = distance(cx, cy, position.x, position.y);\n\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  if ((hasFill && hasStroke) || isClipPath) {\n    return absDistance <= r + halfLineWidth;\n  }\n  if (hasFill) {\n    return absDistance <= r;\n  }\n  if (hasStroke) {\n    return absDistance >= r - halfLineWidth && absDistance <= r + halfLineWidth;\n  }\n  return false;\n}\n","import type {\n  DisplayObject,\n  EllipseStyleProps,\n  ParsedEllipseStyleProps,\n  Point,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\n\nfunction ellipseDistance(\n  squareX: number,\n  squareY: number,\n  rx: number,\n  ry: number,\n) {\n  return squareX / (rx * rx) + squareY / (ry * ry);\n}\n\nexport function isPointInPath(\n  displayObject: DisplayObject<EllipseStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    cx = 0,\n    cy = 0,\n    rx,\n    ry,\n    fill,\n    stroke,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedEllipseStyleProps;\n\n  const { x, y } = position;\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  const halfLineWith = (lineWidth + increasedLineWidthForHitTesting) / 2;\n  const squareX = (x - cx) * (x - cx);\n  const squareY = (y - cy) * (y - cy);\n  //  x*x/rx*rx + y*y/ry*ry = 1;\n  if ((hasFill && hasStroke) || isClipPath) {\n    return (\n      ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <=\n      1\n    );\n  }\n  if (hasFill) {\n    return ellipseDistance(squareX, squareY, rx, ry) <= 1;\n  }\n  if (hasStroke) {\n    return (\n      ellipseDistance(squareX, squareY, rx - halfLineWith, ry - halfLineWith) >=\n        1 &&\n      ellipseDistance(squareX, squareY, rx + halfLineWith, ry + halfLineWith) <=\n        1\n    );\n  }\n  return false;\n}\n","import { distance, linePointToLine } from '@antv/g-math';\n\nexport function inBox(\n  minX: number,\n  minY: number,\n  width: number,\n  height: number,\n  x: number,\n  y: number,\n) {\n  return x >= minX && x <= minX + width && y >= minY && y <= minY + height;\n}\n\nexport function inRect(\n  minX: number,\n  minY: number,\n  width: number,\n  height: number,\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const halfWidth = lineWidth / 2;\n  // \n  return (\n    inBox(minX - halfWidth, minY - halfWidth, width, lineWidth, x, y) || // \n    inBox(\n      minX + width - halfWidth,\n      minY - halfWidth,\n      lineWidth,\n      height,\n      x,\n      y,\n    ) || // \n    inBox(\n      minX + halfWidth,\n      minY + height - halfWidth,\n      width,\n      lineWidth,\n      x,\n      y,\n    ) || // \n    inBox(minX - halfWidth, minY + halfWidth, lineWidth, height, x, y)\n  ); // \n}\n\nexport function inArc(\n  cx: number,\n  cy: number,\n  r: number,\n  startAngle: number,\n  endAngle: number,\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const angle = (Math.atan2(y - cy, x - cx) + Math.PI * 2) % (Math.PI * 2); //  0 - 2 * Math.PI \n  // if (angle < startAngle || angle > endAngle) {\n  //   return false;\n  // }\n  const point = {\n    x: cx + r * Math.cos(angle),\n    y: cy + r * Math.sin(angle),\n  };\n\n  return distance(point.x, point.y, x, y) <= lineWidth / 2;\n}\n\nexport function inLine(\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const minX = Math.min(x1, x2);\n  const maxX = Math.max(x1, x2);\n  const minY = Math.min(y1, y2);\n  const maxY = Math.max(y1, y2);\n  const halfWidth = lineWidth / 2;\n  // \n  //  lineWidth \n  if (\n    !(\n      x >= minX - halfWidth &&\n      x <= maxX + halfWidth &&\n      y >= minY - halfWidth &&\n      y <= maxY + halfWidth\n    )\n  ) {\n    return false;\n  }\n  // \n  return linePointToLine(x1, y1, x2, y2, x, y) <= lineWidth / 2;\n}\n\nexport function inPolyline(\n  points: any[],\n  lineWidth: number,\n  x: number,\n  y: number,\n  isClose: boolean,\n) {\n  const count = points.length;\n  if (count < 2) {\n    return false;\n  }\n  for (let i = 0; i < count - 1; i++) {\n    const x1 = points[i][0];\n    const y1 = points[i][1];\n    const x2 = points[i + 1][0];\n    const y2 = points[i + 1][1];\n\n    if (inLine(x1, y1, x2, y2, lineWidth, x, y)) {\n      return true;\n    }\n  }\n\n  // \n  if (isClose) {\n    const first = points[0];\n    const last = points[count - 1];\n    if (inLine(first[0], first[1], last[0], last[1], lineWidth, x, y)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// https://blog.csdn.net/WilliamSun0122/article/details/77994526\nconst tolerance = 1e-6;\n// doubleeps\nfunction dcmp(x: number) {\n  if (Math.abs(x) < tolerance) {\n    return 0;\n  }\n\n  return x < 0 ? -1 : 1;\n}\n\n// Qp1p2\nfunction onSegment(p1: any, p2: any, q: any) {\n  if (\n    (q[0] - p1[0]) * (p2[1] - p1[1]) === (p2[0] - p1[0]) * (q[1] - p1[1]) &&\n    Math.min(p1[0], p2[0]) <= q[0] &&\n    q[0] <= Math.max(p1[0], p2[0]) &&\n    Math.min(p1[1], p2[1]) <= q[1] &&\n    q[1] <= Math.max(p1[1], p2[1])\n  ) {\n    return true;\n  }\n  return false;\n}\n\n// P-\nexport function inPolygon(points: any[], x: number, y: number) {\n  let isHit = false;\n  const n = points.length;\n  if (n <= 2) {\n    // svg  3 \n    return false;\n  }\n  for (let i = 0; i < n; i++) {\n    const p1 = points[i];\n    const p2 = points[(i + 1) % n];\n    if (onSegment(p1, p2, [x, y])) {\n      // \n      return true;\n    }\n    // min(p1[1],p2[1])<P.y<=max(p1[1],p2[1])\n    //    \n    if (\n      dcmp(p1[1] - y) > 0 !== dcmp(p2[1] - y) > 0 &&\n      dcmp(x - ((y - p1[1]) * (p1[0] - p2[0])) / (p1[1] - p2[1]) - p1[0]) < 0\n    ) {\n      isHit = !isHit;\n    }\n  }\n  return isHit;\n}\nexport function inPolygons(polygons: any[], x: number, y: number): boolean {\n  let isHit = false;\n  for (let i = 0; i < polygons.length; i++) {\n    const points = polygons[i];\n    isHit = inPolygon(points, x, y);\n    if (isHit) {\n      break;\n    }\n  }\n  return isHit;\n}\n","import type {\n  DisplayObject,\n  LineStyleProps,\n  ParsedLineStyleProps,\n  Point,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { inLine } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<LineStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    x1,\n    y1,\n    x2,\n    y2,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    pointerEvents = 'auto',\n    fill,\n    stroke,\n  } = displayObject.parsedStyle as ParsedLineStyleProps;\n\n  const [, hasStroke] = isFillOrStrokeAffected(pointerEvents, fill, stroke);\n\n  if ((!hasStroke && !isClipPath) || !lineWidth) {\n    return false;\n  }\n\n  return inLine(\n    x1,\n    y1,\n    x2,\n    y2,\n    lineWidth + increasedLineWidthForHitTesting,\n    position.x,\n    position.y,\n  );\n}\n","import type {\n  DisplayObject,\n  GlobalRuntime,\n  ParsedPathStyleProps,\n  Path,\n  PathSegment,\n  PathStyleProps,\n  Point,\n  RenderingPluginContext,\n} from '@antv/g-lite';\nimport {\n  getOrCalculatePathTotalLength,\n  isFillOrStrokeAffected,\n} from '@antv/g-lite';\nimport { cubicPointDistance, quadPointDistance } from '@antv/g-math';\nimport { arcToCubic } from '@antv/util';\nimport { inBox, inLine, inPolygons } from './utils/math';\n\n// TODO: replace it with method in @antv/util\nfunction isPointInStroke(\n  segments: PathSegment[],\n  lineWidth: number,\n  px: number,\n  py: number,\n  length: number,\n) {\n  let isHit = false;\n  const halfWidth = lineWidth / 2;\n  for (let i = 0; i < segments.length; i++) {\n    const segment = segments[i];\n    const { currentPoint, params, prePoint, box } = segment;\n    // \n    if (\n      box &&\n      !inBox(\n        box.x - halfWidth,\n        box.y - halfWidth,\n        box.width + lineWidth,\n        box.height + lineWidth,\n        px,\n        py,\n      )\n    ) {\n      continue;\n    }\n    switch (segment.command) {\n      // L  Z  M \n      case 'L':\n      case 'Z':\n        isHit = inLine(\n          prePoint[0],\n          prePoint[1],\n          currentPoint[0],\n          currentPoint[1],\n          lineWidth,\n          px,\n          py,\n        );\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'Q':\n        const qDistance = quadPointDistance(\n          prePoint[0],\n          prePoint[1],\n          params[1],\n          params[2],\n          params[3],\n          params[4],\n          px,\n          py,\n        );\n        isHit = qDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'C':\n        const cDistance = cubicPointDistance(\n          prePoint[0], // ,  C \n          prePoint[1],\n          params[1], // 'C' 12 34 56 \n          params[2],\n          params[3],\n          params[4],\n          params[5],\n          params[6],\n          px,\n          py,\n          length,\n        );\n        isHit = cDistance <= lineWidth / 2;\n        if (isHit) {\n          return true;\n        }\n        break;\n      case 'A':\n        // cache conversion result\n        if (!segment.cubicParams) {\n          segment.cubicParams = arcToCubic(\n            prePoint[0],\n            prePoint[1],\n            params[1],\n            params[2],\n            params[3],\n            params[4],\n            params[5],\n            params[6],\n            params[7],\n            undefined,\n          ) as [number, number, number, number, number, number];\n        }\n\n        const args = segment.cubicParams;\n\n        // fixArc\n        let prePointInCubic = prePoint;\n        for (let i = 0; i < args.length; i += 6) {\n          const cDistance = cubicPointDistance(\n            prePointInCubic[0], // ,  C \n            prePointInCubic[1],\n            args[i],\n            args[i + 1],\n            args[i + 2],\n            args[i + 3],\n            args[i + 4],\n            args[i + 5],\n            px,\n            py,\n            length,\n          );\n          prePointInCubic = [args[i + 4], args[i + 5]];\n          isHit = cDistance <= lineWidth / 2;\n\n          if (isHit) {\n            return true;\n          }\n        }\n        break;\n      default:\n        break;\n    }\n  }\n  return isHit;\n}\n\nexport function isPointInPath(\n  displayObject: DisplayObject<PathStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<PathStyleProps>,\n    position: Point,\n  ) => boolean,\n  renderingPluginContext: RenderingPluginContext,\n  runtime: GlobalRuntime,\n): boolean {\n  const {\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    stroke,\n    fill,\n    d,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedPathStyleProps;\n\n  const { segments, hasArc, polylines, polygons } = d;\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    // Only a closed path can be filled.\n    polygons?.length && fill,\n    stroke,\n  );\n\n  const totalLength = getOrCalculatePathTotalLength(displayObject as Path);\n\n  let isHit = false;\n\n  if (hasFill || isClipPath) {\n    if (hasArc) {\n      //  canvas  api \n      isHit = isPointInPath(displayObject, position);\n    } else {\n      // \n      isHit =\n        inPolygons(polygons, position.x, position.y) ||\n        inPolygons(polylines, position.x, position.y);\n    }\n    return isHit;\n  }\n  if (hasStroke || isClipPath) {\n    isHit = isPointInStroke(\n      segments,\n      lineWidth + increasedLineWidthForHitTesting,\n      position.x,\n      position.y,\n      totalLength,\n    );\n  }\n\n  return isHit;\n}\n","import type {\n  DisplayObject,\n  ParsedPolygonStyleProps,\n  Point,\n  PolylineStyleProps,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { inPolygon, inPolyline } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<PolylineStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    stroke,\n    fill,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    points,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedPolygonStyleProps;\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  let isHit = false;\n  if (hasStroke || isClipPath) {\n    isHit = inPolyline(\n      points.points,\n      lineWidth + increasedLineWidthForHitTesting,\n      position.x,\n      position.y,\n      true,\n    );\n  }\n  if (!isHit && (hasFill || isClipPath)) {\n    isHit = inPolygon(points.points, position.x, position.y);\n  }\n  return isHit;\n}\n","import type {\n  DisplayObject,\n  ParsedPolylineStyleProps,\n  Point,\n  PolylineStyleProps,\n} from '@antv/g-lite';\nimport { isFillOrStrokeAffected } from '@antv/g-lite';\nimport { inPolyline } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<PolylineStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n): boolean {\n  const {\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    points,\n    pointerEvents = 'auto',\n    fill,\n    stroke,\n  } = displayObject.parsedStyle as ParsedPolylineStyleProps;\n  const [, hasStroke] = isFillOrStrokeAffected(pointerEvents, fill, stroke);\n\n  if ((!hasStroke && !isClipPath) || !lineWidth) {\n    return false;\n  }\n\n  return inPolyline(\n    points.points,\n    lineWidth + increasedLineWidthForHitTesting,\n    position.x,\n    position.y,\n    false,\n  );\n}\n","import type {\n  DisplayObject,\n  ParsedRectStyleProps,\n  Point,\n  RectStyleProps,\n} from '@antv/g-lite';\nimport { GlobalRuntime, isFillOrStrokeAffected } from '@antv/g-lite';\nimport { clamp } from '@antv/util';\nimport { inArc, inBox, inLine, inRect } from './utils/math';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<RectStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<RectStyleProps>,\n    position: Point,\n  ) => boolean,\n  runtime: GlobalRuntime,\n): boolean {\n  const {\n    radius,\n    fill,\n    stroke,\n    lineWidth = 1,\n    increasedLineWidthForHitTesting = 0,\n    x = 0,\n    y = 0,\n    width,\n    height,\n    pointerEvents = 'auto',\n  } = displayObject.parsedStyle as ParsedRectStyleProps;\n\n  const [hasFill, hasStroke] = isFillOrStrokeAffected(\n    pointerEvents,\n    fill,\n    stroke,\n  );\n\n  const hasRadius = radius && radius.some((r) => r !== 0);\n\n  const lineWidthForHitTesting = lineWidth + increasedLineWidthForHitTesting;\n\n  // \n  if (!hasRadius) {\n    const halfWidth = lineWidthForHitTesting / 2;\n    // \n    if ((hasFill && hasStroke) || isClipPath) {\n      return inBox(\n        x - halfWidth,\n        y - halfWidth,\n        width + halfWidth,\n        height + halfWidth,\n        position.x,\n        position.y,\n      );\n    }\n    // \n    if (hasFill) {\n      return inBox(x, y, width, height, position.x, position.y);\n    }\n    if (hasStroke) {\n      return inRect(\n        x,\n        y,\n        width,\n        height,\n        lineWidthForHitTesting,\n        position.x,\n        position.y,\n      );\n    }\n  } else {\n    let isHit = false;\n    if (hasStroke || isClipPath) {\n      isHit = inRectWithRadius(\n        x,\n        y,\n        width,\n        height,\n        radius.map((r) =>\n          clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2)),\n        ) as [number, number, number, number],\n        lineWidthForHitTesting,\n        position.x,\n        position.y,\n      );\n    }\n    // \n    // \n    if (!isHit && (hasFill || isClipPath)) {\n      isHit = isPointInPath(displayObject, position);\n    }\n    return isHit;\n  }\n\n  return false;\n}\n\nfunction inRectWithRadius(\n  minX: number,\n  minY: number,\n  width: number,\n  height: number,\n  radiusArray: [number, number, number, number],\n  lineWidth: number,\n  x: number,\n  y: number,\n) {\n  const [tlr, trr, brr, blr] = radiusArray;\n  return (\n    inLine(minX + tlr, minY, minX + width - trr, minY, lineWidth, x, y) ||\n    inLine(\n      minX + width,\n      minY + trr,\n      minX + width,\n      minY + height - brr,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inLine(\n      minX + width - brr,\n      minY + height,\n      minX + blr,\n      minY + height,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inLine(minX, minY + height - blr, minX, minY + tlr, lineWidth, x, y) ||\n    inArc(\n      minX + width - trr,\n      minY + trr,\n      trr,\n      1.5 * Math.PI,\n      2 * Math.PI,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inArc(\n      minX + width - brr,\n      minY + height - brr,\n      brr,\n      0,\n      0.5 * Math.PI,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inArc(\n      minX + blr,\n      minY + height - blr,\n      blr,\n      0.5 * Math.PI,\n      Math.PI,\n      lineWidth,\n      x,\n      y,\n    ) ||\n    inArc(minX + tlr, minY + tlr, tlr, Math.PI, 1.5 * Math.PI, lineWidth, x, y)\n  );\n}\n","import {\n  DisplayObject,\n  ParsedImageStyleProps,\n  Point,\n  ImageStyleProps,\n  Shape,\n  RenderingPluginContext,\n  GlobalRuntime,\n} from '@antv/g-lite';\nimport { StyleRenderer } from '../canvas-renderer';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<ImageStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<ImageStyleProps>,\n    position: Point,\n  ) => boolean,\n  renderingPluginContext: RenderingPluginContext,\n  runtime: GlobalRuntime,\n): boolean {\n  const {\n    pointerEvents = 'auto',\n    x = 0,\n    y = 0,\n    width,\n    height,\n  } = displayObject.parsedStyle as ParsedImageStyleProps;\n\n  if (pointerEvents === 'non-transparent-pixel') {\n    const { offscreenCanvas } = renderingPluginContext.config;\n    const canvas =\n      runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n    const context = runtime.offscreenCanvasCreator.getOrCreateContext(\n      offscreenCanvas,\n      {\n        willReadFrequently: true,\n      },\n    ) as CanvasRenderingContext2D;\n    canvas.width = width;\n    canvas.height = height;\n\n    (\n      (renderingPluginContext as any).defaultStyleRendererFactory as Record<\n        Shape,\n        StyleRenderer\n      >\n    )[Shape.IMAGE].render(\n      context,\n      { ...displayObject.parsedStyle, x: 0, y: 0 },\n      displayObject,\n      undefined,\n      undefined,\n      undefined,\n    );\n\n    const imagedata = context.getImageData(\n      position.x - x,\n      position.y - y,\n      1,\n      1,\n    ).data;\n    return imagedata.every((component) => component !== 0);\n  }\n\n  return true;\n}\n","import type { DisplayObject, Point, TextStyleProps } from '@antv/g-lite';\n\nexport function isPointInPath(\n  displayObject: DisplayObject<TextStyleProps>,\n  position: Point,\n  isClipPath: boolean,\n  isPointInPath: (\n    displayObject: DisplayObject<TextStyleProps>,\n    position: Point,\n  ) => boolean,\n): boolean {\n  const bounds = displayObject.getGeometryBounds();\n\n  // @see https://stackoverflow.com/questions/28706989/how-do-i-check-if-a-mouse-click-is-inside-a-rotated-text-on-the-html5-canvas-in\n  return (\n    position.x >= bounds.min[0] &&\n    position.y >= bounds.min[1] &&\n    position.x <= bounds.max[0] &&\n    position.y <= bounds.max[1]\n  );\n}\n","import { AbstractRendererPlugin, Shape } from '@antv/g-lite';\nimport type { PointInPathPicker } from './CanvasPickerPlugin';\nimport { CanvasPickerPlugin } from './CanvasPickerPlugin';\nimport { isPointInPath as CirclePicker } from './Circle';\nimport { isPointInPath as EllipsePicker } from './Ellipse';\nimport { isPointInPath as LinePicker } from './Line';\nimport { isPointInPath as PathPicker } from './Path';\nimport { isPointInPath as PolygonPicker } from './Polygon';\nimport { isPointInPath as PolylinePicker } from './Polyline';\nimport { isPointInPath as RectPicker } from './Rect';\nimport { isPointInPath as ImagePicker } from './Image';\nimport { isPointInPath as TextPicker } from './Text';\n\nexport class Plugin extends AbstractRendererPlugin {\n  name = 'canvas-picker';\n  init(): void {\n    const pointInPathPickerFactory: Record<Shape, PointInPathPicker<any>> = {\n      [Shape.CIRCLE]: CirclePicker,\n      [Shape.ELLIPSE]: EllipsePicker,\n      [Shape.RECT]: RectPicker,\n      [Shape.LINE]: LinePicker,\n      [Shape.POLYLINE]: PolylinePicker,\n      [Shape.POLYGON]: PolygonPicker,\n      [Shape.PATH]: PathPicker,\n      [Shape.TEXT]: TextPicker,\n      [Shape.GROUP]: null,\n      [Shape.IMAGE]: ImagePicker,\n      [Shape.HTML]: null,\n      [Shape.MESH]: null,\n    };\n\n    // @ts-ignore\n    this.context.pointInPathPickerFactory = pointInPathPickerFactory;\n\n    this.addRenderingPlugin(new CanvasPickerPlugin());\n  }\n  destroy(): void {\n    // @ts-ignore\n    delete this.context.pointInPathPickerFactory;\n    this.removeAllRenderingPlugins();\n  }\n}\n","import type { ParsedCircleStyleProps } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedCircleStyleProps,\n) {\n  const { cx = 0, cy = 0, r } = parsedStyle;\n  context.arc(cx, cy, r, 0, Math.PI * 2, false);\n}\n","import type { ParsedEllipseStyleProps } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedEllipseStyleProps,\n) {\n  const { cx = 0, cy = 0, rx, ry } = parsedStyle;\n\n  // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n  if (context.ellipse) {\n    context.ellipse(cx, cy, rx, ry, 0, 0, Math.PI * 2, false);\n  } else {\n    // \n    const r = rx > ry ? rx : ry;\n    const scaleX = rx > ry ? 1 : rx / ry;\n    const scaleY = rx > ry ? ry / rx : 1;\n    context.save();\n    context.scale(scaleX, scaleY);\n    context.arc(cx, cy, r, 0, Math.PI * 2);\n  }\n}\n","import type { ParsedLineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedLineStyleProps,\n) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2,\n    markerStart,\n    markerEnd,\n    markerStartOffset,\n    markerEndOffset,\n  } = parsedStyle;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = x2 - x1;\n    y = y2 - y1;\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = x1 - x2;\n    y = y1 - y2;\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  context.moveTo(x1 + startOffsetX, y1 + startOffsetY);\n  context.lineTo(x2 + endOffsetX, y2 + endOffsetY);\n}\n","import type { ParsedPathStyleProps, Path } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedPathStyleProps,\n) {\n  const { markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n  const { absolutePath, segments } = parsedStyle.d;\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    const [p1, p2] = (markerStart.parentNode as Path).getStartTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    const [p1, p2] = (markerEnd.parentNode as Path).getEndTangent();\n    x = p1[0] - p2[0];\n    y = p1[1] - p2[1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  for (let i = 0; i < absolutePath.length; i++) {\n    const params = absolutePath[i];\n    const command = params[0];\n    const nextSegment = absolutePath[i + 1];\n    const useStartOffset =\n      i === 0 && (startOffsetX !== 0 || startOffsetY !== 0);\n    const useEndOffset =\n      (i === absolutePath.length - 1 ||\n        (nextSegment && (nextSegment[0] === 'M' || nextSegment[0] === 'Z'))) &&\n      endOffsetX !== 0 &&\n      endOffsetY !== 0;\n    const [startOffsetXTemp, startOffsetYTemp] = useStartOffset\n      ? [startOffsetX, startOffsetY]\n      : [0, 0];\n    const [endOffsetXTemp, endOffsetYTemp] = useEndOffset\n      ? [endOffsetX, endOffsetY]\n      : [0, 0];\n\n    switch (command) {\n      case 'M':\n        // Use start marker offset\n        context.moveTo(\n          params[1] + startOffsetXTemp,\n          params[2] + startOffsetYTemp,\n        );\n        break;\n      case 'L':\n        context.lineTo(params[1] + endOffsetXTemp, params[2] + endOffsetYTemp);\n        break;\n      case 'Q':\n        context.quadraticCurveTo(\n          params[1],\n          params[2],\n          params[3] + endOffsetXTemp,\n          params[4] + endOffsetYTemp,\n        );\n        break;\n      case 'C':\n        context.bezierCurveTo(\n          params[1],\n          params[2],\n          params[3],\n          params[4],\n          params[5] + endOffsetXTemp,\n          params[6] + endOffsetYTemp,\n        );\n        break;\n      case 'A': {\n        // FIXME startOffset / endOffset\n        const { arcParams } = segments[i];\n        const { cx, cy, rx, ry, startAngle, endAngle, xRotation, sweepFlag } =\n          arcParams;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/ellipse\n        if (context.ellipse) {\n          context.ellipse(\n            cx,\n            cy,\n            rx,\n            ry,\n            xRotation,\n            startAngle,\n            endAngle,\n            !!(1 - sweepFlag),\n          );\n        } else {\n          // @see https://stackoverflow.com/a/47494351\n          const r = rx > ry ? rx : ry;\n          const scaleX = rx > ry ? 1 : rx / ry;\n          const scaleY = rx > ry ? ry / rx : 1;\n          context.translate(cx, cy);\n          context.rotate(xRotation);\n          context.scale(scaleX, scaleY);\n          context.arc(0, 0, r, startAngle, endAngle, !!(1 - sweepFlag));\n          context.scale(1 / scaleX, 1 / scaleY);\n          context.rotate(-xRotation);\n          context.translate(-cx, -cy);\n        }\n\n        if (useEndOffset) {\n          context.lineTo(params[6] + endOffsetX, params[7] + endOffsetY);\n        }\n        break;\n      }\n      case 'Z':\n        context.closePath();\n        break;\n      default:\n        break;\n    }\n  }\n}\n","import type { ParsedPolygonStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedPolygonStyleProps,\n) {\n  const { markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n  const { points } = parsedStyle.points;\n  const { length } = points;\n\n  const x1 = points[0][0];\n  const y1 = points[0][1];\n  const x2 = points[length - 1][0];\n  const y2 = points[length - 1][1];\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = points[1][0] - points[0][0];\n    y = points[1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = points[length - 1][0] - points[0][0];\n    y = points[length - 1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  context.moveTo(\n    x1 + (startOffsetX || endOffsetX),\n    y1 + (startOffsetY || endOffsetY),\n  );\n  for (let i = 1; i < length - 1; i++) {\n    const point = points[i];\n    context.lineTo(point[0], point[1]);\n  }\n  context.lineTo(x2, y2);\n}\n","import type { ParsedPolylineStyleProps } from '@antv/g-lite';\nimport { isDisplayObject } from '@antv/g-lite';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedPolylineStyleProps,\n) {\n  const { markerStart, markerEnd, markerStartOffset, markerEndOffset } =\n    parsedStyle;\n  const { points } = parsedStyle.points;\n  const { length } = points;\n\n  const x1 = points[0][0];\n  const y1 = points[0][1];\n  const x2 = points[length - 1][0];\n  const y2 = points[length - 1][1];\n\n  let startOffsetX = 0;\n  let startOffsetY = 0;\n  let endOffsetX = 0;\n  let endOffsetY = 0;\n\n  let rad = 0;\n  let x: number;\n  let y: number;\n\n  if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n    x = points[1][0] - points[0][0];\n    y = points[1][1] - points[0][1];\n    rad = Math.atan2(y, x);\n    startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n    startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n  }\n\n  if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n    x = points[length - 2][0] - points[length - 1][0];\n    y = points[length - 2][1] - points[length - 1][1];\n    rad = Math.atan2(y, x);\n    endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n    endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n  }\n\n  context.moveTo(x1 + startOffsetX, y1 + startOffsetY);\n  for (let i = 1; i < length - 1; i++) {\n    const point = points[i];\n    context.lineTo(point[0], point[1]);\n  }\n  context.lineTo(x2 + endOffsetX, y2 + endOffsetY);\n}\n","import type { ParsedRectStyleProps } from '@antv/g-lite';\nimport { clamp } from '@antv/util';\n\nexport function generatePath(\n  context: CanvasRenderingContext2D,\n  parsedStyle: ParsedRectStyleProps,\n) {\n  const { x = 0, y = 0, radius, width, height } = parsedStyle;\n\n  const w = width;\n  const h = height;\n  const hasRadius = radius && radius.some((r) => r !== 0);\n\n  if (!hasRadius) {\n    // Canvas support negative width/height of rect\n    context.rect(x, y, w, h);\n  } else {\n    const signX = width > 0 ? 1 : -1;\n    const signY = height > 0 ? 1 : -1;\n    const sweepFlag = signX + signY === 0;\n    const [tlr, trr, brr, blr] = radius.map((r) =>\n      clamp(r, 0, Math.min(Math.abs(w) / 2, Math.abs(h) / 2)),\n    );\n\n    context.moveTo(signX * tlr + x, y);\n    context.lineTo(w - signX * trr + x, y);\n    if (trr !== 0) {\n      context.arc(\n        w - signX * trr + x,\n        signY * trr + y,\n        trr,\n        (-signY * Math.PI) / 2,\n        signX > 0 ? 0 : Math.PI,\n        sweepFlag,\n      );\n    }\n    context.lineTo(w + x, h - signY * brr + y);\n    if (brr !== 0) {\n      context.arc(\n        w - signX * brr + x,\n        h - signY * brr + y,\n        brr,\n        signX > 0 ? 0 : Math.PI,\n        signY > 0 ? Math.PI / 2 : 1.5 * Math.PI,\n        sweepFlag,\n      );\n    }\n    context.lineTo(signX * blr + x, h + y);\n    if (blr !== 0) {\n      context.arc(\n        signX * blr + x,\n        h - signY * blr + y,\n        blr,\n        signY > 0 ? Math.PI / 2 : -Math.PI / 2,\n        signX > 0 ? Math.PI : 0,\n        sweepFlag,\n      );\n    }\n    context.lineTo(x, signY * tlr + y);\n    if (tlr !== 0) {\n      context.arc(\n        signX * tlr + x,\n        signY * tlr + y,\n        tlr,\n        signX > 0 ? Math.PI : 0,\n        signY > 0 ? Math.PI * 1.5 : Math.PI / 2,\n        sweepFlag,\n      );\n    }\n  }\n}\n","import { AbstractRendererPlugin, Shape } from '@antv/g-lite';\nimport type { PathGenerator } from './interfaces';\nimport {\n  CirclePath,\n  EllipsePath,\n  LinePath,\n  PathPath,\n  PolygonPath,\n  PolylinePath,\n  RectPath,\n} from './paths';\n\nexport class Plugin extends AbstractRendererPlugin<{\n  pathGeneratorFactory: Record<Shape, PathGenerator<any>>;\n}> {\n  name = 'canvas-path-generator';\n  init(): void {\n    const pathGeneratorFactory: Record<Shape, PathGenerator<any>> = {\n      [Shape.CIRCLE]: CirclePath,\n      [Shape.ELLIPSE]: EllipsePath,\n      [Shape.RECT]: RectPath,\n      [Shape.LINE]: LinePath,\n      [Shape.POLYLINE]: PolylinePath,\n      [Shape.POLYGON]: PolygonPath,\n      [Shape.PATH]: PathPath,\n      [Shape.TEXT]: undefined,\n      [Shape.GROUP]: undefined,\n      [Shape.IMAGE]: undefined,\n      [Shape.HTML]: undefined,\n      [Shape.MESH]: undefined,\n      [Shape.FRAGMENT]: undefined,\n    };\n\n    // @ts-ignore\n    this.context.pathGeneratorFactory = pathGeneratorFactory;\n  }\n  destroy(): void {\n    // @ts-ignore\n    delete this.context.pathGeneratorFactory;\n  }\n}\n\nexport * from './interfaces';\n","import type {\n  RenderingContext,\n  CanvasContext,\n  CanvasLike,\n  DataURLOptions,\n  GlobalRuntime,\n  CanvasConfig,\n  ContextService,\n} from '@antv/g-lite';\nimport { RenderReason, setDOMSize } from '@antv/g-lite';\nimport { isString } from '@antv/util';\n\nexport class Canvas2DContextService\n  implements ContextService<CanvasRenderingContext2D>\n{\n  private $container: HTMLElement | null;\n  private $canvas: CanvasLike | null;\n  private dpr: number;\n  private context:\n    | CanvasRenderingContext2D\n    | OffscreenCanvasRenderingContext2D\n    | null;\n  private canvasConfig: Partial<CanvasConfig>;\n  private renderingContext: RenderingContext;\n\n  constructor(context: GlobalRuntime & CanvasContext) {\n    this.renderingContext = context.renderingContext;\n    this.canvasConfig = context.config;\n  }\n\n  init() {\n    const { container, canvas } = this.canvasConfig;\n\n    if (canvas) {\n      this.$canvas = canvas;\n\n      if (\n        container &&\n        (canvas as HTMLCanvasElement).parentElement !== container\n      ) {\n        (container as HTMLElement).appendChild(canvas as HTMLCanvasElement);\n      }\n\n      this.$container = (canvas as HTMLCanvasElement).parentElement;\n      this.canvasConfig.container = this.$container;\n    } else if (container) {\n      // create container\n      this.$container = isString(container)\n        ? document.getElementById(container)\n        : container;\n      if (this.$container) {\n        // create canvas\n        const $canvas = document.createElement('canvas');\n\n        this.$container.appendChild($canvas);\n        if (!this.$container.style.position) {\n          this.$container.style.position = 'relative';\n        }\n        this.$canvas = $canvas;\n      }\n    }\n\n    this.context = this.$canvas.getContext('2d');\n    this.resize(this.canvasConfig.width, this.canvasConfig.height);\n  }\n\n  getContext() {\n    return this.context as CanvasRenderingContext2D;\n  }\n\n  getDomElement() {\n    return this.$canvas;\n  }\n\n  getDPR() {\n    return this.dpr;\n  }\n\n  getBoundingClientRect() {\n    if ((this.$canvas as HTMLCanvasElement).getBoundingClientRect) {\n      return (this.$canvas as HTMLCanvasElement).getBoundingClientRect();\n    }\n  }\n\n  destroy() {\n    // @ts-ignore\n    if (this.$container && this.$canvas && this.$canvas.parentNode) {\n      // destroy context\n      // @ts-ignore\n      this.$container.removeChild(this.$canvas);\n    }\n  }\n\n  resize(width: number, height: number) {\n    const { devicePixelRatio: dpr } = this.canvasConfig;\n    this.dpr = dpr;\n\n    if (this.$canvas) {\n      // set canvas width & height\n      this.$canvas.width = this.dpr * width;\n      this.$canvas.height = this.dpr * height;\n\n      // set CSS style width & height\n      setDOMSize(this.$canvas, width, height);\n\n      // const dpr = this.getDPR();\n      // scale all drawing operations by the dpr\n      // @see https://www.html5rocks.com/en/tutorials/canvas/hidpi/\n      // this.context.scale(dpr, dpr);\n    }\n\n    this.renderingContext.renderReasons.add(RenderReason.CAMERA_CHANGED);\n  }\n\n  applyCursorStyle(cursor: string) {\n    if (this.$container && this.$container.style) {\n      this.$container.style.cursor = cursor;\n    }\n  }\n\n  async toDataURL(options: Partial<DataURLOptions> = {}) {\n    const { type, encoderOptions } = options;\n    return (this.context.canvas as HTMLCanvasElement).toDataURL(\n      type,\n      encoderOptions,\n    );\n  }\n}\n","/**\n * \n * @return \n */\nexport default function isString(value) {\n    return typeof value === 'string';\n}\n//# sourceMappingURL=is-string.js.map","import { AbstractRendererPlugin } from '@antv/g-lite';\nimport { Canvas2DContextService } from './Canvas2DContextService';\n\nexport class ContextRegisterPlugin extends AbstractRendererPlugin {\n  name = 'canvas-context-register';\n  init(): void {\n    this.context.ContextService = Canvas2DContextService;\n  }\n  destroy(): void {\n    delete this.context.ContextService;\n  }\n}\n","import type { RendererConfig } from '@antv/g-lite';\nimport {\n  AbstractRenderer,\n  ImageLoader,\n  HTMLRenderer,\n  DomInteraction,\n} from '@antv/g-lite';\nimport * as CanvasRenderer from './plugins/canvas-renderer';\nimport * as CanvasPicker from './plugins/picker';\nimport * as CanvasPathGenerator from './plugins/path-generator';\nimport { ContextRegisterPlugin } from './ContextRegisterPlugin';\n\nexport class Renderer extends AbstractRenderer {\n  constructor(config?: Partial<RendererConfig>) {\n    super(config);\n\n    // register Canvas2DContext\n    this.registerPlugin(new ContextRegisterPlugin());\n    this.registerPlugin(new ImageLoader.Plugin());\n    this.registerPlugin(new CanvasPathGenerator.Plugin());\n    // enable rendering with Canvas2D API\n    this.registerPlugin(new CanvasRenderer.Plugin());\n    this.registerPlugin(new DomInteraction.Plugin());\n    // enable picking with Canvas2D API\n    this.registerPlugin(new CanvasPicker.Plugin());\n\n    // render HTML component\n    this.registerPlugin(new HTMLRenderer.Plugin());\n  }\n}\n\n// plugins\nexport type { PathGenerator } from './plugins/path-generator';\nexport { CanvasRenderer, CanvasPicker, CanvasPathGenerator };\nexport { DomInteraction, HTMLRenderer, ImageLoader };\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","_defineProperties","length","enumerable","configurable","writable","Object","defineProperty","key","_createClass","_classCallCheck","a","n","_getPrototypeOf","setPrototypeOf","getPrototypeOf","bind","__proto__","_isNativeReflectConstruct","Boolean","valueOf","Reflect","construct","_possibleConstructorReturn","ReferenceError","assertThisInitialized","_callSuper","possibleConstructorReturn","isNativeReflectConstruct","apply","_setPrototypeOf","_inherits","create","value","_defineProperty","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","_objectSpread2","arguments","forEach","getOwnPropertyDescriptors","defineProperties","_arrayLikeToArray","Array","_unsupportedIterableToArray","arrayLikeToArray","toString","slice","name","from","test","_slicedToArray","isArray","arrayWithHoles","l","u","f","next","done","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","_classPrivateFieldBase","hasOwnProperty","id","_classPrivateFieldKey","ARRAY_TYPE","Float32Array","out","glMatrix.ARRAY_TYPE","copy","multiply","b","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b0","b1","b2","b3","exactEquals","set","x","y","z","transformMat4","m","w","isNil","vec","clamp$1","min","max","rotateVector","rad","Math","cos","sin","arcToCubic","X1","Y1","RX","RY","angle","LAF","SF","X2","Y2","recursive","xy","f1","f2","cx","cy","x1","y1","rx","ry","x2","y2","d120","PI","res","h","sqrt","rx2","ry2","k","abs","asin","df","f2old","x2old","y2old","c1","s1","c2","s2","tan","hx","hy","m1","m2","m3","m4","concat","newres","ii","_renderState","_classPrivateFieldLooseKey","CanvasRendererPlugin","canvasRendererPluginOptions","this","renderQueue","restoreStack","prevObject","currentContext","Map","clearFullScreenLastFrame","clearFullScreen","vpMatrix","mat4","dprMatrix","tmpMat4","vec3a","vec3","vec3b","vec3c","vec3d","context","runtime","_this","_this$context","config","camera","renderingService","renderingContext","pathGeneratorFactory","enableRenderingOptimization","renderer","getConfig","enableDirtyCheck","enableDirtyRectangleRendering","contextService","canvas","root","ownerDocument","defaultView","hooks","init","tap","tag","dpr","getDPR","width","height","getContext","clearRect","background","destroy","_classPrivateFieldLooseBase","renderByZIndex","object","stack","_currentObject$sortab","currentObject","pop","isVisible","isCulled","renderDisplayObjectOptimized","renderDisplayObject","objects","sortable","sorted","childNodes","endFrame","_canvas$context$rende","_this$canvasRendererP","dirtyObjectNumThreshold","dirtyObjectRatioThreshold","_renderingService$get","getStats","rendered","ratio","total","renderingPlugins","isFirstTimeRenderingFinished","disableDirtyRectangleRendering","resetTransform","setTransform","beforeDraw","clear","v","getOrthoMatrix","save","restore","dirtyRenderBounds","safeMergeAABB","mergeDirtyAABBs","AABB","isEmpty","dirtyRect","convertAABB2Rect","tl","tr","bl","br","minx","miny","maxx","maxy","ix","floor","iy","iwidth","ceil","iheight","beginPath","rect","clip","enableDirtyRectangleRenderingDebug","dispatchEvent","CustomEvent","CanvasEvent","DIRTY_RECTANGLE","_dirtyRenderBounds$ge2","getMin","minX","minY","_dirtyRenderBounds$ge4","getMax","elementsFromBBox","sort","renderOrder","saveDirtyAABB","render","fillStyle","fillRect","canvasContext","renderState","nodeName","clipDraw","styleRenderer","styleRendererFactory","generatePath","clipPath","parsedStyle","getWorldTransform","applyWorldTransform","closePath","forceUpdateStyle","prevNodeName","Shape","TEXT","IMAGE","applyStyleToContext","LINE","PATH","POLYLINE","drawToContext","dirty","parent","compareDocumentPosition","Node","DOCUMENT_POSITION_CONTAINS","applyAttributesToContext","_ref","stroke","fill","opacity","lineDash","lineDashOffset","setLineDash","globalAlpha","isNone","strokeStyle","attributes","aabb","dirtyObjects","renderBounds","getRenderBounds","add","renderable","update","center","halfExtents","matrix","getLocalTransform","merged","_len","aabbs","_key","getPattern","pattern","plugin","imagePool","$offscreenCanvas","image","_parsedStyle","offscreenCanvas","offscreenCanvasCreator","getOrCreateCanvas","offscreenCanvasContext","getOrCreateContext","getOrCreatePatternSync","getGeometryBounds","getColor","parsedColor","color","type","GradientType","LinearGradient","RadialGradient","bounds","getOrCreateGradient","_objectSpread","SHADOW_NUMBER_STYLE","STROKE_STYLE","DEFAULT_STYLE","shadowBlur","shadowOffsetX","shadowOffsetY","shadowColor","globalCompositeOperation","strokeOpacity","lineWidth","lineCap","lineJoin","miterLimit","fillOpacity","defaultParsedStyle","updateContextIfNotHitCache","cache","prevValue","has","get","OptimizedDefaultRenderer","forceUpdate","prevStyle","style","blend","_style$lineWidth","hasFill","styleName","applyCommonStyleToContext","applyStrokeFillStyleToContext","hasShadow","hasFilter","onlyClearShadowFilter","undefined","oldFilter","indexOf","replace","trim","_object$parsedStyle","fillRule","resetStyle","gradient","isPattern","_this2","_style$fill","_style$opacity","_style$fillOpacity","_style$strokeOpacity","_style$lineWidth2","hasStroke","isInnerShadow","shadowType","isFillTransparent","alpha","shouldDrawShadowWithStroke","originGlobalAlpha","applyShadowAndFilterStyleToContext","fillToContext","clearShadowAndFilterStyleForContext","clearShadowAndFilter","prevOpacity","originBlend","strokeToContext","DefaultRenderer","_OptimizedDefaultRend","_parsedStyle$opacity","_parsedStyle$fillOpac","_parsedStyle$strokeOp","_parsedStyle$lineWidt","setShadowAndFilter","applyFill","applyStroke","skipFill","skipStroke","ImageRenderer","_DefaultRenderer","data","src","imageCache","downSampled","drawImage","drawRect","createDownSampledImage","then","reason","console","error","imageRect","originalSize","size","_context$getTransform","getTransform","c","d","gridSize","scaleToOrigin","scaledTileSize","tileSize","startTileX","endTileX","_ref2","endTileY","tileY","tileX","item","tiles","tileRect","createImageTiles","_parsedStyle$x","_parsedStyle$y","getImageSync","img","iw","ih","rect2","_rect","w1","h1","_rect2","w2","h2","overlapLeft","overlapTop","overlapRight","overlapBottom","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","_object$ownerDocument","getContextService","getDomElement","viewWidth","viewHeight","currentTransform","transformMatrix","enableLargeImageOptimization","renderFull","downSamplingRate","renderDownSampled","ImagePool","isSupportTile","renderTile","_unused","_createForOfIteratorHelper","_n","F","s","TextRenderer","getBounds","_parsedStyle$textAlig","textAlign","_parsedStyle$textBase","textBaseline","_parsedStyle$lineJoin","_parsedStyle$miterLim","_parsedStyle$letterSp","letterSpacing","metrics","dx","dy","textDecorationLine","lines","lineHeight","lineMetrics","font","formattedTextBaseline","linePositionY","offsetX","linePositionX","drawLetterSpacing","drawTextDecorations","text","isStroke","currentTextAlign","currentPosition","stringArray","previousWidth","measureText","currentWidth","currentChar","strokeText","fillText","substring","currentGlobalAlpha","applyOpacity","baseY","textDecorationColor","textDecorationStyle","_parsedStyle$textDeco","textDecorationThickness","_parsedStyle$textAlig2","_parsedStyle$lineWidt2","decorations","split","g","_parsedStyle$textBase2","lineMetric","lineWidthOffset","startX","endX","_step","_iterator","decorationY","drawWavyLine","moveTo","lineTo","err","wavelength","numWaves","quadraticCurveTo","Plugin","_AbstractRendererPlug","options","_defaultStyleRenderer","defaultRenderer","defaultStyleRendererFactory","CIRCLE","ELLIPSE","RECT","POLYGON","GROUP","HTML","MESH","FRAGMENT","addRenderingPlugin","removeAllRenderingPlugins","AbstractRendererPlugin","_OverloadYield","_regeneratorDefine","_invoke","_regenerator","toStringTag","Generator","regeneratorDefine","p","G","GeneratorFunction","GeneratorFunctionPrototype","displayName","AsyncIterator","OverloadYield","resolve","asyncIterator","_regeneratorAsyncGen","regeneratorAsyncIterator","regenerator","Promise","_regeneratorAsync","regeneratorAsyncGen","_regeneratorKeys","unshift","_regeneratorValues","isNaN","_regeneratorRuntime","throw","return","break","continue","stop","catch","abrupt","delegateYield","resultName","regeneratorValues","finish","_t","prev","sent","wrap","reverse","isGeneratorFunction","mark","awrap","async","regeneratorAsync","regeneratorKeys","values","asyncGeneratorStep","_asyncToGenerator","_next","_throw","tmpVec3a","tmpVec3b","tmpVec3c","CanvasPickerPlugin","isHit","displayObject","position","worldTransform","isClipPath","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","pick","pointInPathPickerFactory","invertWorldMat","localPosition","Point","isPointInPath","_renderingContext$roo","document","tapPromise","_callee","result","_context","_x","pickSync","topmost","_result$position","pickedDisplayObjects","clipped","findClosestClipPathTarget","picked","_toConsumableArray","arrayWithoutHoles","iterableToArray","nonIterableSpread","distance","len","_ref$cx","_ref$cy","_ref$lineWidth","_ref$increasedLineWid","increasedLineWidthForHitTesting","_ref$pointerEvents","pointerEvents","halfLineWidth","absDistance","_isFillOrStrokeAffect2","isFillOrStrokeAffected","ellipseDistance","squareX","squareY","halfLineWith","inBox","inArc","startAngle","endAngle","atan2","point","inLine","halfWidth","linePointToLine","inPolyline","points","isClose","count","first","last","dcmp","onSegment","p1","p2","q","inPolygon","inPolygons","polygons","renderingPluginContext","segments","hasArc","polylines","totalLength","getOrCalculatePathTotalLength","px","py","segment","currentPoint","params","prePoint","box","command","quadPointDistance","cubicPointDistance","cubicParams","args","prePointInCubic","cDistance","isPointInStroke","radius","_ref$x","_ref$y","lineWidthForHitTesting","some","radiusArray","_radiusArray","tlr","trr","brr","blr","inRectWithRadius","map","clamp","inRect","willReadFrequently","getImageData","every","component","_pointInPathPickerFac","CirclePicker","EllipsePicker","RectPicker","LinePicker","PolylinePicker","PolygonPicker","PathPicker","TextPicker","ImagePicker","_parsedStyle$cx","_parsedStyle$cy","arc","ellipse","scaleX","scaleY","scale","markerStart","markerEnd","markerStartOffset","markerEndOffset","startOffsetX","startOffsetY","endOffsetX","endOffsetY","isDisplayObject","_parsedStyle$d","absolutePath","_getStartTangent2","parentNode","getStartTangent","_getEndTangent2","getEndTangent","nextSegment","useEndOffset","startOffsetXTemp","startOffsetYTemp","_ref4","endOffsetXTemp","endOffsetYTemp","bezierCurveTo","arcParams","xRotation","sweepFlag","translate","rotate","signX","signY","_radius$map2","_pathGeneratorFactory","CirclePath","EllipsePath","RectPath","LinePath","PolylinePath","PolygonPath","PathPath","Canvas2DContextService","canvasConfig","_this$canvasConfig","container","$canvas","parentElement","appendChild","$container","getElementById","createElement","resize","getBoundingClientRect","removeChild","devicePixelRatio","setDOMSize","renderReasons","RenderReason","CAMERA_CHANGED","cursor","_toDataURL","_args","toDataURL","encoderOptions","ContextRegisterPlugin","ContextService","Renderer","_AbstractRenderer","registerPlugin","ImageLoader","CanvasPathGenerator","CanvasRenderer","DomInteraction","CanvasPicker","HTMLRenderer","AbstractRenderer"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,36,39,40,41,42,43,44,45,46,47,48,50,51,52,53,75]}