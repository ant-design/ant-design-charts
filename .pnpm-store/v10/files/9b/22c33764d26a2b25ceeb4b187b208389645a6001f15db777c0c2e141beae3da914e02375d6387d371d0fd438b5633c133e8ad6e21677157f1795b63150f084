!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Hierarchy={})}(this,function(t){"use strict";function e(t,e,i,n="height"){const h=t[n],o=e[n];return"center"===i?(h+o)/2:t.height}const i=Object.assign,n={getId:t=>t.id||t.name,getPreH:t=>t.preH||0,getPreV:t=>t.preV||0,getHGap:t=>t.hgap||18,getVGap:t=>t.vgap||18,getChildren:t=>t.children,getHeight:t=>t.height||36,getWidth(t){const e=t.label||" ";return t.width||18*e.split("").length}};class h{constructor(t,e){if(this.x=0,this.y=0,this.depth=0,this.children=[],this.hgap=0,this.vgap=0,t instanceof h||"x"in t&&"y"in t&&"children"in t){const e=t;return this.data=e.data,this.id=e.id,this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.depth=e.depth,this.children=e.children,this.parent=e.parent,this.hgap=e.hgap,this.vgap=e.vgap,this.preH=e.preH,void(this.preV=e.preV)}this.data=t;const i=e.getHGap(t),n=e.getVGap(t);this.preH=e.getPreH(t),this.preV=e.getPreV(t),this.width=e.getWidth(t),this.height=e.getHeight(t),this.width+=this.preH,this.height+=this.preV,this.id=e.getId(t),this.addGap(i,n)}isRoot(){return 0===this.depth}isLeaf(){return 0===this.children.length}addGap(t,e){this.hgap+=t,this.vgap+=e,this.width+=2*t,this.height+=2*e}eachNode(t){let e,i=[this];for(;e=i.shift();)t(e),i=e.children.concat(i)}DFTraverse(t){this.eachNode(t)}BFTraverse(t){let e,i=[this];for(;e=i.shift();)t(e),i=i.concat(e.children)}getBoundingBox(){const t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(e=>{t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)}),t}translate(t=0,e=0){this.eachNode(i=>{i.x+=t,i.y+=e,i.x+=i.preH,i.y+=i.preV})}right2left(){const t=this.getBoundingBox();this.eachNode(e=>{e.x=e.x-2*(e.x-t.left)-e.width}),this.translate(t.width,0)}bottom2top(){const t=this.getBoundingBox();this.eachNode(e=>{e.y=e.y-2*(e.y-t.top)-e.height}),this.translate(0,t.height)}}function o(t,e={},o){e=i({},n,e);const r=new h(t,e),s=[r];let c;if(!o&&!t.collapsed)for(;c=s.shift();)if(!c.data.collapsed){const t=e.getChildren(c.data),i=t?t.length:0;if(c.children=new Array(i),t&&i)for(let n=0;n<i;n++){const i=new h(t[n],e);c.children[n]=i,s.push(i),i.parent=c,i.depth=c.depth+1}}return r}class r{constructor(t,e={}){this.options=e,this.rootNode=o(t,e)}execute(){throw new Error("please override this method")}}let s=class t{constructor(t=0,e=0,i=0,n=[]){this.x=0,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0,this.w=t||0,this.h=e||0,this.y=i||0,this.c=n||[],this.cs=n.length}static fromNode(e,i){if(!e)return null;const n=[];return e.children.forEach(e=>{const h=t.fromNode(e,i);h&&n.push(h)}),i?new t(e.height,e.width,e.x,n):new t(e.width,e.height,e.y,n)}};function c(t,e,i){i?t.y+=e:t.x+=e,t.children.forEach(t=>{c(t,e,i)})}function l(t,e){let i=e?t.y:t.x;return t.children.forEach(t=>{i=Math.min(l(t,e),i)}),i}function d(t,e){c(t,-l(t,e),e)}function a(t,e,i){i?e.y=t.x:e.x=t.x,t.c.forEach((t,n)=>{a(t,e.children[n],i)})}function f(t,e,i=0){e?(t.x=i,i+=t.width):(t.y=i,i+=t.height),t.children.forEach(t=>{f(t,e,i)})}function u(t,e={}){const i=e.isHorizontal;function n(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function h(t,e,i){let n=t.c[e-1],h=n.mod,s=t.c[e],d=s.mod;for(;null!==n&&null!==s;){i&&l(n)>i.low&&(i=i.nxt);const a=h+n.prelim+n.w-(d+s.prelim);a>0&&(d+=a,i&&o(t,e,i.index,a));const f=l(n),u=l(s);f<=u&&(n=c(n),null!==n&&(h+=n.mod)),f>=u&&(s=r(s),null!==s&&(d+=s.mod))}!n&&s?function(t,e,i,n){const h=t.c[0].el;h.tl=i;const o=n-i.mod-t.c[0].msel;h.mod+=o,h.prelim-=o,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,s,d):n&&!s&&function(t,e,i,n){const h=t.c[e].er;h.tr=i;const o=n-i.mod-t.c[e].mser;h.mod+=o,h.prelim-=o,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,n,h)}function o(t,e,i,n){t.c[e].mod+=n,t.c[e].msel+=n,t.c[e].mser+=n,function(t,e,i,n){if(i!==e-1){const h=e-i;t.c[i+1].shift+=n/h,t.c[e].shift-=n/h,t.c[e].change-=n-n/h}}(t,e,i,n)}function r(t){return 0===t.cs?t.tl:t.c[0]}function c(t){return 0===t.cs?t.tr:t.c[t.cs-1]}function l(t){return t.y+t.h}function u(t,e,i){for(;null!==i&&t>=i.low;)i=i.nxt;return{low:t,index:e,nxt:i}}f(t,i);const g=s.fromNode(t,i);return g&&(!function t(e){if(0===e.cs)return void n(e);t(e.c[0]);let i=u(l(e.c[0].el),0,null);for(let n=1;n<e.cs;++n){t(e.c[n]);const o=l(e.c[n].er);h(e,n,i),i=u(o,n,i)}!function(t){t.prelim=(t.c[0].prelim+t.c[0].mod+t.c[t.cs-1].mod+t.c[t.cs-1].prelim+t.c[t.cs-1].w)/2-t.w/2}(e),n(e)}(g),function t(e,i){i+=e.mod,e.x=e.prelim+i,function(t){let e=0,i=0;for(let n=0;n<t.cs;n++)e+=t.c[n].shift,i+=e+t.c[n].change,t.c[n].mod+=i}(e);for(let n=0;n<e.cs;n++)t(e.c[n],i)}(g,0),a(g,t,i),d(t,i)),t}function g(t,e){const i=o(t.data,e,!0),n=o(t.data,e,!0),h=t.children.length,r=Math.round(h/2),s=e.getSide||function(t,e){return e<r?"right":"left"};for(let o=0;o<h;o++){const e=t.children[o];"right"===s(e,o)?n.children.push(e):i.children.push(e)}return i.eachNode(t=>{t.isRoot()||(t.side="left")}),n.eachNode(t=>{t.isRoot()||(t.side="right")}),{left:i,right:n}}const p=["LR","RL","TB","BT","H","V"],x=["LR","RL","H"],y=p[0];function m(t,e,i){const n=e.direction||y;if(e.isHorizontal=(t=>x.indexOf(t)>-1)(n),n&&-1===p.indexOf(n))throw new TypeError(`Invalid direction: ${n}`);if(n===p[0])i(t,e);else if(n===p[1])i(t,e),t.right2left();else if(n===p[2])i(t,e);else if(n===p[3])i(t,e),t.bottom2top();else if(n===p[4]||n===p[5]){const{left:n,right:h}=g(t,e);i(n,e),i(h,e),e.isHorizontal?n.right2left():n.bottom2top(),h.translate(n.x-h.x,n.y-h.y),t.x=n.x,t.y=h.y;const o=t.getBoundingBox();e.isHorizontal?o.top<0&&t.translate(0,-o.top):o.left<0&&t.translate(-o.left,0)}let h=e.fixedRoot;return void 0===h&&(h=!0),h&&t.translate(-(t.x+t.width/2+t.hgap),-(t.y+t.height/2+t.vgap)),function(t,e){if(e.radial){const[i,n]=e.isHorizontal?["x","y"]:["y","x"],h={x:1/0,y:1/0},o={x:-1/0,y:-1/0};let r=0;t.DFTraverse(t=>{r++;const{x:e,y:i}=t;h.x=Math.min(h.x,e),h.y=Math.min(h.y,i),o.x=Math.max(o.x,e),o.y=Math.max(o.y,i)});const s=o[n]-h[n];if(0===s)return;const c=2*Math.PI/r;t.DFTraverse(e=>{const o=e[n],r=h[n],l=e[i],d=t[i],a=(o-r)/s*(2*Math.PI-c)+c,f=l-d;e.x=Math.cos(a)*f,e.y=Math.sin(a)*f})}}(t,e),t}class w extends r{execute(){return m(this.rootNode,this.options,u)}}const H={};function N(t,e){const n=i({},H,e);return new w(t,n).execute()}class v{constructor(t=0,e=[]){this.x=0,this.y=0,this.leftChild=null,this.rightChild=null,this.isLeaf=!1,this.height=t,this.children=e}}const M={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function b(t,e,i){i?(e.x=t.x,e.y=t.y):(e.x=t.y,e.y=t.x),t.children.forEach((t,n)=>{b(t,e.children[n],i)})}function T(t,e={}){const n=i({},M,e);let h=0;let o=null;const r=function t(e){e.width=0,e.depth&&e.depth>h&&(h=e.depth);const i=e.children,n=i.length,o=new v(0,[]);return i.forEach((e,i)=>{const h=t(e);o.children.push(h),0===i&&(o.leftChild=h),i===n-1&&(o.rightChild=h)}),o.originNode=e,o.isLeaf=e.isLeaf(),o}(t);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=h;else{const i=e.children.map(e=>t(e)),n=Math.min(...i);e.drawingDepth=n-1}return e.drawingDepth}(r),function t(e){e.x=e.drawingDepth*n.rankSep,e.isLeaf?(e.y=0,o&&(e.y=o.y+o.height+n.nodeSep,e.originNode.parent!==o.originNode.parent&&(e.y+=n.subTreeSep)),o=e):(e.children.forEach(e=>{t(e)}),e.y=(e.leftChild.y+e.rightChild.y)/2)}(r),b(r,t,n.isHorizontal),t}class E extends r{execute(){return this.rootNode.width=0,m(this.rootNode,this.options,T)}}const S={};function B(t,e){const n=i({},S,e);return new E(t,n).execute()}function L(t,i,n,h){let o=null;t.eachNode(t=>{!function(t,i,n,h,o){const r=("function"==typeof n?n(t):n)*t.depth;if(!h)try{if(t.parent&&t.id===t.parent.children[0].id)return t.x+=r,void(t.y=i?i.y:0)}catch{}if(t.x+=r,i){if(t.y=i.y+e(i,t,o),i.parent&&t.parent&&t.parent.id!==i.parent.id){const n=i.parent,h=n.y+e(n,t,o);t.y=h>t.y?h:t.y}}else t.y=0}(t,o,i,n,h),o=t})}const V=["LR","RL","H"],R=V[0];class z extends r{execute(){const t=this.options,e=this.rootNode;t.isHorizontal=!0;const{indent:i=20,dropCap:n=!0,direction:h=R,align:o}=t;if(h&&-1===V.indexOf(h))throw new TypeError(`Invalid direction: ${h}`);if(h===V[0])L(e,i,n,o);else if(h===V[1])L(e,i,n,o),e.right2left();else if(h===V[2]){const{left:h,right:r}=g(e,t);L(h,i,n,o),h.right2left(),L(r,i,n,o);const s=h.getBoundingBox();r.translate(s.width,0),e.x=r.x-e.width/2}return e}}const C={};function D(t,e){const n=i({},C,e);return new z(t,n).execute()}function P(t,e){let i=0;return t.children.length?t.children.forEach(t=>{i+=P(t,e)}):i=t.height,t._subTreeSep=e.getSubTreeSep(t.data),t.totalHeight=Math.max(t.height,i)+2*t._subTreeSep,t.totalHeight}function Y(t){const e=t.children,i=e.length;if(i){e.forEach(t=>{Y(t)});const n=e[0],h=e[i-1],o=h.y-n.y+h.height;let r=0;if(e.forEach(t=>{r+=t.totalHeight}),o>t.height)t.y=n.y+o/2-t.height/2;else if(1!==e.length||t.height>r){const i=t.y+(t.height-o)/2-n.y;e.forEach(t=>{t.translate(0,i)})}else t.y=(n.y+n.height/2+h.y+h.height/2)/2-t.height/2}}const _={getSubTreeSep:()=>0};function G(t,e={}){return e=i({},_,e),t.parent={x:0,width:0,height:0,y:0},t.BFTraverse(t=>{t.x=t.parent.x+t.parent.width}),t.parent=void 0,P(t,e),t.startY=0,t.y=t.totalHeight/2-t.height/2,t.eachNode(t=>{const e=t.children,i=e.length;if(i){const n=e[0];if(n.startY=t.startY+t._subTreeSep,1===i)n.y=t.y+t.height/2-n.height/2;else{n.y=n.startY+n.totalHeight/2-n.height/2;for(let t=1;t<i;t++){const i=e[t];i.startY=e[t-1].startY+e[t-1].totalHeight,i.y=i.startY+i.totalHeight/2-i.height/2}}}}),Y(t),t}class I extends r{execute(){return m(this.rootNode,this.options,G)}}const A={};function F(t,e){const n=i({},A,e);return new I(t,n).execute()}const O={compactBox:N,dendrogram:B,indented:D,mindmap:F};t.compactBox=N,t.default=O,t.dendrogram=B,t.indented=D,t.mindmap=F,t.version="0.7.0",Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=hierarchy.umd.js.map
