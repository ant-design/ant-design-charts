!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).G6={})}(this,function(t){"use strict";var e="undefined"!=typeof document?document.currentScript:null;function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e);if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}function i(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function c(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(t){if("string"==typeof t)return l(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function h(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(f=function(){return!!t})()}function g(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t,e,n){return e=d(e),g(t,f()?Reflect.construct(e,n||[],d(t).constructor):e.apply(t,n))}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}function y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,A,o,s=[],a=!0,c=!1;try{if(A=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=A.call(n)).done)&&(s.push(r.value),s.length!==e);a=!0);}catch(t){c=!0,i=t}finally{try{if(!a&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw i}}return s}}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var w="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function B(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function b(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})}),n}var E={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function A(t,e,r,A,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new i(r,A||t,o),a=n?n+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function o(t,e){0===--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,r,i=[];if(0===this._eventsCount)return i;for(r in t=this._events)e.call(t,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(t)):i},s.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,A=r.length,o=new Array(A);i<A;i++)o[i]=r[i].fn;return o},s.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,i,A,o){var s=n?n+t:t;if(!this._events[s])return!1;var a,c,l=this._events[s],u=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,i),!0;case 5:return l.fn.call(l.context,e,r,i,A),!0;case 6:return l.fn.call(l.context,e,r,i,A,o),!0}for(c=1,a=new Array(u-1);c<u;c++)a[c-1]=arguments[c];l.fn.apply(l.context,a)}else{var h,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),u){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,r);break;case 4:l[c].fn.call(l[c].context,e,r,i);break;default:if(!a)for(h=1,a=new Array(u-1);h<u;h++)a[h-1]=arguments[h];l[c].fn.apply(l[c].context,a)}}return!0},s.prototype.on=function(t,e,n){return A(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return A(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,r,i){var A=n?n+t:t;if(!this._events[A])return this;if(!e)return o(this,A),this;var s=this._events[A];if(s.fn)s.fn!==e||i&&!s.once||r&&s.context!==r||o(this,A);else{for(var a=0,c=[],l=s.length;a<l;a++)(s[a].fn!==e||i&&!s[a].once||r&&s[a].context!==r)&&c.push(s[a]);c.length?this._events[A]=1===c.length?c[0]:c:o(this,A)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s}(E);var x=B(E.exports),C=1e-6,F="undefined"!=typeof Float32Array?Float32Array:Array;function M(){var t=new F(9);return F!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function k(){var t=new F(16);return F!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Q(t){var e=new F(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function S(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function U(t,e,n,r,i,A,o,s,a,c,l,u,h,d,f,g){var p=new F(16);return p[0]=t,p[1]=e,p[2]=n,p[3]=r,p[4]=i,p[5]=A,p[6]=o,p[7]=s,p[8]=a,p[9]=c,p[10]=l,p[11]=u,p[12]=h,p[13]=d,p[14]=f,p[15]=g,p}function T(t,e,n,r,i,A,o,s,a,c,l,u,h,d,f,g,p){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=A,t[5]=o,t[6]=s,t[7]=a,t[8]=c,t[9]=l,t[10]=u,t[11]=h,t[12]=d,t[13]=f,t[14]=g,t[15]=p,t}function O(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function N(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],A=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=A,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function I(t,e){var n=e[0],r=e[1],i=e[2],A=e[3],o=e[4],s=e[5],a=e[6],c=e[7],l=e[8],u=e[9],h=e[10],d=e[11],f=e[12],g=e[13],p=e[14],v=e[15],m=n*s-r*o,y=n*a-i*o,w=n*c-A*o,B=r*a-i*s,b=r*c-A*s,E=i*c-A*a,x=l*g-u*f,C=l*p-h*f,F=l*v-d*f,M=u*p-h*g,k=u*v-d*g,Q=h*v-d*p,S=m*Q-y*k+w*M+B*F-b*C+E*x;return S?(S=1/S,t[0]=(s*Q-a*k+c*M)*S,t[1]=(i*k-r*Q-A*M)*S,t[2]=(g*E-p*b+v*B)*S,t[3]=(h*b-u*E-d*B)*S,t[4]=(a*F-o*Q-c*C)*S,t[5]=(n*Q-i*F+A*C)*S,t[6]=(p*w-f*E-v*y)*S,t[7]=(l*E-h*w+d*y)*S,t[8]=(o*k-s*F+c*x)*S,t[9]=(r*F-n*k-A*x)*S,t[10]=(f*b-g*w+v*m)*S,t[11]=(u*w-l*b-d*m)*S,t[12]=(s*C-o*M-a*x)*S,t[13]=(n*M-r*C+i*x)*S,t[14]=(g*y-f*B-p*m)*S,t[15]=(l*B-u*y+h*m)*S,t):null}function L(t){var e=t[0],n=t[1],r=t[2],i=t[3],A=t[4],o=t[5],s=t[6],a=t[7],c=t[8],l=t[9],u=t[10],h=t[11],d=t[12],f=t[13],g=t[14],p=e*o-n*A,v=e*s-r*A,m=n*s-r*o,y=c*f-l*d,w=c*g-u*d,B=l*g-u*f;return a*(e*B-n*w+r*y)-i*(A*B-o*w+s*y)+t[15]*(c*m-l*v+u*p)-h*(d*m-f*v+g*p)}function D(t,e,n){var r=e[0],i=e[1],A=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],g=e[12],p=e[13],v=e[14],m=e[15],y=n[0],w=n[1],B=n[2],b=n[3];return t[0]=y*r+w*s+B*u+b*g,t[1]=y*i+w*a+B*h+b*p,t[2]=y*A+w*c+B*d+b*v,t[3]=y*o+w*l+B*f+b*m,y=n[4],w=n[5],B=n[6],b=n[7],t[4]=y*r+w*s+B*u+b*g,t[5]=y*i+w*a+B*h+b*p,t[6]=y*A+w*c+B*d+b*v,t[7]=y*o+w*l+B*f+b*m,y=n[8],w=n[9],B=n[10],b=n[11],t[8]=y*r+w*s+B*u+b*g,t[9]=y*i+w*a+B*h+b*p,t[10]=y*A+w*c+B*d+b*v,t[11]=y*o+w*l+B*f+b*m,y=n[12],w=n[13],B=n[14],b=n[15],t[12]=y*r+w*s+B*u+b*g,t[13]=y*i+w*a+B*h+b*p,t[14]=y*A+w*c+B*d+b*v,t[15]=y*o+w*l+B*f+b*m,t}function P(t,e,n){var r,i,A,o,s,a,c,l,u,h,d,f,g=n[0],p=n[1],v=n[2];return e===t?(t[12]=e[0]*g+e[4]*p+e[8]*v+e[12],t[13]=e[1]*g+e[5]*p+e[9]*v+e[13],t[14]=e[2]*g+e[6]*p+e[10]*v+e[14],t[15]=e[3]*g+e[7]*p+e[11]*v+e[15]):(r=e[0],i=e[1],A=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],t[0]=r,t[1]=i,t[2]=A,t[3]=o,t[4]=s,t[5]=a,t[6]=c,t[7]=l,t[8]=u,t[9]=h,t[10]=d,t[11]=f,t[12]=r*g+s*p+u*v+e[12],t[13]=i*g+a*p+h*v+e[13],t[14]=A*g+c*p+d*v+e[14],t[15]=o*g+l*p+f*v+e[15]),t}function R(t,e,n){var r=n[0],i=n[1],A=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*A,t[9]=e[9]*A,t[10]=e[10]*A,t[11]=e[11]*A,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function H(t,e,n){var r=Math.sin(n),i=Math.cos(n),A=e[4],o=e[5],s=e[6],a=e[7],c=e[8],l=e[9],u=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=A*i+c*r,t[5]=o*i+l*r,t[6]=s*i+u*r,t[7]=a*i+h*r,t[8]=c*i-A*r,t[9]=l*i-o*r,t[10]=u*i-s*r,t[11]=h*i-a*r,t}function _(t,e,n){var r=Math.sin(n),i=Math.cos(n),A=e[0],o=e[1],s=e[2],a=e[3],c=e[8],l=e[9],u=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=A*i-c*r,t[1]=o*i-l*r,t[2]=s*i-u*r,t[3]=a*i-h*r,t[8]=A*r+c*i,t[9]=o*r+l*i,t[10]=s*r+u*i,t[11]=a*r+h*i,t}function G(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function K(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function j(t,e,n){var r,i,A,o=n[0],s=n[1],a=n[2],c=Math.sqrt(o*o+s*s+a*a);return c<C?null:(o*=c=1/c,s*=c,a*=c,r=Math.sin(e),A=1-(i=Math.cos(e)),t[0]=o*o*A+i,t[1]=s*o*A+a*r,t[2]=a*o*A-s*r,t[3]=0,t[4]=o*s*A-a*r,t[5]=s*s*A+i,t[6]=a*s*A+o*r,t[7]=0,t[8]=o*a*A+s*r,t[9]=s*a*A-o*r,t[10]=a*a*A+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function V(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function z(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function W(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Y(t,e,n){var r=e[0],i=e[1],A=e[2],o=e[3],s=r+r,a=i+i,c=A+A,l=r*s,u=r*a,h=r*c,d=i*a,f=i*c,g=A*c,p=o*s,v=o*a,m=o*c;return t[0]=1-(d+g),t[1]=u+m,t[2]=h-v,t[3]=0,t[4]=u-m,t[5]=1-(l+g),t[6]=f+p,t[7]=0,t[8]=h+v,t[9]=f-p,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function X(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function q(t,e){var n=e[0],r=e[1],i=e[2],A=e[4],o=e[5],s=e[6],a=e[8],c=e[9],l=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(A*A+o*o+s*s),t[2]=Math.sqrt(a*a+c*c+l*l),t}function Z(t,e){var n=new F(3);q(n,e);var r=1/n[0],i=1/n[1],A=1/n[2],o=e[0]*r,s=e[1]*i,a=e[2]*A,c=e[4]*r,l=e[5]*i,u=e[6]*A,h=e[8]*r,d=e[9]*i,f=e[10]*A,g=o+l+f,p=0;return g>0?(p=2*Math.sqrt(g+1),t[3]=.25*p,t[0]=(u-d)/p,t[1]=(h-a)/p,t[2]=(s-c)/p):o>l&&o>f?(p=2*Math.sqrt(1+o-l-f),t[3]=(u-d)/p,t[0]=.25*p,t[1]=(s+c)/p,t[2]=(h+a)/p):l>f?(p=2*Math.sqrt(1+l-o-f),t[3]=(h-a)/p,t[0]=(s+c)/p,t[1]=.25*p,t[2]=(u+d)/p):(p=2*Math.sqrt(1+f-o-l),t[3]=(s-c)/p,t[0]=(h+a)/p,t[1]=(u+d)/p,t[2]=.25*p),t}function J(t,e,n,r,i){var A=e[0],o=e[1],s=e[2],a=e[3],c=A+A,l=o+o,u=s+s,h=A*c,d=A*l,f=A*u,g=o*l,p=o*u,v=s*u,m=a*c,y=a*l,w=a*u,B=r[0],b=r[1],E=r[2],x=i[0],C=i[1],F=i[2],M=(1-(g+v))*B,k=(d+w)*B,Q=(f-y)*B,S=(d-w)*b,U=(1-(h+v))*b,T=(p+m)*b,O=(f+y)*E,N=(p-m)*E,I=(1-(h+g))*E;return t[0]=M,t[1]=k,t[2]=Q,t[3]=0,t[4]=S,t[5]=U,t[6]=T,t[7]=0,t[8]=O,t[9]=N,t[10]=I,t[11]=0,t[12]=n[0]+x-(M*x+S*C+O*F),t[13]=n[1]+C-(k*x+U*C+N*F),t[14]=n[2]+F-(Q*x+T*C+I*F),t[15]=1,t}function $(t,e){var n=e[0],r=e[1],i=e[2],A=e[3],o=n+n,s=r+r,a=i+i,c=n*o,l=r*o,u=r*s,h=i*o,d=i*s,f=i*a,g=A*o,p=A*s,v=A*a;return t[0]=1-u-f,t[1]=l+v,t[2]=h-p,t[3]=0,t[4]=l-v,t[5]=1-c-f,t[6]=d+g,t[7]=0,t[8]=h+p,t[9]=d-g,t[10]=1-c-u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tt(t,e,n,r,i){var A=1/Math.tan(e/2);if(t[0]=A/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){var o=1/(r-i);t[10]=(i+r)*o,t[14]=2*i*r*o}else t[10]=-1,t[14]=-2*r;return t}var et=tt;function nt(t,e,n,r,i,A,o){var s=1/(e-n),a=1/(r-i),c=1/(A-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*a,t[14]=(o+A)*c,t[15]=1,t}var rt=nt;function it(t,e,n,r,i,A,o){var s=1/(e-n),a=1/(r-i),c=1/(A-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=c,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*a,t[14]=A*c,t[15]=1,t}function At(t,e,n,r){var i,A,o,s,a,c,l,u,h,d,f=e[0],g=e[1],p=e[2],v=r[0],m=r[1],y=r[2],w=n[0],B=n[1],b=n[2];return Math.abs(f-w)<C&&Math.abs(g-B)<C&&Math.abs(p-b)<C?O(t):(l=f-w,u=g-B,h=p-b,i=m*(h*=d=1/Math.sqrt(l*l+u*u+h*h))-y*(u*=d),A=y*(l*=d)-v*h,o=v*u-m*l,(d=Math.sqrt(i*i+A*A+o*o))?(i*=d=1/d,A*=d,o*=d):(i=0,A=0,o=0),s=u*o-h*A,a=h*i-l*o,c=l*A-u*i,(d=Math.sqrt(s*s+a*a+c*c))?(s*=d=1/d,a*=d,c*=d):(s=0,a=0,c=0),t[0]=i,t[1]=s,t[2]=l,t[3]=0,t[4]=A,t[5]=a,t[6]=u,t[7]=0,t[8]=o,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*f+A*g+o*p),t[13]=-(s*f+a*g+c*p),t[14]=-(l*f+u*g+h*p),t[15]=1,t)}function ot(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function st(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}var at=D,ct=ot,lt=Object.freeze({__proto__:null,add:function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},adjoint:function(t,e){var n=e[0],r=e[1],i=e[2],A=e[3],o=e[4],s=e[5],a=e[6],c=e[7],l=e[8],u=e[9],h=e[10],d=e[11],f=e[12],g=e[13],p=e[14],v=e[15],m=n*s-r*o,y=n*a-i*o,w=n*c-A*o,B=r*a-i*s,b=r*c-A*s,E=i*c-A*a,x=l*g-u*f,C=l*p-h*f,F=l*v-d*f,M=u*p-h*g,k=u*v-d*g,Q=h*v-d*p;return t[0]=s*Q-a*k+c*M,t[1]=i*k-r*Q-A*M,t[2]=g*E-p*b+v*B,t[3]=h*b-u*E-d*B,t[4]=a*F-o*Q-c*C,t[5]=n*Q-i*F+A*C,t[6]=p*w-f*E-v*y,t[7]=l*E-h*w+d*y,t[8]=o*k-s*F+c*x,t[9]=r*F-n*k-A*x,t[10]=f*b-g*w+v*m,t[11]=u*w-l*b-d*m,t[12]=s*C-o*M-a*x,t[13]=n*M-r*C+i*x,t[14]=g*y-f*B-p*m,t[15]=l*B-u*y+h*m,t},clone:Q,copy:S,create:k,decompose:function(t,e,n,r){e[0]=r[12],e[1]=r[13],e[2]=r[14];var i=r[0],A=r[1],o=r[2],s=r[4],a=r[5],c=r[6],l=r[8],u=r[9],h=r[10];n[0]=Math.sqrt(i*i+A*A+o*o),n[1]=Math.sqrt(s*s+a*a+c*c),n[2]=Math.sqrt(l*l+u*u+h*h);var d=1/n[0],f=1/n[1],g=1/n[2],p=i*d,v=A*f,m=o*g,y=s*d,w=a*f,B=c*g,b=l*d,E=u*f,x=h*g,C=p+w+x,F=0;return C>0?(F=2*Math.sqrt(C+1),t[3]=.25*F,t[0]=(B-E)/F,t[1]=(b-m)/F,t[2]=(v-y)/F):p>w&&p>x?(F=2*Math.sqrt(1+p-w-x),t[3]=(B-E)/F,t[0]=.25*F,t[1]=(v+y)/F,t[2]=(b+m)/F):w>x?(F=2*Math.sqrt(1+w-p-x),t[3]=(b-m)/F,t[0]=(v+y)/F,t[1]=.25*F,t[2]=(B+E)/F):(F=2*Math.sqrt(1+x-p-w),t[3]=(v-y)/F,t[0]=(b+m)/F,t[1]=(B+E)/F,t[2]=.25*F),t},determinant:L,equals:function(t,e){var n=t[0],r=t[1],i=t[2],A=t[3],o=t[4],s=t[5],a=t[6],c=t[7],l=t[8],u=t[9],h=t[10],d=t[11],f=t[12],g=t[13],p=t[14],v=t[15],m=e[0],y=e[1],w=e[2],B=e[3],b=e[4],E=e[5],x=e[6],F=e[7],M=e[8],k=e[9],Q=e[10],S=e[11],U=e[12],T=e[13],O=e[14],N=e[15];return Math.abs(n-m)<=C*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-y)<=C*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-w)<=C*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(A-B)<=C*Math.max(1,Math.abs(A),Math.abs(B))&&Math.abs(o-b)<=C*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(s-E)<=C*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(a-x)<=C*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(c-F)<=C*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(l-M)<=C*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-k)<=C*Math.max(1,Math.abs(u),Math.abs(k))&&Math.abs(h-Q)<=C*Math.max(1,Math.abs(h),Math.abs(Q))&&Math.abs(d-S)<=C*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(f-U)<=C*Math.max(1,Math.abs(f),Math.abs(U))&&Math.abs(g-T)<=C*Math.max(1,Math.abs(g),Math.abs(T))&&Math.abs(p-O)<=C*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(v-N)<=C*Math.max(1,Math.abs(v),Math.abs(N))},exactEquals:st,frob:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8]+t[9]*t[9]+t[10]*t[10]+t[11]*t[11]+t[12]*t[12]+t[13]*t[13]+t[14]*t[14]+t[15]*t[15])},fromQuat:$,fromQuat2:function(t,e){var n=new F(3),r=-e[0],i=-e[1],A=-e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=r*r+i*i+A*A+o*o;return u>0?(n[0]=2*(s*o+l*r+a*A-c*i)/u,n[1]=2*(a*o+l*i+c*r-s*A)/u,n[2]=2*(c*o+l*A+s*i-a*r)/u):(n[0]=2*(s*o+l*r+a*A-c*i),n[1]=2*(a*o+l*i+c*r-s*A),n[2]=2*(c*o+l*A+s*i-a*r)),Y(t,e,n),t},fromRotation:j,fromRotationTranslation:Y,fromRotationTranslationScale:function(t,e,n,r){var i=e[0],A=e[1],o=e[2],s=e[3],a=i+i,c=A+A,l=o+o,u=i*a,h=i*c,d=i*l,f=A*c,g=A*l,p=o*l,v=s*a,m=s*c,y=s*l,w=r[0],B=r[1],b=r[2];return t[0]=(1-(f+p))*w,t[1]=(h+y)*w,t[2]=(d-m)*w,t[3]=0,t[4]=(h-y)*B,t[5]=(1-(u+p))*B,t[6]=(g+v)*B,t[7]=0,t[8]=(d+m)*b,t[9]=(g-v)*b,t[10]=(1-(u+f))*b,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromRotationTranslationScaleOrigin:J,fromScaling:K,fromTranslation:G,fromValues:U,fromXRotation:V,fromYRotation:z,fromZRotation:W,frustum:function(t,e,n,r,i,A,o){var s=1/(n-e),a=1/(i-r),c=1/(A-o);return t[0]=2*A*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*A*a,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*a,t[10]=(o+A)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*A*2*c,t[15]=0,t},getRotation:Z,getScaling:q,getTranslation:X,identity:O,invert:I,lookAt:At,mul:at,multiply:D,multiplyScalar:function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},multiplyScalarAndAdd:function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},ortho:rt,orthoNO:nt,orthoZO:it,perspective:et,perspectiveFromFieldOfView:function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),A=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),a=2/(o+s),c=2/(i+A);return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-s)*a*.5,t[9]=(i-A)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},perspectiveNO:tt,perspectiveZO:function(t,e,n,r,i){var A=1/Math.tan(e/2);if(t[0]=A/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=A,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){var o=1/(r-i);t[10]=i*o,t[14]=i*r*o}else t[10]=-1,t[14]=-r;return t},rotate:function(t,e,n,r){var i,A,o,s,a,c,l,u,h,d,f,g,p,v,m,y,w,B,b,E,x,F,M,k,Q=r[0],S=r[1],U=r[2],T=Math.sqrt(Q*Q+S*S+U*U);return T<C?null:(Q*=T=1/T,S*=T,U*=T,i=Math.sin(n),o=1-(A=Math.cos(n)),s=e[0],a=e[1],c=e[2],l=e[3],u=e[4],h=e[5],d=e[6],f=e[7],g=e[8],p=e[9],v=e[10],m=e[11],y=Q*Q*o+A,w=S*Q*o+U*i,B=U*Q*o-S*i,b=Q*S*o-U*i,E=S*S*o+A,x=U*S*o+Q*i,F=Q*U*o+S*i,M=S*U*o-Q*i,k=U*U*o+A,t[0]=s*y+u*w+g*B,t[1]=a*y+h*w+p*B,t[2]=c*y+d*w+v*B,t[3]=l*y+f*w+m*B,t[4]=s*b+u*E+g*x,t[5]=a*b+h*E+p*x,t[6]=c*b+d*E+v*x,t[7]=l*b+f*E+m*x,t[8]=s*F+u*M+g*k,t[9]=a*F+h*M+p*k,t[10]=c*F+d*M+v*k,t[11]=l*F+f*M+m*k,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},rotateX:H,rotateY:_,rotateZ:function(t,e,n){var r=Math.sin(n),i=Math.cos(n),A=e[0],o=e[1],s=e[2],a=e[3],c=e[4],l=e[5],u=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=A*i+c*r,t[1]=o*i+l*r,t[2]=s*i+u*r,t[3]=a*i+h*r,t[4]=c*i-A*r,t[5]=l*i-o*r,t[6]=u*i-s*r,t[7]=h*i-a*r,t},scale:R,set:T,str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},sub:ct,subtract:ot,targetTo:function(t,e,n,r){var i=e[0],A=e[1],o=e[2],s=r[0],a=r[1],c=r[2],l=i-n[0],u=A-n[1],h=o-n[2],d=l*l+u*u+h*h;d>0&&(l*=d=1/Math.sqrt(d),u*=d,h*=d);var f=a*h-c*u,g=c*l-s*h,p=s*u-a*l;return(d=f*f+g*g+p*p)>0&&(f*=d=1/Math.sqrt(d),g*=d,p*=d),t[0]=f,t[1]=g,t[2]=p,t[3]=0,t[4]=u*p-h*g,t[5]=h*f-l*p,t[6]=l*g-u*f,t[7]=0,t[8]=l,t[9]=u,t[10]=h,t[11]=0,t[12]=i,t[13]=A,t[14]=o,t[15]=1,t},translate:P,transpose:N});function ut(){var t=new F(3);return F!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ht(t){var e=new F(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function dt(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function ft(t,e,n){var r=new F(3);return r[0]=t,r[1]=e,r[2]=n,r}function gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function pt(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function vt(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function mt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function yt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function wt(t,e){var n=e[0],r=e[1],i=e[2],A=n*n+r*r+i*i;return A>0&&(A=1/Math.sqrt(A)),t[0]=e[0]*A,t[1]=e[1]*A,t[2]=e[2]*A,t}function Bt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function bt(t,e,n){var r=e[0],i=e[1],A=e[2],o=n[0],s=n[1],a=n[2];return t[0]=i*a-A*s,t[1]=A*o-r*a,t[2]=r*s-i*o,t}function Et(t,e,n,r){var i=e[0],A=e[1],o=e[2];return t[0]=i+r*(n[0]-i),t[1]=A+r*(n[1]-A),t[2]=o+r*(n[2]-o),t}function xt(t,e,n){var r=e[0],i=e[1],A=e[2],o=n[3]*r+n[7]*i+n[11]*A+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*A+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*A+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*A+n[14])/o,t}function Ct(t,e){var n=t[0],r=t[1],i=t[2],A=e[0],o=e[1],s=e[2];return Math.abs(n-A)<=C*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(r-o)<=C*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=C*Math.max(1,Math.abs(i),Math.abs(s))}var Ft=mt,Mt=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},kt=dt;function Qt(){var t=new F(4);return F!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function St(t,e,n,r){var i=new F(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=r,i}function Ut(t,e,n){var r=e[0],i=e[1],A=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*A+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*A+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*A+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*A+n[15]*o,t}function Tt(){var t=new F(4);return F!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ot(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Nt(t,e,n){var r=e[0],i=e[1],A=e[2],o=e[3],s=n[0],a=n[1],c=n[2],l=n[3];return t[0]=r*l+o*s+i*c-A*a,t[1]=i*l+o*a+A*s-r*c,t[2]=A*l+o*c+r*a-i*s,t[3]=o*l-r*s-i*a-A*c,t}function It(t,e){var n=e[0],r=e[1],i=e[2],A=e[3],o=n*n+r*r+i*i+A*A,s=o?1/o:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=A*s,t}function Lt(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"zyx",A=Math.PI/360;e*=A,r*=A,n*=A;var o=Math.sin(e),s=Math.cos(e),a=Math.sin(n),c=Math.cos(n),l=Math.sin(r),u=Math.cos(r);switch(i){case"xyz":t[0]=o*c*u+s*a*l,t[1]=s*a*u-o*c*l,t[2]=s*c*l+o*a*u,t[3]=s*c*u-o*a*l;break;case"xzy":t[0]=o*c*u-s*a*l,t[1]=s*a*u-o*c*l,t[2]=s*c*l+o*a*u,t[3]=s*c*u+o*a*l;break;case"yxz":t[0]=o*c*u+s*a*l,t[1]=s*a*u-o*c*l,t[2]=s*c*l-o*a*u,t[3]=s*c*u+o*a*l;break;case"yzx":t[0]=o*c*u+s*a*l,t[1]=s*a*u+o*c*l,t[2]=s*c*l-o*a*u,t[3]=s*c*u-o*a*l;break;case"zxy":t[0]=o*c*u-s*a*l,t[1]=s*a*u+o*c*l,t[2]=s*c*l+o*a*u,t[3]=s*c*u-o*a*l;break;case"zyx":t[0]=o*c*u-s*a*l,t[1]=s*a*u+o*c*l,t[2]=s*c*l-o*a*u,t[3]=s*c*u+o*a*l;break;default:throw new Error("Unknown angle order "+i)}return t}ut(),function(){var t=Qt()}();var Dt=St,Pt=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},Rt=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},Ht=Nt,_t=function(t,e){var n=e[0],r=e[1],i=e[2],A=e[3],o=n*n+r*r+i*i+A*A;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=A*o,t};function Gt(){var t=new F(2);return F!=Float32Array&&(t[0]=0,t[1]=0),t}ut(),ft(1,0,0),ft(0,1,0),Tt(),Tt(),M(),function(){var t=Gt()}();var Kt=function(t){return null!==t&&"function"!=typeof t&&isFinite(t.length)},jt=function(t,e){return void 0===e&&(e=[]),function(t,e){if(!Kt(t))return t;for(var n=[],r=0;r<t.length;r++){var i=t[r];e(i,r)&&n.push(i)}return n}(t,function(t){return!function(t,e){return!!Kt(t)&&t.indexOf(e)>-1}(e,t)})};function Vt(t){return"function"==typeof t}function zt(t){return null==t}function Wt(t){return Array.isArray(t)}var Yt=function(t){var e=typeof t;return null!==t&&"object"===e||"function"===e};function Xt(t,e){if(t)if(Wt(t))for(var n=0,r=t.length;n<r&&!1!==e(t[n],n);n++);else if(Yt(t))for(var i in t)if(t.hasOwnProperty(i)&&!1===e(t[i],i))break}var qt=function(t){return"object"==typeof t&&null!==t},Zt={}.toString,Jt=function(t,e){return Zt.call(t)==="[object "+e+"]"},$t=function(t){if(!qt(t)||!Jt(t,"Object"))return!1;if(null===Object.getPrototypeOf(t))return!0;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e};function te(t){if(!Array.isArray(t))return-1/0;var e=t.length;if(!e)return-1/0;for(var n=t[0],r=1;r<e;r++)n=Math.max(n,t[r]);return n}var ee=function(t){if(Wt(t))return t.reduce(function(t,e){return Math.min(t,e)},t[0])};function ne(t){return"string"==typeof t}var re=Object.prototype.hasOwnProperty;function ie(t,e){if(!e||!Wt(t))return{};for(var n,r={},i=Vt(e)?e:function(t){return t[e]},A=0;A<t.length;A++){var o=t[A];n=i(o),re.call(r,n)?r[n].push(o):r[n]=[o]}return r}var Ae=function(t,e,n){return t<e?e:t>n?n:t};function oe(t){return"number"==typeof t}function se(t,e,n){return void 0===n&&(n=1e-5),t===e||Math.abs(t-e)<n}var ae=function(t,e){if(Wt(t)){for(var n,r=-1/0,i=0;i<t.length;i++){var A=t[i],o=Vt(e)?e(A):A[e];o>r&&(n=A,r=o)}return n}},ce=function(t,e){if(Wt(t)){for(var n,r=1/0,i=0;i<t.length;i++){var A=t[i],o=Vt(e)?e(A):A[e];o<r&&(n=A,r=o)}return n}},le=function(t,e){return(t%e+e)%e},ue=function(t){return zt(t)?"":t.toString()};var he=function(t){var e=ue(t);return e.charAt(0).toUpperCase()+e.substring(1)},de={}.toString,fe=function(t){return Jt(t,"Boolean")};var ge=Object.prototype,pe=function(t){return void 0===t};function ve(t,e){for(var n in e)e.hasOwnProperty(n)&&"constructor"!==n&&void 0!==e[n]&&(t[n]=e[n])}var me=function(t){if("object"!=typeof t||null===t)return t;var e;if(Wt(t)){e=[];for(var n=0,r=t.length;n<r;n++)"object"==typeof t[n]&&null!=t[n]?e[n]=me(t[n]):e[n]=t[n]}else for(var i in e={},t)"object"==typeof t[i]&&null!=t[i]?e[i]=me(t[i]):e[i]=t[i];return e};function ye(t,e,n){var r;return function(){var n=this,i=arguments;clearTimeout(r),r=setTimeout(function(){r=null,t.apply(n,i)},e)}}var we=new Map;function Be(t,e,n){void 0===n&&(n=128);return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var A=e?e.apply(this,r):r[0];we.has(t)||we.set(t,function(t){var e,n,r,i=t||1;function A(t,A){++e>i&&(r=n,o(1),++e),n[t]=A}function o(t){e=0,n=Object.create(null),t||(r=Object.create(null))}return o(),{clear:o,has:function(t){return void 0!==n[t]||void 0!==r[t]},get:function(t){var e=n[t];return void 0!==e?e:void 0!==(e=r[t])?(A(t,e),e):void 0},set:function(t,e){void 0!==n[t]?n[t]=e:A(t,e)}}}(n));var o=we.get(t);if(o.has(A))return o.get(A);var s=t.apply(this,r);return o.set(A,s),s}}function be(t,e){if(Object.hasOwn)return Object.hasOwn(t,e);if(null==t)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(t),e)}function Ee(t,e,n,r){for(var i in n=n||0,r=r||5,e)if(be(e,i)){var A=e[i];null!==A&&$t(A)?($t(t[i])||(t[i]={}),n<r?Ee(t[i],A,n+1,r):t[i]=e[i]):Wt(A)?(t[i]=[],t[i]=t[i].concat(A)):void 0!==A&&(t[i]=A)}}var xe=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)Ee(t,e[r]);return t},Ce=Object.prototype.hasOwnProperty;function Fe(t){if(zt(t))return!0;if(Kt(t))return!t.length;var e=function(t){return de.call(t).replace(/^\[object /,"").replace(/]$/,"")}(t);if("Map"===e||"Set"===e)return!t.size;if(function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ge)}(t))return!Object.keys(t).length;for(var n in t)if(Ce.call(t,n))return!1;return!0}var Me=function(t,e){if(t===e)return!0;if(!t||!e)return!1;if(ne(t)||ne(e))return!1;if(Kt(t)||Kt(e)){if(t.length!==e.length)return!1;for(var n=!0,r=0;r<t.length&&(n=Me(t[r],e[r]));r++);return n}if(qt(t)||qt(e)){var i=Object.keys(t),A=Object.keys(e);if(i.length!==A.length)return!1;for(n=!0,r=0;r<i.length&&(n=Me(t[i[r]],e[i[r]]));r++);return n}return!1},ke=function(t,e,n){for(var r=0,i=ne(e)?e.split("."):e;t&&r<i.length;)t=t[i[r++]];return void 0===t||r<i.length?n:t},Qe=function(t,e,n){var r=t,i=ne(e)?e.split("."):e;return i.forEach(function(t,e){e<i.length-1?(Yt(r[t])||(r[t]=oe(i[e+1])?[]:{}),r=r[t]):r[t]=n}),t},Se=Object.prototype.hasOwnProperty,Ue=function(t,e){if(null===t||!$t(t))return{};var n={};return Xt(e,function(e){Se.call(t,e)&&(n[e]=t[e])}),n},Te=function(t,e){return function(t,e,n){if(!Wt(t)&&!$t(t))return t;var r=n;return Xt(t,function(t,n){r=e(r,t,n)}),r}(t,function(t,n,r){return e.includes(r)||(t[r]=n),t},{})},Oe=function(t,e,n){var r,i,A,o,s=0;n||(n={});var a=function(){s=!1===n.leading?0:Date.now(),r=null,o=t.apply(i,A),r||(i=A=null)},c=function(){var c=Date.now();s||!1!==n.leading||(s=c);var l=e-(c-s);return i=this,A=arguments,l<=0||l>e?(r&&(clearTimeout(r),r=null),s=c,o=t.apply(i,A),r||(i=A=null)):r||!1===n.trailing||(r=setTimeout(a,l)),o};return c.cancel=function(){clearTimeout(r),s=0,r=i=A=null},c},Ne={},Ie=function(){},Le=function(t){return t},De=function(t,e){return De=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},De(t,e)};function Pe(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}De(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Re=function(){return Re=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Re.apply(this,arguments)};function He(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function _e(t,e,n,r){return new(n||(n=Promise))(function(i,A){function o(t){try{a(r.next(t))}catch(t){A(t)}}function s(t){try{a(r.throw(t))}catch(t){A(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,s)}a((r=r.apply(t,e||[])).next())})}function Ge(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ke(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,A=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(r=A.next()).done;)o.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=A.return)&&n.call(A)}finally{if(i)throw i.error}}return o}function je(t,e,n){if(n||2===arguments.length)for(var r,i=0,A=e.length;i<A;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function Ve(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}"function"==typeof SuppressedError&&SuppressedError;var ze={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function We(t,e,n){if(t[n].length>7){t[n].shift();for(var r=t[n],i=n;r.length;)e[n]="A",t.splice(i+=1,0,["C"].concat(r.splice(0,6)));t.splice(n,1)}}var Ye={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function Xe(t){return Array.isArray(t)&&t.every(function(t){var e=t[0].toLowerCase();return Ye[e]===t.length-1&&"achlmqstvz".includes(e)})}function qe(t){return Xe(t)&&t.every(function(t){var e=t[0];return e===e.toUpperCase()})}function Ze(t){return qe(t)&&t.every(function(t){var e=t[0];return"ACLMQZ".includes(e)})}function Je(t){for(var e=t.pathValue[t.segmentStart],n=e.toLowerCase(),r=t.data;r.length>=Ye[n]&&("m"===n&&r.length>2?(t.segments.push([e].concat(r.splice(0,2))),n="l",e="m"===e?"l":"L"):t.segments.push([e].concat(r.splice(0,Ye[n]))),Ye[n]););}function $e(t){var e=t.index,n=t.pathValue,r=n.charCodeAt(e);return 48===r?(t.param=0,void(t.index+=1)):49===r?(t.param=1,void(t.index+=1)):void(t.err='[path-util]: invalid Arc flag "'.concat(n[e],'", expecting 0 or 1 at index ').concat(e))}function tn(t){return t>=48&&t<=57||43===t||45===t||46===t}function en(t){return t>=48&&t<=57}function nn(t){var e,n=t.max,r=t.pathValue,i=t.index,A=i,o=!1,s=!1,a=!1,c=!1;if(A>=n)t.err="[path-util]: Invalid path value at index ".concat(A,', "pathValue" is missing param');else if(43!==(e=r.charCodeAt(A))&&45!==e||(A+=1,e=r.charCodeAt(A)),en(e)||46===e){if(46!==e){if(o=48===e,A+=1,e=r.charCodeAt(A),o&&A<n&&e&&en(e))return void(t.err="[path-util]: Invalid path value at index ".concat(i,', "').concat(r[i],'" illegal number'));for(;A<n&&en(r.charCodeAt(A));)A+=1,s=!0;e=r.charCodeAt(A)}if(46===e){for(c=!0,A+=1;en(r.charCodeAt(A));)A+=1,a=!0;e=r.charCodeAt(A)}if(101===e||69===e){if(c&&!s&&!a)return void(t.err="[path-util]: Invalid path value at index ".concat(A,', "').concat(r[A],'" invalid float exponent'));if(A+=1,43!==(e=r.charCodeAt(A))&&45!==e||(A+=1),!(A<n&&en(r.charCodeAt(A))))return void(t.err="[path-util]: Invalid path value at index ".concat(A,', "').concat(r[A],'" invalid integer exponent'));for(;A<n&&en(r.charCodeAt(A));)A+=1}t.index=A,t.param=+t.pathValue.slice(i,A)}else t.err="[path-util]: Invalid path value at index ".concat(A,', "').concat(r[A],'" is not a number')}function rn(t){return 10===t||13===t||8232===t||8233===t||32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(t)}function An(t){for(var e=t.pathValue,n=t.max;t.index<n&&rn(e.charCodeAt(t.index));)t.index+=1}function on(t){return 97==(32|t)}function sn(t){var e=t.max,n=t.pathValue,r=t.index,i=n.charCodeAt(r),A=Ye[n[r].toLowerCase()];if(t.segmentStart=r,function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}(i))if(t.index+=1,An(t),t.data=[],A){for(;;){for(var o=A;o>0;o-=1){if(!on(i)||3!==o&&4!==o?nn(t):$e(t),t.err.length)return;t.data.push(t.param),An(t),t.index<e&&44===n.charCodeAt(t.index)&&(t.index+=1,An(t))}if(t.index>=t.max)break;if(!tn(n.charCodeAt(t.index)))break}Je(t)}else Je(t);else t.err='[path-util]: Invalid path value "'.concat(n[r],'" is not a path command')}var an=function(t){this.pathValue=t,this.segments=[],this.max=t.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""};function cn(t){if(qe(t))return[].concat(t);var e=function(t){if(Xe(t))return[].concat(t);var e=new an(t);for(An(e);e.index<e.max&&!e.err.length;)sn(e);return e.err?e.err:e.segments}(t),n=0,r=0,i=0,A=0;return e.map(function(t){var e,o=t.slice(1).map(Number),s=t[0],a=s.toUpperCase();if("M"===s)return n=o[0],r=o[1],i=n,A=r,["M",n,r];if(s!==a)switch(a){case"A":e=[a,o[0],o[1],o[2],o[3],o[4],o[5]+n,o[6]+r];break;case"V":e=[a,o[0]+r];break;case"H":e=[a,o[0]+n];break;default:var c=o.map(function(t,e){return t+(e%2?r:n)});e=[a].concat(c)}else e=[a].concat(o);var l=e.length;switch(a){case"Z":n=i,r=A;break;case"H":n=e[1];break;case"V":r=e[1];break;default:n=e[l-2],r=e[l-1],"M"===a&&(i=n,A=r)}return e})}function ln(t,e){var n=t[0],r=e.x1,i=e.y1,A=e.x2,o=e.y2,s=t.slice(1).map(Number),a=t;if("TQ".includes(n)||(e.qx=null,e.qy=null),"H"===n)a=["L",t[1],i];else if("V"===n)a=["L",r,t[1]];else if("S"===n){var c=2*r-A,l=2*i-o;e.x1=c,e.y1=l,a=["C",c,l].concat(s)}else if("T"===n){var u=2*r-e.qx,h=2*i-e.qy;e.qx=u,e.qy=h,a=["Q",u,h].concat(s)}else if("Q"===n){var d=s[0],f=s[1];e.qx=d,e.qy=f}return a}function un(t){if(Ze(t))return[].concat(t);for(var e=cn(t),n=Re({},ze),r=0;r<e.length;r+=1){e[r]=ln(e[r],n);var i=e[r],A=i.length;n.x1=+i[A-2],n.y1=+i[A-1],n.x2=+i[A-4]||n.x1,n.y2=+i[A-3]||n.y1}return e}function hn(t,e,n){return{x:t*Math.cos(n)-e*Math.sin(n),y:t*Math.sin(n)+e*Math.cos(n)}}function dn(t,e,n,r,i,A,o,s,a,c){var l,u,h,d,f,g=t,p=e,v=n,m=r,y=s,w=a,B=120*Math.PI/180,b=Math.PI/180*(+i||0),E=[];if(c)u=c[0],h=c[1],d=c[2],f=c[3];else{g=(l=hn(g,p,-b)).x,p=l.y;var x=(g-(y=(l=hn(y,w,-b)).x))/2,C=(p-(w=l.y))/2,F=x*x/(v*v)+C*C/(m*m);F>1&&(v*=F=Math.sqrt(F),m*=F);var M=v*v,k=m*m,Q=(A===o?-1:1)*Math.sqrt(Math.abs((M*k-M*C*C-k*x*x)/(M*C*C+k*x*x)));d=Q*v*C/m+(g+y)/2,f=Q*-m*x/v+(p+w)/2,u=Math.asin(((p-f)/m*Math.pow(10,9)|0)/Math.pow(10,9)),h=Math.asin(((w-f)/m*Math.pow(10,9)|0)/Math.pow(10,9)),u=g<d?Math.PI-u:u,h=y<d?Math.PI-h:h,u<0&&(u=2*Math.PI+u),h<0&&(h=2*Math.PI+h),o&&u>h&&(u-=2*Math.PI),!o&&h>u&&(h-=2*Math.PI)}var S=h-u;if(Math.abs(S)>B){var U=h,T=y,O=w;h=u+B*(o&&h>u?1:-1),E=dn(y=d+v*Math.cos(h),w=f+m*Math.sin(h),v,m,i,0,o,T,O,[h,U,d,f])}S=h-u;var N=Math.cos(u),I=Math.sin(u),L=Math.cos(h),D=Math.sin(h),P=Math.tan(S/4),R=4/3*v*P,H=4/3*m*P,_=[g,p],G=[g+R*I,p-H*N],K=[y+R*D,w-H*L],j=[y,w];if(G[0]=2*_[0]-G[0],G[1]=2*_[1]-G[1],c)return G.concat(K,j,E);for(var V=[],z=0,W=(E=G.concat(K,j,E)).length;z<W;z+=1)V[z]=z%2?hn(E[z-1],E[z],b).y:hn(E[z],E[z+1],b).x;return V}function fn(t,e,n){var r=t[0],i=t[1];return[r+(e[0]-r)*n,i+(e[1]-i)*n]}var gn=function(t,e,n,r){return je(je([],fn([t,e],[n,r],.5),!0),[n,r,n,r],!1)};function pn(t,e){var n,r,i,A,o,s,a,c,l,u=t[0],h=t.slice(1).map(Number),d=h[0],f=h[1],g=e.x1,p=e.y1,v=e.x,m=e.y;switch("TQ".includes(u)||(e.qx=null,e.qy=null),u){case"M":return e.x=d,e.y=f,t;case"A":return n=[g,p].concat(h),["C"].concat(dn(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]));case"Q":return e.qx=d,e.qy=f,n=[g,p].concat(h),["C"].concat((r=n[0],i=n[1],A=n[2],o=n[3],s=n[4],a=n[5],[(c=1/3)*r+(l=2/3)*A,c*i+l*o,c*s+l*A,c*a+l*o,s,a]));case"L":return["C"].concat(gn(g,p,d,f));case"Z":return g===v&&p===m?["C",g,p,v,m,v,m]:["C"].concat(gn(g,p,v,m))}return t}function vn(t,e){if(void 0===e&&(e=!1),function(t){return Ze(t)&&t.every(function(t){var e=t[0];return"MC".includes(e)})}(t)){var n=[].concat(t);return e?[n,[]]:n}for(var r,i,A=un(t),o=Re({},ze),s=[],a="",c=A.length,l=[],u=0;u<c;u+=1){A[u]&&(a=A[u][0]),s[u]=a;var h=pn(A[u],o);A[u]=h,We(A,s,u),c=A.length,"Z"===a&&l.push(u),i=(r=A[u]).length,o.x1=+r[i-2],o.y1=+r[i-1],o.x2=+r[i-4]||o.x1,o.y2=+r[i-3]||o.y1}return e?[A,l]:A}function mn(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function yn(t,e,n,r,i){var A=mn([t,e],[n,r]),o={x:0,y:0};if("number"==typeof i)if(i<=0)o={x:t,y:e};else if(i>=A)o={x:n,y:r};else{var s=fn([t,e],[n,r],i/A);o={x:s[0],y:s[1]}}return{length:A,point:o,min:{x:Math.min(t,n),y:Math.min(e,r)},max:{x:Math.max(t,n),y:Math.max(e,r)}}}function wn(t,e){var n=t.x,r=t.y,i=e.x,A=e.y,o=n*i+r*A,s=Math.sqrt((Math.pow(n,2)+Math.pow(r,2))*(Math.pow(i,2)+Math.pow(A,2)));return(n*A-r*i<0?-1:1)*Math.acos(o/s)}function Bn(t,e,n,r,i,A,o,s,a,c){var l=Math.abs,u=Math.sin,h=Math.cos,d=Math.sqrt,f=Math.PI,g=l(n),p=l(r),v=(i%360+360)%360*(f/180);if(t===s&&e===a)return{x:t,y:e};if(0===g||0===p)return yn(t,e,s,a,c).point;var m=(t-s)/2,y=(e-a)/2,w={x:h(v)*m+u(v)*y,y:-u(v)*m+h(v)*y},B=Math.pow(w.x,2)/Math.pow(g,2)+Math.pow(w.y,2)/Math.pow(p,2);B>1&&(g*=d(B),p*=d(B));var b=(Math.pow(g,2)*Math.pow(p,2)-Math.pow(g,2)*Math.pow(w.y,2)-Math.pow(p,2)*Math.pow(w.x,2))/(Math.pow(g,2)*Math.pow(w.y,2)+Math.pow(p,2)*Math.pow(w.x,2)),E=(A!==o?1:-1)*d(b=b<0?0:b),x=E*(g*w.y/p),C=E*(-p*w.x/g),F=h(v)*x-u(v)*C+(t+s)/2,M=u(v)*x+h(v)*C+(e+a)/2,k={x:(w.x-x)/g,y:(w.y-C)/p},Q=wn({x:1,y:0},k),S=wn(k,{x:(-w.x-x)/g,y:(-w.y-C)/p});!o&&S>0?S-=2*f:o&&S<0&&(S+=2*f);var U=Q+(S%=2*f)*c,T=g*h(U),O=p*u(U);return{x:h(v)*T-u(v)*O+F,y:u(v)*T+h(v)*O+M}}function bn(t,e,n,r,i,A,o,s,a,c,l){var u,h=l.bbox,d=void 0===h||h,f=l.length,g=void 0===f||f,p=l.sampleSize,v=void 0===p?30:p,m="number"==typeof c,y=t,w=e,B=0,b=[y,w,B],E=[y,w],x={x:0,y:0},C=[{x:y,y:w}];m&&c<=0&&(x={x:y,y:w});for(var F=0;F<=v;F+=1){if(y=(u=Bn(t,e,n,r,i,A,o,s,a,F/v)).x,w=u.y,d&&C.push({x:y,y:w}),g&&(B+=mn(E,[y,w])),E=[y,w],m&&B>=c&&c>b[2]){var M=(B-c)/(B-b[2]);x={x:E[0]*(1-M)+b[0]*M,y:E[1]*(1-M)+b[1]*M}}b=[y,w,B]}return m&&c>=B&&(x={x:s,y:a}),{length:B,point:x,min:{x:Math.min.apply(null,C.map(function(t){return t.x})),y:Math.min.apply(null,C.map(function(t){return t.y}))},max:{x:Math.max.apply(null,C.map(function(t){return t.x})),y:Math.max.apply(null,C.map(function(t){return t.y}))}}}function En(t,e,n,r,i,A,o,s,a){var c=1-a;return{x:Math.pow(c,3)*t+3*Math.pow(c,2)*a*n+3*c*Math.pow(a,2)*i+Math.pow(a,3)*o,y:Math.pow(c,3)*e+3*Math.pow(c,2)*a*r+3*c*Math.pow(a,2)*A+Math.pow(a,3)*s}}function xn(t,e,n,r,i,A,o,s,a,c){var l,u=c.bbox,h=void 0===u||u,d=c.length,f=void 0===d||d,g=c.sampleSize,p=void 0===g?10:g,v="number"==typeof a,m=t,y=e,w=0,B=[m,y,w],b=[m,y],E={x:0,y:0},x=[{x:m,y:y}];v&&a<=0&&(E={x:m,y:y});for(var C=0;C<=p;C+=1){if(m=(l=En(t,e,n,r,i,A,o,s,C/p)).x,y=l.y,h&&x.push({x:m,y:y}),f&&(w+=mn(b,[m,y])),b=[m,y],v&&w>=a&&a>B[2]){var F=(w-a)/(w-B[2]);E={x:b[0]*(1-F)+B[0]*F,y:b[1]*(1-F)+B[1]*F}}B=[m,y,w]}return v&&a>=w&&(E={x:o,y:s}),{length:w,point:E,min:{x:Math.min.apply(null,x.map(function(t){return t.x})),y:Math.min.apply(null,x.map(function(t){return t.y}))},max:{x:Math.max.apply(null,x.map(function(t){return t.x})),y:Math.max.apply(null,x.map(function(t){return t.y}))}}}function Cn(t,e,n,r,i,A,o){var s=1-o;return{x:Math.pow(s,2)*t+2*s*o*n+Math.pow(o,2)*i,y:Math.pow(s,2)*e+2*s*o*r+Math.pow(o,2)*A}}function Fn(t,e,n,r,i,A,o,s){var a,c=s.bbox,l=void 0===c||c,u=s.length,h=void 0===u||u,d=s.sampleSize,f=void 0===d?10:d,g="number"==typeof o,p=t,v=e,m=0,y=[p,v,m],w=[p,v],B={x:0,y:0},b=[{x:p,y:v}];g&&o<=0&&(B={x:p,y:v});for(var E=0;E<=f;E+=1){if(p=(a=Cn(t,e,n,r,i,A,E/f)).x,v=a.y,l&&b.push({x:p,y:v}),h&&(m+=mn(w,[p,v])),w=[p,v],g&&m>=o&&o>y[2]){var x=(m-o)/(m-y[2]);B={x:w[0]*(1-x)+y[0]*x,y:w[1]*(1-x)+y[1]*x}}y=[p,v,m]}return g&&o>=m&&(B={x:i,y:A}),{length:m,point:B,min:{x:Math.min.apply(null,b.map(function(t){return t.x})),y:Math.min.apply(null,b.map(function(t){return t.y}))},max:{x:Math.max.apply(null,b.map(function(t){return t.x})),y:Math.max.apply(null,b.map(function(t){return t.y}))}}}function Mn(t,e,n){for(var r,i,A,o,s,a,c,l,u,h=un(t),d="number"==typeof e,f=[],g=0,p=0,v=0,m=0,y=[],w=[],B=0,b={x:0,y:0},E=b,x=b,C=b,F=0,M=0,k=h.length;M<k;M+=1)f=(c="M"===(l=(u=h[M])[0]))?f:[g,p].concat(u.slice(1)),c?(E=b={x:v=u[1],y:m=u[2]},B=0,d&&e<.001&&(C=b)):"L"===l?(B=(r=yn(f[0],f[1],f[2],f[3],(e||0)-F)).length,b=r.min,E=r.max,x=r.point):"A"===l?(B=(i=bn(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(e||0)-F,n||{})).length,b=i.min,E=i.max,x=i.point):"C"===l?(B=(A=xn(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(e||0)-F,n||{})).length,b=A.min,E=A.max,x=A.point):"Q"===l?(B=(o=Fn(f[0],f[1],f[2],f[3],f[4],f[5],(e||0)-F,n||{})).length,b=o.min,E=o.max,x=o.point):"Z"===l&&(B=(s=yn((f=[g,p,v,m])[0],f[1],f[2],f[3],(e||0)-F)).length,b=s.min,E=s.max,x=s.point),d&&F<e&&F+B>=e&&(C=x),w.push(E),y.push(b),F+=B,g=(a="Z"!==l?u.slice(-2):[v,m])[0],p=a[1];return d&&e>=F&&(C={x:g,y:p}),{length:F,point:C,min:{x:Math.min.apply(null,y.map(function(t){return t.x})),y:Math.min.apply(null,y.map(function(t){return t.y}))},max:{x:Math.max.apply(null,w.map(function(t){return t.x})),y:Math.max.apply(null,w.map(function(t){return t.y}))}}}function kn(t,e){var n=t.length-1,r=[],i=0,A=function(t){var e=t.length,n=e-1;return t.map(function(r,i){return t.map(function(r,A){var o,s=i+A;return 0===A||t[s]&&"M"===t[s][0]?(o=t[s],["M"].concat(o.slice(-2))):(s>=e&&(s-=n),t[s])})})}(t);return A.forEach(function(A,o){t.slice(1).forEach(function(r,A){i+=mn(t[(o+A)%n].slice(-2),e[A%n].slice(-2))}),r[o]=i,i=0}),A[r.indexOf(Math.min.apply(null,r))]}function Qn(t){return function(t){var e=0,n=0,r=0;return vn(t).map(function(t){var i;if("M"===t[0])return e=t[1],n=t[2],0;var A=t.slice(1),o=A[0],s=A[1],a=A[2],c=A[3],l=A[4],u=A[5];return r=function(t,e,n,r,i,A,o,s){return 3*((s-e)*(n+i)-(o-t)*(r+A)+r*(t-i)-n*(e-A)+s*(i+t/3)-o*(A+e/3))/20}(e,n,o,s,a,c,l,u),i=t.slice(-2),e=i[0],n=i[1],r}).reduce(function(t,e){return t+e},0)}(t)>=0}function Sn(t){return t.map(function(t,e,n){var r,i=e&&n[e-1].slice(-2).concat(t.slice(1)),A=e?xn(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0;return r=e?A?function(t,e){void 0===e&&(e=.5);var n=t.slice(0,2),r=t.slice(2,4),i=t.slice(4,6),A=t.slice(6,8),o=fn(n,r,e),s=fn(r,i,e),a=fn(i,A,e),c=fn(o,s,e),l=fn(s,a,e),u=fn(c,l,e);return[["C"].concat(o,c,u),["C"].concat(l,a,A)]}(i):[t,t]:[t],{s:t,ss:r,l:A}})}function Un(t,e,n,r){if(void 0===r&&(r=0),r>50)return console.warn("Maximum recursion depth reached in equalizeSegments"),[t,e];var i=Sn(t),A=Sn(e),o=i.length,s=A.length,a=i.filter(function(t){return t.l}).length,c=A.filter(function(t){return t.l}).length,l=i.filter(function(t){return t.l}).reduce(function(t,e){return t+e.l},0)/a||0,u=A.filter(function(t){return t.l}).reduce(function(t,e){return t+e.l},0)/c||0,h=n||Math.max(o,s),d=[l,u],f=[h-o,h-s],g=0,p=[i,A].map(function(t,e){return t.l===h?t.map(function(t){return t.s}):t.map(function(t,n){return g=n&&f[e]&&t.l>=d[e],f[e]-=g?1:0,g?t.ss:[t.s]}).flat()});return p[0].length===p[1].length?p:Un(p[0],p[1],h,r+1)}function Tn(t){var e=document.createElement("div");e.innerHTML=t;var n=e.childNodes[0];return n&&e.contains(n)&&e.removeChild(n),n}function On(){return On="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},On.apply(null,arguments)}function Nn(t,e,n,r){var i=On(d(t.prototype),e,n);return"function"==typeof i?function(t){return i.apply(n,t)}:i}
/*!
   * @antv/g-math
   * @description Geometry util
   * @version 3.1.0
   * @date 12/22/2025, 3:02:36 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */function In(t,e,n,r){var i=t-n,A=e-r;return Math.sqrt(i*i+A*A)}function Ln(t,e){var n=Math.min.apply(Math,h(t)),r=Math.min.apply(Math,h(e));return{x:n,y:r,width:Math.max.apply(Math,h(t))-n,height:Math.max.apply(Math,h(e))-r}}function Dn(t,e,n,r,i,A){return n*Math.cos(i)*Math.cos(A)-r*Math.sin(i)*Math.sin(A)+t}function Pn(t,e,n,r,i,A){return n*Math.sin(i)*Math.cos(A)+r*Math.cos(i)*Math.sin(A)+e}function Rn(t,e,n,r,i,A,o){for(var s=function(t,e,n){return Math.atan(-e/t*Math.tan(n))}(n,r,i),a=1/0,c=-1/0,l=[A,o],u=2*-Math.PI;u<=2*Math.PI;u+=Math.PI){var h=s+u;A<o?A<h&&h<o&&l.push(h):o<h&&h<A&&l.push(h)}for(var d=0;d<l.length;d++){var f=Dn(t,0,n,r,i,l[d]);f<a&&(a=f),f>c&&(c=f)}for(var g=function(t,e,n){return Math.atan(e/(t*Math.tan(n)))}(n,r,i),p=1/0,v=-1/0,m=[A,o],y=2*-Math.PI;y<=2*Math.PI;y+=Math.PI){var w=g+y;A<o?A<w&&w<o&&m.push(w):o<w&&w<A&&m.push(w)}for(var B=0;B<m.length;B++){var b=Pn(0,e,n,r,i,m[B]);b<p&&(p=b),b>v&&(v=b)}return{x:a,y:p,width:c-a,height:v-p}}function Hn(t,e,n,r,i,A){var o=-1,s=1/0,a=[n,r],c=20;A&&A>200&&(c=A/10);for(var l=1/c,u=l/10,d=0;d<=c;d++){var f=d*l,g=[i.apply(void 0,h(t.concat([f]))),i.apply(void 0,h(e.concat([f])))],p=In(a[0],a[1],g[0],g[1]);p<s&&(o=f,s=p)}if(0===o)return{x:t[0],y:e[0]};if(1===o){var v=t.length;return{x:t[v-1],y:e[v-1]}}s=1/0;for(var m=0;m<32&&!(u<1e-4);m++){var y=o-u,w=o+u,B=[i.apply(void 0,h(t.concat([y]))),i.apply(void 0,h(e.concat([y])))],b=In(a[0],a[1],B[0],B[1]);if(y>=0&&b<s)o=y,s=b;else{var E=[i.apply(void 0,h(t.concat([w]))),i.apply(void 0,h(e.concat([w])))],x=In(a[0],a[1],E[0],E[1]);w<=1&&x<s?(o=w,s=x):u*=.5}}return{x:i.apply(void 0,h(t.concat([o]))),y:i.apply(void 0,h(e.concat([o])))}}function _n(t,e,n,r){return In(t,e,n,r)}function Gn(t,e,n,r,i){return{x:(1-i)*t+i*n,y:(1-i)*e+i*r}}function Kn(t,e,n,r,i,A){var o=[n-t,r-e];if(function(t,e){return t[0]===e[0]&&t[1]===e[1]}(o,[0,0]))return Math.sqrt((i-t)*(i-t)+(A-e)*(A-e));var s=[-o[1],o[0]];!function(t,e){var n=e[0],r=e[1],i=n*n+r*r;i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i}(s,s);var a=[i-t,A-e];return Math.abs(function(t,e){return t[0]*e[0]+t[1]*e[1]}(a,s))}function jn(t,e,n,r,i){var A=1-i;return A*A*A*t+3*e*i*A*A+3*n*i*i*A+r*i*i*i}function Vn(t,e,n,r){var i,A,o,s=-3*t+9*e-9*n+3*r,a=6*t-12*e+6*n,c=3*e-3*t,l=[];if(se(s,0))se(a,0)||(i=-c/a)>=0&&i<=1&&l.push(i);else{var u=a*a-4*s*c;se(u,0)?l.push(-a/(2*s)):u>0&&(A=(-a-(o=Math.sqrt(u)))/(2*s),(i=(-a+o)/(2*s))>=0&&i<=1&&l.push(i),A>=0&&A<=1&&l.push(A))}return l}function zn(t,e,n,r,i,A,o,s){for(var a=[t,o],c=[e,s],l=Vn(t,n,i,o),u=Vn(e,r,A,s),h=0;h<l.length;h++)a.push(jn(t,n,i,o,l[h]));for(var d=0;d<u.length;d++)c.push(jn(e,r,A,s,u[d]));return Ln(a,c)}function Wn(t,e,n,r,i,A,o,s,a,c,l){var u=function(t,e,n,r,i,A,o,s,a,c,l){return Hn([t,n,i,o],[e,r,A,s],a,c,jn,l)}(t,e,n,r,i,A,o,s,a,c,l);return In(u.x,u.y,a,c)}function Yn(t){return function(t){if(t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var r=t[n],i=t[n+1];e+=In(r[0],r[1],i[0],i[1])}return e}(t)}function Xn(t,e,n,r){var i=1-r;return i*i*t+2*r*i*e+r*r*n}function qn(t,e,n){var r=t+n-2*e;if(se(r,0))return[.5];var i=(t-e)/r;return i<=1&&i>=0?[i]:[]}function Zn(t,e,n,r,i,A){var o=qn(t,n,i)[0],s=qn(e,r,A)[0],a=[t,i],c=[e,A];return void 0!==o&&a.push(Xn(t,n,i,o)),void 0!==s&&c.push(Xn(e,r,A,s)),Ln(a,c)}function Jn(t,e,n,r,i,A,o,s){var a=function(t,e,n,r,i,A,o,s){return Hn([t,n,i],[e,r,A],o,s,Xn)}(t,e,n,r,i,A,o,s);return In(a.x,a.y,o,s)}function $n(t,e){this.v=t,this.k=e}function tr(t,e,n,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}tr=function(t,e,n,r){function A(e,n){tr(t,e,function(t){return this._invoke(e,n,t)})}e?i?i(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(A("next",0),A("throw",1),A("return",2))},tr(t,e,n,r)}function er(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.toStringTag||"@@toStringTag";function A(n,r,i,A){var a=r&&r.prototype instanceof s?r:s,c=Object.create(a.prototype);return tr(c,"_invoke",function(n,r,i){var A,s,a,c=0,l=i||[],u=!1,h={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return A=e,s=0,a=t,h.n=n,o}};function d(n,r){for(s=n,a=r,e=0;!u&&c&&!i&&e<l.length;e++){var i,A=l[e],d=h.p,f=A[2];n>3?(i=f===r)&&(a=A[(s=A[4])?5:(s=3,3)],A[4]=A[5]=t):A[0]<=d&&((i=n<2&&d<A[1])?(s=0,h.v=r,h.n=A[1]):d<f&&(i=n<3||A[0]>r||r>f)&&(A[4]=n,A[5]=r,h.n=f,s=0))}if(i||n>1)return o;throw u=!0,r}return function(i,l,f){if(c>1)throw TypeError("Generator is already running");for(u&&1===l&&d(l,f),s=l,a=f;(e=s<2?t:a)||!u;){A||(s?s<3?(s>1&&(h.n=-1),d(s,a)):h.n=a:h.v=a);try{if(c=2,A){if(s||(i="next"),e=A[i]){if(!(e=e.call(A,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,s<2&&(s=0)}else 1===s&&(e=A.return)&&e.call(A),s<2&&(a=TypeError("The iterator does not provide a '"+i+"' method"),s=1);A=t}else if((e=(u=h.n<0)?a:n.call(r,h))!==o)break}catch(e){A=t,s=1,a=e}finally{c=1}}return{value:e,done:u}}}(n,i,A),!0),c}var o={};function s(){}function a(){}function c(){}e=Object.getPrototypeOf;var l=[][r]?e(e([][r]())):(tr(e={},r,function(){return this}),e),u=c.prototype=s.prototype=Object.create(l);function h(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,tr(t,i,"GeneratorFunction")),t.prototype=Object.create(u),t}return a.prototype=c,tr(u,"constructor",c),tr(c,"constructor",a),a.displayName="GeneratorFunction",tr(c,i,"GeneratorFunction"),tr(u),tr(u,i,"Generator"),tr(u,r,function(){return this}),tr(u,"toString",function(){return"[object Generator]"}),(er=function(){return{w:A,m:h}})()}function nr(t,e){function n(r,i,A,o){try{var s=t[r](i),a=s.value;return a instanceof $n?e.resolve(a.v).then(function(t){n("next",t,A,o)},function(t){n("throw",t,A,o)}):e.resolve(a).then(function(t){s.value=t,A(s)},function(t){return n("throw",t,A,o)})}catch(t){o(t)}}var r;this.next||(tr(nr.prototype),tr(nr.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),tr(this,"_invoke",function(t,i,A){function o(){return new e(function(e,r){n(t,A,e,r)})}return r=r?r.then(o,o):o()},!0)}function rr(t,e,n,r,i){return new nr(er().w(t,e,n,r),i||Promise)}function ir(t,e,n,r,i){var A=rr(t,e,n,r,i);return A.next().then(function(t){return t.done?t.value:A.next()})}function Ar(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}}function or(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(n(t)+" is not iterable")}function sr(){var t=er(),e=t.m(sr),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function r(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var i={throw:1,return:2,break:3,continue:3};function A(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,i[t],e)},delegateYield:function(t,i,A){return e.resultName=i,n(r.d,or(t),A)},finish:function(t){return n(r.f,t)}},n=function(t,n,i){r.p=e.prev,r.n=e.next;try{return t(n,i)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(sr=function(){return{wrap:function(e,n,r,i){return t.w(A(e),n,r,i&&i.reverse())},isGeneratorFunction:r,mark:t.m,awrap:function(t,e){return new $n(t,e)},AsyncIterator:nr,async:function(t,e,n,i,o){return(r(e)?rr:ir)(A(t),e,n,i,o)},keys:Ar,values:or}})()}function ar(t,e,n,r,i,A,o){try{var s=t[A](o),a=s.value}catch(t){return void n(t)}s.done?e(a):Promise.resolve(a).then(r,i)}function cr(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var A=t.apply(e,n);function o(t){ar(A,r,i,o,s,"next",t)}function s(t){ar(A,r,i,o,s,"throw",t)}o(void 0)})}}function lr(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=u(t))||e){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var A,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,A=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw A}}}}function ur(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(-1!==e.indexOf(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(t);for(r=0;r<A.length;r++)n=A[r],-1===e.indexOf(n)&&{}.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}
/*!
   * @antv/g-lite
   * @description A core module for rendering engine implements DOM API.
   * @version 2.7.0
   * @date 12/24/2025, 11:55:20 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */var hr=function(t){return t.GROUP="g",t.FRAGMENT="fragment",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh",t}({}),dr=function(t){return t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE",t}({}),fr=function(){return c(function t(){s(this,t),this.plugins=[]},[{key:"addRenderingPlugin",value:function(t){this.plugins.push(t),this.context.renderingPlugins.push(t)}},{key:"removeAllRenderingPlugins",value:function(){var t=this;this.plugins.forEach(function(e){var n=t.context.renderingPlugins.indexOf(e);n>=0&&t.context.renderingPlugins.splice(n,1)})}}])}(),gr=function(){return c(function t(e){s(this,t),this.clipSpaceNearZ=dr.NEGATIVE_ONE,this.plugins=[],this.config=o({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},e)},[{key:"registerPlugin",value:function(t){var e=this.plugins.findIndex(function(e){return e===t});-1===e&&this.plugins.push(t)}},{key:"unregisterPlugin",value:function(t){var e=this.plugins.findIndex(function(e){return e===t});e>-1&&this.plugins.splice(e,1)}},{key:"getPlugins",value:function(){return this.plugins}},{key:"getPlugin",value:function(t){return this.plugins.find(function(e){return e.name===t})}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(t){Object.assign(this.config,t)}}])}(),pr=vt,vr=gt,mr=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},yr=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},wr=yt,Br=Ft,br=function(){function t(){s(this,t),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return c(t,[{key:"update",value:function(t,e){vr(this.center,t),vr(this.halfExtents,e),Br(this.min,this.center,this.halfExtents),pr(this.max,this.center,this.halfExtents)}},{key:"setMinMax",value:function(t,e){pr(this.center,e,t),wr(this.center,this.center,.5),Br(this.halfExtents,e,t),wr(this.halfExtents,this.halfExtents,.5),vr(this.min,t),vr(this.max,e)}},{key:"getMin",value:function(){return this.min}},{key:"getMax",value:function(){return this.max}},{key:"add",value:function(e){if(!t.isEmpty(e))if(t.isEmpty(this))this.setMinMax(e.getMin(),e.getMax());else{var n=this.center,r=n[0],i=n[1],A=n[2],o=this.halfExtents,s=o[0],a=o[1],c=o[2],l=r-s,u=r+s,h=i-a,d=i+a,f=A-c,g=A+c,p=e.center,v=p[0],m=p[1],y=p[2],w=e.halfExtents,B=w[0],b=w[1],E=w[2],x=v-B,C=v+B,F=m-b,M=m+b,k=y-E,Q=y+E;x<l&&(l=x),C>u&&(u=C),F<h&&(h=F),M>d&&(d=M),k<f&&(f=k),Q>g&&(g=Q),n[0]=.5*(l+u),n[1]=.5*(h+d),n[2]=.5*(f+g),o[0]=.5*(u-l),o[1]=.5*(d-h),o[2]=.5*(g-f),this.min[0]=l,this.min[1]=h,this.min[2]=f,this.max[0]=u,this.max[1]=d,this.max[2]=g}}},{key:"setFromTransformedAABB",value:function(t,e){var n=this.center,r=this.halfExtents,i=t.center,A=t.halfExtents,o=e[0],s=e[4],a=e[8],c=e[1],l=e[5],u=e[9],h=e[2],d=e[6],f=e[10],g=Math.abs(o),p=Math.abs(s),v=Math.abs(a),m=Math.abs(c),y=Math.abs(l),w=Math.abs(u),B=Math.abs(h),b=Math.abs(d),E=Math.abs(f);n[0]=e[12]+o*i[0]+s*i[1]+a*i[2],n[1]=e[13]+c*i[0]+l*i[1]+u*i[2],n[2]=e[14]+h*i[0]+d*i[1]+f*i[2],r[0]=g*A[0]+p*A[1]+v*A[2],r[1]=m*A[0]+y*A[1]+w*A[2],r[2]=B*A[0]+b*A[1]+E*A[2],Br(this.min,n,r),pr(this.max,n,r)}},{key:"intersects",value:function(t){var e=this.getMax(),n=this.getMin(),r=t.getMax(),i=t.getMin();return n[0]<=r[0]&&e[0]>=i[0]&&n[1]<=r[1]&&e[1]>=i[1]&&n[2]<=r[2]&&e[2]>=i[2]}},{key:"intersection",value:function(e){if(!this.intersects(e))return null;var n=new t,r=mr([0,0,0],this.getMin(),e.getMin()),i=yr([0,0,0],this.getMax(),e.getMax());return n.setMinMax(r,i),n}},{key:"getNegativeFarPoint",value:function(t){return 273===t.pnVertexFlag?vr([0,0,0],this.min):272===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:257===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:256===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:17===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:16===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:1===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:"getPositiveFarPoint",value:function(t){return 273===t.pnVertexFlag?vr([0,0,0],this.max):272===t.pnVertexFlag?[this.max[0],this.max[1],this.min[2]]:257===t.pnVertexFlag?[this.max[0],this.min[1],this.max[2]]:256===t.pnVertexFlag?[this.max[0],this.min[1],this.min[2]]:17===t.pnVertexFlag?[this.min[0],this.max[1],this.max[2]]:16===t.pnVertexFlag?[this.min[0],this.max[1],this.min[2]]:1===t.pnVertexFlag?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:"isEmpty",value:function(t){return!t||0===t.halfExtents[0]&&0===t.halfExtents[1]&&0===t.halfExtents[2]}}])}(),Er=function(){return c(function t(e,n){s(this,t),this.distance=e||0,this.normal=n||ft(0,1,0),this.updatePNVertexFlag()},[{key:"updatePNVertexFlag",value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:"distanceToPoint",value:function(t){return Bt(t,this.normal)-this.distance}},{key:"normalize",value:function(){var t=1/kt(this.normal);yt(this.normal,this.normal,t),this.distance*=t}},{key:"intersectsLine",value:function(t,e,n){var r=this.distanceToPoint(t),i=r/(r-this.distanceToPoint(e)),A=i>=0&&i<=1;return A&&n&&Et(n,t,e,i),A}}])}(),xr=function(t){return t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE",t}({}),Cr=function(){return c(function t(e){if(s(this,t),this.planes=[],e)this.planes=e;else for(var n=0;n<6;n++)this.planes.push(new Er)},[{key:"extractFromVPMatrix",value:function(t){var e=y(t,16),n=e[0],r=e[1],i=e[2],A=e[3],o=e[4],s=e[5],a=e[6],c=e[7],l=e[8],u=e[9],h=e[10],d=e[11],f=e[12],g=e[13],p=e[14],v=e[15];pt(this.planes[0].normal,A-n,c-o,d-l),this.planes[0].distance=v-f,pt(this.planes[1].normal,A+n,c+o,d+l),this.planes[1].distance=v+f,pt(this.planes[2].normal,A+r,c+s,d+u),this.planes[2].distance=v+g,pt(this.planes[3].normal,A-r,c-s,d-u),this.planes[3].distance=v-g,pt(this.planes[4].normal,A-i,c-a,d-h),this.planes[4].distance=v-p,pt(this.planes[5].normal,A+i,c+a,d+h),this.planes[5].distance=v+p,this.planes.forEach(function(t){t.normalize(),t.updatePNVertexFlag()})}}])}(),Fr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;s(this,t),this.x=0,this.y=0,this.x=e,this.y=n}return c(t,[{key:"clone",value:function(){return new t(this.x,this.y)}},{key:"copyFrom",value:function(t){this.x=t.x,this.y=t.y}}])}(),Mr=function(){function t(e,n,r,i){s(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.left=e,this.right=e+r,this.top=n,this.bottom=n+i}return c(t,[{key:"toJSON",value:function(){}}],[{key:"fromRect",value:function(e){return new t(e.x,e.y,e.width,e.height)}},{key:"applyTransform",value:function(e,n){var r=St(e.x,e.y,0,1),i=St(e.x+e.width,e.y,0,1),A=St(e.x,e.y+e.height,0,1),o=St(e.x+e.width,e.y+e.height,0,1),s=Qt(),a=Qt(),c=Qt(),l=Qt();Ut(s,r,n),Ut(a,i,n),Ut(c,A,n),Ut(l,o,n);var u=Math.min(s[0],a[0],c[0],l[0]),h=Math.min(s[1],a[1],c[1],l[1]),d=Math.max(s[0],a[0],c[0],l[0]),f=Math.max(s[1],a[1],c[1],l[1]);return t.fromRect({x:u,y:h,width:d-u,height:f-h})}}])}(),kr="Method not implemented.",Qr="Use document.documentElement instead.";function Sr(t){return void 0===t?0:t>360||t<-360?t%360:t}var Ur=ut();function Tr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return Array.isArray(t)&&3===t.length?r?ht(t):gt(Ur,t):oe(t)?r?ft(t,e,n):pt(Ur,t,e,n):r?ft(t[0],t[1]||e,t[2]||n):pt(Ur,t[0],t[1]||e,t[2]||n)}var Or=Math.PI/180;function Nr(t){return t*Or}var Ir=180/Math.PI;function Lr(t){return t*Ir}var Dr=Math.PI/2;function Pr(t,e){return 16===e.length?function(t,e){var n,r,i=y(q(ut(),e),3),A=i[0],o=i[1],s=i[2],a=Math.asin(-e[2]/A);return a<Dr?a>-Dr?(n=Math.atan2(e[6]/o,e[10]/s),r=Math.atan2(e[1]/A,e[0]/A)):(r=0,n=-Math.atan2(e[4]/o,e[5]/o)):(r=0,n=Math.atan2(e[4]/o,e[5]/o)),t[0]=n,t[1]=a,t[2]=r,t}(t,e):function(t,e){var n=e[0],r=e[1],i=e[2],A=e[3],o=r*r,s=i*i,a=A*A,c=n*n+o+s+a,l=n*A-r*i;return l>.499995*c?(t[0]=Dr,t[1]=2*Math.atan2(r,n),t[2]=0):l<-.499995*c?(t[0]=-Dr,t[1]=2*Math.atan2(r,n),t[2]=0):(t[0]=Math.asin(2*(n*i-A*r)),t[1]=Math.atan2(2*(n*A+r*i),1-2*(s+a)),t[2]=Math.atan2(2*(n*r+i*A),1-2*(o+s))),t}(t,e)}function Rr(t,e,n,r,i){var A,o,s,a,c,l,u,h,d,f,g=Math.cos(t),p=Math.sin(t);return A=r*g,o=i*p,s=0,a=-r*p,c=i*g,l=0,u=e,h=n,d=1,(f=new F(9))[0]=A,f[1]=o,f[2]=s,f[3]=a,f[4]=c,f[5]=l,f[6]=u,f[7]=h,f[8]=d,f}function Hr(t){var e=t[0],n=t[1],r=t[3],i=t[4],A=Math.sqrt(e*e+n*n),o=Math.sqrt(r*r+i*i);if(e*i-n*r<0&&(e<i?A=-A:o=-o),A){var s=1/A;e*=s,n*=s}if(o){var a=1/o;r*=a,i*=a}var c=Lr(Math.atan2(n,e));return[t[6],t[7],A,o,c]}var _r=k(),Gr=k(),Kr=Qt(),jr=[ut(),ut(),ut()],Vr=ut();function zr(t,e,n,r,i){t[0]=e[0]*r+n[0]*i,t[1]=e[1]*r+n[1]*i,t[2]=e[2]*r+n[2]*i}var Wr=function(t){return t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING",t}({}),Yr=function(t){return t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC",t}({}),Xr=function(t){return t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE",t}({}),qr="updated",Zr=2e-4,Jr=function(){return c(function t(){s(this,t),this.clipSpaceNearZ=dr.NEGATIVE_ONE,this.eventEmitter=new x,this.matrix=k(),this.right=ft(1,0,0),this.up=ft(0,1,0),this.forward=ft(0,0,1),this.position=ft(0,0,1),this.focalPoint=ft(0,0,0),this.distanceVector=ft(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=k(),this.projectionMatrixInverse=k(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Wr.EXPLORING,this.trackingMode=Yr.DEFAULT,this.projectionMode=Xr.PERSPECTIVE,this.frustum=new Cr,this.orthoMatrix=k()},[{key:"isOrtho",value:function(){return this.projectionMode===Xr.ORTHOGRAPHIC}},{key:"getProjectionMode",value:function(){return this.projectionMode}},{key:"getPerspective",value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:"getPerspectiveInverse",value:function(){return this.projectionMatrixInverse}},{key:"getFrustum",value:function(){return this.frustum}},{key:"getPosition",value:function(){return this.position}},{key:"getFocalPoint",value:function(){return this.focalPoint}},{key:"getDollyingStep",value:function(){return this.dollyingStep}},{key:"getNear",value:function(){return this.near}},{key:"getFar",value:function(){return this.far}},{key:"getZoom",value:function(){return this.zoom}},{key:"getOrthoMatrix",value:function(){return this.orthoMatrix}},{key:"getView",value:function(){return this.view}},{key:"setEnableUpdate",value:function(t){this.enableUpdate=t}},{key:"setType",value:function(t,e){return this.type=t,this.type===Wr.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Wr.TRACKING&&void 0!==e&&this.setTrackingMode(e),this}},{key:"setProjectionMode",value:function(t){return this.projectionMode=t,this}},{key:"setTrackingMode",value:function(t){if(this.type!==Wr.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=t,this}},{key:"setWorldRotation",value:function(t){return this.rotateWorld=t,this._getAngles(),this}},{key:"getViewTransform",value:function(){return I(k(),this.matrix)}},{key:"getWorldTransform",value:function(){return this.matrix}},{key:"jitterProjectionMatrix",value:function(t,e){var n=G(k(),[t,e,0]);this.jitteredProjectionMatrix=D(k(),n,this.projectionMatrix)}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0}},{key:"setMatrix",value:function(t){return this.matrix=t,this._update(),this}},{key:"setProjectionMatrix",value:function(t){this.projectionMatrix=t}},{key:"setFov",value:function(t){return this.setPerspective(this.near,this.far,t,this.aspect),this}},{key:"setAspect",value:function(t){return this.setPerspective(this.near,this.far,this.fov,t),this}},{key:"setNear",value:function(t){return this.projectionMode===Xr.PERSPECTIVE?this.setPerspective(t,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,t,this.far),this}},{key:"setFar",value:function(t){return this.projectionMode===Xr.PERSPECTIVE?this.setPerspective(this.near,t,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,t),this}},{key:"setViewOffset",value:function(t,e,n,r,i,A){return this.aspect=t/e,void 0===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=A,this.projectionMode===Xr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"clearViewOffset",value:function(){return void 0!==this.view&&(this.view.enabled=!1),this.projectionMode===Xr.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:"setZoom",value:function(t){return this.zoom=t,this.projectionMode===Xr.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Xr.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:"setZoomByViewportPoint",value:function(t,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),r=n.x,i=n.y,A=this.roll;this.rotate(0,0,-A),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(t),this.rotate(0,0,A);var o=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),s=ft(o.x-r,o.y-i,0),a=Bt(s,this.right)/dt(this.right),c=Bt(s,this.up)/dt(this.up),l=y(this.getPosition(),2),u=l[0],h=l[1],d=y(this.getFocalPoint(),2),f=d[0],g=d[1];return this.setPosition(u-a,h-c),this.setFocalPoint(f-a,g-c),this}},{key:"setPerspective",value:function(t,e,n,r){var i;this.projectionMode=Xr.PERSPECTIVE,this.fov=n,this.near=t,this.far=e,this.aspect=r;var A=this.near*Math.tan(Nr(.5*this.fov))/this.zoom,o=2*A,s=this.aspect*o,a=-.5*s;if(null!==(i=this.view)&&void 0!==i&&i.enabled){var c=this.view.fullWidth,l=this.view.fullHeight;a+=this.view.offsetX*s/c,A-=this.view.offsetY*o/l,s*=this.view.width/c,o*=this.view.height/l}return function(t,e,n,r,i,A,o){var s,a,c=2*A,l=n-e,u=r-i,h=c/l,d=c/u,f=(n+e)/l,g=(r+i)/u,p=o-A,v=o*A;arguments.length>7&&void 0!==arguments[7]&&arguments[7]?(s=-o/p,a=-v/p):(s=-(o+A)/p,a=-2*v/p),t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=f,t[9]=g,t[10]=s,t[11]=-1,t[12]=0,t[13]=0,t[14]=a,t[15]=0}(this.projectionMatrix,a,a+s,A-o,A,t,this.far,this.clipSpaceNearZ===dr.ZERO),I(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:"setOrthographic",value:function(t,e,n,r,i,A){var o;this.projectionMode=Xr.ORTHOGRAPHIC,this.rright=e,this.left=t,this.top=n,this.bottom=r,this.near=i,this.far=A;var s=(this.rright-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),c=(this.rright+this.left)/2,l=(this.top+this.bottom)/2,u=c-s,h=c+s,d=l+a,f=l-a;if(null!==(o=this.view)&&void 0!==o&&o.enabled){var g=(this.rright-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;h=(u+=g*this.view.offsetX)+g*this.view.width,f=(d-=p*this.view.offsetY)-p*this.view.height}return this.clipSpaceNearZ===dr.NEGATIVE_ONE?rt(this.projectionMatrix,u,h,d,f,i,A):it(this.projectionMatrix,u,h,d,f,i,A),I(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:"setPosition",value:function(t){var e=Tr(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.position[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.position[2]);return this._setPosition(e),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:"setFocalPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.focalPoint[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.focalPoint[2],r=ft(0,1,0);if(this.focalPoint=Tr(t,e,n),this.trackingMode===Yr.CINEMATIC){var i=mt(ut(),this.focalPoint,this.position);t=i[0],e=i[1],n=i[2];var A=dt(i),o=Lr(Math.asin(e/A)),s=90+Lr(Math.atan2(n,t)),a=k();_(a,a,Nr(s)),H(a,a,Nr(o)),r=xt(ut(),[0,1,0],a)}return I(this.matrix,At(k(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:"getDistance",value:function(){return this.distance}},{key:"getDistanceVector",value:function(){return this.distanceVector}},{key:"setDistance",value:function(t){if(this.distance===t||t<0)return this;this.distance=t,this.distance<Zr&&(this.distance=Zr),this.dollyingStep=this.distance/100;var e=ut();t=this.distance;var n=this.forward,r=this.focalPoint;return e[0]=t*n[0]+r[0],e[1]=t*n[1]+r[1],e[2]=t*n[2]+r[2],this._setPosition(e),this.triggerUpdate(),this}},{key:"setMaxDistance",value:function(t){return this.maxDistance=t,this}},{key:"setMinDistance",value:function(t){return this.minDistance=t,this}},{key:"setAzimuth",value:function(t){return this.azimuth=Sr(t),this.computeMatrix(),this._getAxes(),this.type===Wr.ORBITING||this.type===Wr.EXPLORING?this._getPosition():this.type===Wr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getAzimuth",value:function(){return this.azimuth}},{key:"setElevation",value:function(t){return this.elevation=Sr(t),this.computeMatrix(),this._getAxes(),this.type===Wr.ORBITING||this.type===Wr.EXPLORING?this._getPosition():this.type===Wr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getElevation",value:function(){return this.elevation}},{key:"setRoll",value:function(t){return this.roll=Sr(t),this.computeMatrix(),this._getAxes(),this.type===Wr.ORBITING||this.type===Wr.EXPLORING?this._getPosition():this.type===Wr.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:"getRoll",value:function(){return this.roll}},{key:"_update",value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:"computeMatrix",value:function(){var t=Ot(Tt(),[0,0,1],Nr(this.roll));O(this.matrix);var e=Ot(Tt(),[1,0,0],Nr((this.rotateWorld&&this.type!==Wr.TRACKING||this.type===Wr.TRACKING?1:-1)*this.elevation)),n=Ot(Tt(),[0,1,0],Nr((this.rotateWorld&&this.type!==Wr.TRACKING||this.type===Wr.TRACKING?1:-1)*this.azimuth)),r=Nt(Tt(),n,e);r=Nt(Tt(),r,t);var i=$(k(),r);this.type===Wr.ORBITING||this.type===Wr.EXPLORING?(P(this.matrix,this.matrix,this.focalPoint),D(this.matrix,this.matrix,i),P(this.matrix,this.matrix,[0,0,this.distance])):this.type===Wr.TRACKING&&(P(this.matrix,this.matrix,this.position),D(this.matrix,this.matrix,i))}},{key:"_setPosition",value:function(t,e,n){this.position=Tr(t,e,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()}},{key:"_getAxes",value:function(){gt(this.right,Tr(Ut(Qt(),[1,0,0,0],this.matrix))),gt(this.up,Tr(Ut(Qt(),[0,1,0,0],this.matrix))),gt(this.forward,Tr(Ut(Qt(),[0,0,1,0],this.matrix))),wt(this.right,this.right),wt(this.up,this.up),wt(this.forward,this.forward)}},{key:"_getAngles",value:function(){var t=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],r=dt(this.distanceVector);if(0===r)return this.elevation=0,void(this.azimuth=0);this.type===Wr.TRACKING||this.rotateWorld?(this.elevation=Lr(Math.asin(e/r)),this.azimuth=Lr(Math.atan2(-t,-n))):(this.elevation=-Lr(Math.asin(e/r)),this.azimuth=-Lr(Math.atan2(-t,-n)))}},{key:"_getPosition",value:function(){gt(this.position,Tr(Ut(Qt(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:"_getFocalPoint",value:function(){!function(t,e,n){var r=e[0],i=e[1],A=e[2];t[0]=r*n[0]+i*n[3]+A*n[6],t[1]=r*n[1]+i*n[4]+A*n[7],t[2]=r*n[2]+i*n[5]+A*n[8]}(this.distanceVector,[0,0,-this.distance],function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}(M(),this.matrix)),vt(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:"_getDistance",value:function(){this.distanceVector=mt(ut(),this.focalPoint,this.position),this.distance=dt(this.distanceVector),this.dollyingStep=this.distance/100}},{key:"_getOrthoMatrix",value:function(){if(this.projectionMode===Xr.ORTHOGRAPHIC){var t=this.position,e=Ot(Tt(),[0,0,1],-this.roll*Math.PI/180);J(this.orthoMatrix,e,ft((this.rright-this.left)/2-t[0],(this.top-this.bottom)/2-t[1],0),ft(this.zoom,this.zoom,1),t)}}},{key:"triggerUpdate",value:function(){if(this.enableUpdate){var t=this.getViewTransform(),e=D(k(),this.getPerspective(),t);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(qr)}}},{key:"rotate",value:function(t,e,n){throw new Error(kr)}},{key:"pan",value:function(t,e){throw new Error(kr)}},{key:"dolly",value:function(t){throw new Error(kr)}},{key:"createLandmark",value:function(t,e){throw new Error(kr)}},{key:"gotoLandmark",value:function(t,e){throw new Error(kr)}},{key:"cancelLandmarkAnimation",value:function(){throw new Error(kr)}}])}(),$r=function(t){return t[t.Standard=0]="Standard",t}({}),ti=function(t){return t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED",t}({}),ei=ut(),ni=k(),ri=Tt();function ii(t){if(t.localDirtyFlag){if(0!==t.localSkew[0]||0!==t.localSkew[1]){J(t.localTransform,t.localRotation,t.localPosition,ft(1,1,1),t.origin),0===t.localSkew[0]&&0===t.localSkew[1]||(O(ni),ni[4]=Math.tan(t.localSkew[0]),ni[1]=Math.tan(t.localSkew[1]),D(t.localTransform,t.localTransform,ni));var e=J(ni,Rt(ri,0,0,0,1),pt(ei,1,1,1),t.localScale,t.origin);D(t.localTransform,t.localTransform,e)}else{var n=t.localTransform,r=t.localPosition,i=t.localRotation,A=t.localScale,o=t.origin,s=0!==r[0]||0!==r[1]||0!==r[2],a=1!==i[3]||0!==i[0]||0!==i[1]||0!==i[2],c=1!==A[0]||1!==A[1]||1!==A[2],l=0!==o[0]||0!==o[1]||0!==o[2];a||c||l?J(n,i,r,A,o):s?G(n,r):O(n)}t.localDirtyFlag=!1}}var Ai={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Mr(0,0,0,0)},oi=function(t){return t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>",t}({});function si(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ai(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ci(){}var li=.7,ui=1/li,hi="\\s*([+-]?\\d+)\\s*",di="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gi=/^#([0-9a-f]{3,8})$/,pi=new RegExp(`^rgb\\(${hi},${hi},${hi}\\)$`),vi=new RegExp(`^rgb\\(${fi},${fi},${fi}\\)$`),mi=new RegExp(`^rgba\\(${hi},${hi},${hi},${di}\\)$`),yi=new RegExp(`^rgba\\(${fi},${fi},${fi},${di}\\)$`),wi=new RegExp(`^hsl\\(${di},${fi},${fi}\\)$`),Bi=new RegExp(`^hsla\\(${di},${fi},${fi},${di}\\)$`),bi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ei(){return this.rgb().formatHex()}function xi(){return this.rgb().formatRgb()}function Ci(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=gi.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Fi(e):3===n?new ki(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Mi(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Mi(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=pi.exec(t))?new ki(e[1],e[2],e[3],1):(e=vi.exec(t))?new ki(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=mi.exec(t))?Mi(e[1],e[2],e[3],e[4]):(e=yi.exec(t))?Mi(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=wi.exec(t))?Ni(e[1],e[2]/100,e[3]/100,1):(e=Bi.exec(t))?Ni(e[1],e[2]/100,e[3]/100,e[4]):bi.hasOwnProperty(t)?Fi(bi[t]):"transparent"===t?new ki(NaN,NaN,NaN,0):null}function Fi(t){return new ki(t>>16&255,t>>8&255,255&t,1)}function Mi(t,e,n,r){return r<=0&&(t=e=n=NaN),new ki(t,e,n,r)}function ki(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function Qi(){return`#${Oi(this.r)}${Oi(this.g)}${Oi(this.b)}`}function Si(){const t=Ui(this.opacity);return`${1===t?"rgb(":"rgba("}${Ti(this.r)}, ${Ti(this.g)}, ${Ti(this.b)}${1===t?")":`, ${t})`}`}function Ui(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ti(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Oi(t){return((t=Ti(t))<16?"0":"")+t.toString(16)}function Ni(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Li(t,e,n,r)}function Ii(t){if(t instanceof Li)return new Li(t.h,t.s,t.l,t.opacity);if(t instanceof ci||(t=Ci(t)),!t)return new Li;if(t instanceof Li)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),A=Math.max(e,n,r),o=NaN,s=A-i,a=(A+i)/2;return s?(o=e===A?(n-r)/s+6*(n<r):n===A?(r-e)/s+2:(e-n)/s+4,s/=a<.5?A+i:2-A-i,o*=60):s=a>0&&a<1?0:o,new Li(o,s,a,t.opacity)}function Li(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Di(t){return(t=(t||0)%360)<0?t+360:t}function Pi(t){return Math.max(0,Math.min(1,t||0))}function Ri(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Hi(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){for(var r=arguments.length,i=new Array(r),A=0;A<r;A++)i[A]=arguments[A];var o=e?e.apply(this,i):i[0],s=n.cache;if(s.has(o))return s.get(o);var a=t.apply(this,i);return n.cache=s.set(o,a)||s,a};return n.cache=new(Hi.Cache||Map),Hi.cacheList.push(n.cache),n}si(ci,Ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ei,formatHex:Ei,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ii(this).formatHsl()},formatRgb:xi,toString:xi}),si(ki,function(t,e,n,r){return 1===arguments.length?function(t){return t instanceof ci||(t=Ci(t)),t?new ki((t=t.rgb()).r,t.g,t.b,t.opacity):new ki}(t):new ki(t,e,n,null==r?1:r)},ai(ci,{brighter(t){return t=null==t?ui:Math.pow(ui,t),new ki(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?li:Math.pow(li,t),new ki(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ki(Ti(this.r),Ti(this.g),Ti(this.b),Ui(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qi,formatHex:Qi,formatHex8:function(){return`#${Oi(this.r)}${Oi(this.g)}${Oi(this.b)}${Oi(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:Si,toString:Si})),si(Li,function(t,e,n,r){return 1===arguments.length?Ii(t):new Li(t,e,n,null==r?1:r)},ai(ci,{brighter(t){return t=null==t?ui:Math.pow(ui,t),new Li(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?li:Math.pow(li,t),new Li(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new ki(Ri(t>=240?t-240:t+120,i,r),Ri(t,i,r),Ri(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Li(Di(this.h),Pi(this.s),Pi(this.l),Ui(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ui(this.opacity);return`${1===t?"hsl(":"hsla("}${Di(this.h)}, ${100*Pi(this.s)}%, ${100*Pi(this.l)}%${1===t?")":`, ${t})`}`}})),Hi.Cache=Map,Hi.cacheList=[],Hi.clearCache=function(){Hi.cacheList.forEach(function(t){return t.clear()})};var _i=function(t){return t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger",t}({}),Gi=function(t){return t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther",t}({}),Ki=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),ji=function(t){return t[t.kYes=0]="kYes",t[t.kNo=1]="kNo",t}({}),Vi=[{name:"em",unit_type:_i.kEms},{name:"px",unit_type:_i.kPixels},{name:"deg",unit_type:_i.kDegrees},{name:"rad",unit_type:_i.kRadians},{name:"grad",unit_type:_i.kGradians},{name:"ms",unit_type:_i.kMilliseconds},{name:"s",unit_type:_i.kSeconds},{name:"rem",unit_type:_i.kRems},{name:"turn",unit_type:_i.kTurns}],zi=function(t){return t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType",t}({}),Wi=function(t){return t?"number"===t?_i.kNumber:"percent"===t||"%"===t?_i.kPercentage:function(t){return Vi.find(function(e){return e.name===t}).unit_type}(t):_i.kUnknown},Yi=function(t){var e=1;switch(t){case _i.kPixels:case _i.kDegrees:case _i.kSeconds:break;case _i.kMilliseconds:e=.001;break;case _i.kRadians:e=180/Math.PI;break;case _i.kGradians:e=.9;break;case _i.kTurns:e=360}return e},Xi=function(t){switch(t){case _i.kNumber:case _i.kInteger:return"";case _i.kPercentage:return"%";case _i.kEms:return"em";case _i.kRems:return"rem";case _i.kPixels:return"px";case _i.kDegrees:return"deg";case _i.kRadians:return"rad";case _i.kGradians:return"grad";case _i.kMilliseconds:return"ms";case _i.kSeconds:return"s";case _i.kTurns:return"turn"}return""},qi=function(){return c(function t(){s(this,t)},[{key:"toString",value:function(){return this.buildCSSText(Ki.kNo,ji.kNo,"")}},{key:"isNumericValue",value:function(){return this.getType()>=zi.kUnitType&&this.getType()<=zi.kClampType}}],[{key:"isAngle",value:function(t){return t===_i.kDegrees||t===_i.kRadians||t===_i.kGradians||t===_i.kTurns}},{key:"isLength",value:function(t){return t>=_i.kEms&&t<_i.kDegrees}},{key:"isRelativeUnit",value:function(t){return t===_i.kPercentage||t===_i.kEms||t===_i.kRems}},{key:"isTime",value:function(t){return t===_i.kSeconds||t===_i.kMilliseconds}}])}(),Zi=function(t){function e(t){var n;return s(this,e),(n=p(this,e)).colorSpace=t,n}return m(e,t),c(e,[{key:"getType",value:function(){return zi.kColorType}},{key:"to",value:function(t){return this}}])}(qi),Ji=function(t){return t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient",t}({}),$i=function(t){function e(t,n){var r;return s(this,e),(r=p(this,e)).type=t,r.value=n,r}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.type,this.value)}},{key:"buildCSSText",value:function(t,e,n){return n}},{key:"getType",value:function(){return zi.kColorType}}])}(qi),tA=function(t){function e(t){var n;return s(this,e),(n=p(this,e)).value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value)}},{key:"getType",value:function(){return zi.kKeywordType}},{key:"buildCSSText",value:function(t,e,n){return n+this.value}}])}(qi),eA=function(t){return function(t){switch(t){case Gi.kUNumber:return _i.kNumber;case Gi.kULength:return _i.kPixels;case Gi.kUPercent:return _i.kPercentage;case Gi.kUTime:return _i.kSeconds;case Gi.kUAngle:return _i.kDegrees;default:return _i.kUnknown}}(function(t){switch(t){case _i.kNumber:case _i.kInteger:return Gi.kUNumber;case _i.kPercentage:return Gi.kUPercent;case _i.kPixels:return Gi.kULength;case _i.kMilliseconds:case _i.kSeconds:return Gi.kUTime;case _i.kDegrees:case _i.kRadians:case _i.kGradians:case _i.kTurns:return Gi.kUAngle;default:return Gi.kUOther}}(t))},nA=function(t){function e(t){var n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_i.kNumber;return s(this,e),n=p(this,e),r="string"==typeof i?Wi(i):i,n.unit=r,n.value=t,n}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.value,this.unit)}},{key:"equals",value:function(t){var e=t;return this.value===e.value&&this.unit===e.unit}},{key:"getType",value:function(){return zi.kUnitType}},{key:"convertTo",value:function(t){if(this.unit===t)return new e(this.value,this.unit);var n=eA(this.unit);if(n!==eA(t)||n===_i.kUnknown)return null;var r=Yi(this.unit)/Yi(t);return new e(this.value*r,t)}},{key:"buildCSSText",value:function(t,e,n){var r;switch(this.unit){case _i.kUnknown:break;case _i.kInteger:r=Number(this.value).toFixed(0);break;case _i.kNumber:case _i.kPercentage:case _i.kEms:case _i.kRems:case _i.kPixels:case _i.kDegrees:case _i.kRadians:case _i.kGradians:case _i.kMilliseconds:case _i.kSeconds:case _i.kTurns:var i=this.value,A=Xi(this.unit);if(i<-999999||i>999999){var o=Xi(this.unit);r=!Number.isFinite(i)||Number.isNaN(i)?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(Number.isFinite(t)?"NaN":t>0?"infinity":"-infinity")+e}(i,o):i+(o||"")}else r="".concat(i).concat(A)}return n+=r}}])}(qi),rA=new nA(0,"px");new nA(1,"px");var iA=new nA(0,"deg"),AA=function(t){function e(t,n,r){var i,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return s(this,e),(i=p(this,e,["rgb"])).r=t,i.g=n,i.b=r,i.alpha=A,i.isNone=o,i}return m(e,t),c(e,[{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.alpha)}},{key:"buildCSSText",value:function(t,e,n){return"".concat(n,"rgba(").concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")}}])}(Zi),oA=new tA("unset"),sA={"":oA,unset:oA,initial:new tA("initial"),inherit:new tA("inherit")},aA=new AA(0,0,0,0,!0),cA=new AA(0,0,0,0),lA=Hi(function(t,e,n,r){return new AA(t,e,n,r)},function(t,e,n,r){return"rgba(".concat(t,",").concat(e,",").concat(n,",").concat(r,")")}),uA=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_i.kNumber;return new nA(t,e)};function hA(t){var e=t.type,n=t.value;return"hex"===e?"#".concat(n):"literal"===e?n:"rgb"===e?"rgb(".concat(n.join(","),")"):"rgba(".concat(n.join(","),")")}new nA(50,"%");var dA=function(){var t=/^(linear\-gradient)/i,e=/^(repeating\-linear\-gradient)/i,n=/^(radial\-gradient)/i,r=/^(repeating\-radial\-gradient)/i,i=/^(conic\-gradient)/i,A=/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,o=/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,s=/^(left|center|right|top|bottom)/i,a=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,c=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,l=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,u=/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,h=/^\(/,d=/^\)/,f=/^,/,g=/^\#([0-9a-fA-F]+)/,p=/^([a-zA-Z]+)/,v=/^rgb/i,m=/^rgba/i,y=/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/,w="";function B(t){throw new Error("".concat(w,": ").concat(t))}function b(){var t=T(E);return w.length>0&&B("Invalid input not EOF"),t}function E(){return x("linear-gradient",t,F)||x("repeating-linear-gradient",e,F)||x("radial-gradient",n,M)||x("repeating-radial-gradient",r,M)||x("conic-gradient",i,M)}function x(t,e,n){return C(e,function(e){var r=n();return r&&(P(f)||B("Missing comma before color stops")),{type:t,orientation:r,colorStops:T(O)}})}function C(t,e){var n=P(t);if(n){P(h)||B("Missing (");var r=e(n);return P(d)||B("Missing )"),r}}function F(){return D("directional",A,1)||D("angular",u,1)}function M(){var t,e,n=k();return n&&((t=[]).push(n),e=w,P(f)&&((n=k())?t.push(n):w=e)),t}function k(){var t=function(){var t=D("shape",/^(circle)/i,0);t&&(t.style=L()||Q());return t}()||function(){var t=D("shape",/^(ellipse)/i,0);t&&(t.style=I()||Q());return t}();if(t)t.at=S();else{var e=Q();if(e){t=e;var n=S();n&&(t.at=n)}else{var r=U();r&&(t={type:"default-radial",at:r})}}return t}function Q(){return D("extent-keyword",o,1)}function S(){if(D("position",/^at/,0)){var t=U();return t||B("Missing positioning value"),t}}function U(){var t={x:I(),y:I()};if(t.x||t.y)return{type:"position",value:t}}function T(t){var e=t(),n=[];if(e)for(n.push(e);P(f);)(e=t())?n.push(e):B("One extra comma");return n}function O(){var t=D("hex",g,1)||C(m,function(){return{type:"rgba",value:T(N)}})||C(v,function(){return{type:"rgb",value:T(N)}})||D("literal",p,0);return t||B("Expected color definition"),t.length=I(),t}function N(){return P(y)[1]}function I(){return D("%",c,1)||D("position-keyword",s,1)||L()}function L(){return D("px",a,1)||D("em",l,1)}function D(t,e,n){var r=P(e);if(r)return{type:t,value:r[n]}}function P(t){var e=/^[\n\r\t\s]+/.exec(w);e&&R(e[0].length);var n=t.exec(w);return n&&R(n[0].length),n}function R(t){w=w.substring(t)}return function(t){return w=t,b()}}();var fA=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,gA=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,pA=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,vA=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;var mA={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},yA=Hi(function(t){var e;return e="angular"===t.type?Number(t.value):mA[t.value]||0,uA(e,"deg")}),wA=Hi(function(t){var e=50,n=50,r="%",i="%";if("position"===(null==t?void 0:t.type)){var A=t.value,o=A.x,s=A.y;"position-keyword"===(null==o?void 0:o.type)&&("left"===o.value?e=0:"center"===o.value?e=50:"right"===o.value?e=100:"top"===o.value?n=0:"bottom"===o.value&&(n=100)),"position-keyword"===(null==s?void 0:s.type)&&("left"===s.value?e=0:"center"===s.value?n=50:"right"===s.value?e=100:"top"===s.value?n=0:"bottom"===s.value&&(n=100)),"px"!==(null==o?void 0:o.type)&&"%"!==(null==o?void 0:o.type)&&"em"!==(null==o?void 0:o.type)||(r=null==o?void 0:o.type,e=Number(o.value)),"px"!==(null==s?void 0:s.type)&&"%"!==(null==s?void 0:s.type)&&"em"!==(null==s?void 0:s.type)||(i=null==s?void 0:s.type,n=Number(s.value))}return{cx:uA(e,r),cy:uA(n,i)}}),BA=Hi(function(t){if(t.indexOf("linear")>-1||t.indexOf("radial")>-1)return dA(t).map(function(t){var e=t.type,n=t.orientation,r=t.colorStops;!function(t){var e,n,r=t.length;t[r-1].length=null!==(e=t[r-1].length)&&void 0!==e?e:{type:"%",value:"100"},r>1&&(t[0].length=null!==(n=t[0].length)&&void 0!==n?n:{type:"%",value:"0"});for(var i=0,A=Number(t[0].length.value),o=1;o<r;o++){var s,a=null===(s=t[o].length)||void 0===s?void 0:s.value;if(!zt(a)&&!zt(A)){for(var c=1;c<o-i;c++)t[i+c].length={type:"%",value:"".concat(A+(Number(a)-A)*c/(o-i))};i=o,A=Number(a)}}}(r);var i=r.map(function(t){return{offset:uA(Number(t.length.value),"%"),color:hA(t)}});if("linear-gradient"===e)return new $i(Ji.LinearGradient,{angle:n?yA(n):iA,steps:i});if("radial-gradient"===e&&(n||(n=[{type:"shape",value:"circle"}]),"shape"===n[0].type&&"circle"===n[0].value)){var A,o=wA(n[0].at),s=o.cx,a=o.cy;if(n[0].style){var c=n[0].style,l=c.type,u=c.value;A="extent-keyword"===l?function(t){return sA[t]||(sA[t]=new tA(t)),sA[t]}(u):uA(u,l)}return new $i(Ji.RadialGradient,{cx:s,cy:a,size:A,steps:i})}});var e=t[0];if("("===t[1]||"("===t[2])if("l"===e){var n=fA.exec(t);if(n){var r,i=(null===(r=n[2].match(vA))||void 0===r?void 0:r.map(function(t){return t.split(":")}))||[];return[new $i(Ji.LinearGradient,{angle:uA(parseFloat(n[1]),"deg"),steps:i.map(function(t){var e=y(t,2),n=e[0],r=e[1];return{offset:uA(100*Number(n),"%"),color:r}})})]}}else if("r"===e){var A=function(t){var e=gA.exec(t);if(e){var n,r=(null===(n=e[4].match(vA))||void 0===n?void 0:n.map(function(t){return t.split(":")}))||[];return{cx:uA(50,"%"),cy:uA(50,"%"),steps:r.map(function(t){var e=y(t,2),n=e[0],r=e[1];return{offset:uA(100*Number(n),"%"),color:r}})}}return null}(t);if(A){if(!ne(A))return[new $i(Ji.RadialGradient,A)];t=A}}else if("p"===e)return function(t){var e=pA.exec(t);if(e){var n=e[1],r=e[2];switch(n){case"a":n="repeat";break;case"x":n="repeat-x";break;case"y":n="repeat-y";break;default:n="no-repeat"}return{image:r,repetition:n}}return null}(t)});function bA(t){return t&&!!t.image}function EA(t){return t&&!zt(t.r)&&!zt(t.g)&&!zt(t.b)}var xA=Hi(function(t){if(bA(t))return o({repetition:"repeat"},t);if(zt(t)&&(t=""),"transparent"===t)return cA;if("currentColor"===t)t="black";else if("none"===t)return aA;var e=BA(t);if(e)return e;var n=Ci(t),r=[0,0,0,0];return null!==n&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),lA.apply(void 0,r)});function CA(t,e){if(EA(t)&&EA(e))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],function(t){var e=t.slice();if(e[3])for(var n=0;n<3;n++)e[n]=Math.round(Ae(e[n],0,255));return e[3]=Ae(e[3],0,1),"rgba(".concat(e.join(","),")")}]}function FA(t,e){if(zt(e))return uA(0,"px");if(e="".concat(e).trim().toLowerCase(),isFinite(Number(e))){if("px".search(t)>=0)return uA(Number(e),"px");if("deg".search(t)>=0)return uA(Number(e),"deg")}var n=[];e=e.replace(t,function(t){return n.push(t),"U".concat(t)});var r="U(".concat(t.source,")");return n.map(function(t){return uA(Number(e.replace(new RegExp("U".concat(t),"g"),"").replace(new RegExp(r,"g"),"*0")),t)})[0]}var MA=function(t){return FA(new RegExp("px","g"),t)},kA=Hi(MA);Hi(function(t){return FA(new RegExp("%","g"),t)});var QA=function(t){return oe(t)||isFinite(Number(t))?uA(Number(t)||0,"px"):FA(new RegExp("px|%|em|rem","g"),t)},SA=Hi(QA),UA=function(t){return FA(new RegExp("deg|rad|grad|turn","g"),t)},TA=Hi(UA);function OA(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,A="",o=t.value||0,s=e.value||0,a=eA(t.unit),c=t.convertTo(a),l=e.convertTo(a);return c&&l?(o=c.value,s=l.value,A=Xi(t.unit)):(nA.isLength(t.unit)||nA.isLength(e.unit))&&(o=LA(t,i,n),s=LA(e,i,n),A="px"),[o,s,function(t){return t+A}]}function NA(t){var e=0;return t.unit===_i.kDegrees?e=t.value:t.unit===_i.kRadians?e=Lr(Number(t.value)):t.unit===_i.kTurns?e=360*Number(t.value):t.value&&(e=t.value),e}function IA(t,e){var n;return Array.isArray(t)?n=t.map(function(t){return Number(t)}):ne(t)?n=t.split(" ").map(function(t){return Number(t)}):oe(t)&&(n=[t]),2===e?1===n.length?[n[0],n[0]]:[n[0],n[1]]:4===e?1===n.length?[n[0],n[0],n[0],n[0]]:2===n.length?[n[0],n[1],n[0],n[1]]:3===n.length?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:"even"===e&&n.length%2==1?[].concat(h(n),h(n)):n}function LA(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.unit===_i.kPixels)return Number(t.value);if(t.unit===_i.kPercentage&&n){var i=n.nodeName===hr.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[e]:0)+t.value/100*i.halfExtents[e]*2}return 0}var DA=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function PA(t){return t.toString()}var RA=function(t){return"number"==typeof t?uA(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?uA(Number(t)):uA(0)},HA=Hi(RA);function _A(t,e){return[t,e,PA]}function GA(t,e){return function(n,r){return[n,r,function(n){return PA(Ae(n,t,e))}]}}function KA(t,e){if(t.length===e.length)return[t,e,function(t){return t}]}function jA(t){var e;return 0===t.parsedStyle.d.totalLength&&(t.parsedStyle.d.totalLength=Mn(t.parsedStyle.d.absolutePath,void 0,Re(Re({},e),{bbox:!1,length:!0})).length),t.parsedStyle.d.totalLength}function VA(t,e){return t[0]===e[0]&&t[1]===e[1]}function zA(t,e){var n=t.prePoint,r=t.currentPoint,i=t.nextPoint,A=Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2),o=Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2),s=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),a=Math.acos((A+o-s)/(2*Math.sqrt(A)*Math.sqrt(o)));if(!a||0===Math.sin(a)||se(a,0))return{xExtra:0,yExtra:0};var c=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),l=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return c=c>Math.PI/2?Math.PI-c:c,l=l>Math.PI/2?Math.PI-l:l,{xExtra:Math.cos(a/2-c)*(e/2*(1/Math.sin(a/2)))-e/2||0,yExtra:Math.cos(l-a/2)*(e/2*(1/Math.sin(a/2)))-e/2||0}}function WA(t,e){return[e[0]+(e[0]-t[0]),e[1]+(e[1]-t[1])]}Hi(function(t){return ne(t)?t.split(" ").map(HA):t.map(HA)});var YA=function(t,e){var n=t.x*e.x+t.y*e.y,r=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(e.x,2)+Math.pow(e.y,2)));return(t.x*e.y-t.y*e.x<0?-1:1)*Math.acos(n/r)},XA=function(t,e,n,r,i,A,o,s){e=Math.abs(e),n=Math.abs(n);var a=Nr(r=le(r,360));if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(0===e||0===n)return{x:0,y:0,ellipticalArcAngle:0};var c=(t.x-o.x)/2,l=(t.y-o.y)/2,u={x:Math.cos(a)*c+Math.sin(a)*l,y:-Math.sin(a)*c+Math.cos(a)*l},h=Math.pow(u.x,2)/Math.pow(e,2)+Math.pow(u.y,2)/Math.pow(n,2);h>1&&(e*=Math.sqrt(h),n*=Math.sqrt(h));var d=(Math.pow(e,2)*Math.pow(n,2)-Math.pow(e,2)*Math.pow(u.y,2)-Math.pow(n,2)*Math.pow(u.x,2))/(Math.pow(e,2)*Math.pow(u.y,2)+Math.pow(n,2)*Math.pow(u.x,2));d=d<0?0:d;var f=(i!==A?1:-1)*Math.sqrt(d),g=f*(e*u.y/n),p=f*(-n*u.x/e),v={x:Math.cos(a)*g-Math.sin(a)*p+(t.x+o.x)/2,y:Math.sin(a)*g+Math.cos(a)*p+(t.y+o.y)/2},m={x:(u.x-g)/e,y:(u.y-p)/n},y=YA({x:1,y:0},m),w=YA(m,{x:(-u.x-g)/e,y:(-u.y-p)/n});!A&&w>0?w-=2*Math.PI:A&&w<0&&(w+=2*Math.PI);var B=y+(w%=2*Math.PI)*s,b=e*Math.cos(B),E=n*Math.sin(B);return{x:Math.cos(a)*b-Math.sin(a)*E+v.x,y:Math.sin(a)*b+Math.cos(a)*E+v.y,ellipticalArcStartAngle:y,ellipticalArcEndAngle:y+w,ellipticalArcAngle:B,ellipticalArcCenter:v,resultantRx:e,resultantRy:n}};function qA(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=t.arcParams,i=r.rx,A=void 0===i?0:i,o=r.ry,s=void 0===o?0:o,a=r.xRotation,c=r.arcFlag,l=r.sweepFlag,u=XA({x:t.prePoint[0],y:t.prePoint[1]},A,s,a,!!c,!!l,{x:t.currentPoint[0],y:t.currentPoint[1]},e),h=XA({x:t.prePoint[0],y:t.prePoint[1]},A,s,a,!!c,!!l,{x:t.currentPoint[0],y:t.currentPoint[1]},n?e+.005:e-.005),d=h.x-u.x,f=h.y-u.y,g=Math.sqrt(d*d+f*f);return{x:-d/g,y:-f/g}}function ZA(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function JA(t,e){return ZA(t)*ZA(e)?(t[0]*e[0]+t[1]*e[1])/(ZA(t)*ZA(e)):1}function $A(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(JA(t,e))}function to(t,e){var n=e[1],r=e[2],i=le(Nr(e[3]),2*Math.PI),A=e[4],o=e[5],s=t[0],a=t[1],c=e[6],l=e[7],u=Math.cos(i)*(s-c)/2+Math.sin(i)*(a-l)/2,h=-1*Math.sin(i)*(s-c)/2+Math.cos(i)*(a-l)/2,d=u*u/(n*n)+h*h/(r*r);d>1&&(n*=Math.sqrt(d),r*=Math.sqrt(d));var f=n*n*(h*h)+r*r*(u*u),g=f?Math.sqrt((n*n*(r*r)-f)/f):1;A===o&&(g*=-1),isNaN(g)&&(g=0);var p=r?g*n*h/r:0,v=n?g*-r*u/n:0,m=(s+c)/2+Math.cos(i)*p-Math.sin(i)*v,y=(a+l)/2+Math.sin(i)*p+Math.cos(i)*v,w=[(u-p)/n,(h-v)/r],B=[(-1*u-p)/n,(-1*h-v)/r],b=$A([1,0],w),E=$A(w,B);return JA(w,B)<=-1&&(E=Math.PI),JA(w,B)>=1&&(E=0),0===o&&E>0&&(E-=2*Math.PI),1===o&&E<0&&(E+=2*Math.PI),{cx:m,cy:y,rx:VA(t,[c,l])?0:n,ry:VA(t,[c,l])?0:r,startAngle:b,endAngle:b+E,xRotation:i,arcFlag:A,sweepFlag:o}}var eo=function(t){if(""===t||Array.isArray(t)&&0===t.length)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var e;try{e=un(t)}catch(n){e=un(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}!function(t){for(var e=0;e<t.length;e++){var n=t[e-1],r=t[e];if("M"===r[0]&&n){var i=n[0],A=[r[1],r[2]],o=void 0;"L"===i||"M"===i?o=[n[1],n[2]]:"C"!==i&&"A"!==i&&"Q"!==i||(o=[n[n.length-2],n[n.length-1]]),o&&VA(A,o)&&(t.splice(e,1),e--)}}}(e);var n=function(t){for(var e=!1,n=t.length,r=0;r<n;r++){var i=t[r][0];if("C"===i||"A"===i||"Q"===i){e=!0;break}}return e}(e),r=function(t){for(var e=[],n=[],r=[],i=0;i<t.length;i++){var A=t[i],o=A[0];"M"===o?(r.length&&(n.push(r),r=[]),r.push([A[1],A[2]])):"Z"===o?r.length&&(e.push(r),r=[]):r.push([A[1],A[2]])}return r.length>0&&n.push(r),{polygons:e,polylines:n}}(e),i=r.polygons,A=r.polylines,o=function(t){for(var e=[],n=null,r=null,i=null,A=0,o=t.length,s=0;s<o;s++){var a=t[s];r=t[s+1];var c=a[0],l={command:c,prePoint:n,params:a,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(c){case"M":i=[a[1],a[2]],A=s;break;case"A":var u=to(n,a);l.arcParams=u}if("Z"===c)n=i,r=t[A+1];else{var h=a.length;n=[a[h-2],a[h-1]]}r&&"Z"===r[0]&&(r=t[A],e[A]&&(e[A].prePoint=n)),l.currentPoint=n,e[A]&&VA(n,e[A].currentPoint)&&(e[A].prePoint=l.prePoint);var d=r?[r[r.length-2],r[r.length-1]]:null;l.nextPoint=d;var f=l.prePoint;if(["L","H","V"].includes(c))l.startTangent=[f[0]-n[0],f[1]-n[1]],l.endTangent=[n[0]-f[0],n[1]-f[1]];else if("Q"===c){var g=[a[1],a[2]];l.startTangent=[f[0]-g[0],f[1]-g[1]],l.endTangent=[n[0]-g[0],n[1]-g[1]]}else if("T"===c){var p=e[s-1],v=WA(p.currentPoint,f);"Q"===p.command?(l.command="Q",l.startTangent=[f[0]-v[0],f[1]-v[1]],l.endTangent=[n[0]-v[0],n[1]-v[1]]):(l.command="TL",l.startTangent=[f[0]-n[0],f[1]-n[1]],l.endTangent=[n[0]-f[0],n[1]-f[1]])}else if("C"===c){var m=[a[1],a[2]],y=[a[3],a[4]];l.startTangent=[f[0]-m[0],f[1]-m[1]],l.endTangent=[n[0]-y[0],n[1]-y[1]],0===l.startTangent[0]&&0===l.startTangent[1]&&(l.startTangent=[m[0]-y[0],m[1]-y[1]]),0===l.endTangent[0]&&0===l.endTangent[1]&&(l.endTangent=[y[0]-m[0],y[1]-m[1]])}else if("S"===c){var w=e[s-1],B=WA(w.currentPoint,f),b=[a[1],a[2]];"C"===w.command?(l.command="C",l.startTangent=[f[0]-B[0],f[1]-B[1]],l.endTangent=[n[0]-b[0],n[1]-b[1]]):(l.command="SQ",l.startTangent=[f[0]-b[0],f[1]-b[1]],l.endTangent=[n[0]-b[0],n[1]-b[1]])}else if("A"===c){var E=qA(l,0),x=E.x,C=E.y,F=qA(l,1,!1),M=F.x,k=F.y;l.startTangent=[x,C],l.endTangent=[M,k]}e.push(l)}return e}(e),s=function(t,e){for(var n=[],r=[],i=[],A=0;A<t.length;A++){var o=t[A],s=o.currentPoint,a=o.params,c=o.prePoint,l=void 0;switch(o.command){case"Q":l=Zn(c[0],c[1],a[1],a[2],a[3],a[4]);break;case"C":l=zn(c[0],c[1],a[1],a[2],a[3],a[4],a[5],a[6]);break;case"A":var u=o.arcParams;l=Rn(u.cx,u.cy,u.rx,u.ry,u.xRotation,u.startAngle,u.endAngle);break;default:n.push(s[0]),r.push(s[1])}l&&(o.box=l,n.push(l.x,l.x+l.width),r.push(l.y,l.y+l.height))}n=n.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0}),r=r.filter(function(t){return!Number.isNaN(t)&&t!==1/0&&t!==-1/0});var h=ee(n),d=ee(r),f=te(n),g=te(r);if(0===i.length)return{x:h,y:d,width:f-h,height:g-d};for(var p=0;p<i.length;p++){var v=i[p],m=v.currentPoint;m[0]===h?h-=zA(v,e).xExtra:m[0]===f&&(f+=zA(v,e).xExtra),m[1]===d?d-=zA(v,e).yExtra:m[1]===g&&(g+=zA(v,e).yExtra)}return{x:h,y:d,width:f-h,height:g-d}}(o,0),a=s.x,c=s.y,l=s.width,u=s.height;return{absolutePath:e,hasArc:n,segments:o,polygons:i,polylines:A,totalLength:0,rect:{x:Number.isFinite(a)?a:0,y:Number.isFinite(c)?c:0,width:Number.isFinite(l)?l:0,height:Number.isFinite(u)?u:0}}},no=Hi(eo);function ro(t){return ne(t)?no(t):eo(t)}function io(t,e,n){var r=t.curve,i=e.curve;r&&0!==r.length||(r=vn(t.absolutePath,!1),t.curve=r),i&&0!==i.length||(i=vn(e.absolutePath,!1),e.curve=i);var A=[r,i];r.length!==i.length&&(A=Un(r,i));var o,s,a=Qn(A[0])!==Qn(A[1])?(o=A[0],s=o.slice(1).map(function(t,e,n){return e?n[e-1].slice(-2).concat(t.slice(1)):o[0].slice(1).concat(t.slice(1))}).map(function(t){return t.map(function(e,n){return t[t.length-n-2*(1-n%2)]})}).reverse(),[["M"].concat(s[0].slice(0,2))].concat(s.map(function(t){return["C"].concat(t.slice(2))}))):A[0].map(function(t){return Array.isArray(t)?[].concat(t):t});return[a,kn(A[1],a),function(t){return t}]}function Ao(t,e){return[t.points,e.points,function(t){return t}]}var oo=null,so=/\s*(\w+)\(([^)]*)\)/g;function ao(t){return function(e){var n=0;return t.map(function(t){return t===oo?e[n++]:t})}}function co(t){return t}var lo={matrix:["NNNNNN",[oo,oo,0,0,oo,oo,0,0,0,0,1,0,oo,oo,0,1],co],matrix3d:["NNNNNNNNNNNNNNNN",co],rotate:["A"],rotateX:["A"],rotateY:["A"],rotateZ:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",ao([oo,oo,new nA(1)]),co],scaleX:["N",ao([oo,new nA(1),new nA(1)]),ao([oo,new nA(1)])],scaleY:["N",ao([new nA(1),oo,new nA(1)]),ao([new nA(1),oo])],scaleZ:["N",ao([new nA(1),new nA(1),oo])],scale3d:["NNN",co],skew:["Aa",null,co],skewX:["A",null,ao([oo,iA])],skewY:["A",null,ao([iA,oo])],translate:["Tt",ao([oo,oo,rA]),co],translateX:["T",ao([oo,rA,rA]),ao([oo,rA])],translateY:["T",ao([rA,oo,rA]),ao([rA,oo])],translateZ:["L",ao([rA,rA,oo])],translate3d:["TTL",co]};function uo(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r],A=i[0],o=i.slice(1);if("translate"===A||"skew"===A?1===o.length&&o.push(0):"scale"===A&&1===o.length&&o.push(o[0]),!lo[A])return[];var s=o.map(function(t){return uA(t)});e.push({t:A,d:s})}return e}function ho(t){if(Array.isArray(t))return uo(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(so.lastIndex=0;e=so.exec(t);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],A=lo[i];if(!A)return[];var o=e[2].split(","),s=A[0];if(s.length<o.length)return[];for(var a=[],c=0;c<s.length;c++){var l=o[c],u=s[c],h=void 0;if(h=l?{A:function(t){return"0"===t.trim()?iA:TA(t)},N:HA,T:SA,L:kA}[u.toUpperCase()](l):{a:iA,n:a[0],t:rA}[u],void 0===h)return[];a.push(h)}if(n.push({t:i,d:a}),so.lastIndex===t.length)return n}return[]}function fo(t){if(Array.isArray(t))return uo(t);if("none"===(t=(t||"none").trim()))return[];var e,n=[],r=0;for(so.lastIndex=0;e=so.exec(t);){if(e.index!==r)return[];r=e.index+e[0].length;var i=e[1],A=lo[i];if(!A)return[];var o=e[2].split(","),s=A[0];if(s.length<o.length)return[];for(var a=[],c=0;c<s.length;c++){var l=o[c],u=s[c],h=void 0;if(h=l?{A:function(t){return"0"===t.trim()?iA:UA(t)},N:RA,T:QA,L:MA}[u.toUpperCase()](l):{a:iA,n:a[0],t:rA}[u],void 0===h)return[];a.push(h)}if(n.push({t:i,d:a}),so.lastIndex===t.length)return n}return[]}function go(t){var e,n,r,i;switch(t.t){case"rotateX":return i=Nr(NA(t.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotateY":return i=Nr(NA(t.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotateZ":return i=Nr(NA(t.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":e=t.d[0].value,n=t.d[1].value,r=t.d[2].value,i=Nr(NA(t.d[3]));var A=e*e+n*n+r*r;if(0===A)e=1,n=0,r=0;else if(1!==A){var o=Math.sqrt(A);e/=o,n/=o,r/=o}var s=Math.sin(i/2),a=s*Math.cos(i/2),c=s*s;return[1-2*(n*n+r*r)*c,2*(e*n*c+r*a),2*(e*r*c-n*a),0,2*(e*n*c-r*a),1-2*(e*e+r*r)*c,2*(n*r*c+e*a),0,2*(e*r*c+n*a),2*(n*r*c-e*a),1-2*(e*e+n*n)*c,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scaleX":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaleY":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scaleZ":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var l=Nr(NA(t.d[0])),u=Nr(NA(t.d[1]));return[1,Math.tan(u),0,0,Math.tan(l),1,0,0,0,0,1,0,0,0,0,1];case"skewX":return i=Nr(NA(t.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewY":return i=Nr(NA(t.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return[1,0,0,0,0,1,0,0,0,0,1,0,e=LA(t.d[0],0,null)||0,n=LA(t.d[1],0,null)||0,0,1];case"translateX":return[1,0,0,0,0,1,0,0,0,0,1,0,e=LA(t.d[0],0,null)||0,0,0,1];case"translateY":return[1,0,0,0,0,1,0,0,0,0,1,0,0,n=LA(t.d[0],0,null)||0,0,1];case"translateZ":return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r=LA(t.d[0],0,null)||0,1];case"translate3d":return[1,0,0,0,0,1,0,0,0,0,1,0,e=LA(t.d[0],0,null)||0,n=LA(t.d[1],0,null)||0,r=LA(t.d[2],0,null)||0,1];case"perspective":var h=LA(t.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,h?-1/h:0,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(t){return t.value})}}function po(t,e){return[t[0]*e[0]+t[4]*e[1]+t[8]*e[2]+t[12]*e[3],t[1]*e[0]+t[5]*e[1]+t[9]*e[2]+t[13]*e[3],t[2]*e[0]+t[6]*e[1]+t[10]*e[2]+t[14]*e[3],t[3]*e[0]+t[7]*e[1]+t[11]*e[2]+t[15]*e[3],t[0]*e[4]+t[4]*e[5]+t[8]*e[6]+t[12]*e[7],t[1]*e[4]+t[5]*e[5]+t[9]*e[6]+t[13]*e[7],t[2]*e[4]+t[6]*e[5]+t[10]*e[6]+t[14]*e[7],t[3]*e[4]+t[7]*e[5]+t[11]*e[6]+t[15]*e[7],t[0]*e[8]+t[4]*e[9]+t[8]*e[10]+t[12]*e[11],t[1]*e[8]+t[5]*e[9]+t[9]*e[10]+t[13]*e[11],t[2]*e[8]+t[6]*e[9]+t[10]*e[10]+t[14]*e[11],t[3]*e[8]+t[7]*e[9]+t[11]*e[10]+t[15]*e[11],t[0]*e[12]+t[4]*e[13]+t[8]*e[14]+t[12]*e[15],t[1]*e[12]+t[5]*e[13]+t[9]*e[14]+t[13]*e[15],t[2]*e[12]+t[6]*e[13]+t[10]*e[14]+t[14]*e[15],t[3]*e[12]+t[7]*e[13]+t[11]*e[14]+t[15]*e[15]]}function vo(t){var e=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],A=[0,0,0,1];return function(t,e,n,r,i,A){if(!function(t,e){var n=e[15];if(0===n)return!1;for(var r=1/n,i=0;i<16;i++)t[i]=e[i]*r;return!0}(_r,t))return!1;if(S(Gr,_r),Gr[3]=0,Gr[7]=0,Gr[11]=0,Gr[15]=1,Math.abs(L(Gr))<1e-8)return!1;var o,s,a=_r[3],c=_r[7],l=_r[11],u=_r[12],h=_r[13],d=_r[14],f=_r[15];if(0!==a||0!==c||0!==l){if(Kr[0]=a,Kr[1]=c,Kr[2]=l,Kr[3]=f,!I(Gr,Gr))return!1;N(Gr,Gr),Ut(i,Kr,Gr)}else i[0]=i[1]=i[2]=0,i[3]=1;if(e[0]=u,e[1]=h,e[2]=d,s=_r,(o=jr)[0][0]=s[0],o[0][1]=s[1],o[0][2]=s[2],o[1][0]=s[4],o[1][1]=s[5],o[1][2]=s[6],o[2][0]=s[8],o[2][1]=s[9],o[2][2]=s[10],n[0]=dt(jr[0]),wt(jr[0],jr[0]),r[0]=Bt(jr[0],jr[1]),zr(jr[1],jr[1],jr[0],1,-r[0]),n[1]=dt(jr[1]),wt(jr[1],jr[1]),r[0]/=n[1],r[1]=Bt(jr[0],jr[2]),zr(jr[2],jr[2],jr[0],1,-r[1]),r[2]=Bt(jr[1],jr[2]),zr(jr[2],jr[2],jr[1],1,-r[2]),n[2]=dt(jr[2]),wt(jr[2],jr[2]),r[1]/=n[2],r[2]/=n[2],bt(Vr,jr[1],jr[2]),Bt(jr[0],Vr)<0)for(var g=0;g<3;g++)n[g]*=-1,jr[g][0]*=-1,jr[g][1]*=-1,jr[g][2]*=-1;A[0]=.5*Math.sqrt(Math.max(1+jr[0][0]-jr[1][1]-jr[2][2],0)),A[1]=.5*Math.sqrt(Math.max(1-jr[0][0]+jr[1][1]-jr[2][2],0)),A[2]=.5*Math.sqrt(Math.max(1-jr[0][0]-jr[1][1]+jr[2][2],0)),A[3]=.5*Math.sqrt(Math.max(1+jr[0][0]+jr[1][1]+jr[2][2],0)),jr[2][1]>jr[1][2]&&(A[0]=-A[0]),jr[0][2]>jr[2][0]&&(A[1]=-A[1]),jr[1][0]>jr[0][1]&&(A[2]=-A[2])}(function(t){return 0===t.length?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(go).reduce(po)}(t),e,n,r,i,A),[[e,n,r,A,i]]}var mo=function(){function t(t,e){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var A=0;A<4;A++)n[r][i]+=e[r][A]*t[A][i];return n}return function(e,n,r,i,A){for(var o=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],s=0;s<4;s++)o[s][3]=A[s];for(var a=0;a<3;a++)for(var c=0;c<3;c++)o[3][a]+=e[c]*o[c][a];var l=i[0],u=i[1],h=i[2],d=i[3],f=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];f[0][0]=1-2*(u*u+h*h),f[0][1]=2*(l*u-h*d),f[0][2]=2*(l*h+u*d),f[1][0]=2*(l*u+h*d),f[1][1]=1-2*(l*l+h*h),f[1][2]=2*(u*h-l*d),f[2][0]=2*(l*h-u*d),f[2][1]=2*(u*h+l*d),f[2][2]=1-2*(l*l+u*u),o=t(o,f);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];r[2]&&(g[2][1]=r[2],o=t(o,g)),r[1]&&(g[2][1]=0,g[2][0]=r[0],o=t(o,g)),r[0]&&(g[2][0]=0,g[1][0]=r[0],o=t(o,g));for(var p=0;p<3;p++)for(var v=0;v<3;v++)o[p][v]*=n[p];return function(t){return 0===t[0][2]&&0===t[0][3]&&0===t[1][2]&&0===t[1][3]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]&&0===t[2][3]&&0===t[3][2]&&1===t[3][3]}(o)?[o[0][0],o[0][1],o[1][0],o[1][1],o[3][0],o[3][1]]:o[0].concat(o[1],o[2],o[3])}}();function yo(t){return t.toFixed(6).replace(".000000","")}function wo(t,e){var n,r;return t.decompositionPair!==e&&(t.decompositionPair=e,n=vo(t)),e.decompositionPair!==t&&(e.decompositionPair=t,r=vo(e)),null===n[0]||null===r[0]?[[!1],[!0],function(n){return n?e[0].d:t[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(t){var e=function(t,e,n){var r=function(t,e){for(var n=0,r=0;r<t.length;r++)n+=t[r]*e[r];return n}(t,e);r=Ae(r,-1,1);var i=[];if(1===r)i=t;else for(var A=Math.acos(r),o=1*Math.sin(n*A)/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(t[s]*(Math.cos(n*A)-r*o)+e[s]*o);return i}(n[0][3],r[0][3],t[5]);return mo(t[0],t[1],t[2],e,t[4]).map(yo).join(",")}])}function Bo(t){return t.replace(/[XY]/,"")}function bo(t){return t.replace(/(X|Y|Z|3d)?$/,"3d")}var Eo=function(t,e){return"perspective"===t&&"perspective"===e||("matrix"===t||"matrix3d"===t)&&("matrix"===e||"matrix3d"===e)};function xo(t,e,n){var r=!1;if(!t.length||!e.length){t.length||(r=!0,t=e,e=[]);for(var i=function(){var n=t[A],r=n.t,i=n.d,o="scale"===r.substring(0,5)?1:0;e.push({t:r,d:i.map(function(t){return"number"==typeof t?uA(o):uA(o,t.unit)})})},A=0;A<t.length;A++)i()}var o=[],s=[],a=[];if(t.length!==e.length){var c=wo(t,e);o=[c[0]],s=[c[1]],a=[["matrix",[c[2]]]]}else for(var l=0;l<t.length;l++){var u=t[l].t,h=e[l].t,d=t[l].d,f=e[l].d,g=lo[u],p=lo[h],v=void 0;if(Eo(u,h)){var m=wo([t[l]],[e[l]]);o.push(m[0]),s.push(m[1]),a.push(["matrix",[m[2]]])}else{if(u===h)v=u;else if(g[2]&&p[2]&&Bo(u)===Bo(h))v=Bo(u),d=g[2](d),f=p[2](f);else{if(!g[1]||!p[1]||bo(u)!==bo(h)){var y=wo(t,e);o=[y[0]],s=[y[1]],a=[["matrix",[y[2]]]];break}v=bo(u),d=g[1](d),f=p[1](f)}for(var w=[],B=[],b=[],E=0;E<d.length;E++){var x=OA(d[E],f[E],n,!1,E);w[E]=x[0],B[E]=x[1],b.push(x[2])}o.push(w),s.push(B),a.push([v,b])}}if(r){var C=o;o=s,s=C}return[o,s,function(t){return t.map(function(t,e){var n=t.map(function(t,n){return a[e][1][n](t)}).join(",");return"matrix"===a[e][0]&&16===n.split(",").length&&(a[e][0]="matrix3d"),"matrix3d"===a[e][0]&&6===n.split(",").length&&(a[e][0]="matrix"),"".concat(a[e][0],"(").concat(n,")")}).join(" ")}]}var Co=Hi(function(t){if(ne(t)){if("text-anchor"===t)return[uA(0,"px"),uA(0,"px")];var e=t.split(" ");return 1===e.length&&("top"===e[0]||"bottom"===e[0]?(e[1]=e[0],e[0]="center"):e[1]="center"),2!==e.length?null:[SA(Fo(e[0])),SA(Fo(e[1]))]}return[uA(t[0]||0,"px"),uA(t[1]||0,"px")]});function Fo(t){return"center"===t?"50%":"left"===t||"top"===t?"0%":"right"===t||"bottom"===t?"100%":t}var Mo=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:oi.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:oi.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:oi.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:oi.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:oi.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:oi.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:oi.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:oi.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:oi.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:oi.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:oi.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:oi.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:oi.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:oi.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:oi.FILTER},{n:"clipPath",syntax:oi.DEFINED_PATH},{n:"textPath",syntax:oi.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:oi.TRANSFORM},{n:"transformOrigin",p:100,d:"0 0",l:!0,syntax:oi.TRANSFORM_ORIGIN},{n:"cx",int:!0,l:!0,d:"0",syntax:oi.COORDINATE},{n:"cy",int:!0,l:!0,d:"0",syntax:oi.COORDINATE},{n:"cz",int:!0,l:!0,d:"0",syntax:oi.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"x",int:!0,l:!0,d:"0",syntax:oi.COORDINATE},{n:"y",int:!0,l:!0,d:"0",syntax:oi.COORDINATE},{n:"z",int:!0,l:!0,d:"0",syntax:oi.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:oi.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:oi.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:oi.COORDINATE},{n:"y1",int:!0,l:!0,syntax:oi.COORDINATE},{n:"z1",int:!0,l:!0,syntax:oi.COORDINATE},{n:"x2",int:!0,l:!0,syntax:oi.COORDINATE},{n:"y2",int:!0,l:!0,syntax:oi.COORDINATE},{n:"z2",int:!0,l:!0,syntax:oi.COORDINATE},{n:"d",int:!0,l:!0,d:"",syntax:oi.PATH,p:50},{n:"points",int:!0,l:!0,syntax:oi.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:oi.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:oi.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:oi.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:oi.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:oi.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:oi.NUMBER,d:function(t){return t===hr.PATH||t===hr.POLYGON||t===hr.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:oi.MARKER},{n:"markerEnd",syntax:oi.MARKER},{n:"markerMid",syntax:oi.MARKER},{n:"markerStartOffset",syntax:oi.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:oi.LENGTH,l:!0,int:!0,d:"0"}],ko=new Set(Mo.filter(function(t){return!!t.l}).map(function(t){return t.n})),Qo={},So=function(){return c(function t(e){var n=this;s(this,t),this.runtime=e,Mo.forEach(function(t){n.registerMetadata(t)})},[{key:"registerMetadata",value:function(t){[t.n].concat(h(t.a||[])).forEach(function(e){Qo[e]=t})}},{key:"getPropertySyntax",value:function(t){return this.runtime.CSSPropertySyntaxFactory[t]}},{key:"processProperties",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{forceUpdateGeometry:!1};Object.assign(t.attributes,e);var r=t.parsedStyle.clipPath,i=t.parsedStyle.offsetPath;!function(t,e){var n=Uo(t);for(var r in e)n.has(r)&&(t.parsedStyle[r]=e[r])}(t,e);var A=!!n.forceUpdateGeometry;if(!A)for(var s in e)if(ko.has(s)){A=!0;break}var a,c,l=Uo(t);l.has("fill")&&e.fill&&(t.parsedStyle.fill=xA(e.fill)),l.has("stroke")&&e.stroke&&(t.parsedStyle.stroke=xA(e.stroke)),l.has("shadowColor")&&e.shadowColor&&(t.parsedStyle.shadowColor=xA(e.shadowColor)),l.has("filter")&&e.filter&&(t.parsedStyle.filter=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if("none"===(t=t.toLowerCase().trim()))return[];for(var e,n=/\s*([\w-]+)\(([^)]*)\)/g,r=[],i=0;e=n.exec(t);){if(e.index!==i)return[];if(i=e.index+e[0].length,DA.indexOf(e[1])>-1&&r.push({name:e[1],params:e[2].split(" ").map(function(t){return FA(/deg|rad|grad|turn|px|%/g,t)||xA(t)})}),n.lastIndex===t.length)return r}return[]}(e.filter)),l.has("radius")&&!zt(e.radius)&&(t.parsedStyle.radius=IA(e.radius,4)),l.has("lineDash")&&!zt(e.lineDash)&&(t.parsedStyle.lineDash=IA(e.lineDash,"even")),l.has("points")&&e.points&&(t.parsedStyle.points=(a=e.points,c=ne(a)?a.split(" ").map(function(t){var e=y(t.split(","),2),n=e[0],r=e[1];return[Number(n),Number(r)]}):a,{points:c,totalLength:0,segments:[]})),l.has("d")&&""===e.d&&(t.parsedStyle.d=o({},Ai)),l.has("d")&&e.d&&(t.parsedStyle.d=ro(e.d)),l.has("textTransform")&&e.textTransform&&this.runtime.CSSPropertySyntaxFactory[oi.TEXT_TRANSFORM].calculator(null,null,{value:e.textTransform},t,null),l.has("clipPath")&&!pe(e.clipPath)&&this.runtime.CSSPropertySyntaxFactory[oi.DEFINED_PATH].calculator("clipPath",r,e.clipPath,t,this.runtime),l.has("offsetPath")&&e.offsetPath&&this.runtime.CSSPropertySyntaxFactory[oi.DEFINED_PATH].calculator("offsetPath",i,e.offsetPath,t,this.runtime),l.has("transform")&&e.transform&&(t.parsedStyle.transform=ho(e.transform)),l.has("transformOrigin")&&e.transformOrigin&&(t.parsedStyle.transformOrigin=Co(e.transformOrigin)),l.has("markerStart")&&e.markerStart&&(t.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[oi.MARKER].calculator(null,e.markerStart,e.markerStart,null,null)),l.has("markerEnd")&&e.markerEnd&&(t.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[oi.MARKER].calculator(null,e.markerEnd,e.markerEnd,null,null)),l.has("markerMid")&&e.markerMid&&(t.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[oi.MARKER].calculator("",e.markerMid,e.markerMid,null,null)),l.has("zIndex")&&!zt(e.zIndex)&&this.runtime.CSSPropertySyntaxFactory[oi.Z_INDEX].postProcessor(t),l.has("offsetDistance")&&!zt(e.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[oi.OFFSET_DISTANCE].postProcessor(t),l.has("transform")&&e.transform&&this.runtime.CSSPropertySyntaxFactory[oi.TRANSFORM].postProcessor(t),l.has("transformOrigin")&&e.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[oi.TRANSFORM_ORIGIN].postProcessor(t),A&&(t.dirty(!0,!0),n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(t))}},{key:"updateGeometry",value:function(t){var e=t.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var r=t.geometry;r.contentBounds||(r.contentBounds=new br),r.renderBounds||(r.renderBounds=new br);var i=t.parsedStyle,A=n.update(i,t),o=A.cx,s=void 0===o?0:o,a=A.cy,c=void 0===a?0:a,l=A.cz,u=void 0===l?0:l,h=A.hwidth,d=void 0===h?0:h,f=A.hheight,g=void 0===f?0:f,p=A.hdepth,v=void 0===p?0:p,m=[Math.abs(d),Math.abs(g),v],y=i.stroke,w=i.lineWidth,B=void 0===w?1:w,b=i.increasedLineWidthForHitTesting,E=void 0===b?0:b,x=i.shadowType,C=void 0===x?"outer":x,F=i.shadowColor,M=i.filter,k=void 0===M?[]:M,Q=i.transformOrigin,S=[s,c,u];r.contentBounds.update(S,m);var U=e===hr.POLYLINE||e===hr.POLYGON||e===hr.PATH?Math.SQRT2:.5;if(y&&!y.isNone){var T=((B||0)+(E||0))*U;m[0]+=T,m[1]+=T}if(r.renderBounds.update(S,m),F&&C&&"inner"!==C){var O=r.renderBounds,N=O.min,I=O.max,L=i.shadowBlur||0,D=i.shadowOffsetX||0,P=i.shadowOffsetY||0,R=N[0]-L+D,H=I[0]+L+D,_=N[1]-L+P,G=I[1]+L+P;N[0]=Math.min(N[0],R),I[0]=Math.max(I[0],H),N[1]=Math.min(N[1],_),I[1]=Math.max(I[1],G),r.renderBounds.setMinMax(N,I)}k.forEach(function(t){var e=t.name,n=t.params;if("blur"===e){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,vt(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]))}else if("drop-shadow"===e){var A=n[0].value,o=n[1].value,s=n[2].value,a=r.renderBounds,c=a.min,l=a.max,u=c[0]-s+A,h=l[0]+s+A,d=c[1]-s+o,f=l[1]+s+o;c[0]=Math.min(c[0],u),l[0]=Math.max(l[0],h),c[1]=Math.min(c[1],d),l[1]=Math.max(l[1],f),r.renderBounds.setMinMax(c,l)}}),t.geometry.dirty=!1;var K=g<0,j=(d<0?-1:1)*(Q?LA(Q[0],0,t,!0):0),V=(K?-1:1)*(Q?LA(Q[1],1,t,!0):0);(j||V)&&t.setOrigin(j,V)}}},{key:"updateSizeAttenuation",value:function(t,e){t.style.isSizeAttenuation?(t.style.rawLineWidth||(t.style.rawLineWidth=t.style.lineWidth),t.style.lineWidth=(t.style.rawLineWidth||1)/e,t.nodeName===hr.CIRCLE&&(t.style.rawR||(t.style.rawR=t.style.r),t.style.r=(t.style.rawR||1)/e)):(t.style.rawLineWidth&&(t.style.lineWidth=t.style.rawLineWidth,delete t.style.rawLineWidth),t.nodeName===hr.CIRCLE&&t.style.rawR&&(t.style.r=t.style.rawR,delete t.style.rawR))}}])}();function Uo(t){return t.constructor.PARSED_STYLE_LIST}var To=function(){return c(function t(){s(this,t),this.mixer=_A},[{key:"calculator",value:function(t,e,n,r){return NA(n)}}])}(),Oo=function(){return c(function t(){s(this,t)},[{key:"calculator",value:function(t,e,n,r,i){return n instanceof tA&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(t,e,n,r),"clipPath"===t&&r.forEach(function(t){0===t.childNodes.length&&i.sceneGraphService.dirtyToRoot(t)}),n}}])}(),No=function(){return c(function t(){s(this,t),this.parser=xA,this.mixer=CA},[{key:"calculator",value:function(t,e,n,r){return n instanceof tA?"none"===n.value?aA:cA:n}}])}(),Io=function(){return c(function t(){s(this,t)},[{key:"calculator",value:function(t,e,n){return n instanceof tA?[]:n}}])}();function Lo(t){var e=t.parsedStyle.fontSize;return zt(e)?null:e}var Do=function(){return c(function t(){s(this,t),this.mixer=_A},[{key:"calculator",value:function(t,e,n,r,i){if(oe(n))return n;if(!nA.isRelativeUnit(n.unit))return n.value;if(n.unit===_i.kPercentage)return 0;if(n.unit===_i.kEms){if(r.parentNode){var A=Lo(r.parentNode);if(A)return A*=n.value}return 0}if(n.unit===_i.kRems){var o;if(null!=r&&null!==(o=r.ownerDocument)&&void 0!==o&&o.documentElement){var s=Lo(r.ownerDocument.documentElement);if(s)return s*=n.value}return 0}}}])}(),Po=function(){return c(function t(){s(this,t),this.mixer=KA},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value})}}])}(),Ro=function(){return c(function t(){s(this,t),this.mixer=KA},[{key:"calculator",value:function(t,e,n){return n.map(function(t){return t.value})}}])}(),Ho=function(){return c(function t(){s(this,t)},[{key:"calculator",value:function(t,e,n,r){var i;n instanceof tA&&(n=null);var A=null===(i=n)||void 0===i?void 0:i.cloneNode(!0);return A&&(A.style.isMarker=!0),A}}])}(),_o=function(){return c(function t(){s(this,t),this.mixer=_A},[{key:"calculator",value:function(t,e,n){return n.value}}])}(),Go=function(){return c(function t(){s(this,t),this.mixer=GA(0,1)},[{key:"calculator",value:function(t,e,n){return n.value}},{key:"postProcessor",value:function(t){var e=t.parsedStyle,n=e.offsetPath,r=e.offsetDistance;if(n){var i=n.nodeName;if(i===hr.LINE||i===hr.PATH||i===hr.POLYLINE){var A=n.getPoint(r);A&&t.setLocalPosition(A.x,A.y)}}}}])}(),Ko=function(){return c(function t(){s(this,t),this.mixer=GA(0,1)},[{key:"calculator",value:function(t,e,n){return n.value}}])}(),jo=function(){return c(function t(){s(this,t),this.parser=ro,this.mixer=io},[{key:"calculator",value:function(t,e,n){return n instanceof tA&&"unset"===n.value?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new Mr(0,0,0,0)}:n}}])}(),Vo=c(function t(){s(this,t),this.mixer=Ao}),zo=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).mixer=GA(0,1/0),t}return m(e,t),c(e)}(Do),Wo=function(){return c(function t(){s(this,t)},[{key:"calculator",value:function(t,e,n,r){return n instanceof tA?"unset"===n.value?"":n.value:"".concat(n)}},{key:"postProcessor",value:function(t){t.nodeValue="".concat(t.parsedStyle.text)||""}}])}(),Yo=function(){return c(function t(){s(this,t)},[{key:"calculator",value:function(t,e,n,r){var i=r.getAttribute("text");if(i){var A=i;"capitalize"===n.value?A=i.charAt(0).toUpperCase()+i.slice(1):"lowercase"===n.value?A=i.toLowerCase():"uppercase"===n.value&&(A=i.toUpperCase()),r.parsedStyle.text=A}return n.value}}])}(),Xo=new WeakMap;var qo="undefined"!=typeof window&&void 0!==window.document;function Zo(t){return!!t.getAttribute}function Jo(t,e){var n=Number(t.parsedStyle.zIndex||0),r=Number(e.parsedStyle.zIndex||0);if(n===r){var i=t.parentNode;if(i){var A=i.childNodes||[];return A.indexOf(t)-A.indexOf(e)}}return n-r}function $o(t){var e=t;do{var n;if(null===(n=e.parsedStyle)||void 0===n?void 0:n.clipPath)return e;e=e.parentElement}while(null!==e);return null}function ts(t,e){if(qo)return document.defaultView.getComputedStyle(t,null).getPropertyValue(e)}var es={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},ns="object"==typeof performance&&performance.now?performance:Date;function rs(t){return t.nodeName===hr.FRAGMENT||t.getRootNode().nodeName===hr.FRAGMENT}function is(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=!1,i=!1,A=!!e&&!e.isNone,o=!!n&&!n.isNone;return"visiblepainted"===t||"painted"===t||"auto"===t?(r=A,i=o):"visiblefill"===t||"fill"===t?r=!0:"visiblestroke"===t||"stroke"===t?i=!0:"visible"!==t&&"all"!==t||(r=!0,i=!0),[r,i]}var As=1,os="object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:{},ss=Date.now(),as={},cs=Date.now(),ls=function(t){if("function"!=typeof t)throw new TypeError("".concat(t," is not a function"));var e=Date.now(),n=e-cs,r=n>16?0:16-n,i=As++;return as[i]=t,Object.keys(as).length>1||setTimeout(function(){cs=e;var t=as;as={},Object.keys(t).forEach(function(e){return t[e](os.performance&&"function"==typeof os.performance.now?os.performance.now():Date.now()-ss)})},r),i},us=function(t){delete as[t]},hs=function(t){return"string"!=typeof t?ls:""===t?os.requestAnimationFrame:os["".concat(t,"RequestAnimationFrame")]},ds=function(t,e){for(var n=0;void 0!==t[n];){if(e(t[n]))return t[n];n+=1}}(["","webkit","moz","ms","o"],function(t){return!!hs(t)}),fs=hs(ds),gs=function(t){return"string"!=typeof t?us:""===t?os.cancelAnimationFrame:os["".concat(t,"CancelAnimationFrame")]||os["".concat(t,"CancelRequestAnimationFrame")]}(ds);os.requestAnimationFrame=fs,os.cancelAnimationFrame=gs;var ps=function(){return c(function t(){s(this,t),this.callbacks=[]},[{key:"getCallbacksNum",value:function(){return this.callbacks.length}},{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e)}))}}])}(),vs=function(){return c(function t(){s(this,t),this.callbacks=[]},[{key:"tapPromise",value:function(t,e){this.callbacks.push(e)}},{key:"promise",value:(t=cr(sr().mark(function t(){var e,n,r,i,A=arguments;return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.callbacks.length){t.next=6;break}return t.next=1,(e=this.callbacks)[0].apply(e,A);case 1:n=t.sent,r=1;case 2:if(!(r<this.callbacks.length)){t.next=5;break}return i=this.callbacks[r],t.next=3,i(n);case 3:n=t.sent;case 4:r++,t.next=2;break;case 5:return t.abrupt("return",n);case 6:return t.abrupt("return",null);case 7:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})}]);var t}(),ms=function(){return c(function t(){s(this,t),this.callbacks=[]},[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=arguments;this.callbacks.forEach(function(t){t.apply(void 0,r)})}}])}(),ys=function(){return c(function t(){s(this,t),this.callbacks=[]},[{key:"tap",value:function(t,e){this.callbacks.push(e)}},{key:"call",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(this.callbacks.length){for(var r=arguments,i=this.callbacks[0].apply(void 0,r),A=1;A<this.callbacks.length;A++){i=(0,this.callbacks[A])(i)}return i}return null}}])}(),ws=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Bs=/([\"\'])[^\'\"]+\1/;function bs(t){var e=t.fontSize,n=void 0===e?16:e,r=t.fontFamily,i=void 0===r?"sans-serif":r,A=t.fontStyle,o=void 0===A?"normal":A,s=t.fontVariant,a=void 0===s?"normal":s,c=t.fontWeight;return{fontSize:n,fontFamily:i,fontStyle:o,fontVariant:a,fontWeight:void 0===c?"normal":c}}var Es=Hi(function(t){for(var e=bs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,A=e.fontVariant,o=e.fontWeight,s=oe(n)&&"".concat(n,"px")||"16px",a=r.split(","),c=a.length-1;c>=0;c--){var l=a[c].trim();!Bs.test(l)&&ws.indexOf(l)<0&&(l='"'.concat(l,'"')),a[c]=l}return"".concat(i," ").concat(A," ").concat(o," ").concat(s," ").concat(a.join(","))},function(t){var e=bs(t),n=e.fontSize,r=e.fontFamily,i=e.fontStyle,A=e.fontVariant,o=e.fontWeight;return"".concat(i,"_").concat(A,"_").concat(o,"_").concat(n,"_").concat(r)}),xs=function(t){return Math.max(t,1e-6)};function Cs(t,e,n){return O(t),t[4]=Math.tan(e),t[1]=Math.tan(n),t}var Fs=k(),Ms=k(),ks={scale:function(t){K(Fs,[t[0].value,t[1].value,1].map(function(t){return xs(t)}))},scaleX:function(t){K(Fs,[t[0].value,1,1].map(function(t){return xs(t)}))},scaleY:function(t){K(Fs,[1,t[0].value,1].map(function(t){return xs(t)}))},scaleZ:function(t){K(Fs,[1,1,t[0].value].map(function(t){return xs(t)}))},scale3d:function(t){K(Fs,[t[0].value,t[1].value,t[2].value].map(function(t){return xs(t)}))},translate:function(t){G(Fs,[t[0].value,t[1].value,0])},translateX:function(t){G(Fs,[t[0].value,0,0])},translateY:function(t){G(Fs,[0,t[0].value,0])},translateZ:function(t){G(Fs,[0,0,t[0].value])},translate3d:function(t){G(Fs,[t[0].value,t[1].value,t[2].value])},rotate:function(t){W(Fs,Nr(NA(t[0])))},rotateX:function(t){V(Fs,Nr(NA(t[0])))},rotateY:function(t){z(Fs,Nr(NA(t[0])))},rotateZ:function(t){W(Fs,Nr(NA(t[0])))},rotate3d:function(t){j(Fs,Nr(NA(t[3])),[t[0].value,t[1].value,t[2].value])},skew:function(t){Cs(Fs,Nr(t[0].value),Nr(t[1].value))},skewX:function(t){Cs(Fs,Nr(t[0].value),0)},skewY:function(t){Cs(Fs,0,Nr(t[0].value))},matrix:function(t){T(Fs,t[0].value,t[1].value,0,0,t[2].value,t[3].value,0,0,0,0,1,0,t[4].value,t[5].value,0,1)},matrix3d:function(t){T.apply(lt,[Fs].concat(h(t.map(function(t){return t.value}))))}},Qs=ft(1,1,1),Ss=ut(),Us={translate:function(t,e){Na.sceneGraphService.setLocalScale(t,Qs,!1),Na.sceneGraphService.setLocalEulerAngles(t,Ss,void 0,void 0,!1),Na.sceneGraphService.setLocalPosition(t,[e[0].value,e[1].value,0],!1),Na.sceneGraphService.dirtyLocalTransform(t,t.transformable)}};function Ts(t,e){if(t.length){if(1===t.length&&Us[t[0].t])return void Us[t[0].t](e,t[0].d);for(var n=O(Ms),r=0;r<t.length;r++){var i=t[r],A=i.t,o=i.d,s=ks[A];s&&(s(o),at(n,n,Fs))}e.setLocalTransform(n)}else e.resetLocalTransform();return e.getLocalTransform()}var Os=function(){return c(function t(){s(this,t),this.parser=fo,this.mixer=xo},[{key:"calculator",value:function(t,e,n,r){return n instanceof tA?[]:n}},{key:"postProcessor",value:function(t){Ts(t.parsedStyle.transform,t)}}])}(),Ns=function(){return c(function t(){s(this,t)},[{key:"postProcessor",value:function(t){var e=t.parsedStyle.transformOrigin;e[0].unit===_i.kPixels&&e[1].unit===_i.kPixels?t.setOrigin(e[0].value,e[1].value):t.getGeometryBounds()}}])}(),Is=function(){return c(function t(){s(this,t)},[{key:"calculator",value:function(t,e,n,r){return n.value}},{key:"postProcessor",value:function(t){if(t.parentNode){var e=t.parentNode,n=e.renderable,r=e.sortable;n&&e.dirty(),r&&(r.dirty=!0,r.dirtyReason=ti.Z_INDEX_CHANGED)}}}])}(),Ls=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t,e){var n=t.cx,r=void 0===n?0:n,i=t.cy,A=void 0===i?0:i,o=t.r,s=void 0===o?0:o;return{cx:r,cy:A,hwidth:s,hheight:s}}}])}(),Ds=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t,e){var n=t.cx,r=void 0===n?0:n,i=t.cy,A=void 0===i?0:i,o=t.rx,s=void 0===o?0:o,a=t.ry;return{cx:r,cy:A,hwidth:s,hheight:void 0===a?0:a}}}])}(),Ps=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t){var e=t.x1,n=t.y1,r=t.x2,i=t.y2,A=Math.min(e,r),o=Math.max(e,r),s=Math.min(n,i),a=(o-A)/2,c=(Math.max(n,i)-s)/2;return{cx:A+a,cy:s+c,hwidth:a,hheight:c}}}])}(),Rs=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t){var e=t.d.rect,n=e.x,r=e.y,i=e.width/2,A=e.height/2;return{cx:n+i,cy:r+A,hwidth:i,hheight:A}}}])}(),Hs=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t){if(t.points&&Wt(t.points.points)){var e=t.points.points,n=Math.min.apply(Math,h(e.map(function(t){return t[0]}))),r=Math.max.apply(Math,h(e.map(function(t){return t[0]}))),i=Math.min.apply(Math,h(e.map(function(t){return t[1]}))),A=Math.max.apply(Math,h(e.map(function(t){return t[1]}))),o=(r-n)/2,s=(A-i)/2;return{cx:n+o,cy:i+s,hwidth:o,hheight:s}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),_s=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,A=void 0===i?0:i,o=t.src,s=t.width,a=void 0===s?0:s,c=t.height,l=a,u=void 0===c?0:c;return o&&!ne(o)&&(l||(l=o.width,t.width=l),u||(u=o.height,t.height=u)),{cx:r+l/2,cy:A+u/2,hwidth:l/2,hheight:u/2}}}])}(),Gs=function(){return c(function t(e){s(this,t),this.globalRuntime=e},[{key:"isReadyToMeasure",value:function(t,e){return t.text}},{key:"update",value:function(t,e){var n,r=t.text,i=t.textAlign,A=void 0===i?"start":i,o=t.lineWidth,s=void 0===o?1:o,a=t.textBaseline,c=void 0===a?"alphabetic":a,l=t.dx,u=void 0===l?0:l,h=t.dy,d=void 0===h?0:h,f=t.x,g=void 0===f?0:f,p=t.y,v=void 0===p?0:p;if(!this.isReadyToMeasure(t,e))return t.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var m=((null==e||null===(n=e.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n?void 0:n.getConfig())||{}).offscreenCanvas,y=this.globalRuntime.textService.measureText(r,t,m);t.metrics=y;var w=y.width/2,B=y.height/2,b=g+w;"center"===A||"middle"===A?b+=s/2-w:"right"!==A&&"end"!==A||(b+=s-2*w);var E=v-B;return"middle"===c?E+=B:"top"===c||"hanging"===c?E+=2*B:"alphabetic"===c||"bottom"!==c&&"ideographic"!==c||(E+=0),u&&(b+=u),d&&(E+=d),{cx:b,cy:E,hwidth:w,hheight:B}}}])}(),Ks=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t,e){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),js=function(){return c(function t(){s(this,t)},[{key:"update",value:function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,A=void 0===i?0:i,o=t.width,s=void 0===o?0:o,a=t.height,c=void 0===a?0:a;return{cx:r+s/2,cy:A+c/2,hwidth:s/2,hheight:c/2}}}])}(),Vs=function(){return c(function t(e){s(this,t),this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Fr,this.page=new Fr,this.canvas=new Fr,this.viewport=new Fr,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e},[{key:"name",get:function(){return this.type}},{key:"layerX",get:function(){return this.layer.x}},{key:"layerY",get:function(){return this.layer.y}},{key:"pageX",get:function(){return this.page.x}},{key:"pageY",get:function(){return this.page.y}},{key:"x",get:function(){return this.canvas.x}},{key:"y",get:function(){return this.canvas.y}},{key:"canvasX",get:function(){return this.canvas.x}},{key:"canvasY",get:function(){return this.canvas.y}},{key:"viewportX",get:function(){return this.viewport.x}},{key:"viewportY",get:function(){return this.viewport.y}},{key:"composedPath",value:function(){return!this.manager||this.path&&this.path[0]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:"propagationPath",get:function(){return this.composedPath()}},{key:"preventDefault",value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:"stopImmediatePropagation",value:function(){this.propagationImmediatelyStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"initEvent",value:function(){}},{key:"initUIEvent",value:function(){}},{key:"clone",value:function(){throw new Error(kr)}}])}(),zs=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).client=new Fr,t.movement=new Fr,t.offset=new Fr,t.global=new Fr,t.screen=new Fr,t}return m(e,t),c(e,[{key:"clientX",get:function(){return this.client.x}},{key:"clientY",get:function(){return this.client.y}},{key:"movementX",get:function(){return this.movement.x}},{key:"movementY",get:function(){return this.movement.y}},{key:"offsetX",get:function(){return this.offset.x}},{key:"offsetY",get:function(){return this.offset.y}},{key:"globalX",get:function(){return this.global.x}},{key:"globalY",get:function(){return this.global.y}},{key:"screenX",get:function(){return this.screen.x}},{key:"screenY",get:function(){return this.screen.y}},{key:"getModifierState",value:function(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}},{key:"initMouseEvent",value:function(){throw new Error(kr)}}])}(Vs),Ws=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).width=0,t.height=0,t.isPrimary=!1,t}return m(e,t),c(e,[{key:"getCoalescedEvents",value:function(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}},{key:"getPredictedEvents",value:function(){throw new Error("getPredictedEvents is not supported!")}},{key:"clone",value:function(){return this.manager.clonePointerEvent(this)}}])}(zs),Ys=function(t){function e(){return s(this,e),p(this,e,arguments)}return m(e,t),c(e,[{key:"clone",value:function(){return this.manager.cloneWheelEvent(this)}}])}(zs),Xs=function(t){function e(t,n){var r;return s(this,e),(r=p(this,e,[null])).type=t,r.detail=null==n?void 0:n.detail,n&&!("detail"in n)&&(r.detail=n),Object.assign(r,n),r}return m(e,t),c(e)}(Vs),qs=function(){return c(function t(){s(this,t),this.emitter=new x},[{key:"on",value:function(t,e,n){return this.addEventListener(t,e,n),this}},{key:"addEventListener",value:function(t,e,n){var r=!1,i=!1;if(fe(n))r=n;else if(n){var A=n.capture;r=void 0!==A&&A;var o=n.once;i=void 0!==o&&o}r&&(t+="capture"),e=Vt(e)?e:e.handleEvent;var s=Vt(e)?void 0:e;return i?this.emitter.once(t,e,s):this.emitter.on(t,e,s),this}},{key:"off",value:function(t,e,n){return t?this.removeEventListener(t,e,n):this.removeAllEventListeners(),this}},{key:"removeAllEventListeners",value:function(){var t;null===(t=this.emitter)||void 0===t||t.removeAllListeners()}},{key:"removeEventListener",value:function(t,e,n){var r;if(!this.emitter)return this;(fe(n)?n:null==n?void 0:n.capture)&&(t+="capture"),e=Vt(e)?e:null===(r=e)||void 0===r?void 0:r.handleEvent;var i=Vt(e)?void 0:e;return this.emitter.off(t,e,i),this}},{key:"emit",value:function(t,e){this.dispatchEvent(new Xs(t,e))}},{key:"dispatchEventToSelf",value:function(t){t.target||(t.target=this),t.currentTarget=this,this.emitter.emit(t.type,t)}},{key:"dispatchEvent",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(arguments.length>2?arguments[2]:void 0)return this.dispatchEventToSelf(t),!0;if(this.document)e=this;else if(this.defaultView)e=this.defaultView;else{var r;e=null===(r=this.ownerDocument)||void 0===r?void 0:r.defaultView}if(e){if(t.manager=e.getEventService(),!t.manager)return!1;t.defaultPrevented=!1,t.path?t.path.length=0:t.page=[],n||(t.target=this),t.manager.dispatchEvent(t,t.type,n)}else this.dispatchEventToSelf(t);return!t.defaultPrevented}}])}(),Zs=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).shadow=!1,t.ownerDocument=null,t.isConnected=!1,t.baseURI="",t.childNodes=[],t.nodeType=0,t.nodeName="",t.nodeValue=null,t.mutations=void 0,t.parentNode=null,t.destroyed=!1,t}return m(e,t),c(e,[{key:"textContent",get:function(){var t="";this.nodeName===hr.TEXT&&(t+=this.style.text);var e,n=lr(this.childNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value;r.nodeName===hr.TEXT?t+=r.nodeValue:t+=r.textContent}}catch(t){n.e(t)}finally{n.f()}return t},set:function(t){var e=this;this.childNodes.slice().forEach(function(t){e.removeChild(t)}),this.nodeName===hr.TEXT&&(this.style.text="".concat(t))}},{key:"getRootNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(t):t.composed&&this.host?this.host.getRootNode(t):this}},{key:"hasChildNodes",value:function(){return this.childNodes.length>0}},{key:"isDefaultNamespace",value:function(t){throw new Error(kr)}},{key:"lookupNamespaceURI",value:function(t){throw new Error(kr)}},{key:"lookupPrefix",value:function(t){throw new Error(kr)}},{key:"normalize",value:function(){throw new Error(kr)}},{key:"isEqualNode",value:function(t){return this===t}},{key:"isSameNode",value:function(t){return this.isEqualNode(t)}},{key:"parent",get:function(){return this.parentNode}},{key:"parentElement",get:function(){return null}},{key:"nextSibling",get:function(){return null}},{key:"previousSibling",get:function(){return null}},{key:"firstChild",get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:"lastChild",get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:"compareDocumentPosition",value:function(t){if(t===this)return 0;for(var n=t,r=this,i=[n],A=[r];null!==(o=n.parentNode)&&void 0!==o?o:r.parentNode;){var o;n=n.parentNode?(i.push(n.parentNode),n.parentNode):n,r=r.parentNode?(A.push(r.parentNode),r.parentNode):r}if(n!==r)return e.DOCUMENT_POSITION_DISCONNECTED|e.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|e.DOCUMENT_POSITION_PRECEDING;var s=i.length>A.length?i:A,a=s===i?A:i;if(s[s.length-a.length]===a[0])return s===i?e.DOCUMENT_POSITION_CONTAINED_BY|e.DOCUMENT_POSITION_FOLLOWING:e.DOCUMENT_POSITION_CONTAINS|e.DOCUMENT_POSITION_PRECEDING;for(var c=s.length-a.length,l=a.length-1;l>=0;l--){var u=a[l],h=s[c+l];if(h!==u){var d=u.parentNode.childNodes;return d.indexOf(u)<d.indexOf(h)?a===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING:s===i?e.DOCUMENT_POSITION_PRECEDING:e.DOCUMENT_POSITION_FOLLOWING}}return e.DOCUMENT_POSITION_FOLLOWING}},{key:"contain",value:function(t){return this.contains(t)}},{key:"contains",value:function(t){for(var e=t;e&&this!==e;)e=e.parentNode;return!!e}},{key:"getAncestor",value:function(t){for(var e=this;t>0&&e;)e=e.parentNode,t--;return e}},{key:"forEach",value:function(t){for(var e=[this];e.length>0;){var n=e.pop();if(!1===t(n))break;for(var r=n.childNodes.length-1;r>=0;r--)e.push(n.childNodes[r])}}}],[{key:"isNode",value:function(t){return!!t.childNodes}}])}(qs);Zs.DOCUMENT_POSITION_DISCONNECTED=1,Zs.DOCUMENT_POSITION_PRECEDING=2,Zs.DOCUMENT_POSITION_FOLLOWING=4,Zs.DOCUMENT_POSITION_CONTAINS=8,Zs.DOCUMENT_POSITION_CONTAINED_BY=16,Zs.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var Js=function(){return c(function t(e,n){var r=this;s(this,t),this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=k(),this.tmpVec3=ut(),this.onPointerDown=function(t){var e=r.createPointerEvent(t);if(r.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)r.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){var n=2===e.button;r.dispatchEvent(e,n?"rightdown":"mousedown")}r.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),r.freeEvent(e)},this.onPointerUp=function(t){var e=ns.now(),n=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,"pointerup"),"touch"===n.pointerType)r.dispatchEvent(n,"touchend");else if("mouse"===n.pointerType||"pen"===n.pointerType){var i=2===n.button;r.dispatchEvent(n,i?"rightup":"mouseup")}var A=r.trackingData(t.pointerId),o=r.findMountedTarget(A.pressTargetsByButton[t.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var a=o;a&&!n.composedPath().includes(a);){if(n.currentTarget=a,r.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType)r.notifyTarget(n,"touchendoutside");else if("mouse"===n.pointerType||"pen"===n.pointerType){var c=2===n.button;r.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}Zs.isNode(a)&&(a=a.parentNode)}delete A.pressTargetsByButton[t.button],s=a}if(s){var l,u=r.clonePointerEvent(n,"click");u.target=s,u.path=[],A.clicksByButton[t.button]||(A.clicksByButton[t.button]={clickCount:0,target:u.target,timeStamp:e});var h=r.context.renderingContext.root.ownerDocument.defaultView,d=A.clicksByButton[t.button];d.target===u.target&&e-d.timeStamp<h.getConfig().dblClickSpeed?++d.clickCount:d.clickCount=1,d.target=u.target,d.timeStamp=e,u.detail=d.clickCount,null!==(l=n.detail)&&void 0!==l&&l.preventClick||(r.context.config.useNativeClickEvent||"mouse"!==u.pointerType&&"touch"!==u.pointerType||r.dispatchEvent(u,"click"),r.dispatchEvent(u,"pointertap")),r.freeEvent(u)}r.freeEvent(n)},this.onPointerMove=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n="mouse"===e.pointerType||"pen"===e.pointerType,i=r.trackingData(t.pointerId),A=r.findMountedTarget(i.overTargets);if(i.overTargets&&A!==e.target){var o="mousemove"===t.type?"mouseout":"pointerout",s=r.createPointerEvent(t,o,A||void 0);if(r.dispatchEvent(s,"pointerout"),n&&r.dispatchEvent(s,"mouseout"),!e.composedPath().includes(A)){var a=r.createPointerEvent(t,"pointerleave",A||void 0);for(a.eventPhase=a.AT_TARGET;a.target&&!e.composedPath().includes(a.target);)a.currentTarget=a.target,r.notifyTarget(a),n&&r.notifyTarget(a,"mouseleave"),Zs.isNode(a.target)&&(a.target=a.target.parentNode);r.freeEvent(a)}r.freeEvent(s)}if(A!==e.target){var c="mousemove"===t.type?"mouseover":"pointerover",l=r.clonePointerEvent(e,c);r.dispatchEvent(l,"pointerover"),n&&r.dispatchEvent(l,"mouseover");for(var u=A&&Zs.isNode(A)&&A.parentNode;u&&u!==(Zs.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&u!==e.target;)u=u.parentNode;if(!u||u===(Zs.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var h=r.clonePointerEvent(e,"pointerenter");for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==A&&h.target!==(Zs.isNode(r.rootTarget)&&r.rootTarget.parentNode);)h.currentTarget=h.target,r.notifyTarget(h),n&&r.notifyTarget(h,"mouseenter"),Zs.isNode(h.target)&&(h.target=h.target.parentNode);r.freeEvent(h)}r.freeEvent(l)}r.dispatchEvent(e,"pointermove"),"touch"===e.pointerType&&r.dispatchEvent(e,"touchmove"),n&&(r.dispatchEvent(e,"mousemove"),r.cursor=r.getCursor(e.target)),i.overTargets=e.composedPath(),r.freeEvent(e)},this.onPointerOut=function(t){var e=r.trackingData(t.pointerId);if(e.overTargets){var n="mouse"===t.pointerType||"pen"===t.pointerType,i=r.findMountedTarget(e.overTargets),A=r.createPointerEvent(t,"pointerout",i||void 0);r.dispatchEvent(A),n&&r.dispatchEvent(A,"mouseout");var o=r.createPointerEvent(t,"pointerleave",i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(Zs.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,"mouseleave"),Zs.isNode(o.target)&&(o.target=o.target.parentNode);e.overTargets=null,r.freeEvent(A),r.freeEvent(o)}r.cursor=null},this.onPointerOver=function(t){var e=r.trackingData(t.pointerId),n=r.createPointerEvent(t),i="mouse"===n.pointerType||"pen"===n.pointerType;r.dispatchEvent(n,"pointerover"),i&&r.dispatchEvent(n,"mouseover"),"mouse"===n.pointerType&&(r.cursor=r.getCursor(n.target));var A=r.clonePointerEvent(n,"pointerenter");for(A.eventPhase=A.AT_TARGET;A.target&&A.target!==(Zs.isNode(r.rootTarget)&&r.rootTarget.parentNode);)A.currentTarget=A.target,r.notifyTarget(A),i&&r.notifyTarget(A,"mouseenter"),Zs.isNode(A.target)&&(A.target=A.target.parentNode);e.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(A)},this.onPointerUpOutside=function(t){var e=r.trackingData(t.pointerId),n=r.findMountedTarget(e.pressTargetsByButton[t.button]),i=r.createPointerEvent(t);if(n){for(var A=n;A;)i.currentTarget=A,r.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType||"mouse"!==i.pointerType&&"pen"!==i.pointerType||r.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),Zs.isNode(A)&&(A=A.parentNode);delete e.pressTargetsByButton[t.button]}r.freeEvent(i)},this.onWheel=function(t){var e=r.createWheelEvent(t);r.dispatchEvent(e),r.freeEvent(e)},this.onClick=function(t){if(r.context.config.useNativeClickEvent){var e=r.createPointerEvent(t);r.dispatchEvent(e),r.freeEvent(e)}},this.onPointerCancel=function(t){var e=r.createPointerEvent(t,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(e),r.freeEvent(e)},this.globalRuntime=e,this.context=n},[{key:"init",value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)}},{key:"destroy",value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:"getScale",value:function(){var t=this.context.contextService.getBoundingClientRect(),e=1,n=1,r=this.context.contextService.getDomElement();if(r&&t){var i=r.offsetWidth,A=r.offsetHeight;i&&A&&(e=t.width/i,n=t.height/A)}return{scaleX:e,scaleY:n,bbox:t}}},{key:"client2Viewport",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new Fr((t.x-((null==i?void 0:i.left)||0))/n,(t.y-((null==i?void 0:i.top)||0))/r)}},{key:"viewport2Client",value:function(t){var e=this.getScale(),n=e.scaleX,r=e.scaleY,i=e.bbox;return new Fr((t.x+((null==i?void 0:i.left)||0))*n,(t.y+((null==i?void 0:i.top)||0))*r)}},{key:"viewport2Canvas",value:function(t){var e=t.x,n=t.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,A=i.width,o=i.height,s=r.getPerspectiveInverse(),a=r.getWorldTransform(),c=D(this.tmpMatrix,a,s),l=pt(this.tmpVec3,e/A*2-1,2*(1-n/o)-1,0);return xt(l,l,c),new Fr(l[0],l[1])}},{key:"canvas2Viewport",value:function(t){var e=this.rootTarget.defaultView.getCamera(),n=e.getPerspective(),r=e.getViewTransform(),i=D(this.tmpMatrix,n,r),A=pt(this.tmpVec3,t.x,t.y,0);xt(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,a=o.height;return new Fr((A[0]+1)/2*s,(1-(A[1]+1)/2)*a)}},{key:"setPickHandler",value:function(t){this.pickHandler=t}},{key:"addEventMapping",value:function(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort(function(t,e){return t.priority-e.priority})}},{key:"mapEvent",value:function(t){if(this.rootTarget){var e=this.mappingTable[t.type];if(e)for(var n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn("[EventService]: Event mapping not defined for ".concat(t.type))}}},{key:"dispatchEvent",value:function(t,e,n){if(n){t.eventPhase=t.AT_TARGET;var r=this.rootTarget.defaultView||null;t.currentTarget=r,this.notifyListeners(t,e)}else t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e)}},{key:"propagate",value:function(t,e){if(t.target){var n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){var i=n.indexOf(t.currentTarget);t.eventPhase=t.BUBBLING_PHASE;for(var A=i+1;A<n.length;A++)if(t.currentTarget=n[A],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}}},{key:"propagationPath",value:function(t){var e=[t],n=this.rootTarget.defaultView||null;if(n&&n===t)return e.unshift(n.document),e;for(var r=0;r<2048&&t!==this.rootTarget;r++)Zs.isNode(t)&&t.parentNode&&(e.push(t.parentNode),t=t.parentNode);return n&&e.push(n),e}},{key:"hitTest",value:function(t){var e=t.viewportX,n=t.viewportY,r=this.context.config,i=r.width,A=r.height,o=r.disableHitTesting;return e<0||n<0||e>i||n>A?null:!o&&this.pickHandler(t)||this.rootTarget||null}},{key:"isNativeEventFromCanvas",value:function(t,e){var n,r=null==e?void 0:e.target;if(null!==(n=r)&&void 0!==n&&n.shadowRoot&&(r=e.composedPath()[0]),r){if(r===t)return!0;if(t&&t.contains)return t.contains(r)}return!(null==e||!e.composedPath)&&e.composedPath().indexOf(t)>-1}},{key:"getExistedHTML",value:function(t){if(t.nativeEvent.composedPath)for(var e=0,n=t.nativeEvent.composedPath();e<n.length;e++){var r=n[e],i=this.nativeHTMLMap.get(r);if(i)return i}return null}},{key:"pickTarget",value:function(t){return this.hitTest({clientX:t.clientX,clientY:t.clientY,viewportX:t.viewportX,viewportY:t.viewportY,x:t.canvasX,y:t.canvasY})}},{key:"createPointerEvent",value:function(t,e,n,r){var i=this.allocateEvent(Ws);this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t;var A=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=null!=n?n:A||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r,"string"==typeof e&&(i.type=e),i}},{key:"createWheelEvent",value:function(t){var e=this.allocateEvent(Ys);this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t;var n=this.getExistedHTML(e),r=this.context.contextService.getDomElement();return e.target=n||this.isNativeEventFromCanvas(r,e.nativeEvent)&&this.pickTarget(e),e}},{key:"trackingData",value:function(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}},{key:"cloneWheelEvent",value:function(t){var e=this.allocateEvent(Ys);return e.nativeEvent=t.nativeEvent,e.originalEvent=t.originalEvent,this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.target=t.target,e.path=t.composedPath().slice(),e.type=t.type,e}},{key:"clonePointerEvent",value:function(t,e){var n=this.allocateEvent(Ws);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=null!=e?e:n.type,n}},{key:"copyPointerData",value:function(t,e){e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist}},{key:"copyMouseData",value:function(t,e){e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.client.copyFrom(t.client),e.movement.copyFrom(t.movement),e.canvas.copyFrom(t.canvas),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global),e.offset.copyFrom(t.offset)}},{key:"copyWheelData",value:function(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}},{key:"copyData",value:function(t,e){e.isTrusted=t.isTrusted,e.timeStamp=ns.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.page.copyFrom(t.page),e.viewport.copyFrom(t.viewport)}},{key:"allocateEvent",value:function(t){this.eventPool.has(t)||this.eventPool.set(t,[]);var e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e}},{key:"freeEvent",value:function(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}},{key:"notifyTarget",value:function(t,e){e=null!=e?e:t.type;var n=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(t,n),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}},{key:"notifyListeners",value:function(t,e){var n=t.currentTarget.emitter,r=n._events[e];if(r)if("fn"in r)r.once&&n.removeListener(e,r.fn,void 0,!0),r.fn.call(t.currentTarget||r.context,t);else for(var i=0;i<r.length&&!t.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(e,r[i].fn,void 0,!0),r[i].fn.call(t.currentTarget||r[i].context,t)}},{key:"findMountedTarget",value:function(t){if(!t)return null;for(var e=t[t.length-1],n=t.length-2;n>=0;n--){var r=t[n];if(!(r===this.rootTarget||Zs.isNode(r)&&r.parentNode===e))break;e=t[n]}return e}},{key:"getCursor",value:function(t){for(var e=t;e;){var n=Zo(e)&&e.getAttribute("cursor");if(n)return n;e=Zs.isNode(e)&&e.parentNode}}}])}(),$s=function(){return c(function t(){s(this,t)},[{key:"getOrCreateCanvas",value:function(t,e){if(this.canvas)return this.canvas;if(t||Na.offscreenCanvas)this.canvas=t||Na.offscreenCanvas,this.context=this.canvas.getContext("2d",o({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",o({willReadFrequently:!0},e)),this.context&&this.context.measureText||(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",o({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:"getOrCreateContext",value:function(t,e){return this.context||this.getOrCreateCanvas(t,e),this.context}}],[{key:"createCanvas",value:function(){try{return new window.OffscreenCanvas(0,0)}catch(t){}try{return document.createElement("canvas")}catch(t){}return null}}])}(),ta=function(t){return t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE",t}({}),ea=function(){return c(function t(e,n){s(this,t),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new ms,initAsync:new ps,dirtycheck:new ys,cull:new ys,beginFrame:new ms,beforeRender:new ms,render:new ms,afterRender:new ms,endFrame:new ms,destroy:new ms,pick:new vs,pickSync:new ys,pointerDown:new ms,pointerUp:new ms,pointerMove:new ms,pointerOut:new ms,pointerOver:new ms,pointerWheel:new ms,pointerCancel:new ms,click:new ms},this.globalRuntime=e,this.context=n},[{key:"init",value:function(t){var e=this,n=o(o({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(t){t.apply(n,e.globalRuntime)}),this.hooks.init.call(),0===this.hooks.initAsync.getCallbacksNum()?(this.inited=!0,t()):this.hooks.initAsync.promise().then(function(){e.inited=!0,t()}).catch(function(t){})}},{key:"getStats",value:function(){return this.stats}},{key:"disableDirtyRectangleRendering",value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(ta.CAMERA_CHANGED)}},{key:"render",value:function(t,e,n){var r=this,i=t.getConfig(),A=this.context.renderingContext;if(this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0,this.globalRuntime.sceneGraphService.syncHierarchy(A.root),this.globalRuntime.sceneGraphService.notifyMutationObservers(t),A.renderReasons.size&&this.inited){A.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var o=1===A.renderReasons.size&&A.renderReasons.has(ta.CAMERA_CHANGED),s=!i.disableRenderHooks||!o;s&&this.renderDisplayObject(A.root,i,A),this.hooks.beginFrame.call(e),s&&A.renderListCurrentFrame.forEach(function(t){r.hooks.beforeRender.call(t),r.hooks.render.call(t),r.hooks.afterRender.call(t)}),this.hooks.endFrame.call(e),A.renderListCurrentFrame=[],A.renderReasons.clear(),n()}}},{key:"renderDisplayObject",value:function(t,e,n){var r=this,i=e.renderer.getConfig(),A=i.enableDirtyCheck,o=i.enableCulling;function s(t){var e=t.renderable,i=t.sortable,s=A?e.dirty||n.dirtyRectangleRenderingDisabled?t:null:t,a=null;s&&(a=o?r.hooks.cull.call(s,r.context.camera):s)&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(a)),t.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(t,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0)}for(var a=[t];a.length>0;){var c,l=a.pop();s(l);for(var u=(null===(c=l.sortable)||void 0===c||null===(c=c.sorted)||void 0===c?void 0:c.length)>0?l.sortable.sorted:l.childNodes,h=u.length-1;h>=0;h--)a.push(u[h])}}},{key:"sort",value:function(t,e){var n,r;(null==e||null===(n=e.sorted)||void 0===n?void 0:n.length)>0&&e.dirtyReason!==ti.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var r=e.sorted.indexOf(n);if(r>-1&&e.sorted.splice(r,1),t.childNodes.indexOf(n)>-1)if(0===e.sorted.length)e.sorted.push(n);else{var i=function(t,e){for(var n=0,r=t.length;n<r;){var i=n+r>>>1;Jo(t[i],e)<0?n=i+1:r=i}return n}(e.sorted,n);e.sorted.splice(i,0,n)}}):e.sorted=t.childNodes.slice().sort(Jo),(null===(r=e.sorted)||void 0===r?void 0:r.length)>0&&0===t.childNodes.filter(function(t){return t.parsedStyle.zIndex}).length&&(e.sorted=[])}},{key:"destroy",value:function(){this.inited=!1,this.hooks.destroy.call()}},{key:"dirty",value:function(){this.context.renderingContext.renderReasons.add(ta.DISPLAY_OBJECT_CHANGED)}}])}(),na=/\[\s*(.*)=(.*)\s*\]/,ra=function(){return c(function t(){s(this,t)},[{key:"selectOne",value:function(t,e){var n=this;if(t.startsWith("."))return e.find(function(e){return((null==e?void 0:e.classList)||[]).indexOf(n.getIdOrClassname(t))>-1});if(t.startsWith("#"))return e.find(function(e){return e.id===n.getIdOrClassname(t)});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,A=r.value;return i?e.find(function(t){return e!==t&&("name"===i?t.name===A:n.attributeToString(t,i)===A)}):null}return e.find(function(n){return e!==n&&n.nodeName===t})}},{key:"selectAll",value:function(t,e){var n=this;if(t.startsWith("."))return e.findAll(function(r){return e!==r&&((null==r?void 0:r.classList)||[]).indexOf(n.getIdOrClassname(t))>-1});if(t.startsWith("#"))return e.findAll(function(r){return e!==r&&r.id===n.getIdOrClassname(t)});if(t.startsWith("[")){var r=this.getAttribute(t),i=r.name,A=r.value;return i?e.findAll(function(t){return e!==t&&("name"===i?t.name===A:n.attributeToString(t,i)===A)}):[]}return e.findAll(function(n){return e!==n&&n.nodeName===t})}},{key:"is",value:function(t,e){if(t.startsWith("."))return e.className===this.getIdOrClassname(t);if(t.startsWith("#"))return e.id===this.getIdOrClassname(t);if(t.startsWith("[")){var n=this.getAttribute(t),r=n.name,i=n.value;return"name"===r?e.name===i:this.attributeToString(e,r)===i}return e.nodeName===t}},{key:"getIdOrClassname",value:function(t){return t.substring(1)}},{key:"getAttribute",value:function(t){var e=t.match(na),n="",r="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),r=e[2].replace(/"/g,"")),{name:n,value:r}}},{key:"attributeToString",value:function(t,e){if(!t.getAttribute)return"";var n=t.getAttribute(e);return zt(n)?"":n.toString?n.toString():""}}])}(),ia=function(t){return t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.MOUNTED="DOMNodeInsertedIntoDocument",t.REMOVED="removed",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.REPARENT="reparent",t.DESTROY="destroy",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled",t}({}),Aa=function(t){function e(t,n,r,i,A,o,a,c){var l;return s(this,e),(l=p(this,e,[null])).relatedNode=n,l.prevValue=r,l.newValue=i,l.attrName=A,l.attrChange=o,l.prevParsedValue=a,l.newParsedValue=c,l.type=t,l}return m(e,t),c(e)}(Vs);Aa.ADDITION=2,Aa.MODIFICATION=1,Aa.REMOVAL=3;var oa,sa,aa,ca=new Aa(ia.REPARENT,null,"","","",0,"",""),la=Gt(),ua=ut(),ha=ft(1,1,1),da=k(),fa=Gt(),ga=ut(),pa=k(),va=Tt(),ma=ut(),ya=Tt(),wa=ut(),Ba=ut(),ba=ut(),Ea=k(),xa=Tt(),Ca=Tt(),Fa=Tt(),Ma=function(){return c(function t(e){s(this,t),this.displayObjectDependencyMap=new WeakMap,this.runtime=e},[{key:"matches",value:function(t,e){return this.runtime.sceneGraphSelector.is(t,e)}},{key:"querySelector",value:function(t,e){return this.runtime.sceneGraphSelector.selectOne(t,e)}},{key:"querySelectorAll",value:function(t,e){return this.runtime.sceneGraphSelector.selectAll(t,e)}},{key:"attach",value:function(t,e,n){var r,i=!1;t.parentNode&&(i=t.parentNode!==e,this.detach(t));var A=t.nodeName===hr.FRAGMENT,o=rs(e);t.parentNode=e;var s=A?t.childNodes:[t];oe(n)?s.forEach(function(t){e.childNodes.splice(n,0,t),t.parentNode=e}):s.forEach(function(t){e.childNodes.push(t),t.parentNode=e});var a=e.sortable;if((null!=a&&null!==(r=a.sorted)&&void 0!==r&&r.length||a.dirty||t.parsedStyle.zIndex)&&(-1===a.dirtyChildren.indexOf(t)&&a.dirtyChildren.push(t),a.dirty=!0,a.dirtyReason=ti.ADDED),!o){if(A)this.dirtyFragment(t);else{var c=t.transformable;c&&this.dirtyWorldTransform(t,c)}if(i){var l,u=!0===(null===(l=e.ownerDocument)||void 0===l||null===(l=l.defaultView)||void 0===l||null===(l=l.getConfig())||void 0===l||null===(l=l.future)||void 0===l?void 0:l.experimentalCancelEventPropagation);t.dispatchEvent(ca,u,u)}}}},{key:"detach",value:function(t){var e,n;if(t.parentNode){var r=t.transformable,i=t.parentNode.sortable;(null!=i&&null!==(e=i.sorted)&&void 0!==e&&e.length||null!==(n=t.style)&&void 0!==n&&n.zIndex)&&(-1===i.dirtyChildren.indexOf(t)&&i.dirtyChildren.push(t),i.dirty=!0,i.dirtyReason=ti.REMOVED);var A=t.parentNode.childNodes.indexOf(t);A>-1&&t.parentNode.childNodes.splice(A,1),r&&this.dirtyWorldTransform(t,r),t.parentNode=null}}},{key:"getLocalPosition",value:function(t){return t.transformable.localPosition}},{key:"getLocalRotation",value:function(t){return t.transformable.localRotation}},{key:"getLocalScale",value:function(t){return t.transformable.localScale}},{key:"getLocalSkew",value:function(t){return t.transformable.localSkew}},{key:"getLocalTransform",value:function(t){var e=t.transformable;return ii(e),e.localTransform}},{key:"setLocalPosition",value:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.transformable;Ba[0]=e[0],Ba[1]=e[1],Ba[2]=null!==(n=e[2])&&void 0!==n?n:0,Ct(i.localPosition,Ba)||(gt(i.localPosition,Ba),r&&this.dirtyLocalTransform(t,i))}},{key:"translateLocal",value:function(t,e){"number"==typeof e&&(e=ft(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Ct(e,ua)||(!function(t,e,n){var r=n[0],i=n[1],A=n[2],o=n[3],s=e[0],a=e[1],c=e[2],l=i*c-A*a,u=A*s-r*c,h=r*a-i*s;l+=l,u+=u,h+=h,t[0]=s+o*l+i*h-A*u,t[1]=a+o*u+A*l-r*h,t[2]=c+o*h+r*u-i*l}(e,e,n.localRotation),vt(n.localPosition,n.localPosition,e),this.dirtyLocalTransform(t,n))}},{key:"setLocalRotation",value:function(t,e,n,r,i){var A=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];"number"==typeof e&&(e=Rt(va,e,n,r,i));var o=t.transformable;Pt(o.localRotation,e),A&&this.dirtyLocalTransform(t,o)}},{key:"rotateLocal",value:function(t,e){"number"==typeof e&&(e=ft(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;Lt(Ca,e[0],e[1],e[2]),Ht(n.localRotation,n.localRotation,Ca),this.dirtyLocalTransform(t,n)}},{key:"setLocalScale",value:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.transformable;pt(ga,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:i.localScale[2]),Ct(ga,i.localScale)||(gt(i.localScale,ga),r&&this.dirtyLocalTransform(t,i))}},{key:"scaleLocal",value:function(t,e){var n,r=t.transformable;!function(t,e,n){t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2]}(r.localScale,r.localScale,pt(ga,e[0],e[1],null!==(n=e[2])&&void 0!==n?n:1)),this.dirtyLocalTransform(t,r)}},{key:"setLocalSkew",value:function(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];"number"==typeof e&&(e=function(t,e,n){return t[0]=e,t[1]=n,t}(fa,e,n));var i=t.transformable;!function(t,e){t[0]=e[0],t[1]=e[1]}(i.localSkew,e),r&&this.dirtyLocalTransform(t,i)}},{key:"setLocalEulerAngles",value:function(t,e){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];"number"==typeof e&&(e=ft(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var r=t.transformable;Lt(r.localRotation,e[0],e[1],e[2]),n&&this.dirtyLocalTransform(t,r)}},{key:"setLocalTransform",value:function(t,e){var n=X(ma,e),r=Z(ya,e),i=q(wa,e);this.setLocalScale(t,i,!1),this.setLocalPosition(t,n,!1),this.setLocalRotation(t,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"resetLocalTransform",value:function(t){this.setLocalScale(t,ha,!1),this.setLocalPosition(t,ua,!1),this.setLocalEulerAngles(t,ua,void 0,void 0,!1),this.setLocalSkew(t,la,void 0,!1),this.dirtyLocalTransform(t,t.transformable)}},{key:"getPosition",value:function(t){var e=t.transformable;return X(e.position,this.getWorldTransform(t,e))}},{key:"getRotation",value:function(t){var e=t.transformable;return Z(e.rotation,this.getWorldTransform(t,e))}},{key:"getScale",value:function(t){var e=t.transformable;return q(e.scaling,this.getWorldTransform(t,e))}},{key:"getOrigin",value:function(t){return t.getGeometryBounds(),t.transformable.origin}},{key:"getWorldTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.transformable;return e.localDirtyFlag||e.dirtyFlag?(t.parentNode&&t.parentNode.transformable&&this.getWorldTransform(t.parentNode),this.internalUpdateTransform(t),e.worldTransform):e.worldTransform}},{key:"setPosition",value:function(t,e){var n,r=t.transformable;if(ba[0]=e[0],ba[1]=e[1],ba[2]=null!==(n=e[2])&&void 0!==n?n:0,!Ct(this.getPosition(t),ba)){if(gt(r.position,ba),null!==t.parentNode&&t.parentNode.transformable){var i=t.parentNode.transformable;S(Ea,i.worldTransform),I(Ea,Ea),xt(r.localPosition,ba,Ea)}else gt(r.localPosition,ba);this.dirtyLocalTransform(t,r)}}},{key:"translate",value:function(t,e){"number"==typeof e&&(e=pt(ga,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0)),Ct(e,ua)||(vt(ga,this.getPosition(t),e),this.setPosition(t,ga))}},{key:"setRotation",value:function(t,e,n,r,i){var A=t.transformable;if("number"==typeof e&&(e=Dt(e,n,r,i)),null!==t.parentNode&&t.parentNode.transformable){var o=this.getRotation(t.parentNode);Pt(va,o),It(va,va),Nt(A.localRotation,va,e),_t(A.localRotation,A.localRotation),this.dirtyLocalTransform(t,A)}else this.setLocalRotation(t,e)}},{key:"rotate",value:function(t,e){"number"==typeof e&&(e=ft(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){var r=va;Lt(r,e[0],e[1],e[2]);var i=this.getRotation(t),A=this.getRotation(t.parentNode);Pt(Fa,A),It(Fa,Fa),Nt(r,Fa,r),Nt(n.localRotation,r,i),_t(n.localRotation,n.localRotation),this.dirtyLocalTransform(t,n)}else this.rotateLocal(t,e)}},{key:"setOrigin",value:function(t,e){"number"==typeof e&&(e=[e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0]);var n=t.transformable;if(e[0]!==n.origin[0]||e[1]!==n.origin[1]||e[2]!==n.origin[2]){var r=n.origin;r[0]=e[0],r[1]=e[1],r[2]=e[2]||0,this.dirtyLocalTransform(t,n)}}},{key:"setEulerAngles",value:function(t,e){"number"==typeof e&&(e=ft(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0));var n=t.transformable;if(null!==t.parentNode&&t.parentNode.transformable){Lt(n.localRotation,e[0],e[1],e[2]);var r=this.getRotation(t.parentNode);Pt(xa,It(va,r)),Ht(n.localRotation,n.localRotation,xa),this.dirtyLocalTransform(t,n)}else this.setLocalEulerAngles(t,e)}},{key:"getGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.geometry;return n.dirty&&Na.styleValueRegistry.updateGeometry(t),(e?n.renderBounds:n.contentBounds||null)||new br}},{key:"getTransformedGeometryBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(t,e);if(!br.isEmpty(r)){var i=n||new br;return i.setFromTransformedAABB(r,this.getWorldTransform(t)),i}return null}},{key:"getBounds",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.renderable;if(!r.boundsDirty&&!n&&r.bounds)return r.bounds;if(!r.renderBoundsDirty&&n&&r.renderBounds)return r.renderBounds;var i=n?r.renderBounds:r.bounds,A=this.getTransformedGeometryBounds(t,n,i);if(t.childNodes.forEach(function(t){var r=e.getBounds(t,n);r&&(A?A.add(r):(A=i||new br).update(r.center,r.halfExtents))}),A||(A=new br),n){var o=$o(t);if(o){var s=o.parsedStyle.clipPath.getBounds(n);A?s&&(A=s.intersection(A)):A.update(s.center,s.halfExtents)}}return n?(r.renderBounds=A,r.renderBoundsDirty=!1):(r.bounds=A,r.boundsDirty=!1),A}},{key:"getLocalBounds",value:function(t){if(t.parentNode){var e=da;t.parentNode.transformable&&(e=I(pa,this.getWorldTransform(t.parentNode)));var n=this.getBounds(t);if(!br.isEmpty(n)){var r=new br;return r.setFromTransformedAABB(n,e),r}}return this.getBounds(t)}},{key:"getBoundingClientRect",value:function(t){var e,n,r=this.getGeometryBounds(t);br.isEmpty(r)||(n=new br).setFromTransformedAABB(r,this.getWorldTransform(t));var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e?void 0:e.getContextService().getBoundingClientRect();if(n){var A=y(n.getMin(),2),o=A[0],s=A[1],a=y(n.getMax(),2),c=a[0],l=a[1];return new Mr(o+((null==i?void 0:i.left)||0),s+((null==i?void 0:i.top)||0),c-o,l-s)}return new Mr((null==i?void 0:i.left)||0,(null==i?void 0:i.top)||0,0,0)}},{key:"internalUpdateTransform",value:function(t){var e,n=null===(e=t.parentNode)||void 0===e?void 0:e.transformable;ii(t.transformable),function(t,e){t.dirtyFlag&&(e?D(t.worldTransform,e.worldTransform,t.localTransform):S(t.worldTransform,t.localTransform),t.dirtyFlag=!1)}(t.transformable,n)}},{key:"internalUpdateElement",value:function(t,e){var n,r,i,A,o,s,a=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization),c=e[e.length-1],l=(null==c?void 0:c.transformDirty)||(null===(r=t.transformable)||void 0===r?void 0:r.localDirtyFlag);t.transformable&&((o=t.transformable).dirtyFlag||(o.dirtyFlag=l));(this.internalUpdateTransform(t),l)&&(null===(s=t.dirty)||void 0===s||s.call(t,!0,!0));var u=(null===(i=t.renderable)||void 0===i?void 0:i.boundsDirty)||(null===(A=t.renderable)||void 0===A?void 0:A.renderBoundsDirty);if((l||u)&&!1===(null==c?void 0:c.shapeUpdated)&&a)for(var h=e.length-1;h>=0;){var d,f,g=e[h];if(g.shapeUpdated)break;null===(d=(f=g.node).dirty)||void 0===d||d.call(f,!0,!0),g.shapeUpdated=!0,h-=1}return l}},{key:"syncHierarchy",value:function(t){for(var e,n,r=[t],i=t.parentNode?[{node:t.parentNode,transformDirty:(null===(e=t.parentNode.transformable)||void 0===e?void 0:e.localDirtyFlag)||(null===(n=t.parentNode.transformable)||void 0===n?void 0:n.dirtyFlag),shapeUpdated:!1}]:[];r.length>0;){for(var A=r.pop(),o=i[i.length-1];i.length>0&&A.parentNode!==o.node;)o=i.pop();var s=this.internalUpdateElement(A,i);if(A.childNodes.length>0){for(var a=A.childNodes.length-1;a>=0;a--)r.push(A.childNodes[a]);i.push({node:A,transformDirty:s,shapeUpdated:!1})}}}},{key:"dirtyLocalTransform",value:function(t,e){rs(t)||e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtyWorldTransform(t,e))}},{key:"dirtyWorldTransform",value:function(t,e){this.dirtyWorldInternal(t,e),this.dirtyToRoot(t,!0)}},{key:"dirtyWorldInternal",value:function(t,e){var n,r=this,i=!0===(null===(n=t.ownerDocument)||void 0===n||null===(n=n.defaultView)||void 0===n||null===(n=n.getConfig())||void 0===n||null===(n=n.future)||void 0===n?void 0:n.experimentalAttributeUpdateOptimization);e.dirtyFlag||(e.dirtyFlag=!0,t.dirty(!0,!0),i||t.childNodes.forEach(function(t){var e=t.transformable;r.dirtyWorldInternal(t,e)}))}},{key:"dirtyToRoot",value:function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t,i=!0===(null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalAttributeUpdateOptimization);r;){var A,o;if(null===(A=(o=r).dirty)||void 0===A||A.call(o,!0,!0),i)break;r=r.parentNode}n&&t.forEach(function(t){var e;null===(e=t.dirty)||void 0===e||e.call(t,!0,!0)}),this.informDependentDisplayObjects(t);var s=t.mutations||[],a=s.find(function(t){return"attributes"===t.type&&t._boundsChangeData});a?a._boundsChangeData={affectChildren:a._boundsChangeData.affectChildren||n}:(a={type:"attributes",target:t,_boundsChangeData:{affectChildren:n}},s.push(a)),t.mutations=s}},{key:"dirtyFragment",value:function(t){var e,n,r=t.transformable;r&&(r.dirtyFlag=!0,r.localDirtyFlag=!0),null===(e=(n=t).dirty)||void 0===e||e.call(n,!0,!0);for(var i=t.childNodes.length,A=0;A<i;A++)this.dirtyFragment(t.childNodes[A])}},{key:"notifyMutationObservers",value:function(t){var e=new Set;if(t.getRoot().forEach(function(t){(t.mutations||[]).forEach(function(n){"attributes"===n.type&&n._boundsChangeData&&(n._boundsChangeData.affectChildren?t.forEach(function(t){var r=o({},n);r.target=t,e.add(r)}):e.add(n))}),t.mutations=void 0}),e.size>0){var n=new Xs(ia.BOUNDS_CHANGED,{detail:Array.from(e)});t.dispatchEvent(n,!0,!0)}}},{key:"updateDisplayObjectDependency",value:function(t,e,n,r){if(e&&e!==n){var i=this.displayObjectDependencyMap.get(e);if(i&&i[t]){var A=i[t].indexOf(r);i[t].splice(A,1)}}if(n){var o=this.displayObjectDependencyMap.get(n);o||(this.displayObjectDependencyMap.set(n,{}),o=this.displayObjectDependencyMap.get(n)),o[t]||(o[t]=[]),o[t].push(r)}}},{key:"informDependentDisplayObjects",value:function(t){var e,n=this,r=this.displayObjectDependencyMap.get(t);if(r){var i=null===(e=t.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig())||void 0===e||null===(e=e.future)||void 0===e?void 0:e.experimentalCancelEventPropagation;Object.keys(r).forEach(function(t){r[t].forEach(function(e){n.dirtyToRoot(e,!0),e.dispatchEvent(new Aa(ia.ATTR_MODIFIED,e,n,n,t,Aa.MODIFICATION,n,n),i,i),e.isCustomElement&&e.isConnected&&e.attributeChangedCallback&&e.attributeChangedCallback(t,n,n)})})}}}])}(),ka=function(){return c(function t(e){if(s(this,t),e<=0)throw new Error("LRU capacity must be a positive number.");this.capacity=e,this.cache=new Map},[{key:"get",value:function(t){if(this.cache.has(t)){var e=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,e),e}}},{key:"put",value:function(t,e){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,e),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n)}}},{key:"len",value:function(){return this.cache.size}},{key:"clear",value:function(){this.cache.clear()}}])}(),Qa={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},Sa=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,Ua=new RegExp("".concat(/[!%),.:;?\]}'""]/.source,"|").concat(/[!),.:;?\]}'""]/.source,"|").concat(/[)\]'"?!:;,.]/.source,"|").concat(/[!%),.:;?\]}'"]/.source)),Ta=new RegExp("".concat(/[$('"]/.source,"|").concat(/[([{'"]/.source,"|").concat(/[(['"...]/.source,"|").concat(/[$([{'"#]/.source)),Oa=function(){return c(function t(e){var n=this;s(this,t),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(t,e){return!n.isBreakingSpace(e)&&!(!t||!Ta.exec(e)&&!Ua.exec(t))},this.trimByKinsokuShorui=function(t){var e=h(t),n=e[e.length-2];if(!n)return t;var r=n[n.length-1];return e[e.length-2]=n.slice(0,-1),e[e.length-1]=r+e[e.length-1],e},this.runtime=e,this.charWidthCache=new ka(100)},[{key:"measureFont",value:function(t,e){if(this.fontMetricsCache[t])return this.fontMetricsCache[t];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});i.font=t;var A=Qa.MetricsString+Qa.BaselineSymbol,o=Math.ceil(i.measureText(A).width),s=Math.ceil(i.measureText(Qa.BaselineSymbol).width),a=Qa.HeightMultiplier*s;s=s*Qa.BaselineMultiplier|0,r.width=o,r.height=a,i.fillStyle="#f00",i.fillRect(0,0,o,a),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(A,0,s);var c=i.getImageData(0,0,o||1,a||1).data,l=c.length,u=4*o,h=0,d=0,f=!1;for(h=0;h<s;++h){for(var g=0;g<u;g+=4)if(255!==c[d+g]){f=!0;break}if(f)break;d+=u}for(n.ascent=s-h,d=l-u,f=!1,h=a;h>s;--h){for(var p=0;p<u;p+=4)if(255!==c[d+p]){f=!0;break}if(f)break;d-=u}return n.descent=h-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[t]=n,n}},{key:"measureText",value:function(t,e,n){var r=e.fontSize,i=void 0===r?16:r,A=e.wordWrap,o=void 0!==A&&A,s=e.lineHeight,a=e.lineWidth,c=void 0===a?1:a,l=e.textBaseline,u=void 0===l?"alphabetic":l,h=e.textAlign,d=void 0===h?"start":h,f=e.letterSpacing,g=void 0===f?0:f,p=e.textPath;e.textPathSide,e.textPathStartOffset;var v=e.leading,m=void 0===v?0:v,y=Es(e),w=this.measureFont(y,n);0===w.fontSize&&(w.fontSize=i,w.ascent=i);var B=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);B.font=y,e.isOverflowing=!1;var b=(o?this.wordWrap(t,e,n):t).split(/(?:\r\n|\r|\n)/),E=new Array(b.length),x=0;if(!p){for(var C=0;C<b.length;C++){var F=B.measureText(b[C]).width+(b[C].length-1)*g;E[C]=F,x=Math.max(x,F)}var M=x+c,k=s||w.fontSize+c,Q=Math.max(k,w.fontSize+c)+(b.length-1)*(k+m),S=0;return"middle"===u?S=-Q/2:"bottom"===u||"alphabetic"===u||"ideographic"===u?S=-Q:"top"!==u&&"hanging"!==u||(S=0),{font:y,width:M,height:Q,lines:b,lineWidths:E,lineHeight:k+=m,maxLineWidth:x,fontProperties:w,lineMetrics:E.map(function(t,e){var n=0;return"center"===d||"middle"===d?n-=t/2:"right"!==d&&"end"!==d||(n-=t),new Mr(n-c/2,S+e*k,t+c,k)})}}p.getTotalLength();for(var U=0;U<b.length;U++)B.measureText(b[U]).width,b[U].length}},{key:"wordWrap",value:function(t,e,n){var r=this,i=Array.from(t);if(0===i.length)return"";var A=this,o=e.wordWrapWidth,s=void 0===o?0:o,a=e.letterSpacing,c=void 0===a?0:a,l=e.maxLines,u=void 0===l?1/0:l,h=e.textOverflow,d=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),f=s+c,g="";"ellipsis"===h?g="...":h&&"clip"!==h&&(g=h);var p=[""],v=0,m=0,y=-1,w=Es(e),B=this.charWidthCache.get(w);B||(B=new ka(500),this.charWidthCache.put(w,B));var b=function(t){return r.getFromCache(t,c,B,d)},E=b(g);function x(t,e,n,r){for(;b(t)<r&&e<i.length-1&&!A.isNewline(i[e+1]);)t+=i[e+=1];for(;b(t)>r&&e>=n;)e-=1,t=t.slice(0,-1);return{lineTxt:t,txtLastCharIndex:e}}function C(t,e){if(!(E<=0||E>f))if(p[t]){var n=x(p[t],e,y+1,f-E);p[t]=n.lineTxt+g}else p[t]=g}for(var F=0;F<i.length;F++){var M=i[F],k=i[F-1],Q=i[F+1],S=b(M);if(this.isNewline(M)){if(v+1>=u){F<i.length-1&&C(v,F-1),e.isOverflowing=!0;break}y=F-1,m=0,p[v+=1]=""}else{if(S>f){C(v,F-1),e.isOverflowing=!0;break}if(m>0&&m+S>f){var U=x(p[v],F-1,y+1,f);if(U.txtLastCharIndex!==F-1){if(p[v]=U.lineTxt,U.txtLastCharIndex===i.length-1)break;F=U.txtLastCharIndex+1,M=i[F],k=i[F-1],Q=i[F+1],S=b(M)}if(v+1>=u){C(v,F-1),e.isOverflowing=!0;break}if(y=F-1,m=0,p[v+=1]="",this.isBreakingSpace(M))continue;this.canBreakInLastChar(M)||(p=this.trimToBreakable(p),m=this.sumTextWidthByCache(p[v]||"",b)),this.shouldBreakByKinsokuShorui(M,Q)&&(p=this.trimByKinsokuShorui(p),m+=b(k||""))}m+=S,p[v]+=M}}return p.join("\n")}},{key:"isBreakingSpace",value:function(t){return"string"==typeof t&&Qa.BreakingSpaces.indexOf(t.charCodeAt(0))>=0}},{key:"isNewline",value:function(t){return"string"==typeof t&&Qa.Newlines.indexOf(t.charCodeAt(0))>=0}},{key:"trimToBreakable",value:function(t){var e=h(t),n=e[e.length-2],r=this.findBreakableIndex(n);if(-1===r||!n)return e;var i=n.slice(r,r+1),A=r+1,o=r+(this.isBreakingSpace(i)?0:1);return e[e.length-1]+=n.slice(A,n.length),e[e.length-2]=n.slice(0,o),e}},{key:"canBreakInLastChar",value:function(t){return!t||!Sa.test(t)}},{key:"sumTextWidthByCache",value:function(t,e){return t.split("").reduce(function(t,n){return t+e(n)},0)}},{key:"findBreakableIndex",value:function(t){for(var e=t.length-1;e>=0;e--)if(!Sa.test(t[e]))return e;return-1}},{key:"getFromCache",value:function(t,e,n,r){var i=n.get(t);if("number"!=typeof i){var A=t.length*e;i=r.measureText(t).width+A,n.put(t,i)}return i}},{key:"clearCache",value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])}(),Na={},Ia=(sa=new _s,aa=new Hs,i(i(i(i(i(i(i(i(i(i(oa={},hr.FRAGMENT,null),hr.CIRCLE,new Ls),hr.ELLIPSE,new Ds),hr.RECT,sa),hr.IMAGE,sa),hr.GROUP,new Ks),hr.LINE,new Ps),hr.TEXT,new Gs(Na)),hr.POLYLINE,aa),hr.POLYGON,aa),i(i(i(oa,hr.PATH,new Rs),hr.HTML,new js),hr.MESH,null)),La=function(t){var e=new No,n=new Do;return i(i(i(i(i(i(i(i(i(i(t={},oi.PERCENTAGE,null),oi.NUMBER,new _o),oi.ANGLE,new To),oi.DEFINED_PATH,new Oo),oi.PAINT,e),oi.COLOR,e),oi.FILTER,new Io),oi.LENGTH,n),oi.LENGTH_PERCENTAGE,n),oi.LENGTH_PERCENTAGE_12,new Po),i(i(i(i(i(i(i(i(i(i(t,oi.LENGTH_PERCENTAGE_14,new Ro),oi.COORDINATE,new Do),oi.OFFSET_DISTANCE,new Go),oi.OPACITY_VALUE,new Ko),oi.PATH,new jo),oi.LIST_OF_POINTS,new Vo),oi.SHADOW_BLUR,new zo),oi.TEXT,new Wo),oi.TEXT_TRANSFORM,new Yo),oi.TRANSFORM,new Os),i(i(i(t,oi.TRANSFORM_ORIGIN,new Ns),oi.Z_INDEX,new Is),oi.MARKER,new Ho)}();Na.CameraContribution=Jr,Na.AnimationTimeline=null,Na.EasingFunction=null,Na.offscreenCanvasCreator=new $s,Na.sceneGraphSelector=new ra,Na.sceneGraphService=new Ma(Na),Na.textService=new Oa(Na),Na.geometryUpdaterFactory=Ia,Na.CSSPropertySyntaxFactory=La,Na.styleValueRegistry=new So(Na),Na.layoutRegistry=null,Na.globalThis="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},Na.enableStyleSyntax=!0,Na.enableSizeAttenuation=!1;var Da=0,Pa=new Aa(ia.INSERTED,null,"","","",0,"",""),Ra=new Aa(ia.REMOVED,null,"","","",0,"",""),Ha=new Xs(ia.DESTROY),_a=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).entity=Da++,t.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},t.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},t.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},t.cullable={strategy:$r.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},t.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},t.namespaceURI="g",t.scrollLeft=0,t.scrollTop=0,t.clientTop=0,t.clientLeft=0,t.style={},t.computedStyle={},t.parsedStyle={},t.attributes={},t}return m(e,t),c(e,[{key:"dirty",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1?arguments[1]:void 0;this.renderable.dirty=t,void 0!==e&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e,this.geometry.dirty=e)}},{key:"className",get:function(){return this.getAttribute("class")||""},set:function(t){this.setAttribute("class",t)}},{key:"classList",get:function(){return this.className.split(" ").filter(function(t){return""!==t})}},{key:"tagName",get:function(){return this.nodeName}},{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"parentElement",get:function(){return this.parentNode}},{key:"nextSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t+1]||null}return null}},{key:"previousSibling",get:function(){if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[t-1]||null}return null}},{key:"cloneNode",value:function(t){throw new Error(kr)}},{key:"appendChild",value:function(t,e){var n;if(t.destroyed)throw new Error("Cannot append a destroyed element.");return Na.sceneGraphService.attach(t,this,e),null!==(n=this.ownerDocument)&&void 0!==n&&n.defaultView&&(rs(this)||t.nodeName!==hr.FRAGMENT?this.ownerDocument.defaultView.mountChildren(t):this.ownerDocument.defaultView.mountFragment(t)),this.isMutationObserved&&(Pa.relatedNode=this,t.dispatchEvent(Pa)),t}},{key:"insertBefore",value:function(t,e){if(e){t.parentElement&&t.parentElement.removeChild(t);var n=this.childNodes.indexOf(e);-1===n?this.appendChild(t):this.appendChild(t,n)}else this.appendChild(t);return t}},{key:"replaceChild",value:function(t,e){var n=this.childNodes.indexOf(e);return this.removeChild(e),this.appendChild(t,n),e}},{key:"removeChild",value:function(t){var e,n,r=!0===(null===(e=this.ownerDocument)||void 0===e||null===(e=e.defaultView)||void 0===e||null===(e=e.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return Ra.relatedNode=this,t.dispatchEvent(Ra,r,r),null!==(n=t.ownerDocument)&&void 0!==n&&n.defaultView&&t.ownerDocument.defaultView.unmountChildren(t),Na.sceneGraphService.detach(t),t}},{key:"removeChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];this.removeChild(e)}}},{key:"destroyChildren",value:function(){for(var t=this.childNodes.length-1;t>=0;t--){var e=this.childNodes[t];e.childNodes.length>0&&e.destroyChildren(),e.destroy()}}},{key:"matches",value:function(t){return Na.sceneGraphService.matches(t,this)}},{key:"getElementById",value:function(t){return Na.sceneGraphService.querySelector("#".concat(t),this)}},{key:"getElementsByName",value:function(t){return Na.sceneGraphService.querySelectorAll('[name="'.concat(t,'"]'),this)}},{key:"getElementsByClassName",value:function(t){return Na.sceneGraphService.querySelectorAll(".".concat(t),this)}},{key:"getElementsByTagName",value:function(t){return Na.sceneGraphService.querySelectorAll(t,this)}},{key:"querySelector",value:function(t){return Na.sceneGraphService.querySelector(t,this)}},{key:"querySelectorAll",value:function(t){return Na.sceneGraphService.querySelectorAll(t,this)}},{key:"closest",value:function(t){var e=this;do{if(Na.sceneGraphService.matches(t,e))return e;e=e.parentElement}while(null!==e);return null}},{key:"find",value:function(t){var e=this,n=null;return this.forEach(function(r){return r===e||!t(r)||(n=r,!1)}),n}},{key:"findAll",value:function(t){var e=this,n=[];return this.forEach(function(r){r!==e&&t(r)&&n.push(r)}),n}},{key:"after",value:function(){var t=this;if(this.parentNode){for(var e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){var i;return null===(i=t.parentNode)||void 0===i?void 0:i.appendChild(n,e+r+1)})}}},{key:"before",value:function(){if(this.parentNode){for(var t,e=this.parentNode.childNodes.indexOf(this),n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var A=r[0],o=l(r).slice(1);this.parentNode.appendChild(A,e),(t=A).after.apply(t,h(o))}}},{key:"replaceWith",value:function(){this.after.apply(this,arguments),this.remove()}},{key:"append",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e){return t.appendChild(e)})}},{key:"prepend",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(function(e,n){return t.appendChild(e,n)})}},{key:"replaceChildren",value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:"remove",value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:"destroy",value:function(){var t,e=!0===(null===(t=this.ownerDocument)||void 0===t||null===(t=t.defaultView)||void 0===t||null===(t=t.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation);this.destroyChildren(),this.dispatchEvent(Ha,e,e),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:"getGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Na.sceneGraphService.getGeometryBounds(this,t)}},{key:"getTransformedGeometryBounds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Na.sceneGraphService.getTransformedGeometryBounds(this,t)}},{key:"getBounds",value:function(){return Na.sceneGraphService.getBounds(this)}},{key:"getRenderBounds",value:function(){return Na.sceneGraphService.getBounds(this,!0)}},{key:"getLocalBounds",value:function(){return Na.sceneGraphService.getLocalBounds(this)}},{key:"getBoundingClientRect",value:function(){return Na.sceneGraphService.getBoundingClientRect(this)}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"computedStyleMap",value:function(){return new Map(Object.entries(this.computedStyle))}},{key:"getAttributeNames",value:function(){return Object.keys(this.attributes)}},{key:"getAttribute",value:function(t){if("symbol"!=typeof t){var e=this.attributes[t];return e}}},{key:"hasAttribute",value:function(t){return this.getAttributeNames().includes(t)}},{key:"hasAttributes",value:function(){return!!this.getAttributeNames().length}},{key:"removeAttribute",value:function(t){this.setAttribute(t,null),delete this.attributes[t]}},{key:"setAttribute",value:function(t,e){this.attributes[t]=e}},{key:"getAttributeNS",value:function(t,e){throw new Error(kr)}},{key:"getAttributeNode",value:function(t){throw new Error(kr)}},{key:"getAttributeNodeNS",value:function(t,e){throw new Error(kr)}},{key:"hasAttributeNS",value:function(t,e){throw new Error(kr)}},{key:"removeAttributeNS",value:function(t,e){throw new Error(kr)}},{key:"removeAttributeNode",value:function(t){throw new Error(kr)}},{key:"setAttributeNS",value:function(t,e,n){throw new Error(kr)}},{key:"setAttributeNode",value:function(t){throw new Error(kr)}},{key:"setAttributeNodeNS",value:function(t){throw new Error(kr)}},{key:"toggleAttribute",value:function(t,e){throw new Error(kr)}}])}(Zs);function Ga(t){return!(null==t||!t.nodeName)}var Ka=Na.globalThis.Proxy?Na.globalThis.Proxy:function(){},ja=new Aa(ia.ATTR_MODIFIED,null,null,null,null,Aa.MODIFICATION,null,null),Va=ut(),za=Tt(),Wa=function(t){function e(t){var n;return s(this,e),(n=p(this,e)).isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=t,n.id=t.id||"",n.name=t.name||"",(t.className||t.class)&&(n.className=t.className||t.class),n.nodeName=t.type||hr.GROUP,t.initialParsedStyle&&Object.assign(n.parsedStyle,t.initialParsedStyle),n.initAttributes(t.style),Na.enableStyleSyntax&&(n.style=new Ka({setProperty:function(t,e){n.setAttribute(t,e)},getPropertyValue:function(t){return n.getAttribute(t)},removeProperty:function(t){n.removeAttribute(t)},item:function(){return""}},{get:function(t,e){return void 0!==t[e]?t[e]:n.getAttribute(e)},set:function(t,e,r){return n.setAttribute(e,r),!0}})),n}return m(e,t),c(e,[{key:"destroy",value:function(){Nn(e,"destroy",this)([]),this.getAnimations().forEach(function(t){t.cancel()})}},{key:"cloneNode",value:function(t,e){var n=o({},this.attributes);for(var r in n){var i=n[r];Ga(i)&&"clipPath"!==r&&"offsetPath"!==r&&"textPath"!==r&&(n[r]=i.cloneNode(t)),e&&(n[r]=e(r,i))}var A=new this.constructor(o(o({},this.config),{},{style:n}));return A.setLocalTransform(this.getLocalTransform()),t&&this.children.forEach(function(e){if(!e.style.isMarker){var n=e.cloneNode(t);A.appendChild(n)}}),A}},{key:"initAttributes",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Na.styleValueRegistry.processProperties(this,t,{forceUpdateGeometry:!0}),this.dirty()}},{key:"setAttribute",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];pe(n)||(r||n!==this.attributes[t])&&(this.internalSetAttribute(t,n,{memoize:i}),Nn(e,"setAttribute",this)([t,n]))}},{key:"setAttributes",value:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.skipDispatchAttrModifiedEvent,A=void 0!==i&&i;if(A||(e=o({},this.attributes),n=o({},this.parsedStyle)),Na.styleValueRegistry.processProperties(this,t,r),this.dirty(),!A)for(var s in t)this.dispatchAttrModifiedEvent(s,e[s],t[s],n[s])}},{key:"internalSetAttribute",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.attributes[t],A=this.parsedStyle[t];Na.styleValueRegistry.processProperties(this,i({},t,e),n),this.dirty(),this.dispatchAttrModifiedEvent(t,r,e,A)}},{key:"dispatchAttrModifiedEvent",value:function(t,e,n,r){var i,A=this.parsedStyle[t];if(this.isConnected)if(ja.relatedNode=this,ja.prevValue=e,ja.newValue=n,ja.attrName=t,ja.prevParsedValue=r,ja.newParsedValue=A,this.isMutationObserved)this.dispatchEvent(ja);else{var o,s=!0===(null===(o=this.ownerDocument.defaultView.getConfig().future)||void 0===o?void 0:o.experimentalCancelEventPropagation);ja.target=this,this.ownerDocument.defaultView.dispatchEvent(ja,!0,s)}(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&(null===(i=this.attributeChangedCallback)||void 0===i||i.call(this,t,e,n,r,A))}},{key:"getBBox",value:function(){var t=this.getBounds(),e=y(t.getMin(),2),n=e[0],r=e[1],i=y(t.getMax(),2),A=i[0],o=i[1];return new Mr(n,r,A-n,o-r)}},{key:"setOrigin",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Na.sceneGraphService.setOrigin(this,Tr(t,e,n,!1)),this}},{key:"getOrigin",value:function(){return Na.sceneGraphService.getOrigin(this)}},{key:"setPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Na.sceneGraphService.setPosition(this,Tr(t,e,n,!1)),this}},{key:"setLocalPosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Na.sceneGraphService.setLocalPosition(this,Tr(t,e,n,!1)),this}},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Na.sceneGraphService.translate(this,Tr(t,e,n,!1)),this}},{key:"translateLocal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Na.sceneGraphService.translateLocal(this,Tr(t,e,n,!1)),this}},{key:"getPosition",value:function(){return Na.sceneGraphService.getPosition(this)}},{key:"getLocalPosition",value:function(){return Na.sceneGraphService.getLocalPosition(this)}},{key:"scale",value:function(t,e,n){return this.scaleLocal(t,e,n)}},{key:"scaleLocal",value:function(t,e,n){return"number"==typeof t&&(t=Tr(t,e=e||t,n=n||t,!1)),Na.sceneGraphService.scaleLocal(this,t),this}},{key:"setLocalScale",value:function(t,e,n){return"number"==typeof t&&(t=Tr(t,e=e||t,n=n||t,!1)),Na.sceneGraphService.setLocalScale(this,t),this}},{key:"getLocalScale",value:function(){return Na.sceneGraphService.getLocalScale(this)}},{key:"getScale",value:function(){return Na.sceneGraphService.getScale(this)}},{key:"getEulerAngles",value:function(){return Lr(y(Pr(Va,Na.sceneGraphService.getWorldTransform(this)),3)[2])}},{key:"getLocalEulerAngles",value:function(){return Lr(y(Pr(Va,Na.sceneGraphService.getLocalRotation(this)),3)[2])}},{key:"setEulerAngles",value:function(t){return Na.sceneGraphService.setEulerAngles(this,0,0,t),this}},{key:"setLocalEulerAngles",value:function(t){return Na.sceneGraphService.setLocalEulerAngles(this,0,0,t),this}},{key:"rotateLocal",value:function(t,e,n){return zt(e)&&zt(n)?Na.sceneGraphService.rotateLocal(this,0,0,t):Na.sceneGraphService.rotateLocal(this,t,e,n),this}},{key:"rotate",value:function(t,e,n){return zt(e)&&zt(n)?Na.sceneGraphService.rotate(this,0,0,t):Na.sceneGraphService.rotate(this,t,e,n),this}},{key:"setRotation",value:function(t,e,n,r){return Na.sceneGraphService.setRotation(this,t,e,n,r),this}},{key:"setLocalRotation",value:function(t,e,n,r){return Na.sceneGraphService.setLocalRotation(this,t,e,n,r),this}},{key:"setLocalSkew",value:function(t,e){return Na.sceneGraphService.setLocalSkew(this,t,e),this}},{key:"getRotation",value:function(){return Na.sceneGraphService.getRotation(this)}},{key:"getLocalRotation",value:function(){return Na.sceneGraphService.getLocalRotation(this)}},{key:"getLocalSkew",value:function(){return Na.sceneGraphService.getLocalSkew(this)}},{key:"getLocalTransform",value:function(){return Na.sceneGraphService.getLocalTransform(this)}},{key:"getWorldTransform",value:function(){return Na.sceneGraphService.getWorldTransform(this)}},{key:"setLocalTransform",value:function(t){return Na.sceneGraphService.setLocalTransform(this,t),this}},{key:"resetLocalTransform",value:function(){Na.sceneGraphService.resetLocalTransform(this)}},{key:"getAnimations",value:function(){return this.activeAnimations}},{key:"animate",value:function(t,e){var n,r=null===(n=this.ownerDocument)||void 0===n?void 0:n.timeline;return r?r.play(this,t,e):null}},{key:"isVisible",value:function(){var t;return"hidden"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.visibility)}},{key:"interactive",get:function(){return this.isInteractive()},set:function(t){this.style.pointerEvents=t?"auto":"none"}},{key:"isInteractive",value:function(){var t;return"none"!==(null===(t=this.parsedStyle)||void 0===t?void 0:t.pointerEvents)}},{key:"isCulled",value:function(){return!(!this.cullable||!this.cullable.enable||this.cullable.visible)}},{key:"toFront",value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,h(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))+1),this}},{key:"toBack",value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,h(this.parentNode.children.map(function(t){return Number(t.style.zIndex)})))-1),this}},{key:"getConfig",value:function(){return this.config}},{key:"attr",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],A=n[1];return i?Yt(i)?(Object.keys(i).forEach(function(e){t.setAttribute(e,i[e])}),this):2===n.length?(this.setAttribute(i,A),this):this.attributes[i]:this.attributes}},{key:"getMatrix",value:function(t){var e=t||this.getWorldTransform(),n=y(X(Va,e),2),r=n[0],i=n[1],A=y(q(Va,e),2),o=A[0],s=A[1],a=Z(za,e),c=y(Pr(Va,a),3),l=c[0],u=c[2];return Rr(l||u,r,i,o,s)}},{key:"getLocalMatrix",value:function(){return this.getMatrix(this.getLocalTransform())}},{key:"setMatrix",value:function(t){var e=y(Hr(t),5),n=e[0],r=e[1],i=e[2],A=e[3],o=e[4];this.setEulerAngles(o).setPosition(n,r).setLocalScale(i,A)}},{key:"setLocalMatrix",value:function(t){var e=y(Hr(t),5),n=e[0],r=e[1],i=e[2],A=e[3],o=e[4];this.setLocalEulerAngles(o).setLocalPosition(n,r).setLocalScale(i,A)}},{key:"show",value:function(){this.forEach(function(t){t.style.visibility="visible"})}},{key:"hide",value:function(){this.forEach(function(t){t.style.visibility="hidden"})}},{key:"getCount",value:function(){return this.childElementCount}},{key:"getParent",value:function(){return this.parentElement}},{key:"getChildren",value:function(){return this.children}},{key:"getFirst",value:function(){return this.firstElementChild}},{key:"getLast",value:function(){return this.lastElementChild}},{key:"getChildByIndex",value:function(t){return this.children[t]||null}},{key:"add",value:function(t,e){return this.appendChild(t,e)}},{key:"set",value:function(t,e){this.config[t]=e}},{key:"get",value:function(t){return this.config[t]}},{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"move",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.setPosition(t,e,n),this}},{key:"setZIndex",value:function(t){return this.style.zIndex=t,this}}])}(_a);Wa.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","display","draggable","droppable","fill","fillOpacity","fillRule","filter","increasedLineWidthForHitTesting","lineCap","lineDash","lineDashOffset","lineJoin","lineWidth","miterLimit","hitArea","offsetDistance","offsetPath","offsetX","offsetY","opacity","pointerEvents","shadowColor","shadowType","shadowBlur","shadowOffsetX","shadowOffsetY","stroke","strokeOpacity","strokeWidth","strokeLinecap","strokeLineJoin","strokeDasharray","strokeDashoffset","transform","transformOrigin","textTransform","visibility","zIndex"]);var Ya=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,e),p(this,e,[o({type:hr.CIRCLE},t)])}return m(e,t),c(e)}(Wa);Ya.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["cx","cy","cz","r","isBillboard","isSizeAttenuation"]));var Xa=["style"],qa=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=ur(n,Xa);return s(this,e),(t=p(this,e,[o({style:r},i)])).isCustomElement=!0,t}return m(e,t),c(e)}(Wa);qa.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var Za=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,e),p(this,e,[o({type:hr.ELLIPSE},t)])}return m(e,t),c(e)}(Wa);Za.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["cx","cy","cz","rx","ry","isBillboard","isSizeAttenuation"])),(function(t){function e(){return s(this,e),p(this,e,[{type:hr.FRAGMENT}])}return m(e,t),c(e)}(Wa)).PARSED_STYLE_LIST=new Set(["class","className"]);var Ja=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,e),p(this,e,[o({type:hr.GROUP},t)])}return m(e,t),c(e)}(Wa);Ja.PARSED_STYLE_LIST=new Set(["class","className","clipPath","cursor","draggable","droppable","opacity","pointerEvents","transform","transformOrigin","zIndex","visibility"]);var $a=["style"],tc=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=ur(n,$a);return s(this,e),(t=p(this,e,[o({type:hr.HTML,style:r},i)])).cullable.enable=!1,t}return m(e,t),c(e,[{key:"getDomElement",value:function(){return this.parsedStyle.$el}},{key:"getClientRects",value:function(){return[this.getBoundingClientRect()]}},{key:"getLocalBounds",value:function(){if(this.parentNode){var t=I(k(),this.parentNode.getWorldTransform()),e=this.getBounds();if(!br.isEmpty(e)){var n=new br;return n.setFromTransformedAABB(e,t),n}}return this.getBounds()}}])}(Wa);tc.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["x","y","$el","innerHTML","width","height"]));var ec=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,e),p(this,e,[o({type:hr.IMAGE},t)])}return m(e,t),c(e)}(Wa);ec.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["x","y","z","src","width","height","isBillboard","billboardRotation","isSizeAttenuation","keepAspectRatio"]));var nc=["style"],rc=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=ur(n,nc);s(this,e),(t=p(this,e,[o({type:hr.LINE,style:o({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)])).markerStartAngle=0,t.markerEndAngle=0;var A=t.parsedStyle,a=A.markerStart,c=A.markerEnd;return a&&Ga(a)&&(t.markerStartAngle=a.getLocalEulerAngles(),t.appendChild(a)),c&&Ga(c)&&(t.markerEndAngle=c.getLocalEulerAngles(),t.appendChild(c)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"x1"===t||"y1"===t||"x2"===t||"y2"===t||"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&Ga(r)&&(this.markerStartAngle=0,r.remove()),i&&Ga(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t&&(r&&Ga(r)&&(this.markerEndAngle=0,r.remove()),i&&Ga(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)))}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,A=e.markerEndOffset,o=e.x1,s=e.x2,a=e.y1,c=e.y2,l=t?n:r;if(l&&Ga(l)){var u,h,d,f,g,p,v;t?(f=o,g=a,h=s-o,d=c-a,p=i||0,v=this.markerStartAngle):(f=s,g=c,h=o-s,d=a-c,p=A||0,v=this.markerEndAngle),u=Math.atan2(d,h),l.setLocalEulerAngles(180*u/Math.PI+v),l.setLocalPosition(f+Math.cos(u)*p,g+Math.sin(u)*p)}}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle,r=Gn(n.x1,n.y1,n.x2,n.y2,t),i=r.x,A=r.y,o=xt(ut(),ft(i,A,0),e?this.getWorldTransform():this.getLocalTransform());return new Fr(o[0],o[1])}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getTotalLength",value:function(){var t=this.parsedStyle;return _n(t.x1,t.y1,t.x2,t.y2)}}])}(Wa);rc.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["x1","y1","x2","y2","z1","z2","isBillboard","isSizeAttenuation","markerStart","markerEnd","markerStartOffset","markerEndOffset"]));var ic=["style"],Ac=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=ur(n,ic);s(this,e),(t=p(this,e,[o({type:hr.PATH,style:r,initialParsedStyle:{miterLimit:4,d:o({},Ai)}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var A=t.parsedStyle,a=A.markerStart,c=A.markerEnd,l=A.markerMid;return a&&Ga(a)&&(t.markerStartAngle=a.getLocalEulerAngles(),t.appendChild(a)),l&&Ga(l)&&t.placeMarkerMid(l),c&&Ga(c)&&(t.markerEndAngle=c.getLocalEulerAngles(),t.appendChild(c)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"d"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&Ga(r)&&(this.markerStartAngle=0,r.remove()),i&&Ga(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&Ga(r)&&(this.markerEndAngle=0,r.remove()),i&&Ga(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,A=e.markerEndOffset,o=t?n:r;if(o&&Ga(o)){var s,a,c,l,u,h,d;if(t){var f=y(this.getStartTangent(),2),g=f[0],p=f[1];l=p[0],u=p[1],a=g[0]-p[0],c=g[1]-p[1],h=i||0,d=this.markerStartAngle}else{var v=y(this.getEndTangent(),2),m=v[0],w=v[1];l=w[0],u=w[1],a=m[0]-w[0],c=m[1]-w[1],h=A||0,d=this.markerEndAngle}s=Math.atan2(c,a),o.setLocalEulerAngles(180*s/Math.PI+d),o.setLocalPosition(l+Math.cos(s)*h,u+Math.sin(s)*h)}}},{key:"placeMarkerMid",value:function(t){var e=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(t){t.remove()}),t&&Ga(t))for(var n=1;n<e.length-1;n++){var r=y(e[n].currentPoint,2),i=r[0],A=r[1],o=1===n?t:t.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,A)}}},{key:"getTotalLength",value:function(){return jA(this)}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(t,e,n){return Mn(t,e,Re(Re({},n),{bbox:!1,length:!0})).point}(this.parsedStyle.d.absolutePath,t),r=n.x,i=n.y,A=xt(ut(),ft(r,i,0),e?this.getWorldTransform():this.getLocalTransform());return new Fr(A[0],A[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPointAtLength(t*jA(this),e)}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.d.segments,e=[];if(t.length>1){var n=t[0].currentPoint,r=t[1].currentPoint,i=t[1].startTangent;e=[],i?(e.push([n[0]-i[0],n[1]-i[1]]),e.push([n[0],n[1]])):(e.push([r[0],r[1]]),e.push([n[0],n[1]]))}return e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.d.segments,e=t.length,n=[];if(e>1){var r=t[e-2].currentPoint,i=t[e-1].currentPoint,A=t[e-1].endTangent;n=[],A?(n.push([i[0]-A[0],i[1]-A[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n}}])}(Wa);Ac.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["d","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard","isSizeAttenuation"]));var oc=["style"],sc=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.style,i=ur(n,oc);s(this,e),(t=p(this,e,[o({type:hr.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)])).markerStartAngle=0,t.markerEndAngle=0,t.markerMidList=[];var A=t.parsedStyle,a=A.markerStart,c=A.markerEnd,l=A.markerMid;return a&&Ga(a)&&(t.markerStartAngle=a.getLocalEulerAngles(),t.appendChild(a)),l&&Ga(l)&&t.placeMarkerMid(l),c&&Ga(c)&&(t.markerEndAngle=c.getLocalEulerAngles(),t.appendChild(c)),t.transformMarker(!0),t.transformMarker(!1),t}return m(e,t),c(e,[{key:"attributeChangedCallback",value:function(t,e,n,r,i){"points"===t?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):"markerStartOffset"===t||"markerEndOffset"===t?(this.transformMarker(!0),this.transformMarker(!1)):"markerStart"===t?(r&&Ga(r)&&(this.markerStartAngle=0,r.remove()),i&&Ga(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):"markerEnd"===t?(r&&Ga(r)&&(this.markerEndAngle=0,r.remove()),i&&Ga(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):"markerMid"===t&&this.placeMarkerMid(i)}},{key:"transformMarker",value:function(t){var e=this.parsedStyle,n=e.markerStart,r=e.markerEnd,i=e.markerStartOffset,A=e.markerEndOffset,o=(e.points||{}).points,s=t?n:r;if(s&&Ga(s)&&o){var a,c,l,u,h,d,f;if(u=o[0][0],h=o[0][1],t)c=o[1][0]-o[0][0],l=o[1][1]-o[0][1],d=i||0,f=this.markerStartAngle;else{var g=o.length;this.parsedStyle.isClosed?(c=o[g-1][0]-o[0][0],l=o[g-1][1]-o[0][1]):(u=o[g-1][0],h=o[g-1][1],c=o[g-2][0]-o[g-1][0],l=o[g-2][1]-o[g-1][1]),d=A||0,f=this.markerEndAngle}a=Math.atan2(l,c),s.setLocalEulerAngles(180*a/Math.PI+f),s.setLocalPosition(u+Math.cos(a)*d,h+Math.sin(a)*d)}}},{key:"placeMarkerMid",value:function(t){var e=(this.parsedStyle.points||{}).points;if(this.markerMidList.forEach(function(t){t.remove()}),this.markerMidList=[],t&&Ga(t)&&e)for(var n=1;n<(this.parsedStyle.isClosed?e.length:e.length-1);n++){var r=e[n][0],i=e[n][1],A=1===n?t:t.cloneNode(!0);this.markerMidList.push(A),this.appendChild(A),A.setLocalPosition(r,i)}}}])}(Wa);sc.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isClosed","isBillboard","isSizeAttenuation"]));var ac=["style"],cc=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=ur(t,ac);return s(this,e),p(this,e,[o({type:hr.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)])}return m(e,t),c(e,[{key:"getTotalLength",value:function(){return 0===(t=this).parsedStyle.points.totalLength&&(t.parsedStyle.points.totalLength=Yn(t.parsedStyle.points.points)),t.parsedStyle.points.totalLength;var t}},{key:"getPointAtLength",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getPoint(t/this.getTotalLength(),e)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.parsedStyle.points.points;if(0===this.parsedStyle.points.segments.length){var r,i,A=[],o=0,s=this.getTotalLength();n.forEach(function(t,e){n[e+1]&&((r=[0,0])[0]=o/s,i=_n(t[0],t[1],n[e+1][0],n[e+1][1]),o+=i,r[1]=o/s,A.push(r))}),this.parsedStyle.points.segments=A}var a=0,c=0;this.parsedStyle.points.segments.forEach(function(e,n){t>=e[0]&&t<=e[1]&&(a=(t-e[0])/(e[1]-e[0]),c=n)});var l=Gn(n[c][0],n[c][1],n[c+1][0],n[c+1][1],a),u=l.x,h=l.y,d=xt(ut(),ft(u,h,0),e?this.getWorldTransform():this.getLocalTransform());return new Fr(d[0],d[1])}},{key:"getStartTangent",value:function(){var t=this.parsedStyle.points.points,e=[];return e.push([t[1][0],t[1][1]]),e.push([t[0][0],t[0][1]]),e}},{key:"getEndTangent",value:function(){var t=this.parsedStyle.points.points,e=t.length-1,n=[];return n.push([t[e-1][0],t[e-1][1]]),n.push([t[e][0],t[e][1]]),n}}])}(sc);cc.PARSED_STYLE_LIST=new Set([].concat(h(sc.PARSED_STYLE_LIST),["points","markerStart","markerMid","markerEnd","markerStartOffset","markerEndOffset","isBillboard"]));var lc=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,e),p(this,e,[o({type:hr.RECT},t)])}return m(e,t),c(e)}(Wa);lc.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["x","y","z","width","height","isBillboard","isSizeAttenuation","radius"]));var uc=["style"],hc=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.style,r=ur(t,uc);return s(this,e),p(this,e,[o({type:hr.TEXT,style:o({fill:"black"},n)},r)])}return m(e,t),c(e,[{key:"getComputedTextLength",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.maxLineWidth)||0}},{key:"getLineBoundingRects",value:function(){var t;return this.getGeometryBounds(),(null===(t=this.parsedStyle.metrics)||void 0===t?void 0:t.lineMetrics)||[]}},{key:"isOverflowing",value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(Wa);hc.PARSED_STYLE_LIST=new Set([].concat(h(Wa.PARSED_STYLE_LIST),["x","y","z","isBillboard","billboardRotation","isSizeAttenuation","text","textAlign","textBaseline","fontStyle","fontSize","fontFamily","fontWeight","fontVariant","lineHeight","letterSpacing","leading","wordWrap","wordWrapWidth","maxLines","textOverflow","isOverflowing","textPath","textDecorationLine","textDecorationColor","textDecorationStyle","textDecorationThickness","textPathSide","textPathStartOffset","metrics","dx","dy"]));var dc=function(){return c(function t(){s(this,t),this.registry={},this.define(hr.CIRCLE,Ya),this.define(hr.ELLIPSE,Za),this.define(hr.RECT,lc),this.define(hr.IMAGE,ec),this.define(hr.LINE,rc),this.define(hr.GROUP,Ja),this.define(hr.PATH,Ac),this.define(hr.POLYGON,sc),this.define(hr.POLYLINE,cc),this.define(hr.TEXT,hc),this.define(hr.HTML,tc)},[{key:"define",value:function(t,e){this.registry[t]=e}},{key:"get",value:function(t){return this.registry[t]}}])}(),fc=function(t){var e=t.name,n=t.inherits,r=t.interpolable,i=t.initialValue,A=t.syntax;Na.styleValueRegistry.registerMetadata({n:e,inh:n,int:r,d:i,syntax:A})},gc=function(t){function e(){var t;s(this,e),(t=p(this,e)).defaultView=null,t.ownerDocument=null,t.nodeName="document";try{t.timeline=new Na.AnimationTimeline(t)}catch(t){}var n={};return Mo.forEach(function(t){var e=t.n,r=t.inh,i=t.d;r&&i&&(n[e]=Vt(i)?i(hr.GROUP):i)}),t.documentElement=new Ja({id:"g-root",style:n}),t.documentElement.ownerDocument=t,t.documentElement.parentNode=t,t.childNodes=[t.documentElement],t}return m(e,t),c(e,[{key:"children",get:function(){return this.childNodes}},{key:"childElementCount",get:function(){return this.childNodes.length}},{key:"firstElementChild",get:function(){return this.firstChild}},{key:"lastElementChild",get:function(){return this.lastChild}},{key:"createElement",value:function(t,e){if("svg"===t)return this.documentElement;var n=this.defaultView.customElements.get(t);n||(console.warn("Unsupported tagName: ",t),n="tspan"===t?hc:Ja);var r=new n(e);return r.ownerDocument=this,r}},{key:"createElementNS",value:function(t,e,n){return this.createElement(e,n)}},{key:"cloneNode",value:function(t){throw new Error(kr)}},{key:"destroy",value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch(t){}}},{key:"elementsFromBBox",value:function(t,e,n,r){var i=[],A=function(o){if(o.isInteractive()&&!o.isCulled()){var s=o.parsedStyle.pointerEvents;if(!["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(void 0===s?"auto":s)||o.isVisible()){var a=o.getTransformedGeometryBounds(!0);a&&!br.isEmpty(a)&&a.max[0]>=t&&a.min[0]<=n&&a.max[1]>=e&&a.min[1]<=r&&i.push(o)}o.childNodes&&o.childNodes.forEach(function(t){t instanceof Wa&&A(t)})}};return A(this.documentElement),i.sort(function(t,e){return e.sortable.renderOrder-t.sortable.renderOrder}),i}},{key:"elementFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,A=this.defaultView.getConfig(),o=A.width,s=A.height;if(r<0||i<0||r>o||i>s)return null;var a=this.defaultView.viewport2Client({x:r,y:i}),c=a.x,l=a.y,u=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:l},picked:[]}).picked;return u&&u[0]||this.documentElement}},{key:"elementFromPoint",value:(r=cr(sr().mark(function t(e,n){var r,i,A,o,s,a,c,l,u,h,d;return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,A=r.y,o=this.defaultView.getConfig(),s=o.width,a=o.height,!(i<0||A<0||i>s||A>a)){t.next=1;break}return t.abrupt("return",null);case 1:return c=this.defaultView.viewport2Client({x:i,y:A}),l=c.x,u=c.y,t.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:i,viewportY:A,clientX:l,clientY:u},picked:[]});case 2:return h=t.sent,d=h.picked,t.abrupt("return",d&&d[0]||this.documentElement);case 3:case"end":return t.stop()}},t,this)})),function(t,e){return r.apply(this,arguments)})},{key:"elementsFromPointSync",value:function(t,e){var n=this.defaultView.canvas2Viewport({x:t,y:e}),r=n.x,i=n.y,A=this.defaultView.getConfig(),o=A.width,s=A.height;if(r<0||i<0||r>o||i>s)return[];var a=this.defaultView.viewport2Client({x:r,y:i}),c=a.x,l=a.y,u=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:t,y:e,viewportX:r,viewportY:i,clientX:c,clientY:l},picked:[]}).picked;return u[u.length-1]!==this.documentElement&&u.push(this.documentElement),u}},{key:"elementsFromPoint",value:(n=cr(sr().mark(function t(e,n){var r,i,A,o,s,a,c,l,u,h,d;return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.defaultView.canvas2Viewport({x:e,y:n}),i=r.x,A=r.y,o=this.defaultView.getConfig(),s=o.width,a=o.height,!(i<0||A<0||i>s||A>a)){t.next=1;break}return t.abrupt("return",[]);case 1:return c=this.defaultView.viewport2Client({x:i,y:A}),l=c.x,u=c.y,t.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:i,viewportY:A,clientX:l,clientY:u},picked:[]});case 2:return h=t.sent,(d=h.picked)[d.length-1]!==this.documentElement&&d.push(this.documentElement),t.abrupt("return",d);case 3:case"end":return t.stop()}},t,this)})),function(t,e){return n.apply(this,arguments)})},{key:"appendChild",value:function(t,e){throw new Error(Qr)}},{key:"insertBefore",value:function(t,e){throw new Error(Qr)}},{key:"removeChild",value:function(t,e){throw new Error(Qr)}},{key:"replaceChild",value:function(t,e,n){throw new Error(Qr)}},{key:"append",value:function(){throw new Error(Qr)}},{key:"prepend",value:function(){throw new Error(Qr)}},{key:"getElementById",value:function(t){return this.documentElement.getElementById(t)}},{key:"getElementsByName",value:function(t){return this.documentElement.getElementsByName(t)}},{key:"getElementsByTagName",value:function(t){return this.documentElement.getElementsByTagName(t)}},{key:"getElementsByClassName",value:function(t){return this.documentElement.getElementsByClassName(t)}},{key:"querySelector",value:function(t){return this.documentElement.querySelector(t)}},{key:"querySelectorAll",value:function(t){return this.documentElement.querySelectorAll(t)}},{key:"find",value:function(t){return this.documentElement.find(t)}},{key:"findAll",value:function(t){return this.documentElement.findAll(t)}}]);var n,r}(Zs),pc=function(){function t(e){s(this,t),this.strategies=e}return c(t,[{key:"apply",value:function(e){var n=e.config,r=e.camera,i=e.renderingService,A=e.renderingContext,o=this.strategies;i.hooks.cull.tap(t.tag,function(t){if(t){var e,i=t.cullable;if(0===o.length?i.visible=A.unculledEntities.indexOf(t.entity)>-1:i.visible=o.every(function(e){return e.isVisible(r,t)}),!t.isCulled()&&t.isVisible())return t;var s=!0===(null===(e=n.future)||void 0===e?void 0:e.experimentalCancelEventPropagation);return t.dispatchEvent(new Xs(ia.CULLED),s,s),null}return t}),i.hooks.afterRender.tap(t.tag,function(t){t.cullable.visibilityPlaneMask=-1})}}])}();pc.tag="Culling";var vc=function(){function t(){var e=this;s(this,t),this.autoPreventDefault=!1,this.rootPointerEvent=new Ws(null),this.rootWheelEvent=new Ys(null),this.onPointerMove=function(t){var n,r=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView;if(!r.supportsTouchEvents||"touch"!==t.pointerType){var i,A=lr(e.normalizeToPointerEvent(t,r));try{for(A.s();!(i=A.n()).done;){var o=i.value,s=e.bootstrapEvent(e.rootPointerEvent,o,r,t);e.context.eventService.mapEvent(s)}}catch(t){A.e(t)}finally{A.f()}e.setCursor(e.context.eventService.cursor)}},this.onClick=function(t){var n,r,i=null===(n=e.context.renderingContext.root)||void 0===n||null===(n=n.ownerDocument)||void 0===n?void 0:n.defaultView,A=lr(e.normalizeToPointerEvent(t,i));try{for(A.s();!(r=A.n()).done;){var o=r.value,s=e.bootstrapEvent(e.rootPointerEvent,o,i,t);e.context.eventService.mapEvent(s)}}catch(t){A.e(t)}finally{A.f()}e.setCursor(e.context.eventService.cursor)}}return c(t,[{key:"apply",value:function(e){var n=this;this.context=e;var r=e.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(t){return n.context.renderingService.hooks.pickSync.call({position:t,picked:[],topmost:!0}).picked[0]||null}),r.hooks.pointerWheel.tap(t.tag,function(t){var e=n.normalizeWheelEvent(t);n.context.eventService.mapEvent(e)}),r.hooks.pointerDown.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e=n.normalizeToPointerEvent(t,i);if(n.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();var r,A=lr(e);try{for(A.s();!(r=A.n()).done;){var o=r.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,t);n.context.eventService.mapEvent(s)}}catch(t){A.e(t)}finally{A.f()}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerUp.tap(t.tag,function(t){if(!i.supportsTouchEvents||"touch"!==t.pointerType){var e,r=n.context.contextService.getDomElement(),A=n.context.eventService.isNativeEventFromCanvas(r,t)?"":"outside",o=lr(n.normalizeToPointerEvent(t,i));try{for(o.s();!(e=o.n()).done;){var s=e.value,a=n.bootstrapEvent(n.rootPointerEvent,s,i,t);a.type+=A,n.context.eventService.mapEvent(a)}}catch(t){o.e(t)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerMove.tap(t.tag,this.onPointerMove),r.hooks.pointerOver.tap(t.tag,this.onPointerMove),r.hooks.pointerOut.tap(t.tag,this.onPointerMove),r.hooks.click.tap(t.tag,this.onClick),r.hooks.pointerCancel.tap(t.tag,function(t){var e,r=lr(n.normalizeToPointerEvent(t,i));try{for(r.s();!(e=r.n()).done;){var A=e.value,o=n.bootstrapEvent(n.rootPointerEvent,A,i,t);n.context.eventService.mapEvent(o)}}catch(t){r.e(t)}finally{r.f()}n.setCursor(n.context.eventService.cursor)})}},{key:"bootstrapEvent",value:function(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);var i=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),A=i.x,o=i.y;t.viewport.x=A,t.viewport.y=o;var s=this.context.eventService.viewport2Canvas(t.viewport),a=s.x,c=s.y;return t.canvas.x=a,t.canvas.y=c,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=es[t.type]||t.type),t}},{key:"normalizeWheelEvent",value:function(t){var e=this.rootWheelEvent;this.transferMouseData(e,t),e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ;var n=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),r=n.x,i=n.y;e.viewport.x=r,e.viewport.y=i;var A=this.context.eventService.viewport2Canvas(e.viewport),o=A.x,s=A.y;return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=t,e.type=t.type,e}},{key:"transferMouseData",value:function(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=ns.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}},{key:"setCursor",value:function(t){this.context.contextService.applyCursorStyle(t||this.context.config.cursor||"default")}},{key:"normalizeToPointerEvent",value:function(t,e){var n=[];if(e.isTouchEvent(t))for(var r=0;r<t.changedTouches.length;r++){var i=t.changedTouches[r];pe(i.button)&&(i.button=0),pe(i.buttons)&&(i.buttons=1),pe(i.isPrimary)&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),pe(i.width)&&(i.width=i.radiusX||1),pe(i.height)&&(i.height=i.radiusY||1),pe(i.tiltX)&&(i.tiltX=0),pe(i.tiltY)&&(i.tiltY=0),pe(i.pointerType)&&(i.pointerType="touch"),pe(i.pointerId)&&(i.pointerId=i.identifier||0),pe(i.pressure)&&(i.pressure=i.force||.5),pe(i.twist)&&(i.twist=0),pe(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=t.type,n.push(i)}else if(e.isMouseEvent(t)){var A=t;pe(A.isPrimary)&&(A.isPrimary=!0),pe(A.width)&&(A.width=1),pe(A.height)&&(A.height=1),pe(A.tiltX)&&(A.tiltX=0),pe(A.tiltY)&&(A.tiltY=0),pe(A.pointerType)&&(A.pointerType="mouse"),pe(A.pointerId)&&(A.pointerId=1),pe(A.pressure)&&(A.pressure=.5),pe(A.twist)&&(A.twist=0),pe(A.tangentialPressure)&&(A.tangentialPressure=0),A.isNormalized=!0,n.push(A)}else n.push(t);return n}}])}();vc.tag="Event";var mc=[hr.CIRCLE,hr.ELLIPSE,hr.IMAGE,hr.RECT,hr.LINE,hr.POLYLINE,hr.POLYGON,hr.TEXT,hr.PATH,hr.HTML],yc=function(){return c(function t(){s(this,t)},[{key:"isVisible",value:function(t,e){var n,r=e.cullable;if(!r.enable)return!0;var i=e.getRenderBounds();if(br.isEmpty(i))return!1;var A=t.getFrustum(),o=null===(n=e.parentNode)||void 0===n||null===(n=n.cullable)||void 0===n?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,i,o||xr.INDETERMINATE,A.planes),r.visible=r.visibilityPlaneMask!==xr.OUTSIDE,r.visible}},{key:"computeVisibilityWithPlaneMask",value:function(t,e,n,r){if(n===xr.OUTSIDE||n===xr.INSIDE)return n;for(var i=xr.INSIDE,A=mc.indexOf(t.nodeName)>-1,o=0,s=r.length;o<s;++o){var a=1<<o;if(0!==(n&a)&&(!A||4!==o&&5!==o)){var c=r[o],l=c.normal,u=c.distance;if(Bt(l,e.getPositiveFarPoint(r[o]))+u<0)return xr.OUTSIDE;Bt(l,e.getNegativeFarPoint(r[o]))+u<0&&(i|=a)}}return i}}])}(),wc=function(){function t(){s(this,t),this.mutationRecords=[],this.isFirstTimeRendering=!0,this.isFirstTimeRenderingFinished=!1}return c(t,[{key:"apply",value:function(e){var n,r=this,i=e.renderingService,A=e.renderingContext.root.ownerDocument.defaultView,o=function(t){i.dirty()},s=function(t){var e,n=t.detail;(e=r.mutationRecords).push.apply(e,h(n)),i.dirty()},a=function(t){var e=t.target;Na.enableSizeAttenuation&&Na.styleValueRegistry.updateSizeAttenuation(e,A.getCamera().getZoom())},c=function(t){var e=t.target;Na.sceneGraphService.dirtyToRoot(e),i.dirty()};i.hooks.init.tap(t.tag,function(){A.addEventListener(ia.MOUNTED,a),A.addEventListener(ia.UNMOUNTED,c),A.addEventListener(ia.ATTR_MODIFIED,o),A.addEventListener(ia.BOUNDS_CHANGED,s)}),i.hooks.destroy.tap(t.tag,function(){A.removeEventListener(ia.MOUNTED,a),A.removeEventListener(ia.UNMOUNTED,c),A.removeEventListener(ia.ATTR_MODIFIED,o),A.removeEventListener(ia.BOUNDS_CHANGED,s),r.mutationRecords=[]});var l=null!==(n=Na.globalThis.requestIdleCallback)&&void 0!==n?n:fs.bind(Na.globalThis);i.hooks.endFrame.tap(t.tag,function(){r.isFirstTimeRendering&&(r.isFirstTimeRendering=!1,l(function(){r.isFirstTimeRenderingFinished=!0})),r.mutationRecords=[]})}}])}();wc.tag="Prepare";var Bc=function(t){return t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged",t}({}),bc=new Xs(ia.MOUNTED),Ec=new Xs(ia.UNMOUNTED),xc=new Xs(Bc.BEFORE_RENDER),Cc=new Xs(Bc.RERENDER),Fc=new Xs(Bc.AFTER_RENDER),Mc=function(t){function e(t){var n;s(this,e),(n=p(this,e)).Element=Wa,n.inited=!1,n.context={};var r=t.container,i=t.canvas,A=t.renderer,a=t.width,c=t.height,l=t.background,u=t.cursor,h=t.supportsMutipleCanvasesInOneContainer,d=t.cleanUpOnDestroy,f=void 0===d||d,g=t.offscreenCanvas,v=t.devicePixelRatio,m=t.requestAnimationFrame,y=t.cancelAnimationFrame,w=t.createImage,B=t.supportsTouchEvents,b=t.supportsPointerEvents,E=t.isTouchEvent,x=t.isMouseEvent,C=t.dblClickSpeed,F=a,M=c,k=v||qo&&window.devicePixelRatio||1;return k=k>=1?Math.ceil(k):1,i&&(F=a||function(t){var e=ts(t,"width");return"auto"===e?t.offsetWidth:parseFloat(e)}(i)||i.width/k,M=c||function(t){var e=ts(t,"height");return"auto"===e?t.offsetHeight:parseFloat(e)}(i)||i.height/k),n.customElements=new dc,n.devicePixelRatio=k,n.requestAnimationFrame=null!=m?m:fs.bind(Na.globalThis),n.cancelAnimationFrame=null!=y?y:gs.bind(Na.globalThis),n.createImage=null!=w?w:function(){return new window.Image},n.supportsTouchEvents=null!=B?B:"ontouchstart"in Na.globalThis,n.supportsPointerEvents=null!=b?b:!!Na.globalThis.PointerEvent,n.isTouchEvent=null!=E?E:function(t){return n.supportsTouchEvents&&t instanceof Na.globalThis.TouchEvent},n.isMouseEvent=null!=x?x:function(t){return!Na.globalThis.MouseEvent||t instanceof Na.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(t instanceof Na.globalThis.PointerEvent))},g&&(Na.offscreenCanvas=g),n.document=new gc,n.document.defaultView=n,h||function(t,e,n){if(t){var r="string"==typeof t?document.getElementById(t):t;Xo.has(r)&&Xo.get(r).destroy(n),Xo.set(r,e)}}(r,n,f),n.initRenderingContext(o(o({},t),{},{width:F,height:M,background:null!=l?l:"transparent",cursor:null!=u?u:"default",cleanUpOnDestroy:f,devicePixelRatio:k,requestAnimationFrame:n.requestAnimationFrame,cancelAnimationFrame:n.cancelAnimationFrame,createImage:n.createImage,supportsTouchEvents:n.supportsTouchEvents,supportsPointerEvents:n.supportsPointerEvents,isTouchEvent:n.isTouchEvent,isMouseEvent:n.isMouseEvent,dblClickSpeed:null!=C?C:200})),n.initDefaultCamera(F,M,A.clipSpaceNearZ),n.initRenderer(A,!0),n}return m(e,t),c(e,[{key:"initRenderingContext",value:function(t){this.context.config=t,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:"initDefaultCamera",value:function(t,e,n){var r=this,i=new Na.CameraContribution;i.clipSpaceNearZ=n,i.setType(Wr.EXPLORING,Yr.DEFAULT).setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0).setOrthographic(t/-2,t/2,e/2,e/-2,.1,1e3),i.canvas=this,i.eventEmitter.on(qr,function(){r.context.renderingContext.renderReasons.add(ta.CAMERA_CHANGED),Na.enableSizeAttenuation&&r.getConfig().renderer.getConfig().enableSizeAttenuation&&r.updateSizeAttenuation()}),this.context.camera=i}},{key:"updateSizeAttenuation",value:function(){var t=this.getCamera().getZoom();this.document.documentElement.forEach(function(e){Na.styleValueRegistry.updateSizeAttenuation(e,t)})}},{key:"getConfig",value:function(){return this.context.config}},{key:"getRoot",value:function(){return this.document.documentElement}},{key:"getCamera",value:function(){return this.context.camera}},{key:"getContextService",value:function(){return this.context.contextService}},{key:"getEventService",value:function(){return this.context.eventService}},{key:"getRenderingService",value:function(){return this.context.renderingService}},{key:"getRenderingContext",value:function(){return this.context.renderingContext}},{key:"getStats",value:function(){return this.getRenderingService().getStats()}},{key:"ready",get:function(){var t=this;return this.readyPromise||(this.readyPromise=new Promise(function(e){t.resolveReadyPromise=function(){e(t)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:"destroy",value:function(){var t,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0;Hi.clearCache();var r=!0===(null===(t=this.getConfig().future)||void 0===t?void 0:t.experimentalCancelEventPropagation);n||this.dispatchEvent(new Xs(Bc.BEFORE_DESTROY),r,r),this.frameId&&this.cancelAnimationFrame(this.frameId);var i=this.getRoot();e&&(this.unmountChildren(i),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),n||this.dispatchEvent(new Xs(Bc.AFTER_DESTROY),r,r);var A=function(t){t.currentTarget=null,t.manager=null,t.target=null,t.relatedNode=null};A(bc),A(Ec),A(xc),A(Cc),A(Fc),A(ja),A(Pa),A(Ra),A(Ha),Na.textService.clearCache()}},{key:"changeSize",value:function(t,e){this.resize(t,e)}},{key:"resize",value:function(t,e){var n,r=this.context.config;r.width=t,r.height=e,this.getContextService().resize(t,e);var i=this.context.camera,A=i.getProjectionMode();i.setPosition(t/2,e/2,500).setFocalPoint(t/2,e/2,0),A===Xr.ORTHOGRAPHIC?i.setOrthographic(t/-2,t/2,e/2,e/-2,i.getNear(),i.getFar()):i.setAspect(t/e);var o=!0===(null===(n=r.future)||void 0===n?void 0:n.experimentalCancelEventPropagation);this.dispatchEvent(new Xs(Bc.RESIZE,{width:t,height:e}),o,o)}},{key:"appendChild",value:function(t,e){return this.document.documentElement.appendChild(t,e)}},{key:"insertBefore",value:function(t,e){return this.document.documentElement.insertBefore(t,e)}},{key:"removeChild",value:function(t){return this.document.documentElement.removeChild(t)}},{key:"removeChildren",value:function(){this.document.documentElement.removeChildren()}},{key:"destroyChildren",value:function(){this.document.documentElement.destroyChildren()}},{key:"render",value:function(t){var e,n=this;t&&(xc.detail=t,Fc.detail=t);var r=!0===(null===(e=this.getConfig().future)||void 0===e?void 0:e.experimentalCancelEventPropagation);this.dispatchEvent(xc,r,r),this.getRenderingService().render(this,t,function(){n.dispatchEvent(Cc,r,r)}),this.dispatchEvent(Fc,r,r)}},{key:"run",value:function(){var t=this,e=function(n,r){t.render(r),t.frameId=t.requestAnimationFrame(e)};e()}},{key:"initRenderer",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new vc,new wc,new pc([new yc])),this.loadRendererContainerModule(t),this.context.contextService=new this.context.ContextService(o(o({},Na),this.context)),this.context.renderingService=new ea(Na,this.context),this.context.eventService=new Js(Na,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(t,n,!0)):this.context.contextService.initAsync().then(function(){e.initRenderingService(t,n)}).catch(function(t){console.error(t)})}},{key:"initRenderingService",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.context.renderingService.init(function(){var i;e.inited=!0;var A=!0===(null===(i=e.getConfig().future)||void 0===i?void 0:i.experimentalCancelEventPropagation);n?r?e.requestAnimationFrame(function(){e.dispatchEvent(new Xs(Bc.READY),A,A)}):e.dispatchEvent(new Xs(Bc.READY),A,A):e.dispatchEvent(new Xs(Bc.RENDERER_CHANGED),A,A),e.readyPromise&&e.resolveReadyPromise(),n||e.getRoot().forEach(function(t){var e,n;null===(e=(n=t).dirty)||void 0===e||e.call(n,!0,!0)}),e.mountChildren(e.getRoot()),t.getConfig().enableAutoRendering&&e.run()})}},{key:"loadRendererContainerModule",value:function(t){var e=this;t.getPlugins().forEach(function(t){t.context=e.context,t.init(Na)})}},{key:"setRenderer",value:function(t){var e=this.getConfig();if(e.renderer!==t){var n=e.renderer;e.renderer=t,this.destroy(!1,!0),h((null==n?void 0:n.getPlugins())||[]).reverse().forEach(function(t){t.destroy(Na)}),this.initRenderer(t)}}},{key:"setCursor",value:function(t){this.getConfig().cursor=t,this.getContextService().applyCursorStyle(t)}},{key:"unmountChildren",value:function(t){var e=this;if(t.childNodes.forEach(function(t){e.unmountChildren(t)}),this.inited){if(t.isMutationObserved)t.dispatchEvent(Ec);else{var n,r=!0===(null===(n=this.getConfig().future)||void 0===n?void 0:n.experimentalCancelEventPropagation);Ec.target=t,this.dispatchEvent(Ec,!0,r)}t!==this.document.documentElement&&(t.ownerDocument=null),t.isConnected=!1}t.isCustomElement&&t.disconnectedCallback&&t.disconnectedCallback()}},{key:"mountChildren",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rs(t);if(this.inited){if(!t.isConnected&&(t.ownerDocument=this.document,t.isConnected=!0,!n))if(t.isMutationObserved)t.dispatchEvent(bc);else{var r,i=!0===(null===(r=this.getConfig().future)||void 0===r?void 0:r.experimentalCancelEventPropagation);bc.target=t,this.dispatchEvent(bc,!0,i)}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",t.nodeName);t.childNodes.forEach(function(t){e.mountChildren(t,n)}),t.isCustomElement&&t.connectedCallback&&t.connectedCallback()}},{key:"mountFragment",value:function(t){this.mountChildren(t,!1)}},{key:"client2Viewport",value:function(t){return this.getEventService().client2Viewport(t)}},{key:"viewport2Client",value:function(t){return this.getEventService().viewport2Client(t)}},{key:"viewport2Canvas",value:function(t){return this.getEventService().viewport2Canvas(t)}},{key:"canvas2Viewport",value:function(t){return this.getEventService().canvas2Viewport(t)}},{key:"getPointByClient",value:function(t,e){return this.client2Viewport({x:t,y:e})}},{key:"getClientByPoint",value:function(t,e){return this.viewport2Client({x:t,y:e})}}])}(qs),kc=function(){return c(function t(){s(this,t),this.cacheStore=new Map},[{key:"onRefAdded",value:function(t){}},{key:"has",value:function(t){return this.cacheStore.has(t)}},{key:"put",value:function(t,e,n){return!this.cacheStore.has(t)&&(this.cacheStore.set(t,{value:e,counter:new Set([n.entity])}),this.onRefAdded(n),!0)}},{key:"get",value:function(t,e){var n=this.cacheStore.get(t);return n?(n.counter.has(e.entity)||(n.counter.add(e.entity),this.onRefAdded(e)),n.value):null}},{key:"update",value:function(t,e,n){var r=this.cacheStore.get(t);return!!r&&(r.value=o(o({},r.value),e),r.counter.has(n.entity)||(r.counter.add(n.entity),this.onRefAdded(n)),!0)}},{key:"release",value:function(t,e){var n=this.cacheStore.get(t);return!!n&&(n.counter.delete(e.entity),n.counter.size<=0&&this.cacheStore.delete(t),!0)}},{key:"releaseRef",value:function(t){var e=this;Array.from(this.cacheStore.keys()).forEach(function(n){e.release(n,t)})}},{key:"getSize",value:function(){return this.cacheStore.size}},{key:"clear",value:function(){this.cacheStore.clear()}}])}(),Qc=[],Sc=[],Uc=function(){function t(){s(this,t)}return c(t,null,[{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;t.rafId&&(e.cancelAnimationFrame(t.rafId),t.rafId=null)}},{key:"executeTask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.api;Qc.length<=0&&Sc.length<=0||(Sc.forEach(function(t){return t()}),Sc=Qc.splice(0,t.TASK_NUM_PER_FRAME),t.rafId=e.requestAnimationFrame(function(){t.executeTask(e)}))}},{key:"sliceImage",value:function(e,n,r,i){for(var A=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:t.api,s=e.naturalWidth||e.width,a=e.naturalHeight||e.height,c=n-A,l=r-A,u=Math.ceil(s/c),h=Math.ceil(a/l),d={tileSize:[n,r],gridSize:[h,u],tiles:Array(h).fill(null).map(function(){return Array(u).fill(null)})},f=function(t){for(var A=function(A){Qc.push(function(){var u=A*c,h=t*l,f=[Math.min(n,s-u),Math.min(r,a-h)],g=f[0],p=f[1],v=o.createCanvas();v.width=n,v.height=r,v.getContext("2d").drawImage(e,u,h,g,p,0,0,g,p),d.tiles[t][A]={x:u,y:h,tileX:A,tileY:t,data:v},i()})},h=0;h<u;h++)A(h)},g=0;g<h;g++)f(g);return t.stop(),t.executeTask(),d}}])}();Uc.TASK_NUM_PER_FRAME=10;var Tc=new kc;Tc.onRefAdded=function(t){var e=this;t.addEventListener(ia.DESTROY,function(){e.releaseRef(t)},{once:!0})};var Oc=function(){return c(function t(e,n){s(this,t),this.gradientCache={},this.patternCache={},this.context=e,this.runtime=n},[{key:"getImageSync",value:function(t,e,n){var r=ne(t)?t:t.src;if(Tc.has(r)){var i=Tc.get(r,e);if(i.img.complete)return null==n||n(i),i}return this.getOrCreateImage(t,e).then(function(t){null==n||n(t)}).catch(function(t){console.error(t)}),null}},{key:"getOrCreateImage",value:function(t,e){var n=this,r=ne(t)?t:t.src;if(!ne(t)&&!Tc.has(r)){var i={img:t,size:[t.naturalWidth||t.width,t.naturalHeight||t.height],tileSize:Nc(t)};Tc.put(r,i,e)}if(Tc.has(r)){var A=Tc.get(r,e);return A.img.complete?Promise.resolve(A):new Promise(function(t,e){A.img.addEventListener("load",function(){A.size=[A.img.naturalWidth||A.img.width,A.img.naturalHeight||A.img.height],A.tileSize=Nc(A.img),t(A)}),A.img.addEventListener("error",function(t){e(t)})})}return new Promise(function(t,i){var A=n.context.config.createImage();if(A){var o={img:A,size:[0,0],tileSize:Nc(A)};Tc.put(r,o,e),A.onload=function(){o.size=[A.naturalWidth||A.width,A.naturalHeight||A.height],o.tileSize=Nc(o.img),t(o)},A.onerror=function(t){i(t)},A.crossOrigin="Anonymous",A.src=r}})}},{key:"createDownSampledImage",value:(e=cr(sr().mark(function t(e,n){var r,i,A,s,a,c,l,u,h,d,f,g,p,v;return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,this.getOrCreateImage(e,n);case 1:if(void 0===(r=t.sent).downSamplingRate){t.next=2;break}return t.abrupt("return",r);case 2:if(i=this.context.config.enableLargeImageOptimization,s=(A="boolean"==typeof i?{}:i).maxDownSampledImageSize,a=void 0===s?2048:s,c=A.downSamplingRateThreshold,l=void 0===c?.5:c,u=this.runtime.globalThis.createImageBitmap,h=y(r.size,2),d=h[0],f=h[1],g=r.img,p=Math.min((a+a)/(d+f),Math.max(.01,Math.min(l,.5))),v=o(o({},r),{},{downSamplingRate:p}),Tc.update(r.img.src,v,n),!u){t.next=7;break}return t.prev=3,t.next=4,u(r.img,{resizeWidth:d*p,resizeHeight:f*p});case 4:g=t.sent,t.next=6;break;case 5:t.prev=5,t.catch(3),p=1;case 6:t.next=8;break;case 7:p=1;case 8:return v=o(o({},this.getImageSync(e,n)),{},{downSampled:g,downSamplingRate:p}),Tc.update(r.img.src,v,n),t.abrupt("return",v);case 9:case"end":return t.stop()}},t,this,[[3,5]])})),function(t,n){return e.apply(this,arguments)})},{key:"createImageTiles",value:(t=cr(sr().mark(function t(e,n,r,i){var A,s,a,c,l;return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=1,this.getOrCreateImage(e,i);case 1:return A=t.sent,s=i.ownerDocument.defaultView,a=s.requestAnimationFrame,c=s.cancelAnimationFrame,Uc.api={requestAnimationFrame:a,cancelAnimationFrame:c,createCanvas:function(){return $s.createCanvas()}},l=o(o({},A),Uc.sliceImage(A.img,A.tileSize[0],A.tileSize[0],r)),Tc.update(A.img.src,l,i),t.abrupt("return",l);case 2:case"end":return t.stop()}},t,this)})),function(e,n,r,i){return t.apply(this,arguments)})},{key:"releaseImage",value:function(t,e){Tc.release(ne(t)?t:t.src,e)}},{key:"releaseImageRef",value:function(t){Tc.releaseRef(t)}},{key:"getOrCreatePatternSync",value:function(t,e,n,r,i,A,o){var s=this.generatePatternKey(e);if(s&&this.patternCache[s])return this.patternCache[s];var a,c=e.image,l=e.repetition,u=e.transform,h=!1;if(ne(c)){var d=this.getImageSync(c,t,o);a=null==d?void 0:d.img}else r?(a=r,h=!0):a=c;var f,g=a&&n.createPattern(a,l);g&&(f=u?Ts(ho(u),new Wa({})):O(k()),h&&R(f,f,[1/i,1/i,1]),g.setTransform({a:f[0],b:f[1],c:f[4],d:f[5],e:f[12]+A[0],f:f[13]+A[1]}));return s&&g&&(this.patternCache[s]=g),g}},{key:"getOrCreateGradient",value:function(t,e){var n=this.generateGradientKey(t),r=t.type,i=t.steps,A=t.min,o=t.width,s=t.height,a=t.angle,c=t.cx,l=t.cy,u=t.size;if(this.gradientCache[n])return this.gradientCache[n];var h=null;if(r===Ji.LinearGradient){var d=function(t,e,n,r){var i=Nr(r.value),A=0+e/2,o=0+n/2,s=Math.abs(e*Math.cos(i))+Math.abs(n*Math.sin(i));return{x1:t[0]+A-Math.cos(i)*s/2,y1:t[1]+o-Math.sin(i)*s/2,x2:t[0]+A+Math.cos(i)*s/2,y2:t[1]+o+Math.sin(i)*s/2}}(A,o,s,a),f=d.x1,g=d.y1,p=d.x2,v=d.y2;h=e.createLinearGradient(f,g,p,v)}else if(r===Ji.RadialGradient){var m=function(t,e,n,r,i,A){var o=r.value,s=i.value;r.unit===_i.kPercentage&&(o=r.value/100*e),i.unit===_i.kPercentage&&(s=i.value/100*n);var a=Math.max(mn([0,0],[o,s]),mn([0,n],[o,s]),mn([e,n],[o,s]),mn([e,0],[o,s]));return A&&(A instanceof nA?a=A.value:A instanceof tA&&("closest-side"===A.value?a=Math.min(o,e-o,s,n-s):"farthest-side"===A.value?a=Math.max(o,e-o,s,n-s):"closest-corner"===A.value&&(a=Math.min(mn([0,0],[o,s]),mn([0,n],[o,s]),mn([e,n],[o,s]),mn([e,0],[o,s]))))),{x:o+t[0],y:s+t[1],r:a}}(A,o,s,c,l,u),y=m.x,w=m.y,B=m.r;h=e.createRadialGradient(y,w,0,y,w,B)}return h&&(i.forEach(function(t){var e,n=t.offset,r=t.color;n.unit===_i.kPercentage&&(null===(e=h)||void 0===e||e.addColorStop(n.value/100,r.toString()))}),this.gradientCache[n]=h),this.gradientCache[n]}},{key:"generateGradientKey",value:function(t){var e=t.type,n=t.min,r=t.width,i=t.height,A=t.steps,o=t.angle,s=t.cx,a=t.cy,c=t.size;return"gradient-".concat(e,"-").concat((null==o?void 0:o.toString())||0,"-").concat((null==s?void 0:s.toString())||0,"-").concat((null==a?void 0:a.toString())||0,"-").concat((null==c?void 0:c.toString())||0,"-").concat(n[0],"-").concat(n[1],"-").concat(r,"-").concat(i,"-").concat(A.map(function(t){var e=t.offset,n=t.color;return"".concat(e).concat(n)}).join("-"))}},{key:"generatePatternKey",value:function(t){var e=t.image,n=t.repetition;return ne(e)?"pattern-".concat(e,"-").concat(n):"rect"===e.nodeName?"pattern-".concat(e.entity,"-").concat(n):void 0}}]);var t,e}();function Nc(t){if(!t.complete)return[0,0];var e=t.naturalWidth||t.width,n=t.naturalHeight||t.height,r=256;return[256,512].forEach(function(t){Math.ceil(n/t)*Math.ceil(e/t)<1e3&&(r=t)}),[r,r]}Oc.isSupportTile=!!$s.createCanvas();var Ic=function(){function t(){s(this,t)}return c(t,[{key:"apply",value:function(e){var n=e.renderingService,r=e.renderingContext,i=e.imagePool,A=r.root.ownerDocument.defaultView,o=function(t,e,n){var r=t.parsedStyle,i=r.width,A=r.height;i&&!A?t.setAttribute("height",n/e*i):!i&&A&&t.setAttribute("width",e/n*A)},s=function(t){var e=t.target,r=e.nodeName,A=e.attributes;if(r===hr.IMAGE){var s=A.src,a=A.keepAspectRatio;i.getImageSync(s,e,function(t){var r=t.img,i=r.width,A=r.height;a&&o(e,i,A),e.dirty(),n.dirty()})}},a=function(t){var e=t.target,r=t.attrName,A=t.prevValue,s=t.newValue;e.nodeName===hr.IMAGE&&"src"===r&&(A!==s&&i.releaseImage(A,e),ne(s)&&i.getOrCreateImage(s,e).then(function(t){var r=t.img,i=r.width,A=r.height;e.attributes.keepAspectRatio&&o(e,i,A),e.dirty(),n.dirty()}).catch(function(){}))};n.hooks.init.tap(t.tag,function(){A.addEventListener(ia.MOUNTED,s),A.addEventListener(ia.ATTR_MODIFIED,a)}),n.hooks.destroy.tap(t.tag,function(){A.removeEventListener(ia.MOUNTED,s),A.removeEventListener(ia.ATTR_MODIFIED,a)})}}])}();Ic.tag="LoadImage";var Lc=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).name="image-loader",t}return m(e,t),c(e,[{key:"init",value:function(t){this.context.imagePool=new Oc(this.context,t),this.addRenderingPlugin(new Ic)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(fr),Dc=Object.freeze({__proto__:null,ImagePool:Oc,Plugin:Lc}),Pc=function(){function t(){s(this,t),this.displayObjectHTMLElementMap=new WeakMap}return c(t,[{key:"joinTransformMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return"matrix(".concat([t[0],t[1],t[4],t[5],t[12]+e[0],t[13]+e[1]].join(","),")")}},{key:"apply",value:function(e,n){var r=this,i=e.camera,A=e.renderingContext,o=e.renderingService;this.context=e;var s=A.root.ownerDocument.defaultView,a=s.context.eventService.nativeHTMLMap,c=function(t,e){e.style.transform=r.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())},l=function(t){var e=t.target;if(e.nodeName===hr.HTML){r.$camera||(r.$camera=r.createCamera(i));var n=r.getOrCreateEl(e);r.$camera.appendChild(n),Object.keys(e.attributes).forEach(function(t){r.updateAttribute(t,e)}),c(e,n),a.set(n,e)}},u=function(t){var e=t.target;if(e.nodeName===hr.HTML&&r.$camera){var n=r.getOrCreateEl(e);n&&(n.remove(),a.delete(n))}},h=function(t){var e=t.target;if(e.nodeName===hr.HTML){var n=t.attrName;r.updateAttribute(n,e)}},d=function(t){for(var e=t.detail,n=0;n<e.length;n++){var i=e[n].target;(i.nodeName===hr.FRAGMENT?i.childNodes:[i]).forEach(function(t){if(t.nodeName===hr.HTML){var e=r.getOrCreateEl(t);c(t,e)}})}},f=function(){if(r.$camera){var t=r.context.config,e=t.width,n=t.height;r.$camera.parentElement.style.width="".concat(e||0,"px"),r.$camera.parentElement.style.height="".concat(n||0,"px")}};o.hooks.init.tap(t.tag,function(){s.addEventListener(Bc.RESIZE,f),s.addEventListener(ia.MOUNTED,l),s.addEventListener(ia.UNMOUNTED,u),s.addEventListener(ia.ATTR_MODIFIED,h),s.addEventListener(ia.BOUNDS_CHANGED,d)}),o.hooks.endFrame.tap(t.tag,function(){r.$camera&&A.renderReasons.has(ta.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),o.hooks.destroy.tap(t.tag,function(){r.$camera&&r.$camera.remove(),s.removeEventListener(Bc.RESIZE,f),s.removeEventListener(ia.MOUNTED,l),s.removeEventListener(ia.UNMOUNTED,u),s.removeEventListener(ia.ATTR_MODIFIED,h),s.removeEventListener(ia.BOUNDS_CHANGED,d)})}},{key:"createCamera",value:function(t){var e=this.context.config,n=e.document,r=e.width,i=e.height,A=this.context.contextService.getDomElement(),o=A.parentNode;if(o){var s="g-canvas-camera",a=o.querySelector("#".concat(s));if(!a){var c=(n||document).createElement("div");c.style.overflow="hidden",c.style.pointerEvents="none",c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width="".concat(r||0,"px"),c.style.height="".concat(i||0,"px");var l=(n||document).createElement("div");a=l,l.id=s,l.style.position="absolute",l.style.left="".concat(A.offsetLeft||0,"px"),l.style.top="".concat(A.offsetTop||0,"px"),l.style.transformOrigin="left top",l.style.transform=this.joinTransformMatrix(t.getOrthoMatrix()),l.style.pointerEvents="none",l.style.width="100%",l.style.height="100%",c.appendChild(l),o.appendChild(c)}return a}return null}},{key:"getOrCreateEl",value:function(t){var e=this.context.config.document,n=this.displayObjectHTMLElementMap.get(t);return n||(n=(e||document).createElement("div"),t.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(t,n),t.id&&(n.id=t.id),t.name&&n.setAttribute("name",t.name),t.className&&(n.className=t.className),n.style.position="absolute",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(t.getWorldTransform(),t.getOrigin())),n}},{key:"updateAttribute",value:function(t,e){var n=this.getOrCreateEl(e);switch(t){case"innerHTML":var r=e.parsedStyle.innerHTML;ne(r)?n.innerHTML=r:(n.innerHTML="",n.appendChild(r));break;case"x":n.style.left="".concat(e.parsedStyle.x,"px");break;case"y":n.style.top="".concat(e.parsedStyle.y,"px");break;case"transformOrigin":var i=e.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(i[0].buildCSSText(null,null,"")," ").concat(i[1].buildCSSText(null,null,""));break;case"width":var A=e.parsedStyle.width;n.style.width=oe(A)?"".concat(A,"px"):A.toString();break;case"height":var o=e.parsedStyle.height;n.style.height=oe(o)?"".concat(o,"px"):o.toString();break;case"zIndex":var s=e.parsedStyle.zIndex;n.style["z-index"]="".concat(s);break;case"visibility":var a=e.parsedStyle.visibility;n.style.visibility=a;break;case"pointerEvents":var c=e.parsedStyle.pointerEvents,l=void 0===c?"auto":c;n.style.pointerEvents=l;break;case"opacity":var u=e.parsedStyle.opacity;n.style.opacity="".concat(u);break;case"fill":var h=e.parsedStyle.fill,d="";EA(h)?d=h.isNone?"transparent":e.getAttribute("fill"):Array.isArray(h)?d=e.getAttribute("fill"):bA(h),n.style.background=d;break;case"stroke":var f=e.parsedStyle.stroke,g="";EA(f)?g=f.isNone?"transparent":e.getAttribute("stroke"):Array.isArray(f)?g=e.getAttribute("stroke"):bA(f),n.style["border-color"]=g,n.style["border-style"]="solid";break;case"lineWidth":var p=e.parsedStyle.lineWidth;n.style["border-width"]="".concat(p||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var v=e.style.filter;n.style.filter=v;break;default:zt(e.style[t])||""===e.style[t]||(n.style[t]=e.style[t])}}}])}();Pc.tag="HTMLRendering";var Rc=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).name="html-renderer",t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new Pc)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(fr),Hc=Object.freeze({__proto__:null,Plugin:Rc}),_c=function(){function t(){s(this,t)}return c(t,[{key:"apply",value:function(e,n){var r=this,i=e.renderingService,A=e.renderingContext,o=e.config;this.context=e;var s=A.root.ownerDocument.defaultView,a=function(t){i.hooks.pointerMove.call(t)},c=function(t){i.hooks.pointerUp.call(t)},l=function(t){i.hooks.pointerDown.call(t)},u=function(t){i.hooks.pointerOver.call(t)},h=function(t){i.hooks.pointerOut.call(t)},d=function(t){i.hooks.pointerCancel.call(t)},f=function(t){i.hooks.pointerWheel.call(t)},g=function(t){i.hooks.click.call(t)};i.hooks.init.tap(t.tag,function(){var t=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="none",t.style.msTouchAction="none"):s.supportsPointerEvents&&(t.style.touchAction="none"),s.supportsPointerEvents?function(t){n.globalThis.document.addEventListener("pointermove",a,!0),t.addEventListener("pointerdown",l,!0),t.addEventListener("pointerleave",h,!0),t.addEventListener("pointerover",u,!0),n.globalThis.addEventListener("pointerup",c,!0),n.globalThis.addEventListener("pointercancel",d,!0)}(t):function(t){n.globalThis.document.addEventListener("mousemove",a,!0),t.addEventListener("mousedown",l,!0),t.addEventListener("mouseout",h,!0),t.addEventListener("mouseover",u,!0),n.globalThis.addEventListener("mouseup",c,!0)}(t),s.supportsTouchEvents&&function(t){t.addEventListener("touchstart",l,!0),t.addEventListener("touchend",c,!0),t.addEventListener("touchmove",a,!0),t.addEventListener("touchcancel",d,!0)}(t),o.useNativeClickEvent&&t.addEventListener("click",g,!0),t.addEventListener("wheel",f,{passive:!0,capture:!0})}),i.hooks.destroy.tap(t.tag,function(){var t=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(t.style.msContentZooming="",t.style.msTouchAction=""):s.supportsPointerEvents&&(t.style.touchAction=""),s.supportsPointerEvents?function(t){n.globalThis.document.removeEventListener("pointermove",a,!0),t.removeEventListener("pointerdown",l,!0),t.removeEventListener("pointerleave",h,!0),t.removeEventListener("pointerover",u,!0),n.globalThis.removeEventListener("pointerup",c,!0),n.globalThis.removeEventListener("pointercancel",d,!0)}(t):function(t){n.globalThis.document.removeEventListener("mousemove",a,!0),t.removeEventListener("mousedown",l,!0),t.removeEventListener("mouseout",h,!0),t.removeEventListener("mouseover",u,!0),n.globalThis.removeEventListener("mouseup",c,!0)}(t),s.supportsTouchEvents&&function(t){t.removeEventListener("touchstart",l,!0),t.removeEventListener("touchend",c,!0),t.removeEventListener("touchmove",a,!0),t.removeEventListener("touchcancel",d,!0)}(t),o.useNativeClickEvent&&t.removeEventListener("click",g,!0),t.removeEventListener("wheel",f,!0)})}}])}();_c.tag="DOMInteraction";var Gc=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).name="dom-interaction",t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new _c)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}(fr),Kc=Object.freeze({__proto__:null,Plugin:Gc});(function(){function t(){s(this,t)}return c(t,[{key:"apply",value:function(e){var n=e.renderingService,r=e.contextService,i=e.config,A=r.getDomElement(),o=function(t){n.hooks.pointerDown.call(t)},s=function(t){n.hooks.pointerUp.call(t)},a=function(t){n.hooks.pointerMove.call(t)},c=function(t){n.hooks.pointerOver.call(t)},l=function(t){n.hooks.pointerOut.call(t)},u=function(t){n.hooks.click.call(t)},h=function(t){n.hooks.pointerCancel.call(t)};n.hooks.init.tap(t.tag,function(){A.addEventListener("touchstart",o,!0),A.addEventListener("touchend",s,!0),A.addEventListener("touchmove",a,!0),A.addEventListener("touchcancel",h,!0),A.addEventListener("mouseout",l,!0),A.addEventListener("mouseover",c,!0),i.useNativeClickEvent&&A.addEventListener("click",u,!0)}),n.hooks.destroy.tap(t.tag,function(){A.removeEventListener("touchstart",o,!0),A.removeEventListener("touchend",s,!0),A.removeEventListener("touchmove",a,!0),A.removeEventListener("touchcancel",h,!0),A.removeEventListener("mouseout",l,!0),A.removeEventListener("mouseover",c,!0),i.useNativeClickEvent&&A.removeEventListener("click",u,!0)})}}])}()).tag="MobileInteraction";
/*!
   * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
   * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
   * Released under MIT License
   */
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
var jc=function(t,e){return jc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},jc(t,e)};function Vc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}jc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function zc(t,e,n,r){return new(n||(n=Promise))(function(e,i){function A(t){try{s(r.next(t))}catch(t){i(t)}}function o(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n(function(t){t(r)})).then(A,o)}s((r=r.apply(t,[])).next())})}function Wc(t,e){var n,r,i,A,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return A={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(A[Symbol.iterator]=function(){return this}),A;function s(A){return function(s){return function(A){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&A[0]?r.return:A[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,A[1])).done)return i;switch(r=0,i&&(A=[2&A[0],i.value]),A[0]){case 0:case 1:i=A;break;case 4:return o.label++,{value:A[1],done:!1};case 5:o.label++,r=A[1],A=[0];continue;case 7:A=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==A[0]&&2!==A[0])){o=0;continue}if(3===A[0]&&(!i||A[1]>i[0]&&A[1]<i[3])){o.label=A[1];break}if(6===A[0]&&o.label<i[1]){o.label=i[1],i=A;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(A);break}i[2]&&o.ops.pop(),o.trys.pop();continue}A=e.call(t,o)}catch(t){A=[6,t],r=0}finally{n=i=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([A,s])}}}for(var Yc=function(){function t(t,e,n,r){this.left=t,this.top=e,this.width=n,this.height=r}return t.prototype.add=function(e,n,r,i){return new t(this.left+e,this.top+n,this.width+r,this.height+i)},t.fromClientRect=function(e,n){return new t(n.left+e.windowBounds.left,n.top+e.windowBounds.top,n.width,n.height)},t.fromDOMRectList=function(e,n){var r=Array.from(n).find(function(t){return 0!==t.width});return r?new t(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t}(),Xc=function(t,e){return Yc.fromClientRect(t,e.getBoundingClientRect())},qc=function(t){for(var e=[],n=0,r=t.length;n<r;){var i=t.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var A=t.charCodeAt(n++);56320==(64512&A)?e.push(((1023&i)<<10)+(1023&A)+65536):(e.push(i),n--)}else e.push(i)}return e},Zc=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var n=t.length;if(!n)return"";for(var r=[],i=-1,A="";++i<n;){var o=t[i];o<=65535?r.push(o):(o-=65536,r.push(55296+(o>>10),o%1024+56320)),(i+1===n||r.length>16384)&&(A+=String.fromCharCode.apply(String,r),r.length=0)}return A},Jc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$c="undefined"==typeof Uint8Array?[]:new Uint8Array(256),tl=0;tl<64;tl++)$c[Jc.charCodeAt(tl)]=tl;for(var el="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nl="undefined"==typeof Uint8Array?[]:new Uint8Array(256),rl=0;rl<64;rl++)nl[el.charCodeAt(rl)]=rl;for(var il=function(t,e,n){return t.slice?t.slice(e,n):new Uint16Array(Array.prototype.slice.call(t,e,n))},Al=function(){function t(t,e,n,r,i,A){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=r,this.index=i,this.data=A}return t.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=((e=this.index[t>>5])<<2)+(31&t),this.data[e];if(t<=65535)return e=((e=this.index[2048+(t-55296>>5)])<<2)+(31&t),this.data[e];if(t<this.highStart)return e=2080+(t>>11),e=this.index[e],e+=t>>5&63,e=((e=this.index[e])<<2)+(31&t),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),ol="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sl="undefined"==typeof Uint8Array?[]:new Uint8Array(256),al=0;al<64;al++)sl[ol.charCodeAt(al)]=al;var cl=10,ll=13,ul=15,hl=17,dl=18,fl=19,gl=20,pl=21,vl=22,ml=24,yl=25,wl=26,Bl=27,bl=28,El=30,xl=32,Cl=33,Fl=34,Ml=35,kl=37,Ql=38,Sl=39,Ul=40,Tl=42,Ol=[9001,65288],Nl="",Il="",Ll=function(t){var e,n,r,i=function(t){var e,n,r,i,A,o=.75*t.length,s=t.length,a=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),l=Array.isArray(c)?c:new Uint8Array(c);for(e=0;e<s;e+=4)n=nl[t.charCodeAt(e)],r=nl[t.charCodeAt(e+1)],i=nl[t.charCodeAt(e+2)],A=nl[t.charCodeAt(e+3)],l[a++]=n<<2|r>>4,l[a++]=(15&r)<<4|i>>2,l[a++]=(3&i)<<6|63&A;return c}(t),A=Array.isArray(i)?function(t){for(var e=t.length,n=[],r=0;r<e;r+=4)n.push(t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]);return n}(i):new Uint32Array(i),o=Array.isArray(i)?function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n.push(t[r+1]<<8|t[r]);return n}(i):new Uint16Array(i),s=il(o,12,A[4]/2),a=2===A[5]?il(o,(24+A[4])/2):(e=A,n=Math.ceil((24+A[4])/4),e.slice?e.slice(n,r):new Uint32Array(Array.prototype.slice.call(e,n,r)));return new Al(A[0],A[1],A[2],A[3],s,a)}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),Dl=[El,36],Pl=[1,2,3,5],Rl=[cl,8],Hl=[Bl,wl],_l=Pl.concat(Rl),Gl=[Ql,Sl,Ul,Fl,Ml],Kl=[ul,ll],jl=function(t,e,n,r){var i=r[n];if(Array.isArray(t)?-1!==t.indexOf(i):t===i)for(var A=n;A<=r.length;){if((a=r[++A])===e)return!0;if(a!==cl)break}if(i===cl)for(A=n;A>0;){var o=r[--A];if(Array.isArray(t)?-1!==t.indexOf(o):t===o)for(var s=n;s<=r.length;){var a;if((a=r[++s])===e)return!0;if(a!==cl)break}if(o!==cl)break}return!1},Vl=function(t,e){for(var n=t;n>=0;){var r=e[n];if(r!==cl)return r;n--}return 0},zl=function(t,e,n,r,i){if(0===n[r])return Nl;var A=r-1;if(Array.isArray(i)&&!0===i[A])return Nl;var o=A-1,s=A+1,a=e[A],c=o>=0?e[o]:0,l=e[s];if(2===a&&3===l)return Nl;if(-1!==Pl.indexOf(a))return"!";if(-1!==Pl.indexOf(l))return Nl;if(-1!==Rl.indexOf(l))return Nl;if(8===Vl(A,e))return Il;if(11===Ll.get(t[A]))return Nl;if((a===xl||a===Cl)&&11===Ll.get(t[s]))return Nl;if(7===a||7===l)return Nl;if(9===a)return Nl;if(-1===[cl,ll,ul].indexOf(a)&&9===l)return Nl;if(-1!==[hl,dl,fl,ml,bl].indexOf(l))return Nl;if(Vl(A,e)===vl)return Nl;if(jl(23,vl,A,e))return Nl;if(jl([hl,dl],pl,A,e))return Nl;if(jl(12,12,A,e))return Nl;if(a===cl)return Il;if(23===a||23===l)return Nl;if(16===l||16===a)return Il;if(-1!==[ll,ul,pl].indexOf(l)||14===a)return Nl;if(36===c&&-1!==Kl.indexOf(a))return Nl;if(a===bl&&36===l)return Nl;if(l===gl)return Nl;if(-1!==Dl.indexOf(l)&&a===yl||-1!==Dl.indexOf(a)&&l===yl)return Nl;if(a===Bl&&-1!==[kl,xl,Cl].indexOf(l)||-1!==[kl,xl,Cl].indexOf(a)&&l===wl)return Nl;if(-1!==Dl.indexOf(a)&&-1!==Hl.indexOf(l)||-1!==Hl.indexOf(a)&&-1!==Dl.indexOf(l))return Nl;if(-1!==[Bl,wl].indexOf(a)&&(l===yl||-1!==[vl,ul].indexOf(l)&&e[s+1]===yl)||-1!==[vl,ul].indexOf(a)&&l===yl||a===yl&&-1!==[yl,bl,ml].indexOf(l))return Nl;if(-1!==[yl,bl,ml,hl,dl].indexOf(l))for(var u=A;u>=0;){if((h=e[u])===yl)return Nl;if(-1===[bl,ml].indexOf(h))break;u--}if(-1!==[Bl,wl].indexOf(l))for(u=-1!==[hl,dl].indexOf(a)?o:A;u>=0;){var h;if((h=e[u])===yl)return Nl;if(-1===[bl,ml].indexOf(h))break;u--}if(Ql===a&&-1!==[Ql,Sl,Fl,Ml].indexOf(l)||-1!==[Sl,Fl].indexOf(a)&&-1!==[Sl,Ul].indexOf(l)||-1!==[Ul,Ml].indexOf(a)&&l===Ul)return Nl;if(-1!==Gl.indexOf(a)&&-1!==[gl,wl].indexOf(l)||-1!==Gl.indexOf(l)&&a===Bl)return Nl;if(-1!==Dl.indexOf(a)&&-1!==Dl.indexOf(l))return Nl;if(a===ml&&-1!==Dl.indexOf(l))return Nl;if(-1!==Dl.concat(yl).indexOf(a)&&l===vl&&-1===Ol.indexOf(t[s])||-1!==Dl.concat(yl).indexOf(l)&&a===dl)return Nl;if(41===a&&41===l){for(var d=n[A],f=1;d>0&&41===e[--d];)f++;if(f%2!=0)return Nl}return a===xl&&l===Cl?Nl:Il},Wl=function(t,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var n=function(t,e){void 0===e&&(e="strict");var n=[],r=[],i=[];return t.forEach(function(t,A){var o=Ll.get(t);if(o>50?(i.push(!0),o-=50):i.push(!1),-1!==["normal","auto","loose"].indexOf(e)&&-1!==[8208,8211,12316,12448].indexOf(t))return r.push(A),n.push(16);if(4===o||11===o){if(0===A)return r.push(A),n.push(El);var s=n[A-1];return-1===_l.indexOf(s)?(r.push(r[A-1]),n.push(s)):(r.push(A),n.push(El))}return r.push(A),31===o?n.push("strict"===e?pl:kl):o===Tl||29===o?n.push(El):43===o?t>=131072&&t<=196605||t>=196608&&t<=262141?n.push(kl):n.push(El):void n.push(o)}),[r,n,i]}(t,e.lineBreak),r=n[0],i=n[1],A=n[2];"break-all"!==e.wordBreak&&"break-word"!==e.wordBreak||(i=i.map(function(t){return-1!==[yl,El,Tl].indexOf(t)?kl:t}));var o="keep-all"===e.wordBreak?A.map(function(e,n){return e&&t[n]>=19968&&t[n]<=40959}):void 0;return[r,i,o]},Yl=function(){function t(t,e,n,r){this.codePoints=t,this.required="!"===e,this.start=n,this.end=r}return t.prototype.slice=function(){return Zc.apply(void 0,this.codePoints.slice(this.start,this.end))},t}(),Xl=45,ql=43,Zl=-1,Jl=function(t){return t>=48&&t<=57},$l=function(t){return Jl(t)||t>=65&&t<=70||t>=97&&t<=102},tu=function(t){return 10===t||9===t||32===t},eu=function(t){return function(t){return function(t){return t>=97&&t<=122}(t)||function(t){return t>=65&&t<=90}(t)}(t)||function(t){return t>=128}(t)||95===t},nu=function(t){return eu(t)||Jl(t)||t===Xl},ru=function(t){return t>=0&&t<=8||11===t||t>=14&&t<=31||127===t},iu=function(t,e){return 92===t&&10!==e},Au=function(t,e,n){return t===Xl?eu(e)||iu(e,n):!!eu(t)||!(92!==t||!iu(t,e))},ou=function(t,e,n){return t===ql||t===Xl?!!Jl(e)||46===e&&Jl(n):Jl(46===t?e:t)},su=function(t){var e=0,n=1;t[e]!==ql&&t[e]!==Xl||(t[e]===Xl&&(n=-1),e++);for(var r=[];Jl(t[e]);)r.push(t[e++]);var i=r.length?parseInt(Zc.apply(void 0,r),10):0;46===t[e]&&e++;for(var A=[];Jl(t[e]);)A.push(t[e++]);var o=A.length,s=o?parseInt(Zc.apply(void 0,A),10):0;69!==t[e]&&101!==t[e]||e++;var a=1;t[e]!==ql&&t[e]!==Xl||(t[e]===Xl&&(a=-1),e++);for(var c=[];Jl(t[e]);)c.push(t[e++]);var l=c.length?parseInt(Zc.apply(void 0,c),10):0;return n*(i+s*Math.pow(10,-o))*Math.pow(10,a*l)},au={type:2},cu={type:3},lu={type:4},uu={type:13},hu={type:8},du={type:21},fu={type:9},gu={type:10},pu={type:11},vu={type:12},mu={type:14},yu={type:23},wu={type:1},Bu={type:25},bu={type:24},Eu={type:26},xu={type:27},Cu={type:28},Fu={type:29},Mu={type:31},ku={type:32},Qu=function(){function t(){this._value=[]}return t.prototype.write=function(t){this._value=this._value.concat(qc(t))},t.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==ku;)t.push(e),e=this.consumeToken();return t},t.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case 34:return this.consumeStringToken(34);case 35:var e=this.peekCodePoint(0),n=this.peekCodePoint(1),r=this.peekCodePoint(2);if(nu(e)||iu(n,r)){var i=Au(e,n,r)?2:1;return{type:5,value:this.consumeName(),flags:i}}break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),uu;break;case 39:return this.consumeStringToken(39);case 40:return au;case 41:return cu;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),mu;break;case ql:if(ou(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 44:return lu;case Xl:var A=t,o=this.peekCodePoint(0),s=this.peekCodePoint(1);if(ou(A,o,s))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(Au(A,o,s))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(o===Xl&&62===s)return this.consumeCodePoint(),this.consumeCodePoint(),bu;break;case 46:if(ou(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var a=this.consumeCodePoint();if(42===a&&47===(a=this.consumeCodePoint()))return this.consumeToken();if(a===Zl)return this.consumeToken()}break;case 58:return Eu;case 59:return xu;case 60:if(33===this.peekCodePoint(0)&&this.peekCodePoint(1)===Xl&&this.peekCodePoint(2)===Xl)return this.consumeCodePoint(),this.consumeCodePoint(),Bu;break;case 64:var c=this.peekCodePoint(0),l=this.peekCodePoint(1),u=this.peekCodePoint(2);if(Au(c,l,u))return{type:7,value:this.consumeName()};break;case 91:return Cu;case 92:if(iu(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case 93:return Fu;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),hu;break;case 123:return pu;case 125:return vu;case 117:case 85:var h=this.peekCodePoint(0),d=this.peekCodePoint(1);return h!==ql||!$l(d)&&63!==d||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),fu;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),du;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),gu;break;case Zl:return ku}return tu(t)?(this.consumeWhiteSpace(),Mu):Jl(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):eu(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:Zc(t)}},t.prototype.consumeCodePoint=function(){var t=this._value.shift();return void 0===t?-1:t},t.prototype.reconsumeCodePoint=function(t){this._value.unshift(t)},t.prototype.peekCodePoint=function(t){return t>=this._value.length?-1:this._value[t]},t.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();$l(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var n=!1;63===e&&t.length<6;)t.push(e),e=this.consumeCodePoint(),n=!0;if(n)return{type:30,start:parseInt(Zc.apply(void 0,t.map(function(t){return 63===t?48:t})),16),end:parseInt(Zc.apply(void 0,t.map(function(t){return 63===t?70:t})),16)};var r=parseInt(Zc.apply(void 0,t),16);if(this.peekCodePoint(0)===Xl&&$l(this.peekCodePoint(1))){this.consumeCodePoint(),e=this.consumeCodePoint();for(var i=[];$l(e)&&i.length<6;)i.push(e),e=this.consumeCodePoint();return{type:30,start:r,end:parseInt(Zc.apply(void 0,i),16)}}return{type:30,start:r,end:r}},t.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return"url"===t.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},t.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Zl)return{type:22,value:""};var e=this.peekCodePoint(0);if(39===e||34===e){var n=this.consumeStringToken(this.consumeCodePoint());return 0===n.type&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Zl||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:n.value}):(this.consumeBadUrlRemnants(),yu)}for(;;){var r=this.consumeCodePoint();if(r===Zl||41===r)return{type:22,value:Zc.apply(void 0,t)};if(tu(r))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Zl||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:Zc.apply(void 0,t)}):(this.consumeBadUrlRemnants(),yu);if(34===r||39===r||40===r||ru(r))return this.consumeBadUrlRemnants(),yu;if(92===r){if(!iu(r,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),yu;t.push(this.consumeEscapedCodePoint())}else t.push(r)}},t.prototype.consumeWhiteSpace=function(){for(;tu(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(41===t||t===Zl)return;iu(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(t){for(var e="";t>0;){var n=Math.min(5e4,t);e+=Zc.apply(void 0,this._value.splice(0,n)),t-=n}return this._value.shift(),e},t.prototype.consumeStringToken=function(t){for(var e="",n=0;;){var r=this._value[n];if(r===Zl||void 0===r||r===t)return{type:0,value:e+=this.consumeStringSlice(n)};if(10===r)return this._value.splice(0,n),wu;if(92===r){var i=this._value[n+1];i!==Zl&&void 0!==i&&(10===i?(e+=this.consumeStringSlice(n),n=-1,this._value.shift()):iu(r,i)&&(e+=this.consumeStringSlice(n),e+=Zc(this.consumeEscapedCodePoint()),n=-1))}n++}},t.prototype.consumeNumber=function(){var t=[],e=4,n=this.peekCodePoint(0);for(n!==ql&&n!==Xl||t.push(this.consumeCodePoint());Jl(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0);var r=this.peekCodePoint(1);if(46===n&&Jl(r))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;Jl(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),r=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((69===n||101===n)&&((r===ql||r===Xl)&&Jl(i)||Jl(r)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;Jl(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[su(t),e]},t.prototype.consumeNumericToken=function(){var t=this.consumeNumber(),e=t[0],n=t[1],r=this.peekCodePoint(0),i=this.peekCodePoint(1),A=this.peekCodePoint(2);return Au(r,i,A)?{type:15,number:e,flags:n,unit:this.consumeName()}:37===r?(this.consumeCodePoint(),{type:16,number:e,flags:n}):{type:17,number:e,flags:n}},t.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if($l(t)){for(var e=Zc(t);$l(this.peekCodePoint(0))&&e.length<6;)e+=Zc(this.consumeCodePoint());tu(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(e,16);return 0===n||function(t){return t>=55296&&t<=57343}(n)||n>1114111?65533:n}return t===Zl?65533:t},t.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(nu(e))t+=Zc(e);else{if(!iu(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),t;t+=Zc(this.consumeEscapedCodePoint())}}},t}(),Su=function(){function t(t){this._tokens=t}return t.create=function(e){var n=new Qu;return n.write(e),new t(n.read())},t.parseValue=function(e){return t.create(e).parseComponentValue()},t.parseValues=function(e){return t.create(e).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var t=this.consumeToken();31===t.type;)t=this.consumeToken();if(32===t.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);var e=this.consumeComponentValue();do{t=this.consumeToken()}while(31===t.type);if(32===t.type)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(32===e.type)return t;t.push(e),t.push()}},t.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},t.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},n=this.consumeToken();;){if(32===n.type||Du(n,t))return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue()),n=this.consumeToken()}},t.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(32===n.type||3===n.type)return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var t=this._tokens.shift();return void 0===t?ku:t},t.prototype.reconsumeToken=function(t){this._tokens.unshift(t)},t}(),Uu=function(t){return 15===t.type},Tu=function(t){return 17===t.type},Ou=function(t){return 20===t.type},Nu=function(t,e){return Ou(t)&&t.value===e},Iu=function(t){return 31!==t.type&&4!==t.type},Lu=function(t){var e=[],n=[];return t.forEach(function(t){if(4===t.type){if(0===n.length)throw new Error("Error parsing function args, zero tokens for arg");return e.push(n),void(n=[])}31!==t.type&&n.push(t)}),n.length&&e.push(n),e},Du=function(t,e){return 11===e&&12===t.type||(28===e&&29===t.type||2===e&&3===t.type)},Pu=function(t){return 17===t.type||15===t.type},Ru=function(t){return 16===t.type||Pu(t)},Hu=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},_u={type:17,number:0,flags:4},Gu={type:16,number:50,flags:4},Ku={type:16,number:100,flags:4},ju=function(t,e,n){var r=t[0],i=t[1];return[Vu(r,e),Vu(void 0!==i?i:r,n)]},Vu=function(t,e){if(16===t.type)return t.number/100*e;if(Uu(t))switch(t.unit){case"rem":case"em":return 16*t.number;default:return t.number}return t.number},zu="grad",Wu="turn",Yu=function(t,e){if(15===e.type)switch(e.unit){case"deg":return Math.PI*e.number/180;case zu:return Math.PI/200*e.number;case"rad":return e.number;case Wu:return 2*Math.PI*e.number}throw new Error("Unsupported angle type")},Xu=function(t){return 15===t.type&&("deg"===t.unit||t.unit===zu||"rad"===t.unit||t.unit===Wu)},qu=function(t){switch(t.filter(Ou).map(function(t){return t.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[_u,_u];case"to top":case"bottom":return Zu(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[_u,Ku];case"to right":case"left":return Zu(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[Ku,Ku];case"to bottom":case"top":return Zu(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[Ku,_u];case"to left":case"right":return Zu(270)}return 0},Zu=function(t){return Math.PI*t/180},Ju=function(t,e){if(18===e.type){var n=oh[e.name];if(void 0===n)throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return n(t,e.values)}if(5===e.type){if(3===e.value.length){var r=e.value.substring(0,1),i=e.value.substring(1,2),A=e.value.substring(2,3);return eh(parseInt(r+r,16),parseInt(i+i,16),parseInt(A+A,16),1)}if(4===e.value.length){r=e.value.substring(0,1),i=e.value.substring(1,2),A=e.value.substring(2,3);var o=e.value.substring(3,4);return eh(parseInt(r+r,16),parseInt(i+i,16),parseInt(A+A,16),parseInt(o+o,16)/255)}if(6===e.value.length){r=e.value.substring(0,2),i=e.value.substring(2,4),A=e.value.substring(4,6);return eh(parseInt(r,16),parseInt(i,16),parseInt(A,16),1)}if(8===e.value.length){r=e.value.substring(0,2),i=e.value.substring(2,4),A=e.value.substring(4,6),o=e.value.substring(6,8);return eh(parseInt(r,16),parseInt(i,16),parseInt(A,16),parseInt(o,16)/255)}}if(20===e.type){var s=ah[e.value.toUpperCase()];if(void 0!==s)return s}return ah.TRANSPARENT},$u=function(t){return!(255&t)},th=function(t){var e=255&t,n=255&t>>8,r=255&t>>16,i=255&t>>24;return e<255?"rgba("+i+","+r+","+n+","+e/255+")":"rgb("+i+","+r+","+n+")"},eh=function(t,e,n,r){return(t<<24|e<<16|n<<8|Math.round(255*r))>>>0},nh=function(t,e){if(17===t.type)return t.number;if(16===t.type){var n=3===e?1:255;return 3===e?t.number/100*n:Math.round(t.number/100*n)}return 0},rh=function(t,e){var n=e.filter(Iu);if(3===n.length){var r=n.map(nh),i=r[0],A=r[1],o=r[2];return eh(i,A,o,1)}if(4===n.length){var s=n.map(nh),a=(i=s[0],A=s[1],o=s[2],s[3]);return eh(i,A,o,a)}return 0};function ih(t,e,n){return n<0&&(n+=1),n>=1&&(n-=1),n<1/6?(e-t)*n*6+t:n<.5?e:n<2/3?6*(e-t)*(2/3-n)+t:t}var Ah=function(t,e){var n=e.filter(Iu),r=n[0],i=n[1],A=n[2],o=n[3],s=(17===r.type?Zu(r.number):Yu(t,r))/(2*Math.PI),a=Ru(i)?i.number/100:0,c=Ru(A)?A.number/100:0,l=void 0!==o&&Ru(o)?Vu(o,1):1;if(0===a)return eh(255*c,255*c,255*c,1);var u=c<=.5?c*(a+1):c+a-c*a,h=2*c-u,d=ih(h,u,s+1/3),f=ih(h,u,s),g=ih(h,u,s-1/3);return eh(255*d,255*f,255*g,l)},oh={hsl:Ah,hsla:Ah,rgb:rh,rgba:rh},sh=function(t,e){return Ju(t,Su.create(e).parseComponentValue())},ah={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},ch={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(t){if(Ou(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},lh={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},uh=function(t,e){var n=Ju(t,e[0]),r=e[1];return r&&Ru(r)?{color:n,stop:r}:{color:n,stop:null}},hh=function(t,e){var n=t[0],r=t[t.length-1];null===n.stop&&(n.stop=_u),null===r.stop&&(r.stop=Ku);for(var i=[],A=0,o=0;o<t.length;o++){var s=t[o].stop;if(null!==s){var a=Vu(s,e);a>A?i.push(a):i.push(A),A=a}else i.push(null)}var c=null;for(o=0;o<i.length;o++){var l=i[o];if(null===l)null===c&&(c=o);else if(null!==c){for(var u=o-c,h=(l-i[c-1])/(u+1),d=1;d<=u;d++)i[c+d-1]=h*d;c=null}}return t.map(function(t,n){return{color:t.color,stop:Math.max(Math.min(1,i[n]/e),0)}})},dh=function(t,e,n){var r="number"==typeof t?t:function(t,e,n){var r=e/2,i=n/2,A=Vu(t[0],e)-r,o=i-Vu(t[1],n);return(Math.atan2(o,A)+2*Math.PI)%(2*Math.PI)}(t,e,n),i=Math.abs(e*Math.sin(r))+Math.abs(n*Math.cos(r)),A=e/2,o=n/2,s=i/2,a=Math.sin(r-Math.PI/2)*s,c=Math.cos(r-Math.PI/2)*s;return[i,A-c,A+c,o-a,o+a]},fh=function(t,e){return Math.sqrt(t*t+e*e)},gh=function(t,e,n,r,i){return[[0,0],[0,e],[t,0],[t,e]].reduce(function(t,e){var A=e[0],o=e[1],s=fh(n-A,r-o);return(i?s<t.optimumDistance:s>t.optimumDistance)?{optimumCorner:e,optimumDistance:s}:t},{optimumDistance:i?1/0:-1/0,optimumCorner:null}).optimumCorner},ph=function(t,e){var n=Zu(180),r=[];return Lu(e).forEach(function(e,i){if(0===i){var A=e[0];if(20===A.type&&-1!==["top","left","right","bottom"].indexOf(A.value))return void(n=qu(e));if(Xu(A))return void(n=(Yu(t,A)+Zu(270))%Zu(360))}var o=uh(t,e);r.push(o)}),{angle:n,stops:r,type:1}},vh="closest-side",mh="farthest-side",yh="closest-corner",wh="farthest-corner",Bh="circle",bh="ellipse",Eh="cover",xh="contain",Ch=function(t,e){var n=0,r=3,i=[],A=[];return Lu(e).forEach(function(e,o){var s=!0;if(0===o?s=e.reduce(function(t,e){if(Ou(e))switch(e.value){case"center":return A.push(Gu),!1;case"top":case"left":return A.push(_u),!1;case"right":case"bottom":return A.push(Ku),!1}else if(Ru(e)||Pu(e))return A.push(e),!1;return t},s):1===o&&(s=e.reduce(function(t,e){if(Ou(e))switch(e.value){case Bh:return n=0,!1;case bh:return n=1,!1;case xh:case vh:return r=0,!1;case mh:return r=1,!1;case yh:return r=2,!1;case Eh:case wh:return r=3,!1}else if(Pu(e)||Ru(e))return Array.isArray(r)||(r=[]),r.push(e),!1;return t},s)),s){var a=uh(t,e);i.push(a)}}),{size:r,shape:n,stops:i,position:A,type:2}},Fh=function(t,e){if(22===e.type){var n={url:e.value,type:0};return t.cache.addImage(e.value),n}if(18===e.type){var r=kh[e.name];if(void 0===r)throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return r(t,e.values)}throw new Error("Unsupported image type "+e.type)};var Mh,kh={"linear-gradient":function(t,e){var n=Zu(180),r=[];return Lu(e).forEach(function(e,i){if(0===i){var A=e[0];if(20===A.type&&"to"===A.value)return void(n=qu(e));if(Xu(A))return void(n=Yu(t,A))}var o=uh(t,e);r.push(o)}),{angle:n,stops:r,type:1}},"-moz-linear-gradient":ph,"-ms-linear-gradient":ph,"-o-linear-gradient":ph,"-webkit-linear-gradient":ph,"radial-gradient":function(t,e){var n=0,r=3,i=[],A=[];return Lu(e).forEach(function(e,o){var s=!0;if(0===o){var a=!1;s=e.reduce(function(t,e){if(a)if(Ou(e))switch(e.value){case"center":return A.push(Gu),t;case"top":case"left":return A.push(_u),t;case"right":case"bottom":return A.push(Ku),t}else(Ru(e)||Pu(e))&&A.push(e);else if(Ou(e))switch(e.value){case Bh:return n=0,!1;case bh:return n=1,!1;case"at":return a=!0,!1;case vh:return r=0,!1;case Eh:case mh:return r=1,!1;case xh:case yh:return r=2,!1;case wh:return r=3,!1}else if(Pu(e)||Ru(e))return Array.isArray(r)||(r=[]),r.push(e),!1;return t},s)}if(s){var c=uh(t,e);i.push(c)}}),{size:r,shape:n,stops:i,position:A,type:2}},"-moz-radial-gradient":Ch,"-ms-radial-gradient":Ch,"-o-radial-gradient":Ch,"-webkit-radial-gradient":Ch,"-webkit-gradient":function(t,e){var n=Zu(180),r=[],i=1;return Lu(e).forEach(function(e,n){var A=e[0];if(0===n){if(Ou(A)&&"linear"===A.value)return void(i=1);if(Ou(A)&&"radial"===A.value)return void(i=2)}if(18===A.type)if("from"===A.name){var o=Ju(t,A.values[0]);r.push({stop:_u,color:o})}else if("to"===A.name){o=Ju(t,A.values[0]);r.push({stop:Ku,color:o})}else if("color-stop"===A.name){var s=A.values.filter(Iu);if(2===s.length){o=Ju(t,s[1]);var a=s[0];Tu(a)&&r.push({stop:{type:16,number:100*a.number,flags:a.flags},color:o})}}}),1===i?{angle:(n+Zu(180))%Zu(360),stops:r,type:i}:{size:3,shape:0,stops:r,position:[],type:i}}},Qh={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){if(0===e.length)return[];var n=e[0];return 20===n.type&&"none"===n.value?[]:e.filter(function(t){return Iu(t)&&function(t){return!(20===t.type&&"none"===t.value||18===t.type&&!kh[t.name])}(t)}).map(function(e){return Fh(t,e)})}},Sh={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(t){if(Ou(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Uh={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Lu(e).map(function(t){return t.filter(Ru)}).map(Hu)}},Th={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Lu(e).map(function(t){return t.filter(Ou).map(function(t){return t.value}).join(" ")}).map(Oh)}},Oh=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};!function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"}(Mh||(Mh={}));var Nh,Ih={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,e){return Lu(e).map(function(t){return t.filter(Lh)})}},Lh=function(t){return Ou(t)||Ru(t)},Dh=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},Ph=Dh("top"),Rh=Dh("right"),Hh=Dh("bottom"),_h=Dh("left"),Gh=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return Hu(e.filter(Ru))}}},Kh=Gh("top-left"),jh=Gh("top-right"),Vh=Gh("bottom-right"),zh=Gh("bottom-left"),Wh=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Yh=Wh("top"),Xh=Wh("right"),qh=Wh("bottom"),Zh=Wh("left"),Jh=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Uu(e)?e.number:0}}},$h=Jh("top"),td=Jh("right"),ed=Jh("bottom"),nd=Jh("left"),rd={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},id={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){return"rtl"===e?1:0}},Ad={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Ou).reduce(function(t,e){return t|od(e.value)},0)}},od=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},sd={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},ad={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return 20===e.type&&"normal"===e.value?0:17===e.type||15===e.type?e.number:0}};!function(t){t.NORMAL="normal",t.STRICT="strict"}(Nh||(Nh={}));var cd,ld={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){return"strict"===e?Nh.STRICT:Nh.NORMAL}},ud={name:"line-height",initialValue:"normal",prefix:!1,type:4},hd=function(t,e){return Ou(t)&&"normal"===t.value?1.2*e:17===t.type?e*t.number:Ru(t)?Vu(t,e):e},dd={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return 20===e.type&&"none"===e.value?null:Fh(t,e)}},fd={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){return"inside"===e?0:1}},gd={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},pd=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},vd=pd("top"),md=pd("right"),yd=pd("bottom"),wd=pd("left"),Bd={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Ou).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},bd={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){return"break-word"===e?"break-word":"normal"}},Ed=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},xd=Ed("top"),Cd=Ed("right"),Fd=Ed("bottom"),Md=Ed("left"),kd={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},Qd={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},Sd={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&Nu(e[0],"none")?[]:Lu(e).map(function(e){for(var n={color:ah.TRANSPARENT,offsetX:_u,offsetY:_u,blur:_u},r=0,i=0;i<e.length;i++){var A=e[i];Pu(A)?(0===r?n.offsetX=A:1===r?n.offsetY=A:n.blur=A,r++):n.color=Ju(t,A)}return n})}},Ud={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Td={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(20===e.type&&"none"===e.value)return null;if(18===e.type){var n=Od[e.name];if(void 0===n)throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return n(e.values)}return null}},Od={matrix:function(t){var e=t.filter(function(t){return 17===t.type}).map(function(t){return t.number});return 6===e.length?e:null},matrix3d:function(t){var e=t.filter(function(t){return 17===t.type}).map(function(t){return t.number}),n=e[0],r=e[1];e[2],e[3];var i=e[4],A=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var o=e[12],s=e[13];return e[14],e[15],16===e.length?[n,r,i,A,o,s]:null}},Nd={type:16,number:50,flags:4},Id=[Nd,Nd],Ld={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){var n=e.filter(Ru);return 2!==n.length?Id:[n[0],n[1]]}},Dd={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;default:return 0}}};!function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"}(cd||(cd={}));for(var Pd={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"break-all":return cd.BREAK_ALL;case"keep-all":return cd.KEEP_ALL;default:return cd.NORMAL}}},Rd={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(20===e.type)return{auto:!0,order:0};if(Tu(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},Hd=function(t,e){if(15===e.type)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")},_d={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return Tu(e)?e.number:1}},Gd={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Kd={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Ou).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return 0!==t})}},jd={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var n=[],r=[];return e.forEach(function(t){switch(t.type){case 20:case 0:n.push(t.value);break;case 17:n.push(t.number.toString());break;case 4:r.push(n.join(" ")),n.length=0}}),n.length&&r.push(n.join(" ")),r.map(function(t){return-1===t.indexOf(" ")?t:"'"+t+"'"})}},Vd={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},zd={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){return Tu(e)?e.number:Ou(e)&&"bold"===e.value?700:400}},Wd={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Ou).map(function(t){return t.value})}},Yd={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},Xd=function(t,e){return 0!==(t&e)},qd={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Uu).map(function(e){return Hd(t,e)})}},Zd={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&Nu(e[0],"none")?[]:Lu(e).map(function(e){for(var n={color:255,offsetX:_u,offsetY:_u,blur:_u,spread:_u,inset:!1},r=0,i=0;i<e.length;i++){var A=e[i];Nu(A,"inset")?n.inset=!0:Pu(A)?(0===r?n.offsetX=A:1===r?n.offsetY=A:2===r?n.blur=A:n.spread=A,r++):n.color=Ju(t,A)}return n})}},Jd={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var n=[];return e.filter(Ou).forEach(function(t){switch(t.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2)}}),[0,1,2].forEach(function(t){-1===n.indexOf(t)&&n.push(t)}),n}},$d={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},tf={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Uu(e)?e.number:0}},ef=function(){function t(t,e){var n,r;this.animationDuration=nf(t,qd,e.animationDuration),this.backgroundClip=nf(t,ch,e.backgroundClip),this.backgroundColor=nf(t,lh,e.backgroundColor),this.backgroundImage=nf(t,Qh,e.backgroundImage),this.backgroundOrigin=nf(t,Sh,e.backgroundOrigin),this.backgroundPosition=nf(t,Uh,e.backgroundPosition),this.backgroundRepeat=nf(t,Th,e.backgroundRepeat),this.backgroundSize=nf(t,Ih,e.backgroundSize),this.borderTopColor=nf(t,Ph,e.borderTopColor),this.borderRightColor=nf(t,Rh,e.borderRightColor),this.borderBottomColor=nf(t,Hh,e.borderBottomColor),this.borderLeftColor=nf(t,_h,e.borderLeftColor),this.borderTopLeftRadius=nf(t,Kh,e.borderTopLeftRadius),this.borderTopRightRadius=nf(t,jh,e.borderTopRightRadius),this.borderBottomRightRadius=nf(t,Vh,e.borderBottomRightRadius),this.borderBottomLeftRadius=nf(t,zh,e.borderBottomLeftRadius),this.borderTopStyle=nf(t,Yh,e.borderTopStyle),this.borderRightStyle=nf(t,Xh,e.borderRightStyle),this.borderBottomStyle=nf(t,qh,e.borderBottomStyle),this.borderLeftStyle=nf(t,Zh,e.borderLeftStyle),this.borderTopWidth=nf(t,$h,e.borderTopWidth),this.borderRightWidth=nf(t,td,e.borderRightWidth),this.borderBottomWidth=nf(t,ed,e.borderBottomWidth),this.borderLeftWidth=nf(t,nd,e.borderLeftWidth),this.boxShadow=nf(t,Zd,e.boxShadow),this.color=nf(t,rd,e.color),this.direction=nf(t,id,e.direction),this.display=nf(t,Ad,e.display),this.float=nf(t,sd,e.cssFloat),this.fontFamily=nf(t,jd,e.fontFamily),this.fontSize=nf(t,Vd,e.fontSize),this.fontStyle=nf(t,Yd,e.fontStyle),this.fontVariant=nf(t,Wd,e.fontVariant),this.fontWeight=nf(t,zd,e.fontWeight),this.letterSpacing=nf(t,ad,e.letterSpacing),this.lineBreak=nf(t,ld,e.lineBreak),this.lineHeight=nf(t,ud,e.lineHeight),this.listStyleImage=nf(t,dd,e.listStyleImage),this.listStylePosition=nf(t,fd,e.listStylePosition),this.listStyleType=nf(t,gd,e.listStyleType),this.marginTop=nf(t,vd,e.marginTop),this.marginRight=nf(t,md,e.marginRight),this.marginBottom=nf(t,yd,e.marginBottom),this.marginLeft=nf(t,wd,e.marginLeft),this.opacity=nf(t,_d,e.opacity);var i=nf(t,Bd,e.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=nf(t,bd,e.overflowWrap),this.paddingTop=nf(t,xd,e.paddingTop),this.paddingRight=nf(t,Cd,e.paddingRight),this.paddingBottom=nf(t,Fd,e.paddingBottom),this.paddingLeft=nf(t,Md,e.paddingLeft),this.paintOrder=nf(t,Jd,e.paintOrder),this.position=nf(t,Qd,e.position),this.textAlign=nf(t,kd,e.textAlign),this.textDecorationColor=nf(t,Gd,null!==(n=e.textDecorationColor)&&void 0!==n?n:e.color),this.textDecorationLine=nf(t,Kd,null!==(r=e.textDecorationLine)&&void 0!==r?r:e.textDecoration),this.textShadow=nf(t,Sd,e.textShadow),this.textTransform=nf(t,Ud,e.textTransform),this.transform=nf(t,Td,e.transform),this.transformOrigin=nf(t,Ld,e.transformOrigin),this.visibility=nf(t,Dd,e.visibility),this.webkitTextStrokeColor=nf(t,$d,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=nf(t,tf,e.webkitTextStrokeWidth),this.wordBreak=nf(t,Pd,e.wordBreak),this.zIndex=nf(t,Rd,e.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&0===this.visibility},t.prototype.isTransparent=function(){return $u(this.backgroundColor)},t.prototype.isTransformed=function(){return null!==this.transform},t.prototype.isPositioned=function(){return 0!==this.position},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return 0!==this.float},t.prototype.isInlineLevel=function(){return Xd(this.display,4)||Xd(this.display,33554432)||Xd(this.display,268435456)||Xd(this.display,536870912)||Xd(this.display,67108864)||Xd(this.display,134217728)},t}(),nf=function(t,e,n){var r=new Qu,i=null!=n?n.toString():e.initialValue;r.write(i);var A=new Su(r.read());switch(e.type){case 2:var o=A.parseComponentValue();return e.parse(t,Ou(o)?o.value:e.initialValue);case 0:return e.parse(t,A.parseComponentValue());case 1:return e.parse(t,A.parseComponentValues());case 4:return A.parseComponentValue();case 3:switch(e.format){case"angle":return Yu(t,A.parseComponentValue());case"color":return Ju(t,A.parseComponentValue());case"image":return Fh(t,A.parseComponentValue());case"length":var s=A.parseComponentValue();return Pu(s)?s:_u;case"length-percentage":var a=A.parseComponentValue();return Ru(a)?a:_u;case"time":return Hd(t,A.parseComponentValue())}}},rf=function(t,e){var n=function(t){switch(t.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}(t);return 1===n||e===n},Af=function(t,e){this.context=t,this.textNodes=[],this.elements=[],this.flags=0,rf(e,3),this.styles=new ef(t,window.getComputedStyle(e,null)),cg(e)&&(this.styles.animationDuration.some(function(t){return t>0})&&(e.style.animationDuration="0s"),null!==this.styles.transform&&(e.style.transform="none")),this.bounds=Xc(this.context,e),rf(e,4)&&(this.flags|=16)},of="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sf="undefined"==typeof Uint8Array?[]:new Uint8Array(256),af=0;af<64;af++)sf[of.charCodeAt(af)]=af;for(var cf=function(t,e,n){return t.slice?t.slice(e,n):new Uint16Array(Array.prototype.slice.call(t,e,n))},lf=function(){function t(t,e,n,r,i,A){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=r,this.index=i,this.data=A}return t.prototype.get=function(t){var e;if(t>=0){if(t<55296||t>56319&&t<=65535)return e=((e=this.index[t>>5])<<2)+(31&t),this.data[e];if(t<=65535)return e=((e=this.index[2048+(t-55296>>5)])<<2)+(31&t),this.data[e];if(t<this.highStart)return e=2080+(t>>11),e=this.index[e],e+=t>>5&63,e=((e=this.index[e])<<2)+(31&t),this.data[e];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t}(),uf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hf="undefined"==typeof Uint8Array?[]:new Uint8Array(256),df=0;df<64;df++)hf[uf.charCodeAt(df)]=df;var ff,gf=8,pf=9,vf=11,mf=12,yf=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var n=t.length;if(!n)return"";for(var r=[],i=-1,A="";++i<n;){var o=t[i];o<=65535?r.push(o):(o-=65536,r.push(55296+(o>>10),o%1024+56320)),(i+1===n||r.length>16384)&&(A+=String.fromCharCode.apply(String,r),r.length=0)}return A},wf=function(t){var e,n,r,i=function(t){var e,n,r,i,A,o=.75*t.length,s=t.length,a=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var c="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?new ArrayBuffer(o):new Array(o),l=Array.isArray(c)?c:new Uint8Array(c);for(e=0;e<s;e+=4)n=sf[t.charCodeAt(e)],r=sf[t.charCodeAt(e+1)],i=sf[t.charCodeAt(e+2)],A=sf[t.charCodeAt(e+3)],l[a++]=n<<2|r>>4,l[a++]=(15&r)<<4|i>>2,l[a++]=(3&i)<<6|63&A;return c}(t),A=Array.isArray(i)?function(t){for(var e=t.length,n=[],r=0;r<e;r+=4)n.push(t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]);return n}(i):new Uint32Array(i),o=Array.isArray(i)?function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n.push(t[r+1]<<8|t[r]);return n}(i):new Uint16Array(i),s=cf(o,12,A[4]/2),a=2===A[5]?cf(o,(24+A[4])/2):(e=A,n=Math.ceil((24+A[4])/4),e.slice?e.slice(n,r):new Uint32Array(Array.prototype.slice.call(e,n,r)));return new lf(A[0],A[1],A[2],A[3],s,a)}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),Bf="",bf=function(t){return wf.get(t)},Ef=function(t,e,n){var r=n-2,i=e[r],A=e[n-1],o=e[n];if(2===A&&3===o)return Bf;if(2===A||3===A||4===A)return"";if(2===o||3===o||4===o)return"";if(A===gf&&-1!==[gf,pf,vf,mf].indexOf(o))return Bf;if(!(A!==vf&&A!==pf||o!==pf&&10!==o))return Bf;if((A===mf||10===A)&&10===o)return Bf;if(13===o||5===o)return Bf;if(7===o)return Bf;if(1===A)return Bf;if(13===A&&14===o){for(;5===i;)i=e[--r];if(14===i)return Bf}if(15===A&&15===o){for(var s=0;15===i;)s++,i=e[--r];if(s%2==0)return Bf}return""},xf=function(t){var e=function(t){for(var e=[],n=0,r=t.length;n<r;){var i=t.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){var A=t.charCodeAt(n++);56320==(64512&A)?e.push(((1023&i)<<10)+(1023&A)+65536):(e.push(i),n--)}else e.push(i)}return e}(t),n=e.length,r=0,i=0,A=e.map(bf);return{next:function(){if(r>=n)return{done:!0,value:null};for(var t=Bf;r<n&&(t=Ef(0,A,++r))===Bf;);if(t!==Bf||r===n){var o=yf.apply(null,e.slice(i,r));return i=r,{value:o,done:!1}}return{done:!0,value:null}}}},Cf=function(t){return 0===t[0]&&255===t[1]&&0===t[2]&&255===t[3]},Ff=function(t,e,n,r,i){var A="http://www.w3.org/2000/svg",o=document.createElementNS(A,"svg"),s=document.createElementNS(A,"foreignObject");return o.setAttributeNS(null,"width",t.toString()),o.setAttributeNS(null,"height",e.toString()),s.setAttributeNS(null,"width","100%"),s.setAttributeNS(null,"height","100%"),s.setAttributeNS(null,"x",n.toString()),s.setAttributeNS(null,"y",r.toString()),s.setAttributeNS(null,"externalResourcesRequired","true"),o.appendChild(s),s.appendChild(i),o},Mf=function(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){return e(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))})},kf={get SUPPORT_RANGE_BOUNDS(){var t=function(t){if(t.createRange){var e=t.createRange();if(e.getBoundingClientRect){var n=t.createElement("boundtest");n.style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n);var r=e.getBoundingClientRect(),i=Math.round(r.height);if(t.body.removeChild(n),123===i)return!0}}return!1}(document);return Object.defineProperty(kf,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=kf.SUPPORT_RANGE_BOUNDS&&function(t){var e=t.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",t.body.appendChild(e);var n=t.createRange();e.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"";var r=e.firstChild,i=qc(r.data).map(function(t){return Zc(t)}),A=0,o={},s=i.every(function(t,e){n.setStart(r,A),n.setEnd(r,A+t.length);var i=n.getBoundingClientRect();A+=t.length;var s=i.x>o.x||i.y>o.y;return o=i,0===e||s});return t.body.removeChild(e),s}(document);return Object.defineProperty(kf,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=function(t){var e=new Image,n=t.createElement("canvas"),r=n.getContext("2d");if(!r)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(e,0,0),n.toDataURL()}catch(t){return!1}return!0}(document);return Object.defineProperty(kf,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t="function"==typeof Array.from&&"function"==typeof window.fetch?function(t){var e=t.createElement("canvas"),n=100;e.width=n,e.height=n;var r=e.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,n,n);var i=new Image,A=e.toDataURL();i.src=A;var o=Ff(n,n,0,0,i);return r.fillStyle="red",r.fillRect(0,0,n,n),Mf(o).then(function(e){r.drawImage(e,0,0);var i=r.getImageData(0,0,n,n).data;r.fillStyle="red",r.fillRect(0,0,n,n);var o=t.createElement("div");return o.style.backgroundImage="url("+A+")",o.style.height=n+"px",Cf(i)?Mf(Ff(n,n,0,0,o)):Promise.reject(!1)}).then(function(t){return r.drawImage(t,0,0),Cf(r.getImageData(0,0,n,n).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(kf,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=void 0!==(new Image).crossOrigin;return Object.defineProperty(kf,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(kf,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(kf,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(kf,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Qf=function(t,e){this.text=t,this.bounds=e},Sf=function(t,e){var n=e.ownerDocument;if(n){var r=n.createElement("html2canvaswrapper");r.appendChild(e.cloneNode(!0));var i=e.parentNode;if(i){i.replaceChild(r,e);var A=Xc(t,r);return r.firstChild&&i.replaceChild(r.firstChild,r),A}}return Yc.EMPTY},Uf=function(t,e,n){var r=t.ownerDocument;if(!r)throw new Error("Node has no owner document");var i=r.createRange();return i.setStart(t,e),i.setEnd(t,e+n),i},Tf=function(t){if(kf.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(t)).map(function(t){return t.segment})}return function(t){for(var e,n=xf(t),r=[];!(e=n.next()).done;)e.value&&r.push(e.value.slice());return r}(t)},Of=function(t,e){return 0!==e.letterSpacing?Tf(t):function(t,e){if(kf.SUPPORT_NATIVE_TEXT_SEGMENTATION){var n=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(n.segment(t)).map(function(t){return t.segment})}return If(t,e)}(t,e)},Nf=[32,160,4961,65792,65793,4153,4241],If=function(t,e){for(var n,r=function(t,e){var n=qc(t),r=Wl(n,e),i=r[0],A=r[1],o=r[2],s=n.length,a=0,c=0;return{next:function(){if(c>=s)return{done:!0,value:null};for(var t=Nl;c<s&&(t=zl(n,A,i,++c,o))===Nl;);if(t!==Nl||c===s){var e=new Yl(n,t,a,c);return a=c,{value:e,done:!1}}return{done:!0,value:null}}}}(t,{lineBreak:e.lineBreak,wordBreak:"break-word"===e.overflowWrap?"break-word":e.wordBreak}),i=[],A=function(){if(n.value){var t=n.value.slice(),e=qc(t),r="";e.forEach(function(t){-1===Nf.indexOf(t)?r+=Zc(t):(r.length&&i.push(r),i.push(Zc(t)),r="")}),r.length&&i.push(r)}};!(n=r.next()).done;)A();return i},Lf=function(t,e,n){this.text=Df(e.data,n.textTransform),this.textBounds=function(t,e,n,r){var i=Of(e,n),A=[],o=0;return i.forEach(function(e){if(n.textDecorationLine.length||e.trim().length>0)if(kf.SUPPORT_RANGE_BOUNDS){var i=Uf(r,o,e.length).getClientRects();if(i.length>1){var s=Tf(e),a=0;s.forEach(function(e){A.push(new Qf(e,Yc.fromDOMRectList(t,Uf(r,a+o,e.length).getClientRects()))),a+=e.length})}else A.push(new Qf(e,Yc.fromDOMRectList(t,i)))}else{var c=r.splitText(e.length);A.push(new Qf(e,Sf(t,r))),r=c}else kf.SUPPORT_RANGE_BOUNDS||(r=r.splitText(e.length));o+=e.length}),A}(t,this.text,n,e)},Df=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(Pf,Rf);case 2:return t.toUpperCase();default:return t}},Pf=/(^|\s|:|-|\(|\))([a-z])/g,Rf=function(t,e,n){return t.length>0?e+n.toUpperCase():t},Hf=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.src=n.currentSrc||n.src,r.intrinsicWidth=n.naturalWidth,r.intrinsicHeight=n.naturalHeight,r.context.cache.addImage(r.src),r}return Vc(e,t),e}(Af),_f=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.canvas=n,r.intrinsicWidth=n.width,r.intrinsicHeight=n.height,r}return Vc(e,t),e}(Af),Gf=function(t){function e(e,n){var r=t.call(this,e,n)||this,i=new XMLSerializer,A=Xc(e,n);return n.setAttribute("width",A.width+"px"),n.setAttribute("height",A.height+"px"),r.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(n)),r.intrinsicWidth=n.width.baseVal.value,r.intrinsicHeight=n.height.baseVal.value,r.context.cache.addImage(r.svg),r}return Vc(e,t),e}(Af),Kf=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.value=n.value,r}return Vc(e,t),e}(Af),jf=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.start=n.start,r.reversed="boolean"==typeof n.reversed&&!0===n.reversed,r}return Vc(e,t),e}(Af),Vf=[{type:15,flags:0,unit:"px",number:3}],zf=[{type:16,flags:0,number:50}],Wf="checkbox",Yf="radio",Xf="password",qf=707406591,Zf=function(t){function e(e,n){var r,i,A,o=t.call(this,e,n)||this;switch(o.type=n.type.toLowerCase(),o.checked=n.checked,o.value=0===(i=(r=n).type===Xf?new Array(r.value.length+1).join(""):r.value).length?r.placeholder||"":i,o.type!==Wf&&o.type!==Yf||(o.styles.backgroundColor=3739148031,o.styles.borderTopColor=o.styles.borderRightColor=o.styles.borderBottomColor=o.styles.borderLeftColor=2779096575,o.styles.borderTopWidth=o.styles.borderRightWidth=o.styles.borderBottomWidth=o.styles.borderLeftWidth=1,o.styles.borderTopStyle=o.styles.borderRightStyle=o.styles.borderBottomStyle=o.styles.borderLeftStyle=1,o.styles.backgroundClip=[0],o.styles.backgroundOrigin=[0],o.bounds=(A=o.bounds).width>A.height?new Yc(A.left+(A.width-A.height)/2,A.top,A.height,A.height):A.width<A.height?new Yc(A.left,A.top+(A.height-A.width)/2,A.width,A.width):A),o.type){case Wf:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=Vf;break;case Yf:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=zf}return o}return Vc(e,t),e}(Af),Jf=function(t){function e(e,n){var r=t.call(this,e,n)||this,i=n.options[n.selectedIndex||0];return r.value=i&&i.text||"",r}return Vc(e,t),e}(Af),$f=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.value=n.value,r}return Vc(e,t),e}(Af),tg=function(t){function e(e,n){var r=t.call(this,e,n)||this;r.src=n.src,r.width=parseInt(n.width,10)||0,r.height=parseInt(n.height,10)||0,r.backgroundColor=r.styles.backgroundColor;try{if(n.contentWindow&&n.contentWindow.document&&n.contentWindow.document.documentElement){r.tree=ig(e,n.contentWindow.document.documentElement);var i=n.contentWindow.document.documentElement?sh(e,getComputedStyle(n.contentWindow.document.documentElement).backgroundColor):ah.TRANSPARENT,A=n.contentWindow.document.body?sh(e,getComputedStyle(n.contentWindow.document.body).backgroundColor):ah.TRANSPARENT;r.backgroundColor=$u(i)?$u(A)?r.styles.backgroundColor:A:i}}catch(t){}return r}return Vc(e,t),e}(Af),eg=["OL","UL","MENU"],ng=function(t,e,n,r){for(var i=e.firstChild,A=void 0;i;i=A)if(A=i.nextSibling,sg(i)&&i.data.trim().length>0)n.textNodes.push(new Lf(t,i,n.styles));else if(ag(i))if(Bg(i)&&i.assignedNodes)i.assignedNodes().forEach(function(e){return ng(t,e,n,r)});else{var o=rg(t,i);o.styles.isVisible()&&(Ag(i,o,r)?o.flags|=4:og(o.styles)&&(o.flags|=2),-1!==eg.indexOf(i.tagName)&&(o.flags|=8),n.elements.push(o),i.slot,i.shadowRoot?ng(t,i.shadowRoot,o,r):yg(i)||fg(i)||wg(i)||ng(t,i,o,r))}},rg=function(t,e){return vg(e)?new Hf(t,e):pg(e)?new _f(t,e):fg(e)?new Gf(t,e):ug(e)?new Kf(t,e):hg(e)?new jf(t,e):dg(e)?new Zf(t,e):wg(e)?new Jf(t,e):yg(e)?new $f(t,e):mg(e)?new tg(t,e):new Af(t,e)},ig=function(t,e){var n=rg(t,e);return n.flags|=4,ng(t,e,n,n),n},Ag=function(t,e,n){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||gg(t)&&n.styles.isTransparent()},og=function(t){return t.isPositioned()||t.isFloating()},sg=function(t){return t.nodeType===Node.TEXT_NODE},ag=function(t){return t.nodeType===Node.ELEMENT_NODE},cg=function(t){return ag(t)&&void 0!==t.style&&!lg(t)},lg=function(t){return"object"==typeof t.className},ug=function(t){return"LI"===t.tagName},hg=function(t){return"OL"===t.tagName},dg=function(t){return"INPUT"===t.tagName},fg=function(t){return"svg"===t.tagName},gg=function(t){return"BODY"===t.tagName},pg=function(t){return"CANVAS"===t.tagName},vg=function(t){return"IMG"===t.tagName},mg=function(t){return"IFRAME"===t.tagName},yg=function(t){return"TEXTAREA"===t.tagName},wg=function(t){return"SELECT"===t.tagName},Bg=function(t){return"SLOT"===t.tagName},bg={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Eg={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},xg={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Cg={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Fg=function(t,e,n,r,i,A){return t<e||t>n?Ig(t,i,A.length>0):r.integers.reduce(function(e,n,i){for(;t>=n;)t-=n,e+=r.values[i];return e},"")+A},Mg=function(t,e,n,r){var i="";do{n||t--,i=r(t)+i,t/=e}while(t*e>=e);return i},kg=function(t,e,n,r,i){var A=n-e+1;return(t<0?"-":"")+(Mg(Math.abs(t),A,r,function(t){return Zc(Math.floor(t%A)+e)})+i)},Qg=function(t,e,n){void 0===n&&(n=". ");var r=e.length;return Mg(Math.abs(t),r,!1,function(t){return e[Math.floor(t%r)]})+n},Sg=function(t,e,n,r,i,A){if(t<-9999||t>9999)return Ig(t,4,i.length>0);var o=Math.abs(t),s=i;if(0===o)return e[0]+s;for(var a=0;o>0&&a<=4;a++){var c=o%10;0===c&&Xd(A,1)&&""!==s?s=e[c]+s:c>1||1===c&&0===a||1===c&&1===a&&Xd(A,2)||1===c&&1===a&&Xd(A,4)&&t>100||1===c&&a>1&&Xd(A,8)?s=e[c]+(a>0?n[a-1]:"")+s:1===c&&a>0&&(s=n[a-1]+s),o=Math.floor(o/10)}return(t<0?r:"")+s},Ug="",Tg="",Og="",Ng="",Ig=function(t,e,n){var r=n?". ":"",i=n?"":"",A=n?", ":"",o=n?" ":"";switch(e){case 0:return""+o;case 1:return""+o;case 2:return""+o;case 5:var s=kg(t,48,57,!0,r);return s.length<4?"0"+s:s;case 4:return Qg(t,"",i);case 6:return Fg(t,1,3999,bg,3,r).toLowerCase();case 7:return Fg(t,1,3999,bg,3,r);case 8:return kg(t,945,969,!1,r);case 9:return kg(t,97,122,!1,r);case 10:return kg(t,65,90,!1,r);case 11:return kg(t,1632,1641,!0,r);case 12:case 49:return Fg(t,1,9999,Eg,3,r);case 35:return Fg(t,1,9999,Eg,3,r).toLowerCase();case 13:return kg(t,2534,2543,!0,r);case 14:case 30:return kg(t,6112,6121,!0,r);case 15:return Qg(t,"",i);case 16:return Qg(t,"",i);case 17:case 48:return Sg(t,"",Ug,"",i,14);case 47:return Sg(t,"",Tg,"",i,15);case 42:return Sg(t,"",Ug,"",i,14);case 41:return Sg(t,"",Tg,"",i,15);case 26:return Sg(t,"","",Og,i,0);case 25:return Sg(t,"","",Og,i,7);case 31:return Sg(t,"","",Ng,A,7);case 33:return Sg(t,"","",Ng,A,0);case 32:return Sg(t,"","",Ng,A,7);case 18:return kg(t,2406,2415,!0,r);case 20:return Fg(t,1,19999,Cg,3,r);case 21:return kg(t,2790,2799,!0,r);case 22:return kg(t,2662,2671,!0,r);case 22:return Fg(t,1,10999,xg,3,r);case 23:return Qg(t,"");case 24:return Qg(t,"");case 27:return kg(t,3302,3311,!0,r);case 28:return Qg(t,"",i);case 29:return Qg(t,"",i);case 34:return kg(t,3792,3801,!0,r);case 37:return kg(t,6160,6169,!0,r);case 38:return kg(t,4160,4169,!0,r);case 39:return kg(t,2918,2927,!0,r);case 40:return kg(t,1776,1785,!0,r);case 43:return kg(t,3046,3055,!0,r);case 44:return kg(t,3174,3183,!0,r);case 45:return kg(t,3664,3673,!0,r);case 46:return kg(t,3872,3881,!0,r);default:return kg(t,48,57,!0,r)}};!function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"}(ff||(ff={}));var Lg,Dg=function(){function t(){}return t.getOrigin=function(e){var n=t._link;return n?(n.href=e,n.href=n.href,n.protocol+n.hostname+n.port):"about:blank"},t.isSameOrigin=function(e){return t.getOrigin(e)===t._origin},t.setContext=function(e){t._link=e.document.createElement("a"),t._origin=t.getOrigin(e.location.href)},t._origin="about:blank",t}(),Pg=function(){function t(t,e){this.type=0,this.x=t,this.y=e}return t.prototype.add=function(e,n){return new t(this.x+e,this.y+n)},t}(),Rg=function(t,e,n){return new Pg(t.x+(e.x-t.x)*n,t.y+(e.y-t.y)*n)},Hg=function(){function t(t,e,n,r){this.type=1,this.start=t,this.startControl=e,this.endControl=n,this.end=r}return t.prototype.subdivide=function(e,n){var r=Rg(this.start,this.startControl,e),i=Rg(this.startControl,this.endControl,e),A=Rg(this.endControl,this.end,e),o=Rg(r,i,e),s=Rg(i,A,e),a=Rg(o,s,e);return n?new t(this.start,r,o,a):new t(a,s,A,this.end)},t.prototype.add=function(e,n){return new t(this.start.add(e,n),this.startControl.add(e,n),this.endControl.add(e,n),this.end.add(e,n))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t}(),_g=function(t){return 1===t.type},Gg=function(t){var e=t.styles,n=t.bounds,r=ju(e.borderTopLeftRadius,n.width,n.height),i=r[0],A=r[1],o=ju(e.borderTopRightRadius,n.width,n.height),s=o[0],a=o[1],c=ju(e.borderBottomRightRadius,n.width,n.height),l=c[0],u=c[1],h=ju(e.borderBottomLeftRadius,n.width,n.height),d=h[0],f=h[1],g=[];g.push((i+s)/n.width),g.push((d+l)/n.width),g.push((A+f)/n.height),g.push((a+u)/n.height);var p=Math.max.apply(Math,g);p>1&&(i/=p,A/=p,s/=p,a/=p,l/=p,u/=p,d/=p,f/=p);var v=n.width-s,m=n.height-u,y=n.width-l,w=n.height-f,B=e.borderTopWidth,b=e.borderRightWidth,E=e.borderBottomWidth,x=e.borderLeftWidth,C=Vu(e.paddingTop,t.bounds.width),F=Vu(e.paddingRight,t.bounds.width),M=Vu(e.paddingBottom,t.bounds.width),k=Vu(e.paddingLeft,t.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||A>0?Kg(n.left+x/3,n.top+B/3,i-x/3,A-B/3,Lg.TOP_LEFT):new Pg(n.left+x/3,n.top+B/3),this.topRightBorderDoubleOuterBox=i>0||A>0?Kg(n.left+v,n.top+B/3,s-b/3,a-B/3,Lg.TOP_RIGHT):new Pg(n.left+n.width-b/3,n.top+B/3),this.bottomRightBorderDoubleOuterBox=l>0||u>0?Kg(n.left+y,n.top+m,l-b/3,u-E/3,Lg.BOTTOM_RIGHT):new Pg(n.left+n.width-b/3,n.top+n.height-E/3),this.bottomLeftBorderDoubleOuterBox=d>0||f>0?Kg(n.left+x/3,n.top+w,d-x/3,f-E/3,Lg.BOTTOM_LEFT):new Pg(n.left+x/3,n.top+n.height-E/3),this.topLeftBorderDoubleInnerBox=i>0||A>0?Kg(n.left+2*x/3,n.top+2*B/3,i-2*x/3,A-2*B/3,Lg.TOP_LEFT):new Pg(n.left+2*x/3,n.top+2*B/3),this.topRightBorderDoubleInnerBox=i>0||A>0?Kg(n.left+v,n.top+2*B/3,s-2*b/3,a-2*B/3,Lg.TOP_RIGHT):new Pg(n.left+n.width-2*b/3,n.top+2*B/3),this.bottomRightBorderDoubleInnerBox=l>0||u>0?Kg(n.left+y,n.top+m,l-2*b/3,u-2*E/3,Lg.BOTTOM_RIGHT):new Pg(n.left+n.width-2*b/3,n.top+n.height-2*E/3),this.bottomLeftBorderDoubleInnerBox=d>0||f>0?Kg(n.left+2*x/3,n.top+w,d-2*x/3,f-2*E/3,Lg.BOTTOM_LEFT):new Pg(n.left+2*x/3,n.top+n.height-2*E/3),this.topLeftBorderStroke=i>0||A>0?Kg(n.left+x/2,n.top+B/2,i-x/2,A-B/2,Lg.TOP_LEFT):new Pg(n.left+x/2,n.top+B/2),this.topRightBorderStroke=i>0||A>0?Kg(n.left+v,n.top+B/2,s-b/2,a-B/2,Lg.TOP_RIGHT):new Pg(n.left+n.width-b/2,n.top+B/2),this.bottomRightBorderStroke=l>0||u>0?Kg(n.left+y,n.top+m,l-b/2,u-E/2,Lg.BOTTOM_RIGHT):new Pg(n.left+n.width-b/2,n.top+n.height-E/2),this.bottomLeftBorderStroke=d>0||f>0?Kg(n.left+x/2,n.top+w,d-x/2,f-E/2,Lg.BOTTOM_LEFT):new Pg(n.left+x/2,n.top+n.height-E/2),this.topLeftBorderBox=i>0||A>0?Kg(n.left,n.top,i,A,Lg.TOP_LEFT):new Pg(n.left,n.top),this.topRightBorderBox=s>0||a>0?Kg(n.left+v,n.top,s,a,Lg.TOP_RIGHT):new Pg(n.left+n.width,n.top),this.bottomRightBorderBox=l>0||u>0?Kg(n.left+y,n.top+m,l,u,Lg.BOTTOM_RIGHT):new Pg(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=d>0||f>0?Kg(n.left,n.top+w,d,f,Lg.BOTTOM_LEFT):new Pg(n.left,n.top+n.height),this.topLeftPaddingBox=i>0||A>0?Kg(n.left+x,n.top+B,Math.max(0,i-x),Math.max(0,A-B),Lg.TOP_LEFT):new Pg(n.left+x,n.top+B),this.topRightPaddingBox=s>0||a>0?Kg(n.left+Math.min(v,n.width-b),n.top+B,v>n.width+b?0:Math.max(0,s-b),Math.max(0,a-B),Lg.TOP_RIGHT):new Pg(n.left+n.width-b,n.top+B),this.bottomRightPaddingBox=l>0||u>0?Kg(n.left+Math.min(y,n.width-x),n.top+Math.min(m,n.height-E),Math.max(0,l-b),Math.max(0,u-E),Lg.BOTTOM_RIGHT):new Pg(n.left+n.width-b,n.top+n.height-E),this.bottomLeftPaddingBox=d>0||f>0?Kg(n.left+x,n.top+Math.min(w,n.height-E),Math.max(0,d-x),Math.max(0,f-E),Lg.BOTTOM_LEFT):new Pg(n.left+x,n.top+n.height-E),this.topLeftContentBox=i>0||A>0?Kg(n.left+x+k,n.top+B+C,Math.max(0,i-(x+k)),Math.max(0,A-(B+C)),Lg.TOP_LEFT):new Pg(n.left+x+k,n.top+B+C),this.topRightContentBox=s>0||a>0?Kg(n.left+Math.min(v,n.width+x+k),n.top+B+C,v>n.width+x+k?0:s-x+k,a-(B+C),Lg.TOP_RIGHT):new Pg(n.left+n.width-(b+F),n.top+B+C),this.bottomRightContentBox=l>0||u>0?Kg(n.left+Math.min(y,n.width-(x+k)),n.top+Math.min(m,n.height+B+C),Math.max(0,l-(b+F)),u-(E+M),Lg.BOTTOM_RIGHT):new Pg(n.left+n.width-(b+F),n.top+n.height-(E+M)),this.bottomLeftContentBox=d>0||f>0?Kg(n.left+x+k,n.top+w,Math.max(0,d-(x+k)),f-(E+M),Lg.BOTTOM_LEFT):new Pg(n.left+x+k,n.top+n.height-(E+M))};!function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"}(Lg||(Lg={}));var Kg=function(t,e,n,r,i){var A=(Math.sqrt(2)-1)/3*4,o=n*A,s=r*A,a=t+n,c=e+r;switch(i){case Lg.TOP_LEFT:return new Hg(new Pg(t,c),new Pg(t,c-s),new Pg(a-o,e),new Pg(a,e));case Lg.TOP_RIGHT:return new Hg(new Pg(t,e),new Pg(t+o,e),new Pg(a,c-s),new Pg(a,c));case Lg.BOTTOM_RIGHT:return new Hg(new Pg(a,e),new Pg(a,e+s),new Pg(t+o,c),new Pg(t,c));case Lg.BOTTOM_LEFT:default:return new Hg(new Pg(a,c),new Pg(a-o,c),new Pg(t,e+s),new Pg(t,e))}},jg=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},Vg=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},zg=function(t,e,n){this.offsetX=t,this.offsetY=e,this.matrix=n,this.type=0,this.target=6},Wg=function(t,e){this.path=t,this.target=e,this.type=1},Yg=function(t){this.opacity=t,this.type=2,this.target=6},Xg=function(t){return 1===t.type},qg=function(t,e){return t.length===e.length&&t.some(function(t,n){return t===e[n]})},Zg=function(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]},Jg=function(){function t(t,e){if(this.container=t,this.parent=e,this.effects=[],this.curves=new Gg(this.container),this.container.styles.opacity<1&&this.effects.push(new Yg(this.container.styles.opacity)),null!==this.container.styles.transform){var n=this.container.bounds.left+this.container.styles.transformOrigin[0].number,r=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new zg(n,r,i))}if(0!==this.container.styles.overflowX){var A=jg(this.curves),o=Vg(this.curves);qg(A,o)?this.effects.push(new Wg(A,6)):(this.effects.push(new Wg(A,2)),this.effects.push(new Wg(o,4)))}}return t.prototype.getEffects=function(t){for(var e=-1===[2,3].indexOf(this.container.styles.position),n=this.parent,r=this.effects.slice(0);n;){var i=n.effects.filter(function(t){return!Xg(t)});if(e||0!==n.container.styles.position||!n.parent){if(r.unshift.apply(r,i),e=-1===[2,3].indexOf(n.container.styles.position),0!==n.container.styles.overflowX){var A=jg(n.curves),o=Vg(n.curves);qg(A,o)||r.unshift(new Wg(o,6))}}else r.unshift.apply(r,i);n=n.parent}return r.filter(function(e){return Xd(e.target,t)})},t}(),$g=function(t,e,n,r){t.container.elements.forEach(function(i){var A=Xd(i.flags,4),o=Xd(i.flags,2),s=new Jg(i,t);Xd(i.styles.display,2048)&&r.push(s);var a=Xd(i.flags,8)?[]:r;if(A||o){var c=A||i.styles.isPositioned()?n:e,l=new Zg(s);if(i.styles.isPositioned()||i.styles.opacity<1||i.styles.isTransformed()){var u=i.styles.zIndex.order;if(u<0){var h=0;c.negativeZIndex.some(function(t,e){return u>t.element.container.styles.zIndex.order?(h=e,!1):h>0}),c.negativeZIndex.splice(h,0,l)}else if(u>0){var d=0;c.positiveZIndex.some(function(t,e){return u>=t.element.container.styles.zIndex.order?(d=e+1,!1):d>0}),c.positiveZIndex.splice(d,0,l)}else c.zeroOrAutoZIndexOrTransformedOrOpacity.push(l)}else i.styles.isFloating()?c.nonPositionedFloats.push(l):c.nonPositionedInlineLevel.push(l);$g(s,l,A?l:n,a)}else i.styles.isInlineLevel()?e.inlineLevel.push(s):e.nonInlineLevel.push(s),$g(s,e,n,a);Xd(i.flags,8)&&tp(i,a)})},tp=function(t,e){for(var n=t instanceof jf?t.start:1,r=t instanceof jf&&t.reversed,i=0;i<e.length;i++){var A=e[i];A.container instanceof Kf&&"number"==typeof A.container.value&&0!==A.container.value&&(n=A.container.value),A.listValue=Ig(n,A.container.styles.listStyleType,!0),n+=r?-1:1}},ep=function(t,e){switch(e){case 0:return rp(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return rp(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return rp(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);default:return rp(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},np=function(t,e){var n=[];return _g(t)?n.push(t.subdivide(.5,!1)):n.push(t),_g(e)?n.push(e.subdivide(.5,!0)):n.push(e),n},rp=function(t,e,n,r){var i=[];return _g(t)?i.push(t.subdivide(.5,!1)):i.push(t),_g(n)?i.push(n.subdivide(.5,!0)):i.push(n),_g(r)?i.push(r.subdivide(.5,!0).reverse()):i.push(r),_g(e)?i.push(e.subdivide(.5,!1).reverse()):i.push(e),i},ip=function(t){var e=t.bounds,n=t.styles;return e.add(n.borderLeftWidth,n.borderTopWidth,-(n.borderRightWidth+n.borderLeftWidth),-(n.borderTopWidth+n.borderBottomWidth))},Ap=function(t){var e=t.styles,n=t.bounds,r=Vu(e.paddingLeft,n.width),i=Vu(e.paddingRight,n.width),A=Vu(e.paddingTop,n.width),o=Vu(e.paddingBottom,n.width);return n.add(r+e.borderLeftWidth,A+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+r+i),-(e.borderTopWidth+e.borderBottomWidth+A+o))},op=function(t,e,n){var r=function(t,e){return 0===t?e.bounds:2===t?Ap(e):ip(e)}(lp(t.styles.backgroundOrigin,e),t),i=function(t,e){return 0===t?e.bounds:2===t?Ap(e):ip(e)}(lp(t.styles.backgroundClip,e),t),A=cp(lp(t.styles.backgroundSize,e),n,r),o=A[0],s=A[1],a=ju(lp(t.styles.backgroundPosition,e),r.width-o,r.height-s);return[up(lp(t.styles.backgroundRepeat,e),a,A,r,i),Math.round(r.left+a[0]),Math.round(r.top+a[1]),o,s]},sp=function(t){return Ou(t)&&t.value===Mh.AUTO},ap=function(t){return"number"==typeof t},cp=function(t,e,n){var r=e[0],i=e[1],A=e[2],o=t[0],s=t[1];if(!o)return[0,0];if(Ru(o)&&s&&Ru(s))return[Vu(o,n.width),Vu(s,n.height)];var a=ap(A);if(Ou(o)&&(o.value===Mh.CONTAIN||o.value===Mh.COVER))return ap(A)?n.width/n.height<A!=(o.value===Mh.COVER)?[n.width,n.width/A]:[n.height*A,n.height]:[n.width,n.height];var c=ap(r),l=ap(i),u=c||l;if(sp(o)&&(!s||sp(s)))return c&&l?[r,i]:a||u?u&&a?[c?r:i*A,l?i:r/A]:[c?r:n.width,l?i:n.height]:[n.width,n.height];if(a){var h=0,d=0;return Ru(o)?h=Vu(o,n.width):Ru(s)&&(d=Vu(s,n.height)),sp(o)?h=d*A:s&&!sp(s)||(d=h/A),[h,d]}var f=null,g=null;if(Ru(o)?f=Vu(o,n.width):s&&Ru(s)&&(g=Vu(s,n.height)),null===f||s&&!sp(s)||(g=c&&l?f/r*i:n.height),null!==g&&sp(o)&&(f=c&&l?g/i*r:n.width),null!==f&&null!==g)return[f,g];throw new Error("Unable to calculate background-size for element")},lp=function(t,e){var n=t[e];return void 0===n?t[0]:n},up=function(t,e,n,r,i){var A=e[0],o=e[1],s=n[0],a=n[1];switch(t){case 2:return[new Pg(Math.round(r.left),Math.round(r.top+o)),new Pg(Math.round(r.left+r.width),Math.round(r.top+o)),new Pg(Math.round(r.left+r.width),Math.round(a+r.top+o)),new Pg(Math.round(r.left),Math.round(a+r.top+o))];case 3:return[new Pg(Math.round(r.left+A),Math.round(r.top)),new Pg(Math.round(r.left+A+s),Math.round(r.top)),new Pg(Math.round(r.left+A+s),Math.round(r.height+r.top)),new Pg(Math.round(r.left+A),Math.round(r.height+r.top))];case 1:return[new Pg(Math.round(r.left+A),Math.round(r.top+o)),new Pg(Math.round(r.left+A+s),Math.round(r.top+o)),new Pg(Math.round(r.left+A+s),Math.round(r.top+o+a)),new Pg(Math.round(r.left+A),Math.round(r.top+o+a))];default:return[new Pg(Math.round(i.left),Math.round(i.top)),new Pg(Math.round(i.left+i.width),Math.round(i.top)),new Pg(Math.round(i.left+i.width),Math.round(i.height+i.top)),new Pg(Math.round(i.left),Math.round(i.height+i.top))]}},hp="Hidden Text",dp=function(){function t(t){this._data={},this._document=t}return t.prototype.parseMetrics=function(t,e){var n=this._document.createElement("div"),r=this._document.createElement("img"),i=this._document.createElement("span"),A=this._document.body;n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=e,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",A.appendChild(n),r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",r.width=1,r.height=1,r.style.margin="0",r.style.padding="0",r.style.verticalAlign="baseline",i.style.fontFamily=t,i.style.fontSize=e,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(hp)),n.appendChild(i),n.appendChild(r);var o=r.offsetTop-i.offsetTop+2;n.removeChild(i),n.appendChild(this._document.createTextNode(hp)),n.style.lineHeight="normal",r.style.verticalAlign="super";var s=r.offsetTop-n.offsetTop+2;return A.removeChild(n),{baseline:o,middle:s}},t.prototype.getMetrics=function(t,e){var n=t+" "+e;return void 0===this._data[n]&&(this._data[n]=this.parseMetrics(t,e)),this._data[n]},t}(),fp=function(t,e){this.context=t,this.options=e};!function(t){function e(e,n){var r=t.call(this,e,n)||this;return r._activeEffects=[],r.canvas=n.canvas?n.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),n.canvas||(r.canvas.width=Math.floor(n.width*n.scale),r.canvas.height=Math.floor(n.height*n.scale),r.canvas.style.width=n.width+"px",r.canvas.style.height=n.height+"px"),r.fontMetrics=new dp(document),r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-n.x,-n.y),r.ctx.textBaseline="bottom",r._activeEffects=[],r.context.logger.debug("Canvas renderer initialized ("+n.width+"x"+n.height+") with scale "+n.scale),r}Vc(e,t),e.prototype.applyEffects=function(t){for(var e=this;this._activeEffects.length;)this.popEffect();t.forEach(function(t){return e.applyEffect(t)})},e.prototype.applyEffect=function(t){this.ctx.save(),function(t){return 2===t.type}(t)&&(this.ctx.globalAlpha=t.opacity),function(t){return 0===t.type}(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),Xg(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return zc(this,0,void 0,function(){return Wc(this,function(e){switch(e.label){case 0:return t.element.container.styles.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(t){return zc(this,0,void 0,function(){return Wc(this,function(e){switch(e.label){case 0:return Xd(t.container.flags,16),t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return e.sent(),[4,this.renderNodeContent(t)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(t,e,n){var r=this;0===e?this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+n):Tf(t.text).reduce(function(e,i){return r.ctx.fillText(i,e,t.bounds.top+n),e+r.ctx.measureText(i).width},t.bounds.left)},e.prototype.createFontStyle=function(t){var e=t.fontVariant.filter(function(t){return"normal"===t||"small-caps"===t}).join(""),n=yp(t.fontFamily).join(", "),r=Uu(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,e,t.fontWeight,r,n].join(" "),n,r]},e.prototype.renderTextNode=function(t,e){return zc(this,0,void 0,function(){var n,r,i,A,o,s,a,c,l=this;return Wc(this,function(u){return n=this.createFontStyle(e),r=n[0],i=n[1],A=n[2],this.ctx.font=r,this.ctx.direction=1===e.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",o=this.fontMetrics.getMetrics(i,A),s=o.baseline,a=o.middle,c=e.paintOrder,t.textBounds.forEach(function(t){c.forEach(function(n){switch(n){case 0:l.ctx.fillStyle=th(e.color),l.renderTextWithLetterSpacing(t,e.letterSpacing,s);var r=e.textShadow;r.length&&t.text.trim().length&&(r.slice(0).reverse().forEach(function(n){l.ctx.shadowColor=th(n.color),l.ctx.shadowOffsetX=n.offsetX.number*l.options.scale,l.ctx.shadowOffsetY=n.offsetY.number*l.options.scale,l.ctx.shadowBlur=n.blur.number,l.renderTextWithLetterSpacing(t,e.letterSpacing,s)}),l.ctx.shadowColor="",l.ctx.shadowOffsetX=0,l.ctx.shadowOffsetY=0,l.ctx.shadowBlur=0),e.textDecorationLine.length&&(l.ctx.fillStyle=th(e.textDecorationColor||e.color),e.textDecorationLine.forEach(function(e){switch(e){case 1:l.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top+s),t.bounds.width,1);break;case 2:l.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top),t.bounds.width,1);break;case 3:l.ctx.fillRect(t.bounds.left,Math.ceil(t.bounds.top+a),t.bounds.width,1)}}));break;case 1:e.webkitTextStrokeWidth&&t.text.trim().length&&(l.ctx.strokeStyle=th(e.webkitTextStrokeColor),l.ctx.lineWidth=e.webkitTextStrokeWidth,l.ctx.lineJoin=window.chrome?"miter":"round",l.ctx.strokeText(t.text,t.bounds.left,t.bounds.top+s)),l.ctx.strokeStyle="",l.ctx.lineWidth=0,l.ctx.lineJoin="miter"}})}),[2]})})},e.prototype.renderReplacedElement=function(t,e,n){if(n&&t.intrinsicWidth>0&&t.intrinsicHeight>0){var r=Ap(t),i=Vg(e);this.path(i),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,t.intrinsicWidth,t.intrinsicHeight,r.left,r.top,r.width,r.height),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return zc(this,0,void 0,function(){var n,r,i,A,o,s,a,c,l,u,h,d,f,g,p,v,m,y;return Wc(this,function(w){switch(w.label){case 0:this.applyEffects(t.getEffects(4)),n=t.container,r=t.curves,i=n.styles,A=0,o=n.textNodes,w.label=1;case 1:return A<o.length?(s=o[A],[4,this.renderTextNode(s,i)]):[3,4];case 2:w.sent(),w.label=3;case 3:return A++,[3,1];case 4:if(!(n instanceof Hf))return[3,8];w.label=5;case 5:return w.trys.push([5,7,,8]),[4,this.context.cache.match(n.src)];case 6:return p=w.sent(),this.renderReplacedElement(n,r,p),[3,8];case 7:return w.sent(),this.context.logger.error("Error loading image "+n.src),[3,8];case 8:if(n instanceof _f&&this.renderReplacedElement(n,r,n.canvas),!(n instanceof Gf))return[3,12];w.label=9;case 9:return w.trys.push([9,11,,12]),[4,this.context.cache.match(n.svg)];case 10:return p=w.sent(),this.renderReplacedElement(n,r,p),[3,12];case 11:return w.sent(),this.context.logger.error("Error loading svg "+n.svg.substring(0,255)),[3,12];case 12:return n instanceof tg&&n.tree?[4,new e(this.context,{scale:this.options.scale,backgroundColor:n.backgroundColor,x:0,y:0,width:n.width,height:n.height}).render(n.tree)]:[3,14];case 13:a=w.sent(),n.width&&n.height&&this.ctx.drawImage(a,0,0,n.width,n.height,n.bounds.left,n.bounds.top,n.bounds.width,n.bounds.height),w.label=14;case 14:if(n instanceof Zf&&(c=Math.min(n.bounds.width,n.bounds.height),n.type===Wf?n.checked&&(this.ctx.save(),this.path([new Pg(n.bounds.left+.39363*c,n.bounds.top+.79*c),new Pg(n.bounds.left+.16*c,n.bounds.top+.5549*c),new Pg(n.bounds.left+.27347*c,n.bounds.top+.44071*c),new Pg(n.bounds.left+.39694*c,n.bounds.top+.5649*c),new Pg(n.bounds.left+.72983*c,n.bounds.top+.23*c),new Pg(n.bounds.left+.84*c,n.bounds.top+.34085*c),new Pg(n.bounds.left+.39363*c,n.bounds.top+.79*c)]),this.ctx.fillStyle=th(qf),this.ctx.fill(),this.ctx.restore()):n.type===Yf&&n.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(n.bounds.left+c/2,n.bounds.top+c/2,c/4,0,2*Math.PI,!0),this.ctx.fillStyle=th(qf),this.ctx.fill(),this.ctx.restore())),gp(n)&&n.value.length){switch(l=this.createFontStyle(i),m=l[0],u=l[1],h=this.fontMetrics.getMetrics(m,u).baseline,this.ctx.font=m,this.ctx.fillStyle=th(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=vp(n.styles.textAlign),y=Ap(n),d=0,n.styles.textAlign){case 1:d+=y.width/2;break;case 2:d+=y.width}f=y.add(d,0,0,-y.height/2+1),this.ctx.save(),this.path([new Pg(y.left,y.top),new Pg(y.left+y.width,y.top),new Pg(y.left+y.width,y.top+y.height),new Pg(y.left,y.top+y.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Qf(n.value,f),i.letterSpacing,h),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Xd(n.styles.display,2048))return[3,20];if(null===n.styles.listStyleImage)return[3,19];if(0!==(g=n.styles.listStyleImage).type)return[3,18];p=void 0,v=g.url,w.label=15;case 15:return w.trys.push([15,17,,18]),[4,this.context.cache.match(v)];case 16:return p=w.sent(),this.ctx.drawImage(p,n.bounds.left-(p.width+10),n.bounds.top),[3,18];case 17:return w.sent(),this.context.logger.error("Error loading list-style-image "+v),[3,18];case 18:return[3,20];case 19:t.listValue&&-1!==n.styles.listStyleType&&(m=this.createFontStyle(i)[0],this.ctx.font=m,this.ctx.fillStyle=th(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",y=new Yc(n.bounds.left,n.bounds.top+Vu(n.styles.paddingTop,n.bounds.width),n.bounds.width,hd(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Qf(t.listValue,y),i.letterSpacing,hd(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),w.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(t){return zc(this,0,void 0,function(){var e,n,r,i,A,o,s,a,c,l,u,h,d,f,g;return Wc(this,function(p){switch(p.label){case 0:return Xd(t.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:p.sent(),e=0,n=t.negativeZIndex,p.label=2;case 2:return e<n.length?(g=n[e],[4,this.renderStack(g)]):[3,5];case 3:p.sent(),p.label=4;case 4:return e++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:p.sent(),r=0,i=t.nonInlineLevel,p.label=7;case 7:return r<i.length?(g=i[r],[4,this.renderNode(g)]):[3,10];case 8:p.sent(),p.label=9;case 9:return r++,[3,7];case 10:A=0,o=t.nonPositionedFloats,p.label=11;case 11:return A<o.length?(g=o[A],[4,this.renderStack(g)]):[3,14];case 12:p.sent(),p.label=13;case 13:return A++,[3,11];case 14:s=0,a=t.nonPositionedInlineLevel,p.label=15;case 15:return s<a.length?(g=a[s],[4,this.renderStack(g)]):[3,18];case 16:p.sent(),p.label=17;case 17:return s++,[3,15];case 18:c=0,l=t.inlineLevel,p.label=19;case 19:return c<l.length?(g=l[c],[4,this.renderNode(g)]):[3,22];case 20:p.sent(),p.label=21;case 21:return c++,[3,19];case 22:u=0,h=t.zeroOrAutoZIndexOrTransformedOrOpacity,p.label=23;case 23:return u<h.length?(g=h[u],[4,this.renderStack(g)]):[3,26];case 24:p.sent(),p.label=25;case 25:return u++,[3,23];case 26:d=0,f=t.positiveZIndex,p.label=27;case 27:return d<f.length?(g=f[d],[4,this.renderStack(g)]):[3,30];case 28:p.sent(),p.label=29;case 29:return d++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var e=this;t.forEach(function(t,n){var r=_g(t)?t.start:t;0===n?e.ctx.moveTo(r.x,r.y):e.ctx.lineTo(r.x,r.y),_g(t)&&e.ctx.bezierCurveTo(t.startControl.x,t.startControl.y,t.endControl.x,t.endControl.y,t.end.x,t.end.y)})},e.prototype.renderRepeat=function(t,e,n,r){this.path(t),this.ctx.fillStyle=e,this.ctx.translate(n,r),this.ctx.fill(),this.ctx.translate(-n,-r)},e.prototype.resizeImage=function(t,e,n){var r;if(t.width===e&&t.height===n)return t;var i=(null!==(r=this.canvas.ownerDocument)&&void 0!==r?r:document).createElement("canvas");return i.width=Math.max(1,e),i.height=Math.max(1,n),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,e,n),i},e.prototype.renderBackgroundImage=function(t){return zc(this,0,void 0,function(){var e,n,r,i,A,o;return Wc(this,function(s){switch(s.label){case 0:e=t.styles.backgroundImage.length-1,n=function(n){var i,A,o,s,a,c,l,u,h,d,f,g,p,v,m,y,w,B,b,E,x,C,F,M,k,Q,S,U,T,O,N;return Wc(this,function(I){switch(I.label){case 0:if(0!==n.type)return[3,5];i=void 0,A=n.url,I.label=1;case 1:return I.trys.push([1,3,,4]),[4,r.context.cache.match(A)];case 2:return i=I.sent(),[3,4];case 3:return I.sent(),r.context.logger.error("Error loading background-image "+A),[3,4];case 4:return i&&(o=op(t,e,[i.width,i.height,i.width/i.height]),y=o[0],C=o[1],F=o[2],b=o[3],E=o[4],v=r.ctx.createPattern(r.resizeImage(i,b,E),"repeat"),r.renderRepeat(y,v,C,F)),[3,6];case 5:1===n.type?(s=op(t,e,[null,null,null]),y=s[0],C=s[1],F=s[2],b=s[3],E=s[4],a=dh(n.angle,b,E),c=a[0],l=a[1],u=a[2],h=a[3],d=a[4],(f=document.createElement("canvas")).width=b,f.height=E,g=f.getContext("2d"),p=g.createLinearGradient(l,h,u,d),hh(n.stops,c).forEach(function(t){return p.addColorStop(t.stop,th(t.color))}),g.fillStyle=p,g.fillRect(0,0,b,E),b>0&&E>0&&(v=r.ctx.createPattern(f,"repeat"),r.renderRepeat(y,v,C,F))):function(t){return 2===t.type}(n)&&(m=op(t,e,[null,null,null]),y=m[0],w=m[1],B=m[2],b=m[3],E=m[4],x=0===n.position.length?[Gu]:n.position,C=Vu(x[0],b),F=Vu(x[x.length-1],E),M=function(t,e,n,r,i){var A=0,o=0;switch(t.size){case 0:0===t.shape?A=o=Math.min(Math.abs(e),Math.abs(e-r),Math.abs(n),Math.abs(n-i)):1===t.shape&&(A=Math.min(Math.abs(e),Math.abs(e-r)),o=Math.min(Math.abs(n),Math.abs(n-i)));break;case 2:if(0===t.shape)A=o=Math.min(fh(e,n),fh(e,n-i),fh(e-r,n),fh(e-r,n-i));else if(1===t.shape){var s=Math.min(Math.abs(n),Math.abs(n-i))/Math.min(Math.abs(e),Math.abs(e-r)),a=gh(r,i,e,n,!0),c=a[0],l=a[1];o=s*(A=fh(c-e,(l-n)/s))}break;case 1:0===t.shape?A=o=Math.max(Math.abs(e),Math.abs(e-r),Math.abs(n),Math.abs(n-i)):1===t.shape&&(A=Math.max(Math.abs(e),Math.abs(e-r)),o=Math.max(Math.abs(n),Math.abs(n-i)));break;case 3:if(0===t.shape)A=o=Math.max(fh(e,n),fh(e,n-i),fh(e-r,n),fh(e-r,n-i));else if(1===t.shape){s=Math.max(Math.abs(n),Math.abs(n-i))/Math.max(Math.abs(e),Math.abs(e-r));var u=gh(r,i,e,n,!1);c=u[0],l=u[1],o=s*(A=fh(c-e,(l-n)/s))}}return Array.isArray(t.size)&&(A=Vu(t.size[0],r),o=2===t.size.length?Vu(t.size[1],i):A),[A,o]}(n,C,F,b,E),k=M[0],Q=M[1],k>0&&Q>0&&(S=r.ctx.createRadialGradient(w+C,B+F,0,w+C,B+F,k),hh(n.stops,2*k).forEach(function(t){return S.addColorStop(t.stop,th(t.color))}),r.path(y),r.ctx.fillStyle=S,k!==Q?(U=t.bounds.left+.5*t.bounds.width,T=t.bounds.top+.5*t.bounds.height,N=1/(O=Q/k),r.ctx.save(),r.ctx.translate(U,T),r.ctx.transform(1,0,0,O,0,0),r.ctx.translate(-U,-T),r.ctx.fillRect(w,N*(B-T)+T,b,E*N),r.ctx.restore()):r.ctx.fill())),I.label=6;case 6:return e--,[2]}})},r=this,i=0,A=t.styles.backgroundImage.slice(0).reverse(),s.label=1;case 1:return i<A.length?(o=A[i],[5,n(o)]):[3,4];case 2:s.sent(),s.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(t,e,n){return zc(this,0,void 0,function(){return Wc(this,function(r){return this.path(ep(n,e)),this.ctx.fillStyle=th(t),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(t,e,n,r){return zc(this,0,void 0,function(){var i,A;return Wc(this,function(o){switch(o.label){case 0:return e<3?[4,this.renderSolidBorder(t,n,r)]:[3,2];case 1:return o.sent(),[2];case 2:return i=function(t,e){switch(e){case 0:return rp(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return rp(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return rp(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);default:return rp(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}}(r,n),this.path(i),this.ctx.fillStyle=th(t),this.ctx.fill(),A=function(t,e){switch(e){case 0:return rp(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return rp(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return rp(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);default:return rp(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}}(r,n),this.path(A),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(t){return zc(this,0,void 0,function(){var e,n,r,i,A,o,s,a,c=this;return Wc(this,function(l){switch(l.label){case 0:return this.applyEffects(t.getEffects(2)),e=t.container.styles,n=!$u(e.backgroundColor)||e.backgroundImage.length,r=[{style:e.borderTopStyle,color:e.borderTopColor,width:e.borderTopWidth},{style:e.borderRightStyle,color:e.borderRightColor,width:e.borderRightWidth},{style:e.borderBottomStyle,color:e.borderBottomColor,width:e.borderBottomWidth},{style:e.borderLeftStyle,color:e.borderLeftColor,width:e.borderLeftWidth}],i=pp(lp(e.backgroundClip,0),t.curves),n||e.boxShadow.length?(this.ctx.save(),this.path(i),this.ctx.clip(),$u(e.backgroundColor)||(this.ctx.fillStyle=th(e.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:l.sent(),this.ctx.restore(),e.boxShadow.slice(0).reverse().forEach(function(e){c.ctx.save();var n,r,i,A,o,s=jg(t.curves),a=e.inset?0:1e4,l=(n=s,r=-a+(e.inset?1:-1)*e.spread.number,i=(e.inset?1:-1)*e.spread.number,A=e.spread.number*(e.inset?-2:2),o=e.spread.number*(e.inset?-2:2),n.map(function(t,e){switch(e){case 0:return t.add(r,i);case 1:return t.add(r+A,i);case 2:return t.add(r+A,i+o);case 3:return t.add(r,i+o)}return t}));e.inset?(c.path(s),c.ctx.clip(),c.mask(l)):(c.mask(s),c.ctx.clip(),c.path(l)),c.ctx.shadowOffsetX=e.offsetX.number+a,c.ctx.shadowOffsetY=e.offsetY.number,c.ctx.shadowColor=th(e.color),c.ctx.shadowBlur=e.blur.number,c.ctx.fillStyle=e.inset?th(e.color):"rgba(0,0,0,1)",c.ctx.fill(),c.ctx.restore()}),l.label=2;case 2:A=0,o=0,s=r,l.label=3;case 3:return o<s.length?0!==(a=s[o]).style&&!$u(a.color)&&a.width>0?2!==a.style?[3,5]:[4,this.renderDashedDottedBorder(a.color,a.width,A,t.curves,2)]:[3,11]:[3,13];case 4:return l.sent(),[3,11];case 5:return 3!==a.style?[3,7]:[4,this.renderDashedDottedBorder(a.color,a.width,A,t.curves,3)];case 6:return l.sent(),[3,11];case 7:return 4!==a.style?[3,9]:[4,this.renderDoubleBorder(a.color,a.width,A,t.curves)];case 8:return l.sent(),[3,11];case 9:return[4,this.renderSolidBorder(a.color,A,t.curves)];case 10:l.sent(),l.label=11;case 11:A++,l.label=12;case 12:return o++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(t,e,n,r,i){return zc(this,0,void 0,function(){var A,o,s,a,c,l,u,h,d,f,g,p,v,m,y,w;return Wc(this,function(B){return this.ctx.save(),A=function(t,e){switch(e){case 0:return np(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return np(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return np(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);default:return np(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}}(r,n),o=ep(r,n),2===i&&(this.path(o),this.ctx.clip()),_g(o[0])?(s=o[0].start.x,a=o[0].start.y):(s=o[0].x,a=o[0].y),_g(o[1])?(c=o[1].end.x,l=o[1].end.y):(c=o[1].x,l=o[1].y),u=0===n||2===n?Math.abs(s-c):Math.abs(a-l),this.ctx.beginPath(),3===i?this.formatPath(A):this.formatPath(o.slice(0,2)),h=e<3?3*e:2*e,d=e<3?2*e:e,3===i&&(h=e,d=e),f=!0,u<=2*h?f=!1:u<=2*h+d?(h*=g=u/(2*h+d),d*=g):(p=Math.floor((u+d)/(h+d)),v=(u-p*h)/(p-1),d=(m=(u-(p+1)*h)/p)<=0||Math.abs(d-v)<Math.abs(d-m)?v:m),f&&(3===i?this.ctx.setLineDash([0,h+d]):this.ctx.setLineDash([h,d])),3===i?(this.ctx.lineCap="round",this.ctx.lineWidth=e):this.ctx.lineWidth=2*e+1.1,this.ctx.strokeStyle=th(t),this.ctx.stroke(),this.ctx.setLineDash([]),2===i&&(_g(o[0])&&(y=o[3],w=o[0],this.ctx.beginPath(),this.formatPath([new Pg(y.end.x,y.end.y),new Pg(w.start.x,w.start.y)]),this.ctx.stroke()),_g(o[1])&&(y=o[1],w=o[2],this.ctx.beginPath(),this.formatPath([new Pg(y.end.x,y.end.y),new Pg(w.start.x,w.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(t){return zc(this,0,void 0,function(){var e;return Wc(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=th(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),e=function(t){var e=new Jg(t,null),n=new Zg(e),r=[];return $g(e,n,n,r),tp(e.container,r),n}(t),[4,this.renderStack(e)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}})})}}(fp);var gp=function(t){return t instanceof $f||(t instanceof Jf||t instanceof Zf&&t.type!==Yf&&t.type!==Wf)},pp=function(t,e){switch(t){case 0:return jg(e);case 2:return function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]}(e);default:return Vg(e)}},vp=function(t){switch(t){case 1:return"center";case 2:return"right";default:return"left"}},mp=["-apple-system","system-ui"],yp=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(t){return-1===mp.indexOf(t)}):t};!function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.canvas=n.canvas?n.canvas:document.createElement("canvas"),r.ctx=r.canvas.getContext("2d"),r.options=n,r.canvas.width=Math.floor(n.width*n.scale),r.canvas.height=Math.floor(n.height*n.scale),r.canvas.style.width=n.width+"px",r.canvas.style.height=n.height+"px",r.ctx.scale(r.options.scale,r.options.scale),r.ctx.translate(-n.x,-n.y),r.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+n.width+"x"+n.height+" at "+n.x+","+n.y+") with scale "+n.scale),r}Vc(e,t),e.prototype.render=function(t){return zc(this,0,void 0,function(){var e,n;return Wc(this,function(r){switch(r.label){case 0:return e=Ff(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,wp(e)];case 1:return n=r.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=th(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})}}(fp);var wp=function(t){return new Promise(function(e,n){var r=new Image;r.onload=function(){e(r)},r.onerror=n,r.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))})};"undefined"!=typeof window&&Dg.setContext(window);
/*!
   * @antv/g
   * @description A core module for rendering engine implements DOM API.
   * @version 6.3.1
   * @date 12/24/2025, 11:55:39 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */var Bp=function(t){function e(t,n,r,i){var A;return s(this,e),(A=p(this,e,[t])).currentTime=r,A.timelineTime=i,A.target=n,A.type="finish",A.bubbles=!1,A.currentTarget=n,A.defaultPrevented=!1,A.eventPhase=A.AT_TARGET,A.timeStamp=Date.now(),A.currentTime=r,A.timelineTime=i,A}return m(e,t),c(e)}(Vs),bp=0,Ep=function(){return c(function t(e,n){var r;s(this,t),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=e,e.animation=this,this.timeline=n,this.id="".concat(bp++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number(null===(r=this.effect)||void 0===r?void 0:r.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()},[{key:"pending",get:function(){return null===this._startTime&&!this._paused&&0!==this.playbackRate||this.currentTimePending}},{key:"playState",get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"}},{key:"ready",get:function(){var t=this;return this.readyPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(e,n){t.resolveReadyPromise=function(){e(t)},t.rejectReadyPromise=function(){n(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:"finished",get:function(){var t=this;return this.finishedPromise||(-1===this.timeline.animationsWithPromises.indexOf(this)&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(e,n){t.resolveFinishedPromise=function(){e(t)},t.rejectFinishedPromise=function(){n(new Error)}}),"finished"===this.playState&&this.resolveFinishedPromise()),this.finishedPromise}},{key:"currentTime",get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(t){if(t=Number(t),!isNaN(t)){var e;if(this.timeline.restart(),!this._paused&&null!==this._startTime)this._startTime=Number(null===(e=this.timeline)||void 0===e?void 0:e.currentTime)-t/this.playbackRate;this.currentTimePending=!1,this._currentTime!==t&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(t,!0),this.timeline.applyDirtiedAnimation(this))}}},{key:"startTime",get:function(){return this._startTime},set:function(t){if(null!==t){if(this.updatePromises(),t=Number(t),isNaN(t))return;if(this._paused||this._idle)return;this._startTime=t,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){if(t!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=t,this.startTime=null,"paused"!==this.playState&&"idle"!==this.playState&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),null!==e&&(this.currentTime=e),this.updatePromises()}}},{key:"_isFinished",get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:"totalDuration",get:function(){return this._totalDuration}},{key:"_needsTick",get:function(){return this.pending||"running"===this.playState||!this._finishedFlag}},{key:"updatePromises",value:function(){var t;if(null!==(t=this.effect.target)&&void 0!==t&&t.destroyed)return this.readyPromise=void 0,this.finishedPromise=void 0,!1;var e=this.oldPlayState,n=this.pending?"pending":this.playState;return this.readyPromise&&n!==e&&("idle"===n?(this.rejectReadyPromise(),this.readyPromise=void 0):"pending"===e?this.resolveReadyPromise():"pending"===n&&(this.readyPromise=void 0)),this.finishedPromise&&n!==e&&("idle"===n?(this.rejectFinishedPromise(),this.finishedPromise=void 0):"finished"===n?this.resolveFinishedPromise():"finished"===e&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise}},{key:"play",value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),-1===this.timeline.animations.indexOf(this)&&this.timeline.animations.push(this),this.updatePromises()}},{key:"pause",value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),this._isFinished||this._paused||this._idle?this._idle&&(this.rewind(),this._idle=!1):this.currentTimePending=!0,this._startTime=null,this._paused=!0,this.updatePromises()}},{key:"finish",value:function(){this.updatePromises(),this._idle||(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:"cancel",value:function(){var t=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=null,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new Bp(null,this,this.currentTime,null);setTimeout(function(){t.oncancel(e)})}}},{key:"reverse",value:function(){this.updatePromises();var t=this.currentTime;this.playbackRate*=-1,this.play(),null!==t&&(this.currentTime=t),this.updatePromises()}},{key:"updatePlaybackRate",value:function(t){this.playbackRate=t}},{key:"targetAnimations",value:function(){var t;return(null===(t=this.effect)||void 0===t?void 0:t.target).getAnimations()}},{key:"markTarget",value:function(){var t=this.targetAnimations();-1===t.indexOf(this)&&t.push(this)}},{key:"unmarkTarget",value:function(){var t=this.targetAnimations(),e=t.indexOf(this);-1!==e&&t.splice(e,1)}},{key:"tick",value:function(t,e){this._idle||this._paused||(null===this._startTime?e&&(this.startTime=t-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((t-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(t))}},{key:"rewind",value:function(){if(this.playbackRate>=0)this.currentTime=0;else{if(!(this._totalDuration<1/0))throw new Error("Unable to rewind negative playback rate animation with infinite duration");this.currentTime=this._totalDuration}}},{key:"persist",value:function(){throw new Error(kr)}},{key:"addEventListener",value:function(t,e,n){throw new Error(kr)}},{key:"removeEventListener",value:function(t,e,n){throw new Error(kr)}},{key:"dispatchEvent",value:function(t){throw new Error(kr)}},{key:"commitStyles",value:function(){throw new Error(kr)}},{key:"ensureAlive",value:function(){var t,e;this.playbackRate<0&&0===this.currentTime?this._inEffect=!(null===(t=this.effect)||void 0===t||!t.update(-1)):this._inEffect=!(null===(e=this.effect)||void 0===e||!e.update(this.currentTime));this._inTimeline||!this._inEffect&&this._finishedFlag||(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:"tickCurrentTime",value:function(t,e){t!==this._currentTime&&(this._currentTime=t,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:"fireEvents",value:function(t){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new Bp(null,this,this.currentTime,t);setTimeout(function(){e.onfinish&&e.onfinish(n)})}this._finishedFlag=!0}}else{if(this.onframe&&"running"===this.playState){var r=new Bp(null,this,this.currentTime,t);this.onframe(r)}this._finishedFlag=!1}}}])}(),xp=.1,Cp="function"==typeof Float32Array,Fp=function(t,e){return 1-3*e+3*t},Mp=function(t,e){return 3*e-6*t},kp=function(t){return 3*t},Qp=function(t,e,n){return((Fp(e,n)*t+Mp(e,n))*t+kp(e))*t},Sp=function(t,e,n){return 3*Fp(e,n)*t*t+2*Mp(e,n)*t+kp(e)},Up=function(t,e,n,r){if(!(t>=0&&t<=1&&n>=0&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&n===r)return function(t){return t};for(var i=Cp?new Float32Array(11):new Array(11),A=0;A<11;++A)i[A]=Qp(A*xp,t,n);var o=function(e){for(var r=0,A=1;10!==A&&i[A]<=e;++A)r+=xp;--A;var o=r+(e-i[A])/(i[A+1]-i[A])*xp,s=Sp(o,t,n);return s>=.001?function(t,e,n,r){for(var i=0;i<4;++i){var A=Sp(e,n,r);if(0===A)return e;e-=(Qp(e,n,r)-t)/A}return e}(e,o,t,n):0===s?o:function(t,e,n,r,i){var A,o,s=0;do{(A=Qp(o=e+(n-e)/2,r,i)-t)>0?n=o:e=o}while(Math.abs(A)>1e-7&&++s<10);return o}(e,r,r+xp,t,n)};return function(t){return 0===t||1===t?t:Qp(o(t),e,r)}},Tp=function(t){return Math.pow(t,2)},Op=function(t){return Math.pow(t,3)},Np=function(t){return Math.pow(t,4)},Ip=function(t){return Math.pow(t,5)},Lp=function(t){return Math.pow(t,6)},Dp=function(t){return 1-Math.cos(t*Math.PI/2)},Pp=function(t){return 1-Math.sqrt(1-t*t)},Rp=function(t){return t*t*(3*t-2)},Hp=function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)},_p=function(t){var e=y(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],r=void 0===n?1:n,i=e[1],A=void 0===i?.5:i,o=Ae(Number(r),1,10),s=Ae(Number(A),.1,2);return 0===t||1===t?t:-o*Math.pow(2,10*(t-1))*Math.sin((t-1-s/(2*Math.PI)*Math.asin(1/o))*(2*Math.PI)/s)},Gp=function(t){var e=arguments.length>2?arguments[2]:void 0,n=y(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),r=n[0],i=void 0===r?1:r,A=n[1],o=void 0===A?100:A,s=n[2],a=void 0===s?10:s,c=n[3],l=void 0===c?0:c;i=Ae(i,.1,1e3),o=Ae(o,.1,1e3),a=Ae(a,.1,1e3),l=Ae(l,.1,1e3);var u=Math.sqrt(o/i),h=a/(2*Math.sqrt(o*i)),d=h<1?u*Math.sqrt(1-h*h):0,f=h<1?(h*u-l)/d:-l+u,g=e?e*t/1e3:t;return g=h<1?Math.exp(-g*h*u)*(1*Math.cos(d*g)+f*Math.sin(d*g)):(1+f*g)*Math.exp(-g*u),0===t||1===t?t:1-g},Kp=function(t){var e=y(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],2),n=e[0],r=void 0===n?10:n;return("start"===e[1]?Math.ceil:Math.floor)(Ae(t,0,1)*r)/r},jp=function(t){var e=y(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],4),n=e[0],r=e[1],i=e[2],A=e[3];return Up(n,r,i,A)(t)},Vp=Up(.42,0,1,1),zp=function(t){return function(e){return 1-t(1-e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2?arguments[2]:void 0)}},Wp=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return e<.5?t(2*e,n,r)/2:1-t(-2*e+2,n,r)/2}},Yp=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return e<.5?(1-t(1-2*e,n,r))/2:(t(2*e-1,n,r)+1)/2}},Xp={steps:Kp,"step-start":function(t){return Kp(t,[1,"start"])},"step-end":function(t){return Kp(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":jp,ease:function(t){return jp(t,[.25,.1,.25,1])},in:Vp,out:zp(Vp),"in-out":Wp(Vp),"out-in":Yp(Vp),"in-quad":Tp,"out-quad":zp(Tp),"in-out-quad":Wp(Tp),"out-in-quad":Yp(Tp),"in-cubic":Op,"out-cubic":zp(Op),"in-out-cubic":Wp(Op),"out-in-cubic":Yp(Op),"in-quart":Np,"out-quart":zp(Np),"in-out-quart":Wp(Np),"out-in-quart":Yp(Np),"in-quint":Ip,"out-quint":zp(Ip),"in-out-quint":Wp(Ip),"out-in-quint":Yp(Ip),"in-expo":Lp,"out-expo":zp(Lp),"in-out-expo":Wp(Lp),"out-in-expo":Yp(Lp),"in-sine":Dp,"out-sine":zp(Dp),"in-out-sine":Wp(Dp),"out-in-sine":Yp(Dp),"in-circ":Pp,"out-circ":zp(Pp),"in-out-circ":Wp(Pp),"out-in-circ":Yp(Pp),"in-back":Rp,"out-back":zp(Rp),"in-out-back":Wp(Rp),"out-in-back":Yp(Rp),"in-bounce":Hp,"out-bounce":zp(Hp),"in-out-bounce":Wp(Hp),"out-in-bounce":Yp(Hp),"in-elastic":_p,"out-elastic":zp(_p),"in-out-elastic":Wp(_p),"out-in-elastic":Yp(_p),spring:Gp,"spring-in":Gp,"spring-out":zp(Gp),"spring-in-out":Wp(Gp),"spring-out-in":Yp(Gp)},qp=function(t){return t};function Zp(t,e){return function(n){if(n>=1)return 1;var r=1/t;return(n+=e*r)-n%r}}var Jp="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",$p=new RegExp("cubic-bezier\\(".concat(Jp,",").concat(Jp,",").concat(Jp,",").concat(Jp,"\\)")),tv=/steps\(\s*(\d+)\s*\)/,ev=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function nv(t){var e=$p.exec(t);if(e)return Up.apply(void 0,h(e.slice(1).map(Number)));var n=tv.exec(t);if(n)return Zp(Number(n[1]),0);var r=ev.exec(t);return r?Zp(Number(r[1]),{start:1,middle:.5,end:0}[r[2]]):Xp[function(t){return function(t){return"-"===(t=t.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})).charAt(0)?t.substring(1):t}(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()}(t)]||Xp.linear}function rv(t){return Math.abs(function(t){var e;if(0===t.duration||0===t.iterations)return 0;return("auto"===t.duration?0:Number(t.duration))*(null!==(e=t.iterations)&&void 0!==e?e:1)}(t)/(t.playbackRate||1))}function iv(t,e,n){var r=function(t,e,n){if(null===e)return 0;var r=n.endTime;return e<Math.min(n.delay,r)?1:e>=Math.min(n.delay+t+n.endDelay,r)?2:3}(t,e,n),i=function(t,e,n,r,i){switch(r){case 1:return"backwards"===e||"both"===e?0:null;case 3:return n-i;case 2:return"forwards"===e||"both"===e?t:null;case 0:return null}}(t,n.fill,e,r,n.delay);if(null===i)return null;var A="auto"===n.duration?0:n.duration,o=function(t,e,n,r,i){var A=i;return 0===t?1!==e&&(A+=n):A+=r/t,A}(A,r,n.iterations,i,n.iterationStart),s=function(t,e,n,r,i,A){var o=t===1/0?e%1:t%1;return 0!==o||2!==n||0===r||0===i&&0!==A||(o=1),o}(o,n.iterationStart,r,n.iterations,i,A),a=function(t,e,n,r){return 2===t&&e===1/0?1/0:1===n?Math.floor(r)-1:Math.floor(r)}(r,n.iterations,s,o),c=function(t,e,n){var r=t;if("normal"!==t&&"reverse"!==t){var i=e;"alternate-reverse"===t&&(i+=1),r="normal",i!==1/0&&i%2!=0&&(r="reverse")}return"normal"===r?n:1-n}(n.direction,a,s);return n.currentIteration=a,n.progress=c,n.easingFunction(c)}function Av(t,e,n){var r=function(t,e){for(var n={},r=0;r<t.length;r++)for(var i in t[r])if(ov(i)){var A={offset:t[r].offset,computedOffset:t[r].computedOffset,easing:t[r].easing,easingFunction:nv(t[r].easing)||e.easingFunction,value:t[r][i]};n[i]=n[i]||[],n[i].push(A)}return n}(t,e),i=function(t,e){var n=[];for(var r in t)for(var i=t[r],A=0;A<i.length-1;A++){var o=A,s=A+1,a=i[o].computedOffset,c=i[s].computedOffset,l=a,u=c;0===A&&(l=-1/0,0===c&&(s=o)),A===i.length-2&&(u=1/0,1===a&&(o=s)),n.push({applyFrom:l,applyTo:u,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:r,interpolation:av(r,i[o].value,i[s].value,e)})}return n.sort(function(t,e){return t.startOffset-e.startOffset}),n}(r,n);return function(t,e){if(null!==e)i.filter(function(t){return e>=t.applyFrom&&e<t.applyTo}).forEach(function(n){var r=e-n.startOffset,i=n.endOffset-n.startOffset,A=0===i?0:r/i;t.setAttribute(n.property,n.interpolation(A),!1,!1)});else for(var n in r)ov(n)&&t.setAttribute(n,null)}}function ov(t){return"offset"!==t&&"easing"!==t&&"composite"!==t&&"computedOffset"!==t}var sv=function(t,e,n){return function(r){var i=cv(t,e,r);return oe(i)?i:n(i)}};function av(t,e,n,r){var i=Qo[t];if(i&&i.syntax&&i.int){var A=Na.styleValueRegistry.getPropertySyntax(i.syntax);if(A){var o=A.parser,s=o?o(e,r):e,a=o?o(n,r):n,c=A.mixer(s,a,r);if(c){var l=sv.apply(void 0,h(c));return function(t){return 0===t?e:1===t?n:l(t)}}}}return sv(!1,!0,function(t){return t?n:e})}function cv(t,e,n){if("number"==typeof t&&"number"==typeof e)return t*(1-n)+e*n;if("boolean"==typeof t&&"boolean"==typeof e||"string"==typeof t&&"string"==typeof e)return n<.5?t:e;if(Array.isArray(t)&&Array.isArray(e)){for(var r=t.length,i=e.length,A=Math.max(r,i),o=[],s=0;s<A;s++)o.push(cv(t[s<r?s:r-1],e[s<i?s:i-1],n));return o}throw new Error("Mismatched interpolation arguments ".concat(t,":").concat(e))}var lv=function(){return c(function t(){s(this,t),this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=qp,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null},[{key:"easing",get:function(){return this._easing},set:function(t){this.easingFunction=nv(t),this._easing=t}}])}();function uv(t,e){if(null===t)return[];Array.isArray(t)||(t=function(t){var e=[];for(var n in t)if(!(n in["easing","offset","composite"])){var r=t[n];Array.isArray(r)||(r=[r]);for(var i=r.length,A=0;A<i;A++){if(!e[A]){var o={};"offset"in t&&(o.offset=Number(t.offset)),"easing"in t&&(o.easing=t.easing),"composite"in t&&(o.composite=t.composite),e[A]=o}void 0!==r[A]&&null!==r[A]&&(e[A][n]=r[A])}}return e.sort(function(t,e){return(t.computedOffset||0)-(e.computedOffset||0)}),e}(t));for(var n=t.map(function(t){var n={};for(var r in null!=e&&e.composite&&(n.composite="auto"),t){var i=t[r];if("offset"===r){if(null!==i){if(i=Number(i),!isFinite(i))throw new Error("Keyframe offsets must be numbers.");if(i<0||i>1)throw new Error("Keyframe offsets must be between 0 and 1.");n.computedOffset=i}}else if("composite"===r&&-1===["replace","add","accumulate","auto"].indexOf(i))throw new Error("".concat(i," compositing is not supported"));n[r]=i}return void 0===n.offset&&(n.offset=null),void 0===n.easing&&(n.easing=(null==e?void 0:e.easing)||"linear"),void 0===n.composite&&(n.composite="auto"),n}),r=!0,i=-1/0,A=0;A<n.length;A++){var o=n[A].offset;if(zt(o))r=!1;else{if(o<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}return n=n.filter(function(t){return Number(t.offset)>=0&&Number(t.offset)<=1}),r||function(){var t,e,r=n.length;n[r-1].computedOffset=Number(null!==(t=n[r-1].offset)&&void 0!==t?t:1),r>1&&(n[0].computedOffset=Number(null!==(e=n[0].offset)&&void 0!==e?e:0));for(var i=0,A=Number(n[0].computedOffset),o=1;o<r;o++){var s=n[o].computedOffset;if(!zt(s)&&!zt(A)){for(var a=1;a<o-i;a++)n[i+a].computedOffset=A+(Number(s)-A)*a/(o-i);i=o,A=Number(s)}}}(),n}var hv="backwards|forwards|both|none".split("|"),dv="reverse|alternate|alternate-reverse".split("|");function fv(t,e){return function(t){var e=new lv;return"number"!=typeof t||isNaN(t)?void 0!==t&&Object.keys(t).forEach(function(n){if(void 0!==t[n]&&null!==t[n]&&"auto"!==t[n]){if(("number"==typeof e[n]||"duration"===n)&&("number"!=typeof t[n]||isNaN(t[n])))return;if("fill"===n&&-1===hv.indexOf(t[n]))return;if("direction"===n&&-1===dv.indexOf(t[n]))return;e[n]=t[n]}}):e.duration=t,e}(t=function(t){"number"==typeof t&&(t=isNaN(t)?{duration:"auto"}:{duration:t});return t}(null!=t?t:{duration:"auto"}))}var gv=function(){return c(function t(e,n,r){var i=this;s(this,t),this.composite="replace",this.iterationComposite="replace",this.target=e,this.timing=fv(r),this.timing.effect=this,this.timing.activeDuration=rv(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=uv(n,this.timing),this.interpolations=Av(this.normalizedKeyframes,this.timing,this.target);var A=Na.globalThis.Proxy;this.computedTiming=A?new A(this.timing,{get:function(t,e){return"duration"===e?"auto"===t.duration?0:t.duration:"fill"===e?"auto"===t.fill?"none":t.fill:"localTime"===e?i.animation&&i.animation.currentTime||null:"currentIteration"===e?i.animation&&"running"===i.animation.playState?t.currentIteration||0:null:"progress"===e?i.animation&&"running"===i.animation.playState?t.progress||0:null:t[e]},set:function(){return!0}}):this.timing},[{key:"applyInterpolations",value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:"update",value:function(t){return null!==t&&(this.timeFraction=iv(this.timing.activeDuration,t,this.timing),null!==this.timeFraction)}},{key:"getKeyframes",value:function(){return this.normalizedKeyframes}},{key:"setKeyframes",value:function(t){this.normalizedKeyframes=uv(t)}},{key:"getComputedTiming",value:function(){return this.computedTiming}},{key:"getTiming",value:function(){return this.timing}},{key:"updateTiming",value:function(t){var e=this;Object.keys(t||{}).forEach(function(n){e.timing[n]=t[n]})}}])}();function pv(t,e){return Number(t.id)-Number(e.id)}var vv=function(){return c(function t(e){var n=this;s(this,t),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(t){n.currentTime=t,n.discardAnimations(),0===n.animations.length?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(t){var e=n.rafCallbacks;n.rafCallbacks=[],t<Number(n.currentTime)&&(t=Number(n.currentTime)),n.animations.sort(pv),n.animations=n.tick(t,!0,n.animations)[0],e.forEach(function(e){e[1](t)}),n.applyPendingEffects()},this.document=e},[{key:"getAnimations",value:function(){return this.discardAnimations(),this.animations.slice()}},{key:"isTicking",value:function(){return this.inTick}},{key:"play",value:function(t,e,n){var r=new gv(t,e,n),i=new Ep(r,this);return this.animations.push(i),this.restartWebAnimationsNextTick(),i.updatePromises(),i.play(),i.updatePromises(),i}},{key:"applyDirtiedAnimation",value:function(t){var e=this;if(!this.inTick){t.markTarget();var n=t.targetAnimations();n.sort(pv),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach(function(t){var n=e.animations.indexOf(t);-1!==n&&e.animations.splice(n,1)}),this.applyPendingEffects()}}},{key:"restart",value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:"destroy",value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:"applyPendingEffects",value:function(){this.pendingEffects.forEach(function(t){null==t||t.applyInterpolations()}),this.pendingEffects=[]}},{key:"updateAnimationsPromises",value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(t){return t.updatePromises()})}},{key:"discardAnimations",value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(t){return"finished"!==t.playState&&"idle"!==t.playState})}},{key:"restartWebAnimationsNextTick",value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:"rAF",value:function(t){var e=this.rafId++;return 0===this.rafCallbacks.length&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,t]),e}},{key:"requestAnimationFrame",value:function(t){var e=this;return this.rAF(function(n){e.updateAnimationsPromises(),t(n),e.updateAnimationsPromises()})}},{key:"tick",value:function(t,e,n){var r,i,A=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=t,this.ticking=!1;var o=[],s=[],a=[],c=[];return n.forEach(function(n){n.tick(t,e),n._inEffect?(s.push(n.effect),n.markTarget()):(o.push(n.effect),n.unmarkTarget()),n._needsTick&&(A.ticking=!0);var r=n._inEffect||n._needsTick;n._inTimeline=r,r?a.push(n):c.push(n)}),(r=this.pendingEffects).push.apply(r,o),(i=this.pendingEffects).push.apply(i,s),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[a,c]}}])}();Na.EasingFunction=nv,Na.AnimationTimeline=vv;var mv=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).landmarks=[],t}return m(e,t),c(e,[{key:"rotate",value:function(t,e,n){if(this.relElevation=Sr(e),this.relAzimuth=Sr(t),this.relRoll=Sr(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Wr.EXPLORING){var r=Ot(Tt(),[1,0,0],Nr((this.rotateWorld?1:-1)*this.relElevation)),i=Ot(Tt(),[0,1,0],Nr((this.rotateWorld?1:-1)*this.relAzimuth)),A=Ot(Tt(),[0,0,1],Nr(this.relRoll)),o=Nt(Tt(),i,r);o=Nt(Tt(),o,A);var s=$(k(),o);P(this.matrix,this.matrix,[0,0,-this.distance]),D(this.matrix,this.matrix,s),P(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Wr.ORBITING||this.type===Wr.EXPLORING?this._getPosition():this.type===Wr.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,e){var n=Tr(t,e,0),r=ht(this.position);return vt(r,r,yt(ut(),this.right,n[0])),vt(r,r,yt(ut(),this.up,n[1])),this._setPosition(r),this.triggerUpdate(),this}},{key:"dolly",value:function(t){var e=this.forward,n=ht(this.position),r=this.dollyingStep,i=this.distance+t*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*e[0],n[1]+=r*e[1],n[2]+=r*e[2],this._setPosition(n),this.type===Wr.ORBITING||this.type===Wr.EXPLORING?this._getDistance():this.type===Wr.TRACKING&&vt(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(t){var e,n,r,i,A=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=A.position,s=void 0===o?this.position:o,a=A.focalPoint,c=void 0===a?this.focalPoint:a,l=A.roll,u=A.zoom,h=new Na.CameraContribution;h.setType(this.type,void 0),h.setPosition(s[0],null!==(e=s[1])&&void 0!==e?e:this.position[1],null!==(n=s[2])&&void 0!==n?n:this.position[2]),h.setFocalPoint(c[0],null!==(r=c[1])&&void 0!==r?r:this.focalPoint[1],null!==(i=c[2])&&void 0!==i?i:this.focalPoint[2]),h.setRoll(null!=l?l:this.roll),h.setZoom(null!=u?u:this.zoom);var d={name:t,matrix:Q(h.getWorldTransform()),right:ht(h.right),up:ht(h.up),forward:ht(h.forward),position:ht(h.getPosition()),focalPoint:ht(h.getFocalPoint()),distanceVector:ht(h.getDistanceVector()),distance:h.getDistance(),dollyingStep:h.getDollyingStep(),azimuth:h.getAzimuth(),elevation:h.getElevation(),roll:h.getRoll(),relAzimuth:h.relAzimuth,relElevation:h.relElevation,relRoll:h.relRoll,zoom:h.getZoom()};return this.landmarks.push(d),d}},{key:"gotoLandmark",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ne(t)?this.landmarks.find(function(e){return e.name===t}):t;if(r){var i=oe(n)?{duration:n}:n,A=i.easing,o=void 0===A?"linear":A,s=i.duration,a=void 0===s?100:s,c=i.easingFunction,l=void 0===c?void 0:c,u=i.onfinish,h=void 0===u?void 0:u,d=i.onframe,f=void 0===d?void 0:d;this.cancelLandmarkAnimation();var g,p=r.position,v=r.focalPoint,m=r.zoom,y=r.roll,w=l||Na.EasingFunction(o),B=function(){e.setFocalPoint(v),e.setPosition(p),e.setRoll(y),e.setZoom(m),e.computeMatrix(),e.triggerUpdate(),null==h||h()};if(0===a)return B();var b=function(t){void 0===g&&(g=t);var n=t-g;if(n>=a)B();else{var r,i,A=w(n/a),o=ut(),s=ut();if(Et(o,e.focalPoint,v,A),Et(s,e.position,p,A),i=e.roll*(1-A)+y*A,r=e.zoom*(1-A)+m*A,e.setFocalPoint(o),e.setPosition(s),e.setRoll(i),e.setZoom(r),Mt(o,v)+Mt(s,p)<=.01&&void 0===m&&void 0===y)return B();e.computeMatrix(),e.triggerUpdate(),n<a&&(null==f||f(A),e.landmarkAnimationID=e.canvas.requestAnimationFrame(b))}};this.canvas.requestAnimationFrame(b)}}}])}(Jr);Na.CameraContribution=mv;var yv=["body","startHead","endHead","startHeadOffset","endHeadOffset"],wv=["body","startHead","endHead","startHeadOffset","endHeadOffset"],Bv=["body","startHead","endHead","startHeadOffset","endHeadOffset"],bv=function(t){function e(t){var n;s(this,e);var r=(n=p(this,e,[o(o({},t),{},{type:e.tag})])).attributes,i=r.body,A=r.startHead,a=r.endHead;r.startHeadOffset,r.endHeadOffset;var c=ur(r,yv);if(!i)throw new Error("Arrow's body is required");return n.body=i,n.appendChild(n.body),n.handleBodyAttributeChanged(n.body),A&&n.appendArrowHead(n.getArrowHeadType(A),!0),a&&n.appendArrowHead(n.getArrowHeadType(a),!1),n.applyArrowStyle(c,[n.body,n.startHead,n.endHead]),n}return m(e,t),c(e,[{key:"handleBodyAttributeChanged",value:function(t){var e=this;t.addEventListener(ia.ATTR_MODIFIED,function(t){var n=t.attrName;"x1"===n||"y1"===n?e.startHead&&e.transformArrowHead(e.startHead,!0):"x2"!==n&&"y2"!==n||e.endHead&&e.transformArrowHead(e.endHead,!1)})}},{key:"getBody",value:function(){return this.body}},{key:"getStartHead",value:function(){return this.startHead}},{key:"getEndHead",value:function(){return this.endHead}},{key:"attributeChangedCallback",value:function(t,e,n){if("opacity"===t||"strokeOpacity"===t||"stroke"===t||"lineWidth"===t||"increasedLineWidthForHitTesting"===t)this.applyArrowStyle(i({},t,n),[this.body,this.startHead,this.endHead]);else if("startHead"===t||"endHead"===t){var r="startHead"===t;if(this.destroyArrowHead(r),n){var A=this.attributes;A.body,A.startHead,A.endHead,A.startHeadOffset,A.endHeadOffset;var o=ur(A,wv);this.appendArrowHead(this.getArrowHeadType(n),r),this.applyArrowStyle(o,[r?this.startHead:this.endHead])}}else if("body"===t){var s=this.attributes;s.body,s.startHead,s.endHead,s.startHeadOffset,s.endHeadOffset;var a=ur(s,Bv);this.body.destroy(),this.body=n,this.appendChild(this.body),this.applyArrowStyle(a,[this.body])}else"startHeadOffset"===t?this.moveArrowHeadAlongTangent(n,!0):"endHeadOffset"===t&&this.moveArrowHeadAlongTangent(n,!1)}},{key:"getArrowHeadType",value:function(t){return"boolean"==typeof t?"default":"custom"}},{key:"appendArrowHead",value:function(t,e){var n;n="default"===t?this.createDefaultArrowHead():e?this.attributes.startHead:this.attributes.endHead,this.transformArrowHead(n,e),n.setAttribute("zIndex",1),e?this.startHead=n:this.endHead=n,this.appendChild(n);var r=e?this.attributes.startHeadOffset:this.attributes.endHeadOffset;r&&this.moveArrowHeadAlongTangent(r,e)}},{key:"transformArrowHead",value:function(t,e){var n,r=ut(),i=0,A=0,o=0,s=0,a=this.body&&this.body.nodeName;if(a===hr.LINE){var c=this.body.attributes,l=c.x1,u=c.x2,h=c.y1,d=c.y2;i=e?u:l,A=e?l:u,o=e?d:h,s=e?h:d}else if(a===hr.POLYLINE){var f=this.body.attributes.points,g=f.length;i=e?f[1][0]:f[g-2][0],o=e?f[1][1]:f[g-2][1],A=e?f[0][0]:f[g-1][0],s=e?f[0][1]:f[g-1][1]}else if(a===hr.PATH){var p=y(this.getTangent(this.body,e),2),v=p[0],m=p[1];i=v[0],o=v[1],A=m[0],s=m[1]}var w=i-A,B=o-s;n=Math.atan2(B,w),r=ft(A,s,0),e?(this.startHeadPosition=r,this.startHeadRad=n):(this.endHeadPosition=r,this.endHeadRad=n),t.setLocalPosition(r),t.setLocalEulerAngles(180*n/Math.PI+t.getLocalEulerAngles())}},{key:"moveArrowHeadAlongTangent",value:function(t,e){var n=e?this.startHead:this.endHead;n&&n.setLocalPosition(Ft(ut(),e?this.startHeadPosition:this.endHeadPosition,ft(Math.cos(e?this.startHeadRad:this.endHeadRad)*t,Math.sin(e?this.startHeadRad:this.endHeadRad)*t,0))),this.body}},{key:"destroyArrowHead",value:function(t){t&&this.startHead&&(this.startHead.destroy(),this.startHead=void 0),!t&&this.endHead&&(this.endHead.destroy(),this.endHead=void 0)}},{key:"getTangent",value:function(t,e){return e?t.getStartTangent():t.getEndTangent()}},{key:"createDefaultArrowHead",value:function(){var t=this.attributes,e=t.stroke,n=t.lineWidth,r=Math.sin,i=Math.cos,A=Math.PI,o=10*i(A/6);return new Ac({style:{d:"M".concat(o/2,",").concat(10*r(A/6)," L-").concat(o/2,",0 L").concat(o/2,",-").concat(10*r(A/6)),stroke:e,lineWidth:n,transformOrigin:"center"}})}},{key:"applyArrowStyle",value:function(t,e){var n=t.opacity,r=t.stroke,i=t.strokeOpacity,A=t.lineWidth,o=t.increasedLineWidthForHitTesting;e.forEach(function(t){t&&(zt(n)||(t.style.opacity=n),zt(r)||(t.style.stroke=r),zt(i)||(t.style.strokeOpacity=i),zt(A)||(t.style.lineWidth=A),zt(o)||(t.style.increasedLineWidthForHitTesting=o))})}}])}(qa);bv.tag="arrow",bv.PARSED_STYLE_LIST=new Set([].concat(h(qa.PARSED_STYLE_LIST),["body","startHead","endHead","startHeadOffset","endHeadOffset","stroke","lineWidth","opacity","strokeOpacity"]));var Ev=Math.PI,xv=2*Ev,Cv=Math.sin,Fv=Math.cos,Mv=Math.acos,kv=Math.atan2,Qv=Math.sqrt,Sv=Math.max,Uv=Math.min,Tv=1e-4;[{name:"sr",inherits:!1,interpolable:!0,syntax:oi.LENGTH_PERCENTAGE},{name:"sr0",inherits:!1,interpolable:!0,syntax:oi.LENGTH_PERCENTAGE},{name:"startAngle",inherits:!1,interpolable:!0,syntax:oi.ANGLE},{name:"endAngle",inherits:!1,interpolable:!0,syntax:oi.ANGLE}].forEach(function(t){fc(t)});var Ov=function(t,e,n,r){return{x:t+n*Math.cos(r),y:e+n*Math.sin(r)}};function Nv(t,e,n,r,i,A,o){var s=t-n,a=e-r,c=A/Qv(s*s+a*a),l=c*a,u=-c*s,h=t+l,d=e+u,f=n+l,g=r+u,p=(h+f)/2,v=(d+g)/2,m=f-h,y=g-d,w=m*m+y*y,B=i-A,b=h*g-f*d,E=(y<0?-1:1)*Qv(Sv(0,B*B*w-b*b)),x=(b*y-m*E)/w,C=(-b*m-y*E)/w,F=(b*y+m*E)/w,M=(-b*m+y*E)/w,k=x-p,Q=C-v,S=F-p,U=M-v;return k*k+Q*Q>S*S+U*U&&(x=F,C=M),{cx:x,cy:C,x0:-l,y0:-u,x1:x*(i/B-1),y1:C*(i/B-1)}}function Iv(t,e){return(e=e<0&&t>=0?e+xv:e)-t<=Ev?0:1}var Lv=function(t){function e(t){var n;return s(this,e),(n=p(this,e,[t])).updatePath(),n}return m(e,t),c(e,[{key:"setAttribute",value:function(t,n,r){Nn(e,"setAttribute",this)([t,n,r]),["startAngle","endAngle","sr","sr0","radius"].indexOf(t)>-1&&this.updatePath()}},{key:"updatePath",value:function(){var t=this.parsedStyle,n=t.x,r=t.y,i=t.startAngle,A=t.endAngle,o=t.sr,s=t.sr0,a=t.radius,c=this.createPath(n,r,i?Nr(i):0,A?Nr(A):2*Math.PI,o||0,s||0,a||[0,0,0,0]);Nn(e,"setAttribute",this)(["d",c])}},{key:"createPath",value:function(t,e,n,r,i,A,o){if(!(i<=0)){var s=Ov(t,e,i,n),a=Ov(t,e,i,r),c=Ov(t,e,A,n),l=Ov(t,e,A,r);if(se(r-n,2*Math.PI)){var u=Ov(t,e,i,n+Math.PI),h=Ov(t,e,A,n+Math.PI),d=[["M",s.x,s.y],["A",i,i,0,1,1,u.x,u.y],["A",i,i,0,1,1,a.x,a.y],["M",c.x,c.y]];return A&&(d.push(["A",A,A,0,1,0,h.x,h.y]),d.push(["A",A,A,0,1,0,l.x,l.y])),d.push(["M",s.x,s.y]),d.push(["Z"]),d}var f=r-n,g=i*Fv(n),p=i*Cv(n),v=A*Fv(r),m=A*Cv(r),w=i*Fv(r),B=i*Cv(r),b=A*Fv(n),E=A*Cv(n),x=y(o,4),C=x[0],F=x[1],M=x[2],k=x[3],Q=(i-A)/2,S=Uv(Q,C),U=Uv(Q,F),T=Uv(Q,M),O=Uv(Q,k),N=Sv(S,U),I=Sv(T,O),L=N,D=I;if((N>Tv||I>Tv)&&f<Ev){var P=function(t,e,n,r,i,A,o,s){var a=n-t,c=r-e,l=o-i,u=s-A,h=u*a-l*c;if(!(h*h<Tv))return[t+(h=(l*(e-A)-u*(t-i))/h)*a,e+h*c]}(g,p,b,E,w,B,v,m);if(P){var R=g-P[0],H=p-P[1],_=w-P[0],G=B-P[1],K=1/Cv(Mv((R*_+H*G)/(Qv(R*R+H*H)*Qv(_*_+G*G)))/2),j=Qv(P[0]*P[0]+P[1]*P[1]);L=Uv(N,(i-j)/(K+1)),D=Uv(I,(A-j)/(K-1))}}var V=Iv(n,r),z=[];if(L>Tv){var W=Uv(C,L),Y=Uv(F,L),X=Nv(b,E,g,p,i,W),q=Nv(w,B,v,m,i,Y);if(z.push(["M",t+X.cx+X.x0,e+X.cy+X.y0]),L<N&&W===Y){var Z=kv(X.y0,X.x0),J=kv(q.y0,q.x0);z.push(["A",L,L,0,Iv(Z,J),1,t+q.cx+q.x0,e+q.cy+q.y0])}else{if(W>0){var $=kv(X.y0,X.x0),tt=kv(X.y1,X.x1),et=Ov(t,e,i,tt);z.push(["A",W,W,0,Iv($,tt),1,et.x,et.y])}var nt=kv(X.cy+X.y1,X.cx+X.x1),rt=kv(q.cy+q.y1,q.cx+q.x1),it=Ov(t,e,i,rt);if(z.push(["A",i,i,0,Iv(nt,rt),1,it.x,it.y]),Y>0){var At=kv(q.y1,q.x1),ot=kv(q.y0,q.x0);z.push(["A",Y,Y,0,Iv(At,ot),1,t+q.cx+q.x0,e+q.cy+q.y0])}}}else z.push(["M",s.x,s.y]),z.push(["A",i,i,0,V,1,a.x,a.y]);if(A<Tv)z.push(["L",l.x,l.y]);else if(D>Tv){var st=Uv(k,D),at=Uv(M,D),ct=Nv(v,m,0,0,A-i,at),lt=Nv(0,0,b,E,A-i,st);if(z.push(["L",t+ct.cx+ct.x0,e+ct.cy+ct.y0]),D<I&&st===at){var ut=kv(ct.y0,ct.x0),ht=kv(lt.y0,lt.x0),dt=Ov(t,e,A,ht);z.push(["A",L,L,0,Iv(ut,ht),1,dt.x,dt.y])}else{if(at>0){var ft=kv(ct.y0,ct.x0),gt=kv(ct.y1,ct.x1),pt=Ov(t,e,A-i,gt);z.push(["A",at,at,0,Iv(ft,gt),1,pt.x,pt.y])}var vt=kv(ct.cy+ct.y1,ct.cx+ct.x1),mt=kv(lt.cy+lt.y1,lt.cx+lt.x1),yt=Ov(t,e,A,mt);if(z.push(["A",A,A,0,Iv(mt,vt),0,yt.x,yt.y]),z.push(["L",yt.x,yt.y]),st>0){var wt=kv(lt.y1,lt.x1),Bt=kv(lt.y0,lt.x0);z.push(["A",st,st,0,Iv(wt,Bt),1,t+lt.cx+lt.x0,e+lt.cy+lt.y0])}}}else z.push(["L",l.x,l.y]),z.push(["A",A,A,0,V,0,c.x,c.y]);return z.push(["Z"]),z}}}])}(Ac);Lv.PARSED_STYLE_LIST=new Set([].concat(h(Ac.PARSED_STYLE_LIST),["x","y","sr","sr0","radius","startAngle","endAngle"]));const Dv={duration:500},Pv={duration:1e3,easing:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",iterations:1,fill:"both"};var Rv,Hv,_v,Gv,Kv,jv,Vv,zv,Wv;!function(t){t.NodeAdded="NodeAdded",t.NodeUpdated="NodeUpdated",t.NodeRemoved="NodeRemoved",t.EdgeAdded="EdgeAdded",t.EdgeUpdated="EdgeUpdated",t.EdgeRemoved="EdgeRemoved",t.ComboAdded="ComboAdded",t.ComboUpdated="ComboUpdated",t.ComboRemoved="ComboRemoved"}(Rv||(Rv={})),function(t){t.DRAW="draw",t.COLLAPSE="collapse",t.EXPAND="expand",t.TRANSFORM="transform"}(Hv||(Hv={})),t.CanvasEvent=void 0,function(t){t.CLICK="canvas:click",t.DBLCLICK="canvas:dblclick",t.POINTER_OVER="canvas:pointerover",t.POINTER_LEAVE="canvas:pointerleave",t.POINTER_ENTER="canvas:pointerenter",t.POINTER_MOVE="canvas:pointermove",t.POINTER_OUT="canvas:pointerout",t.POINTER_DOWN="canvas:pointerdown",t.POINTER_UP="canvas:pointerup",t.CONTEXT_MENU="canvas:contextmenu",t.DRAG_START="canvas:dragstart",t.DRAG="canvas:drag",t.DRAG_END="canvas:dragend",t.DRAG_ENTER="canvas:dragenter",t.DRAG_OVER="canvas:dragover",t.DRAG_LEAVE="canvas:dragleave",t.DROP="canvas:drop",t.WHEEL="canvas:wheel"}(t.CanvasEvent||(t.CanvasEvent={})),t.ComboEvent=void 0,(_v=t.ComboEvent||(t.ComboEvent={})).CLICK="combo:click",_v.DBLCLICK="combo:dblclick",_v.POINTER_OVER="combo:pointerover",_v.POINTER_LEAVE="combo:pointerleave",_v.POINTER_ENTER="combo:pointerenter",_v.POINTER_MOVE="combo:pointermove",_v.POINTER_OUT="combo:pointerout",_v.POINTER_DOWN="combo:pointerdown",_v.POINTER_UP="combo:pointerup",_v.CONTEXT_MENU="combo:contextmenu",_v.DRAG_START="combo:dragstart",_v.DRAG="combo:drag",_v.DRAG_END="combo:dragend",_v.DRAG_ENTER="combo:dragenter",_v.DRAG_OVER="combo:dragover",_v.DRAG_LEAVE="combo:dragleave",_v.DROP="combo:drop",t.CommonEvent=void 0,(Gv=t.CommonEvent||(t.CommonEvent={})).CLICK="click",Gv.DBLCLICK="dblclick",Gv.POINTER_OVER="pointerover",Gv.POINTER_LEAVE="pointerleave",Gv.POINTER_ENTER="pointerenter",Gv.POINTER_MOVE="pointermove",Gv.POINTER_OUT="pointerout",Gv.POINTER_DOWN="pointerdown",Gv.POINTER_UP="pointerup",Gv.CONTEXT_MENU="contextmenu",Gv.DRAG_START="dragstart",Gv.DRAG="drag",Gv.DRAG_END="dragend",Gv.DRAG_ENTER="dragenter",Gv.DRAG_OVER="dragover",Gv.DRAG_LEAVE="dragleave",Gv.DROP="drop",Gv.KEY_DOWN="keydown",Gv.KEY_UP="keyup",Gv.WHEEL="wheel",Gv.PINCH="pinch",t.ContainerEvent=void 0,(Kv=t.ContainerEvent||(t.ContainerEvent={})).KEY_DOWN="keydown",Kv.KEY_UP="keyup",t.EdgeEvent=void 0,(jv=t.EdgeEvent||(t.EdgeEvent={})).CLICK="edge:click",jv.DBLCLICK="edge:dblclick",jv.POINTER_OVER="edge:pointerover",jv.POINTER_LEAVE="edge:pointerleave",jv.POINTER_ENTER="edge:pointerenter",jv.POINTER_MOVE="edge:pointermove",jv.POINTER_OUT="edge:pointerout",jv.POINTER_DOWN="edge:pointerdown",jv.POINTER_UP="edge:pointerup",jv.CONTEXT_MENU="edge:contextmenu",jv.DRAG_ENTER="edge:dragenter",jv.DRAG_OVER="edge:dragover",jv.DRAG_LEAVE="edge:dragleave",jv.DROP="edge:drop",t.GraphEvent=void 0,(Vv=t.GraphEvent||(t.GraphEvent={})).BEFORE_CANVAS_INIT="beforecanvasinit",Vv.AFTER_CANVAS_INIT="aftercanvasinit",Vv.BEFORE_SIZE_CHANGE="beforesizechange",Vv.AFTER_SIZE_CHANGE="aftersizechange",Vv.BEFORE_ELEMENT_CREATE="beforeelementcreate",Vv.AFTER_ELEMENT_CREATE="afterelementcreate",Vv.BEFORE_ELEMENT_UPDATE="beforeelementupdate",Vv.AFTER_ELEMENT_UPDATE="afterelementupdate",Vv.BEFORE_ELEMENT_DESTROY="beforeelementdestroy",Vv.AFTER_ELEMENT_DESTROY="afterelementdestroy",Vv.BEFORE_ELEMENT_TRANSLATE="beforeelementtranslate",Vv.AFTER_ELEMENT_TRANSLATE="afterelementtranslate",Vv.BEFORE_DRAW="beforedraw",Vv.AFTER_DRAW="afterdraw",Vv.BEFORE_RENDER="beforerender",Vv.AFTER_RENDER="afterrender",Vv.BEFORE_ANIMATE="beforeanimate",Vv.AFTER_ANIMATE="afteranimate",Vv.BEFORE_LAYOUT="beforelayout",Vv.AFTER_LAYOUT="afterlayout",Vv.BEFORE_STAGE_LAYOUT="beforestagelayout",Vv.AFTER_STAGE_LAYOUT="afterstagelayout",Vv.BEFORE_TRANSFORM="beforetransform",Vv.AFTER_TRANSFORM="aftertransform",Vv.BATCH_START="batchstart",Vv.BATCH_END="batchend",Vv.BEFORE_DESTROY="beforedestroy",Vv.AFTER_DESTROY="afterdestroy",Vv.BEFORE_RENDERER_CHANGE="beforerendererchange",Vv.AFTER_RENDERER_CHANGE="afterrendererchange",t.HistoryEvent=void 0,(zv=t.HistoryEvent||(t.HistoryEvent={})).UNDO="undo",zv.REDO="redo",zv.CANCEL="cancel",zv.ADD="add",zv.CLEAR="clear",zv.CHANGE="change",t.NodeEvent=void 0,(Wv=t.NodeEvent||(t.NodeEvent={})).CLICK="node:click",Wv.DBLCLICK="node:dblclick",Wv.POINTER_OVER="node:pointerover",Wv.POINTER_LEAVE="node:pointerleave",Wv.POINTER_ENTER="node:pointerenter",Wv.POINTER_MOVE="node:pointermove",Wv.POINTER_OUT="node:pointerout",Wv.POINTER_DOWN="node:pointerdown",Wv.POINTER_UP="node:pointerup",Wv.CONTEXT_MENU="node:contextmenu",Wv.DRAG_START="node:dragstart",Wv.DRAG="node:drag",Wv.DRAG_END="node:dragend",Wv.DRAG_ENTER="node:dragenter",Wv.DRAG_OVER="node:dragover",Wv.DRAG_LEAVE="node:dragleave",Wv.DROP="node:drop";const Yv="combo",Xv="tree";var qv;t.ExtensionCategory=void 0,(qv=t.ExtensionCategory||(t.ExtensionCategory={})).NODE="node",qv.EDGE="edge",qv.COMBO="combo",qv.THEME="theme",qv.PALETTE="palette",qv.LAYOUT="layout",qv.BEHAVIOR="behavior",qv.PLUGIN="plugin",qv.ANIMATION="animation",qv.TRANSFORM="transform",qv.SHAPE="shape";const Zv={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function Jv(t,e){var n;const r=null===(n=Zv[t])||void 0===n?void 0:n[e];if(r)return r}const $v="5.0.51";function tm(t){return`[G6 v${$v}] ${t}`}const em=t=>{console.warn(tm(t))};function nm(e){const{theme:n}=e;if(!n)return{};const r=Jv(t.ExtensionCategory.THEME,n);return r||(em(`The theme of ${n} is not registered.`),{})}function rm(t,e){if(Array.isArray(t)&&0===t.length)return null;const n=Array.isArray(t)?t[0]:t,r=Array.isArray(t)?t.slice(1):e||[];return new Proxy(n,{get:(t,e)=>"function"!=typeof t[e]||["onframe","onfinish"].includes(e)?"finished"===e?Promise.all([n.finished,...r.map(t=>t.finished)]):Reflect.get(t,e):(...n)=>{t[e](...n),r.forEach(t=>{var r;return null===(r=t[e])||void 0===r?void 0:r.call(t,...n)})},set:(t,e,n)=>(["onframe","onfinish"].includes(e)||r.forEach(t=>{t[e]=n}),Reflect.set(t,e,n))})}function im(t){const e=t.reduce((t,e)=>(Object.entries(e).forEach(([e,n])=>{void 0===t[e]?t[e]=[n]:t[e].push(n)}),t),{});Object.entries(e).forEach(([n,r])=>{(r.length!==t.length||r.some(t=>zt(t))||r.every(t=>!["sourceNode","targetNode","childrenNode"].includes(n)&&Me(t,r[0])))&&delete e[n]});const n=Object.entries(e).reduce((t,[e,n])=>(n.forEach((n,r)=>{t[r]?t[r][e]=n:t[r]={[e]:n}}),t),[]);return 0!==t.length&&0===n.length&&n.push({_:0},{_:0}),n}function Am(t){switch(t){case"opacity":return 1;case"x":case"y":case"z":case"zIndex":return 0;case"visibility":return"visible";case"collapsed":return!1;case"states":return[];default:return}}function om(t,e){const{animation:n}=t;if(!1===n||!1===e)return!1;const r=Object.assign({},Dv);return Yt(n)&&Object.assign(r,n),Yt(e)&&Object.assign(r,e),r}function sm(e,n,r,i){var A,o;const{animation:s}=e;if(!1===s||!1===i)return[];const a=null===(A=null==e?void 0:e[n])||void 0===A?void 0:A.animation;if(!1===a)return[];const c=null==a?void 0:a[r];if(!1===c)return[];const l=null===(o=nm(e)[n])||void 0===o?void 0:o.animation,u=(e=[])=>function(e){if("string"==typeof e){return Jv(t.ExtensionCategory.ANIMATION,e)||(em(`The animation of ${e} is not registered.`),[])}return e}(e).map(t=>Object.assign(Object.assign(Object.assign(Object.assign({},Pv),Yt(s)&&s),t),Yt(i)&&i));if(c)return u(c);if(!l)return[];const h=l[r];return!1===h?[]:u(h)}function am(t,e,n,r=[]){if(!r&&0===t&&0===e&&0===n)return null;if(Array.isArray(r)){let i=-1;const A=[];for(let o=0;o<r.length;o++){const s=r[o];if("translate"===s[0]){if(s[1]===t&&s[2]===e)return null;i=o,A.push(["translate",t,e])}else if("translate3d"===s[0]){if(s[1]===t&&s[2]===e&&s[3]===n)return null;i=o,A.push(["translate3d",t,e,null!=n?n:0])}else A.push(s)}return-1===i&&A.splice(0,0,oe(n)?["translate3d",t,e,null!=n?n:0]:["translate",t,e]),0===A.length?null:A}const i=r?r.replace(/translate(3d)?\([^)]*\)/g,""):"";return 0===n?`translate(${t}, ${e})${i}`:`translate3d(${t}, ${e}, ${n})${i}`}const cm=(t,e,n)=>{if(!n.length)return null;const[r,i]=e;let A;const o=n.map(e=>{var{fields:n,shape:o,states:s}=e,a=He(e,["fields","shape","states"]);const c=(e=>{var n;if(e){const A=t.getShape(e);if(!A)return null;const o=`get${he(e)}Style`,s=(null===(n=null==t?void 0:t[o])||void 0===n?void 0:n.bind(t))||(t=>t);return{shape:A,fromStyle:(null==s?void 0:s(r))||{},toStyle:(null==s?void 0:s(i))||{}}}return{shape:t,fromStyle:r,toStyle:i}})(o);if(!c)return null;const{shape:l,fromStyle:u,toStyle:h}=c,d=[{},{}];if(n.forEach(t=>{var e,n;Object.assign(d[0],{[t]:null!==(e=u[t])&&void 0!==e?e:Am(t)}),Object.assign(d[1],{[t]:null!==(n=h[t])&&void 0!==n?n:Am(t)})}),d.some(t=>Object.keys(t).some(t=>["x","y","z"].includes(t)))){const{x:t=0,y:e=0,z:n,transform:r=""}=l.attributes||{};d.forEach(i=>{var A,o,s;i.transform=am(null!==(A=i.x)&&void 0!==A?A:t,null!==(o=i.y)&&void 0!==o?o:e,null!==(s=i.z)&&void 0!==s?s:n,r)})}const f=l.animate(im(d),a);return void 0===o&&(A=f),f}).filter(Boolean),s=A||(null==o?void 0:o[0]);return s?rm(s,o.filter(t=>t!=t)):null},lm=[{fields:["x","y"]}],um=lm,hm=[{fields:["sourceNode","targetNode"]}],dm=hm,fm=[{fields:["childrenNode","x","y"]}],gm=fm;function pm(t){return t instanceof Float32Array||!(!Array.isArray(t)||2!==t.length&&3!==t.length)&&t.every(t=>"number"==typeof t)}function vm(t,e,n){return t>=e&&t<=n}function mm(t=0){if(Array.isArray(t)){const[e=0,n=e,r=e,i=n]=t;return[e,n,r,i]}return[t,t,t,t]}function ym(t=0){const e=mm(t);return e[0]+e[2]}function wm(t){return t.max[0]-t.min[0]}function Bm(t){return t.max[1]-t.min[1]}function bm(t){return[wm(t),Bm(t)]}function Em(t,e){const n=pm(t)?xm(t):t.getShape("key").getBounds();return e?Cm(n,e):n}function xm(t){const[e,n,r=0]=t,i=new br;return i.setMinMax([e,n,r],[e,n,r]),i}function Cm(t,e){const[n,r,i,A]=mm(e),[o,s,a]=t.min,[c,l,u]=t.max,h=new br;return h.setMinMax([o-A,s-n,a],[c+r,l+i,u]),h}function Fm(t){if(0===t.length)return new br;if(1===t.length)return t[0];const e=new br;e.setMinMax(t[0].min,t[0].max);for(let n=1;n<t.length;n++){const r=t[n];e.setMinMax([Math.min(e.min[0],r.min[0]),Math.min(e.min[1],r.min[1]),Math.min(e.min[2],r.min[2])],[Math.max(e.max[0],r.max[0]),Math.max(e.max[1],r.max[1]),Math.max(e.max[2],r.max[2])])}return e}function Mm(t,e){return vm(t[0],e.min[0],e.max[0])&&vm(t[1],e.min[1],e.max[1])}function km(t,e,n=!1){const{min:[r,i],max:[A,o]}=e,s=(t[1]===i||t[1]===o)&&(n||vm(t[0],r,A)),a=(t[0]===r||t[0]===A)&&(n||vm(t[1],i,o));return s||a}function Qm(t,e){const{center:n}=e;return t[0]===n[0]&&t[1]===n[1]}function Sm(t,e){const[n,r]=t,[i,A]=e.min,[o,s]=e.max,a=n-i,c=o-n,l=r-A,u=s-r,h=Math.min(a,c,l,u);return h===a?"left":h===c?"right":h===l?"top":h===u?"bottom":"left"}function Um(t,e){const n=me(t);if(Mm(t,e)){switch(Sm(t,e)){case"left":n[0]=e.min[0];break;case"right":n[0]=e.max[0];break;case"top":n[1]=e.min[1];break;case"bottom":n[1]=e.max[1]}}else{const[r,i]=t,[A,o]=e.min,[s,a]=e.max;n[0]=vm(r,A,s)?r:r<A?A:s,n[1]=vm(i,o,a)?i:i<o?o:a}return n}var Tm=function(t,e){return t===e},Om=function(){function t(t,e){void 0===e&&(e=null),this.value=t,this.next=e}return t.prototype.toString=function(t){return t?t(this.value):"".concat(this.value)},t}(),Nm=function(){function t(t){void 0===t&&(t=Tm),this.head=null,this.tail=null,this.compare=t}return t.prototype.prepend=function(t){var e=new Om(t,this.head);return this.head=e,this.tail||(this.tail=e),this},t.prototype.append=function(t){var e=new Om(t);return this.head?(this.tail.next=e,this.tail=e,this):(this.head=e,this.tail=e,this)},t.prototype.delete=function(t){if(!this.head)return null;for(var e=null;this.head&&this.compare(this.head.value,t);)e=this.head,this.head=this.head.next;var n=this.head;if(null!==n)for(;n.next;)this.compare(n.next.value,t)?(e=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,t)&&(this.tail=n),e},t.prototype.find=function(t){var e=t.value,n=void 0===e?void 0:e,r=t.callback,i=void 0===r?void 0:r;if(!this.head)return null;for(var A=this.head;A;){if(i&&i(A.value))return A;if(void 0!==n&&this.compare(A.value,n))return A;A=A.next}return null},t.prototype.deleteTail=function(){var t=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,t;for(var e=this.head;e.next;)e.next.next?e=e.next:e.next=null;return this.tail=e,t},t.prototype.deleteHead=function(){if(!this.head)return null;var t=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),t},t.prototype.fromArray=function(t){var e=this;return t.forEach(function(t){return e.append(t)}),this},t.prototype.toArray=function(){for(var t=[],e=this.head;e;)t.push(e),e=e.next;return t},t.prototype.reverse=function(){for(var t=this.head,e=null,n=null;t;)n=t.next,t.next=e,e=t,t=n;this.tail=this.head,this.head=e},t.prototype.toString=function(t){return void 0===t&&(t=void 0),this.toArray().map(function(e){return e.toString(t)}).toString()},t}(),Im=function(t,e,n){void 0===e&&(e=[]);var r=e.filter(function(e){return e.source===t||e.target===t});if("target"===n){return r.filter(function(e){return e.source===t}).map(function(t){return t.target})}if("source"===n){return r.filter(function(e){return e.target===t}).map(function(t){return t.source})}return r.map(function(e){return e.source===t?e.target:e.source})},Lm={}.toString,Dm=function(t,e){return Lm.call(t)==="[object "+e+"]"},Pm=function(t){return Dm(t,"Function")},Rm=function(t){return Array.isArray?Array.isArray(t):Dm(t,"Array")};var Hm,_m=Object.values?function(t){return Object.values(t)}:function(t){var e=[];return function(t,e){var n,r;if(t)if(Rm(t))for(var i=0,A=t.length;i<A&&!1!==e(t[i],i);i++);else if(r=typeof(n=t),null!==n&&"object"===r||"function"===r)for(var o in t)if(t.hasOwnProperty(o)&&!1===e(t[o],o))break}(t,function(n,r){Pm(t)&&"prototype"===r||e.push(n)}),e};!function(t,e){if(!Pm(t))throw new TypeError("Expected a function");var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var A=e?e.apply(this,r):r[0],o=n.cache;if(o.has(A))return o.get(A);var s=t.apply(this,r);return o.set(A,s),s};n.cache=new Map}(function(t,e){void 0===e&&(e={});var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,A=e.fontStyle,o=e.fontVariant;return Hm||(Hm=document.createElement("canvas").getContext("2d")),Hm.font=[A,o,i,n+"px",r].join(" "),Hm.measureText(function(t){return Dm(t,"String")}(t)?t:"").width},function(t,e){return void 0===e&&(e={}),function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var A=arguments[e],o=0,s=A.length;o<s;o++,i++)r[i]=A[o];return r}([t],_m(e)).join("")});function Gm(t,e,n,r){if(t===e)return[t];if(r[e])return r[e];for(var i=[],A=0,o=n[e];A<o.length;A++){var s=Gm(t,o[A],n,r);if(!s)return;for(var a=0,c=s;a<c.length;a++){var l=c[a];Rm(l)?i.push(je(je([],l,!0),[e],!1)):i.push([l,e])}}return r[e]=i,r[e]}var Km,jm=function(t,e,n,r,i){var A=function(t,e,n,r){var i=t.nodes,A=void 0===i?[]:i,o=t.edges,s=void 0===o?[]:o,a={},c={},l={};A.forEach(function(t,n){var r=t.id;c[r]=1/0,r===e&&(c[r]=0)});for(var u=A.length,h=function(t){var e=function(t,e,n){for(var r,i=1/0,A=0;A<e.length;A++){var o=e[A].id;!n[o]&&t[o]<=i&&(i=t[o],r=e[A])}return r}(c,A,a),i=e.id;if(a[i]=!0,c[i]===1/0)return"continue";var o=[];o=n?function(t,e){return e.filter(function(e){return e.source===t})}(i,s):function(t,e){return e.filter(function(e){return e.source===t||e.target===t})}(i,s),o.forEach(function(t){var n=t.target,A=t.source,o=n===i?A:n,s=r&&t[r]?t[r]:1;c[o]>c[e.id]+s?(c[o]=c[e.id]+s,l[o]=[e.id]):c[o]===c[e.id]+s&&l[o].push(e.id)})},d=0;d<u;d++)h();l[e]=[e];var f={};for(var g in c)c[g]!==1/0&&Gm(e,g,l,f);var p={};for(var g in f)p[g]=f[g][0];return{length:c,path:p,allPath:f}}(t,e,r,i),o=A.length,s=A.path,a=A.allPath;return{length:o[n],path:s[n],allPath:a[n]}};!function(t){t.EuclideanDistance="euclideanDistance"}(Km||(Km={}));function Vm(t){if(void 0!==t.id)return t.id;if(void 0!==t.source&&void 0!==t.target)return`${t.source}-${t.target}`;throw new Error(tm("The datum does not have available id."))}function zm(t){return t.combo}function Wm(t,e){const n={nodes:(t.nodes||[]).map(Vm),edges:(t.edges||[]).map(Vm),combos:(t.combos||[]).map(Vm)};return e?Object.values(n).flat():n}!function(){function t(t){void 0===t&&(t=10),this.linkedList=new Nm,this.maxStep=t}Object.defineProperty(t.prototype,"length",{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),t.prototype.isEmpty=function(){return!this.linkedList.head},t.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},t.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},t.prototype.push=function(t){this.linkedList.prepend(t),this.length>this.maxStep&&this.linkedList.deleteTail()},t.prototype.pop=function(){var t=this.linkedList.deleteHead();return t?t.value:null},t.prototype.toArray=function(){return this.linkedList.toArray().map(function(t){return t.value})},t.prototype.clear=function(){for(;!this.isEmpty();)this.pop()}}();const Ym=(t,e,n)=>{var r;switch(n.type){case"degree":{const i=new Map;return null===(r=t.nodes)||void 0===r||r.forEach(t=>{const r=e(Vm(t),n.direction).length;i.set(Vm(t),r)}),i}case"betweenness":return qm(t,n.directed,n.weightPropertyName);case"closeness":return Zm(t,n.directed,n.weightPropertyName);case"eigenvector":return $m(t,n.directed);case"pagerank":return Jm(t,n.epsilon,n.linkProb);default:return Xm(t)}},Xm=t=>{var e;const n=new Map;return null===(e=t.nodes)||void 0===e||e.forEach(t=>{n.set(Vm(t),0)}),n},qm=(t,e,n)=>{const r=Xm(t),{nodes:i=[]}=t;return i.forEach(A=>{i.forEach(i=>{if(A!==i){const{allPath:o}=jm(t,Vm(A),Vm(i),e,n),s=o.length;o.flat().forEach(t=>{t!==Vm(A)&&t!==Vm(i)&&r.set(t,r.get(t)+1/s)})}})}),r},Zm=(t,e,n)=>{const r=new Map,{nodes:i=[]}=t;return i.forEach(A=>{const o=i.reduce((r,i)=>{if(A!==i){const{length:o}=jm(t,Vm(A),Vm(i),e,n);r+=o}return r},0);r.set(Vm(A),1/o)}),r},Jm=(t,e,n)=>{var r;const i=new Map,A=function(t,e,n){"number"!=typeof e&&(e=1e-6),"number"!=typeof n&&(n=.85);for(var r,i=1,A=0,o=1e3,s=t.nodes,a=void 0===s?[]:s,c=t.edges,l=void 0===c?[]:c,u=a.length,h={},d={},f=0;f<u;++f)h[p=(B=a[f]).id]=1/u,d[p]=1/u;for(var g=function(t){var e={},n=t.nodes,r=void 0===n?[]:n,i=t.edges,A=void 0===i?[]:i;return r.forEach(function(t){e[t.id]={degree:0,inDegree:0,outDegree:0}}),A.forEach(function(t){e[t.source].degree++,e[t.source].outDegree++,e[t.target].degree++,e[t.target].inDegree++}),e}(t);o>0&&i>e;){for(A=0,f=0;f<u;++f){var p=(B=a[f]).id;if(r=0,0===g[B.id].inDegree)h[p]=0;else{for(var v=Im(p,l,"source"),m=0;m<v.length;++m){var y=v[m],w=g[y].outDegree;w>0&&(r+=d[y]/w)}h[p]=n*r,A+=h[p]}}for(A=(1-A)/u,i=0,f=0;f<u;++f){var B;r=h[p=(B=a[f]).id]+A,i+=Math.abs(r-d[p]),d[p]=r}o-=1}return d}(t,e,n);return null===(r=t.nodes)||void 0===r||r.forEach(t=>{i.set(Vm(t),A[Vm(t)])}),i},$m=(t,e)=>{const{nodes:n=[]}=t,r=ty(t,e),i=ey(r,n.length),A=new Map;return n.forEach((t,e)=>{A.set(Vm(t),i[e])}),A},ty=(t,e)=>{const{nodes:n=[],edges:r=[]}=t,i=Array(n.length).fill(null).map(()=>Array(n.length).fill(0));return r.forEach(({source:t,target:r})=>{const A=n.findIndex(e=>Vm(e)===t),o=n.findIndex(t=>Vm(t)===r);e?i[A][o]=1:(i[A][o]=1,i[o][A]=1)}),i},ey=(t,e,n=100,r=1e-6)=>{let i=Array(e).fill(1),A=1/0;for(let o=0;o<n&&A>r;o++){const n=Array(e).fill(0);for(let r=0;r<e;r++)for(let A=0;A<e;A++)n[r]+=t[r][A]*i[A];const r=Math.sqrt(n.reduce((t,e)=>t+e*e,0));for(let t=0;t<e;t++)n[t]/=r;A=Math.sqrt(n.reduce((t,e,n)=>t+(e-i[n])*e,0)),i=n}return i};function ny(t,e,n,r=Me){const i=new Map(t.map(t=>[n(t),t])),A=new Map(e.map(t=>[n(t),t])),o=new Set(i.keys()),s=new Set(A.keys()),a=[],c=[],l=[],u=[];return s.forEach(t=>{o.has(t)?r(i.get(t),A.get(t))?u.push(A.get(t)):c.push(A.get(t)):a.push(A.get(t))}),o.forEach(t=>{s.has(t)||l.push(i.get(t))}),{enter:a,exit:l,keep:u,update:c}}function ry(t,e,n){t.forEach(t=>{(t=>{n&&!n(t)||(t.style.visibility=e)})(t)})}class iy{constructor(t){this.extensions=[],this.extensionMap={},this.context=t}setExtensions(t){const e=function(t,e,n){const r={},i=t=>(t in r||(r[t]=0),`${e}-${t}-${r[t]++}`);return n.map(e=>"string"==typeof e?{type:e,key:i(e)}:"function"==typeof e?e.call(t):e.key?e:Object.assign(Object.assign({},e),{key:i(e.type)}))}(this.context.graph,this.category,t),{enter:n,update:r,exit:i,keep:A}=ny(this.extensions,e,t=>t.key);this.createExtensions(n),this.updateExtensions([...r,...A]),this.destroyExtensions(i),this.extensions=e}createExtension(t){const{category:e}=this,{key:n,type:r}=t,i=Jv(e,r);if(!i)return em(`The extension ${r} of ${e} is not registered.`);const A=new i(this.context,t);A.initialized=!0,this.extensionMap[n]=A}createExtensions(t){t.forEach(t=>this.createExtension(t))}updateExtension(t){const{key:e}=t,n=this.extensionMap[e];n&&n.update(t)}updateExtensions(t){t.forEach(t=>this.updateExtension(t))}destroyExtension(t){const e=this.extensionMap[t];e&&(e.initialized&&!e.destroyed&&e.destroy(),delete this.extensionMap[t])}destroyExtensions(t){t.forEach(({key:t})=>this.destroyExtension(t))}destroy(){this.destroyExtensions(this.extensions),this.context={},this.extensions=[],this.extensionMap={}}}class Ay{constructor(t,e){this.events=[],this.initialized=!1,this.destroyed=!1,this.context=t,this.options=e}update(t){this.options=Object.assign(this.options,t)}destroy(){this.context={},this.options={},this.destroyed=!0}}class oy extends Ay{}class sy extends oy{constructor(t,e){super(t,Object.assign({},sy.defaultOptions,e)),this.isOverlapping=(t,e)=>e.some(e=>t.intersects(e)),this.occupiedBounds=[],this.detectLabelCollision=t=>{const e=this.context.viewport,n={show:[],hide:[]};return this.occupiedBounds=[],t.forEach(t=>{const r=t.getShape("label").getRenderBounds();e.isInViewport(r,!0)&&!this.isOverlapping(r,this.occupiedBounds)?(n.show.push(t),this.occupiedBounds.push(Cm(r,this.options.padding))):n.hide.push(t)}),n},this.hideLabelIfExceedViewport=(t,e)=>{const{exit:n}=ny(t,e,t=>t.id);null==n||n.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(t,e)=>{const{model:n}=this.context,r=n.getData(),i=n.getRelatedEdgesData.bind(n);return t.map(t=>(this.nodeCentralities.has(t.id)||(this.nodeCentralities=Ym(r,i,e)),{node:t,centrality:this.nodeCentralities.get(t.id)})).sort((t,e)=>e.centrality-t.centrality).map(t=>t.node)},this.sortLabelElementsInView=t=>{const{sort:e,sortNode:n,sortCombo:r,sortEdge:i}=this.options,{model:A}=this.context;if(Vt(e))return t.sort((t,n)=>e(A.getElementDataById(t.id),A.getElementDataById(n.id)));const{node:o=[],edge:s=[],combo:a=[]}=ie(t,t=>t.type),c=Vt(r)?a.sort((t,e)=>r(...A.getComboData([t.id,e.id]))):a,l=Vt(n)?o.sort((t,e)=>n(...A.getNodeData([t.id,e.id]))):this.sortNodesByCentrality(o,n),u=Vt(i)?s.sort((t,e)=>i(...A.getEdgeData([t.id,e.id]))):s;return[...c,...l,...u]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=t=>{var e;if("zIndex"===(null===(e=t.data)||void 0===e?void 0:e.stage))return;if(!this.validate(t))return void(this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear()));const n=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,n),this.labelElementsInView=n;const r=this.sortLabelElementsInView(this.labelElementsInView),{show:i,hide:A}=this.detectLabelCollision(r);for(let t=i.length-1;t>=0;t--)this.showLabel(i[t]);A.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=t=>{const e=t.getShape("label");e&&ry(e,"hidden"),this.hiddenElements.set(t.id,t)},this.showLabel=t=>{const e=t.getShape("label");e&&ry(e,"visible"),t.toFront(),this.hiddenElements.delete(t.id)},this.onTransform=Oe(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=t=>{this.enableToggle&&this.onToggleVisibility(t)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=t=>{this.onToggleVisibility(t),this.enableToggle=!0},this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){const{elementMap:t}=this.context.element,e=[];for(const n in t){const r=t[n];r.isVisible()&&r.getShape("label")&&e.push(r)}return e}getLabelElementsInView(){const t=this.context.viewport;return this.getLabelElements().filter(e=>t.isInViewport(e.getShape("key").getRenderBounds()))}bindEvents(){const{graph:e}=this.context;e.on(t.GraphEvent.BEFORE_RENDER,this.onBeforeRender),e.on(t.GraphEvent.AFTER_RENDER,this.onAfterRender),e.on(t.GraphEvent.AFTER_DRAW,this.toggle),e.on(t.GraphEvent.AFTER_LAYOUT,this.toggle),e.on(t.GraphEvent.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(t.GraphEvent.BEFORE_RENDER,this.onBeforeRender),e.off(t.GraphEvent.AFTER_RENDER,this.onAfterRender),e.off(t.GraphEvent.AFTER_DRAW,this.toggle),e.off(t.GraphEvent.AFTER_LAYOUT,this.toggle),e.off(t.GraphEvent.AFTER_TRANSFORM,this.onTransform)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}sy.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:"degree"}};const ay=[0,0,0];function cy(t,e){return t.map((t,n)=>t+e[n])}function ly(t,e){return t.map((t,n)=>t-e[n])}function uy(t,e){return"number"==typeof e?t.map(t=>t*e):t.map((t,n)=>t*e[n])}function hy(t,e){return"number"==typeof e?t.map(t=>t/e):t.map((t,n)=>t/e[n])}function dy(t,e){return t.map(t=>t*e)}function fy(t,e){return Math.sqrt(t.reduce((t,n,r)=>t+Math.pow(n-e[r]||0,2),0))}function gy(t,e){return t.reduce((t,n,r)=>t+Math.abs(n-e[r]),0)}function py(t){const e=t.reduce((t,e)=>t+Math.pow(e,2),0);return t.map(t=>t/Math.sqrt(e))}function vy(t,e,n=!1){const r=t[0]*e[1]-t[1]*e[0];let i=Math.acos(uy(t,e).reduce((t,e)=>t+e,0)/(fy(t,ay)*fy(e,ay)));return n&&r<0&&(i=2*Math.PI-i),i}function my(t,e=!0){return e?[-t[1],t[0]]:[t[1],-t[0]]}function yy(t,e){return t.map(t=>t%e)}function wy(t){return[t[0],t[1]]}function By(t){return 2===t.length?[t[0],t[1],0]:t}function by(t){const[e,n]=t;return e||n?Math.atan2(n,e):0}function Ey(t,e){const[n,r]=t;if(e%360==0)return[n,r];const i=e*Math.PI/180,A=Math.cos(i),o=Math.sin(i);return[n*A-r*o,n*o+r*A]}function xy(t,e){const[n,r]=t,[i,A]=e;return function(t,e){const n=By(t),r=By(e);return[n[1]*r[2]-n[2]*r[1],n[2]*r[0]-n[0]*r[2],n[0]*r[1]-n[1]*r[0]]}(ly(n,r),ly(i,A)).every(t=>0===t)}function Cy(t,e,n=!1){if(xy(t,e))return;const[r,i]=t,[A,o]=e,s=((r[0]-A[0])*(A[1]-o[1])-(r[1]-A[1])*(A[0]-o[0]))/((r[0]-i[0])*(A[1]-o[1])-(r[1]-i[1])*(A[0]-o[0])),a=o[0]-A[0]?(r[0]-A[0]+s*(i[0]-r[0]))/(o[0]-A[0]):(r[1]-A[1]+s*(i[1]-r[1]))/(o[1]-A[1]);return n||vm(s,0,1)&&vm(a,0,1)?[r[0]+s*(i[0]-r[0]),r[1]+s*(i[1]-r[1])]:void 0}function Fy(t){if(Array.isArray(t))return vm(t[0],0,1)&&vm(t[1],0,1)?t:[.5,.5];const e=t.split("-");return[e.includes("left")?0:e.includes("right")?1:.5,e.includes("top")?0:e.includes("bottom")?1:.5]}function My(t){const{x:e=0,y:n=0,z:r=0}=t.style||{};return[+e,+n,+r]}function ky(t){const{x:e,y:n,z:r}=t.style||{};return void 0!==e||void 0!==n||void 0!==r}function Qy(t,e="center"){return function(t,e){const[n,r]=e,{min:i,max:A}=t;return[i[0]+n*(A[0]-i[0]),i[1]+r*(A[1]-i[1])]}(t,Fy(e))}function Sy(t){var e;return[t.x,t.y,null!==(e=t.z)&&void 0!==e?e:0]}function Uy(t){var e;return{x:t[0],y:t[1],z:null!==(e=t[2])&&void 0!==e?e:0}}function Ty(t,e=0){return t.map(t=>parseFloat(t.toFixed(e)))}function Oy(t,e,n,r=!1){if(Me(t,e))return t;const i=py(r?ly(t,e):ly(e,t)),A=[i[0]*n,i[1]*n];return cy(wy(t),A)}function Ny(t,e){return t[1]===e[1]}function Iy(t,e){return Ny(t,e)||function(t,e){return t[0]===e[0]}(t,e)}function Ly(t,e,n){return xy([t,e],[e,n])}function Dy(t,e){return[2*e[0]-t[0],2*e[1]-t[1]]}function Py(t,e,n,r=!0,i=!1){for(let A=0;A<n.length;A++){let o=n[A],s=n[(A+1)%n.length];r&&(o=cy(e,o),s=cy(e,s));const a=Cy([e,i?Dy(t,e):t],[o,s]);if(a)return{point:a,line:[o,s]}}return{point:e,line:void 0}}function Ry(t,e,n=!1){const r=e.center,i=ly(n?Dy(t,r):t,e.center),A=Math.atan2(i[1],i[0]);if(isNaN(A))return r;const o=wm(e)/2,s=Bm(e)/2;return[r[0]+o*Math.cos(A),r[1]+s*Math.sin(A)]}function Hy(t,e){let n=1/0,r=[[0,0],[0,0]];return e.forEach(e=>{const i=function(t,e){const n=_y(t,e);return fy(t,n)}(t,e);i<n&&(n=i,r=e)}),r}function _y(t,e){const[n,r]=e[0],[i,A]=e[1],[o,s]=t,a=i-n,c=A-r;if(0===a&&0===c)return[n,r];let l=((o-n)*a+(s-r)*c)/(a*a+c*c);l>1?l=1:l<0&&(l=0);return[n+l*a,r+l*c]}function Gy(t,e=!0){const n=function(t){const e=t.reduce((t,e)=>cy(t,e),[0,0]);return hy(e,t.length)}(t);return t.sort(([t,r],[i,A])=>{const o=Math.atan2(r-n[1],t-n[0]),s=Math.atan2(A-n[1],i-n[0]);return e?s-o:o-s})}function Ky(t,e){return[t,[t[0],e[1]],e,[e[0],t[1]]]}class jy{constructor(t,e,n){if(this.phase=e,this.pointerByTouch=[],this.initialDistance=null,this.emitter=t,jy.instance)return jy.callbacks[this.phase].push(n),jy.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),jy.instance=this,jy.callbacks[this.phase].push(n)}bindEvents(){const{emitter:e}=this;e.on(t.CommonEvent.POINTER_DOWN,this.onPointerDown),e.on(t.CommonEvent.POINTER_MOVE,this.onPointerMove),e.on(t.CommonEvent.POINTER_UP,this.onPointerUp)}updatePointerPosition(t,e,n){const r=this.pointerByTouch.findIndex(e=>e.pointerId===t);r>=0&&(this.pointerByTouch[r]={x:e,y:n,pointerId:t})}onPointerDown(t){const{x:e,y:n}=t.client||{};if(void 0!==e&&void 0!==n&&(this.pointerByTouch.push({x:e,y:n,pointerId:t.pointerId}),"touch"===t.pointerType&&2===this.pointerByTouch.length)){jy.isPinching=!0;const e=this.pointerByTouch[0].x-this.pointerByTouch[1].x,n=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(e*e+n*n),jy.callbacks.pinchstart.forEach(e=>e(t,{scale:0}))}}onPointerMove(t){if(2!==this.pointerByTouch.length||null===this.initialDistance)return;const{x:e,y:n}=t.client||{};if(void 0===e||void 0===n)return;this.updatePointerPosition(t.pointerId,e,n);const r=this.pointerByTouch[0].x-this.pointerByTouch[1].x,i=this.pointerByTouch[0].y-this.pointerByTouch[1].y,A=Math.sqrt(r*r+i*i)/this.initialDistance;jy.callbacks.pinchmove.forEach(e=>e(t,{scale:5*(A-1)}))}onPointerUp(t){var e;jy.callbacks.pinchend.forEach(e=>e(t,{scale:0})),jy.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],null===(e=jy.instance)||void 0===e||e.tryDestroy()}destroy(){this.emitter.off(t.CommonEvent.POINTER_DOWN,this.onPointerDown),this.emitter.off(t.CommonEvent.POINTER_MOVE,this.onPointerMove),this.emitter.off(t.CommonEvent.POINTER_UP,this.onPointerUp),jy.instance=null}off(t,e){const n=jy.callbacks[t].indexOf(e);n>-1&&jy.callbacks[t].splice(n,1),this.tryDestroy()}tryDestroy(){Object.values(jy.callbacks).every(t=>0===t.length)&&this.destroy()}}jy.isPinching=!1,jy.instance=null,jy.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};const Vy=t=>t.map(t=>ne(t)?t.toLocaleLowerCase():t);class zy{constructor(e){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=t=>{(null==t?void 0:t.key)&&(this.recordKey.add(t.key),this.trigger(t))},this.onKeyUp=t=>{(null==t?void 0:t.key)&&this.recordKey.delete(t.key)},this.onWheel=e=>{this.triggerExtendKey(t.CommonEvent.WHEEL,e)},this.onDrag=e=>{this.triggerExtendKey(t.CommonEvent.DRAG,e)},this.handlePinch=(e,n)=>{this.triggerExtendKey(t.CommonEvent.PINCH,Object.assign(Object.assign({},e),n))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=e,this.bindEvents()}bind(e,n){0!==e.length&&(e.includes(t.CommonEvent.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new jy(this.emitter,"pinchmove",this.boundHandlePinch)),this.map.set(e,n))}unbind(t,e){this.map.forEach((n,r)=>{Me(r,t)&&(e&&e!==n||this.map.delete(r))})}unbindAll(){this.map.clear()}match(t){const e=Vy(Array.from(this.recordKey)).sort(),n=Vy(t).sort();return Me(e,n)}bindEvents(){var e;const{emitter:n}=this;n.on(t.CommonEvent.KEY_DOWN,this.onKeyDown),n.on(t.CommonEvent.KEY_UP,this.onKeyUp),n.on(t.CommonEvent.WHEEL,this.onWheel),n.on(t.CommonEvent.DRAG,this.onDrag),null===(e=globalThis.addEventListener)||void 0===e||e.call(globalThis,"focus",this.onFocus)}trigger(t){this.map.forEach((e,n)=>{this.match(n)&&e(t)})}triggerExtendKey(t,e){this.map.forEach((n,r)=>{r.includes(t)&&Me(Array.from(this.recordKey),r.filter(e=>e!==t))&&n(e)})}destroy(){var e,n;this.unbindAll(),this.emitter.off(t.CommonEvent.KEY_DOWN,this.onKeyDown),this.emitter.off(t.CommonEvent.KEY_UP,this.onKeyUp),this.emitter.off(t.CommonEvent.WHEEL,this.onWheel),this.emitter.off(t.CommonEvent.DRAG,this.onDrag),null===(e=this.pinchHandler)||void 0===e||e.off("pinchmove",this.boundHandlePinch),null===(n=globalThis.removeEventListener)||void 0===n||n.call(globalThis,"focus",this.onFocus)}}class Wy extends oy{constructor(t,e){super(t,xe({},Wy.defaultOptions,e)),this.shortcut=new zy(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(t){if(!this.validate(t)||!this.isKeydown()||this.startPoint)return;const{canvas:e,graph:n}=this.context,r=Object.assign({},this.options.style);this.options.style.lineWidth&&(r.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new lc({id:"g6-brush-select",style:r}),e.appendChild(this.rectShape),this.startPoint=[t.canvas.x,t.canvas.y]}onPointerMove(t){var e;if(!this.startPoint)return;const{immediately:n,mode:r}=this.options;this.endPoint=Yy(t,this.context.graph),null===(e=this.rectShape)||void 0===e||e.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&"default"===r&&this.updateElementsStates(Ky(this.startPoint,this.endPoint))}onPointerUp(t){this.startPoint&&(this.endPoint?(this.endPoint=Yy(t,this.context.graph),this.updateElementsStates(Ky(this.startPoint,this.endPoint)),this.clearBrush()):this.clearBrush())}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){const{graph:t}=this.context,e=Object.values(t.getData()).reduce((t,e)=>Object.assign({},t,e.reduce((t,e)=>{var n;const r=null===(n=e.states||[])||void 0===n?void 0:n.filter(t=>t!==this.options.state);return t[Vm(e)]=r,t},{})),{});t.setElementState(e,this.options.animation)}updateElementsStates(t){const{graph:e}=this.context,{enableElements:n,state:r,mode:i,onSelect:A}=this.options,o=this.selector(e,t,n),s={};switch(i){case"union":o.forEach(t=>{s[t]=[...e.getElementState(t),r]});break;case"diff":o.forEach(t=>{const n=e.getElementState(t);s[t]=n.includes(r)?n.filter(t=>t!==r):[...n,r]});break;case"intersect":o.forEach(t=>{const n=e.getElementState(t);s[t]=n.includes(r)?[r]:[]});break;default:o.forEach(t=>{s[t]=[r]})}Vt(A)&&A(s),e.setElementState(s,this.options.animation)}selector(t,e,n){if(!n||0===n.length)return[];const r=[],i=t.getData();if(n.forEach(n=>{i[`${n}s`].forEach(n=>{const i=Vm(n);"hidden"!==t.getElementVisibility(i)&&function(t,e,n,r){const i=t[0],A=t[1];let o=!1;void 0===n&&(n=0),void 0===r&&(r=e.length);const s=r-n;for(let t=0,r=s-1;t<s;r=t++){const s=e[t+n][0],a=e[t+n][1],c=e[r+n][0],l=e[r+n][1];a>A!=l>A&&i<(c-s)*(A-a)/(l-a)+s&&(o=!o)}return o}(t.getElementPosition(i),e)&&r.push(i)})}),n.includes("edge")){const t=i.edges;null==t||t.forEach(t=>{const{source:e,target:n}=t;r.includes(e)&&r.includes(n)&&r.push(Vm(t))})}return r}clearBrush(){var t;null===(t=this.rectShape)||void 0===t||t.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){const{trigger:t}=this.options,e=Array.isArray(t)?t:[t];return this.shortcut.match(e.filter(t=>"drag"!==t))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}bindEvents(){const{graph:e}=this.context;e.on(t.CommonEvent.POINTER_DOWN,this.onPointerDown),e.on(t.CommonEvent.POINTER_MOVE,this.onPointerMove),e.on(t.CommonEvent.POINTER_UP,this.onPointerUp),e.on(t.CanvasEvent.CLICK,this.clearStates)}unbindEvents(){const{graph:e}=this.context;e.off(t.CommonEvent.POINTER_DOWN,this.onPointerDown),e.off(t.CommonEvent.POINTER_MOVE,this.onPointerMove),e.off(t.CommonEvent.POINTER_UP,this.onPointerUp),e.off(t.CanvasEvent.CLICK,this.clearStates)}update(t){this.unbindEvents(),this.options=xe(this.options,t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}Wy.defaultOptions={animation:!1,enable:!0,enableElements:["node","combo","edge"],immediately:!1,mode:"default",state:"selected",trigger:["shift"],style:{width:0,height:0,lineWidth:1,fill:"#1677FF",stroke:"#1677FF",fillOpacity:.1,zIndex:2,pointerEvents:"none"}};const Yy=(t,e)=>{if(!("node"!==t.targetType&&"combo"!==t.targetType||t.nativeEvent.target instanceof HTMLCanvasElement)){const[n,r]=e.getCanvasByClient([t.client.x,t.client.y]);return[n,r]}return[t.canvas.x,t.canvas.y]},Xy=.8,qy=["node","edge","combo"];function Zy(t,e,n,r,i=0){"TB"===r&&e(t,i);const A=n(t);if(A)for(const t of A)Zy(t,e,n,r,i+1);"BT"===r&&e(t,i)}function Jy(t,e,n,r,i="both"){if("combo"===e||"node"===e)return $y(t,n,r,i);const A=t.getEdgeData(n);if(!A)return[];const o=$y(t,A.source,r-1,i),s=$y(t,A.target,r-1,i);return Array.from(new Set([...o,...s,n]))}function $y(t,e,n,r="both"){const i=new Set,A=new Set,o=new Set;return function(t,e,n){const r=[[t,0]];for(;r.length;){const[t,i]=r.shift();e(t,i);const A=n(t);if(A)for(const t of A)r.push([t,i+1])}}(e,(e,i)=>{i>n||(o.add(e),t.getRelatedEdgesData(e,r).forEach(t=>{const e=Vm(t);!A.has(e)&&i<n&&(o.add(e),A.add(e))}))},e=>t.getRelatedEdgesData(e,r).map(t=>t.source===e?t.target:t.source).filter(t=>!i.has(t)&&(i.add(t),!0))),Array.from(o)}function tw(t){return t.states||[]}class ew extends oy{constructor(t,e){super(t,Object.assign({},ew.defaultOptions,e)),this.onClickSelect=t=>_e(this,void 0,void 0,function*(){var e,n;this.validate(t)&&(yield this.updateState(t),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))}),this.onClickCanvas=t=>_e(this,void 0,void 0,function*(){var e,n;this.validate(t)&&(yield this.clearState(),null===(n=(e=this.options).onClick)||void 0===n||n.call(e,t))}),this.shortcut=new zy(t.graph),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),qy.forEach(n=>{e.on(`${n}:${t.CommonEvent.CLICK}`,this.onClickSelect)}),e.on(t.CanvasEvent.CLICK,this.onClickCanvas)}get isMultipleSelect(){const{multiple:t,trigger:e}=this.options;return t&&this.shortcut.match(e)}getNeighborIds(t){const{target:e,targetType:n}=t,{graph:r}=this.context,{degree:i}=this.options;return Jy(r,n,e.id,"function"==typeof i?i(t):i).filter(t=>t!==e.id)}updateState(t){return _e(this,void 0,void 0,function*(){const{state:e,unselectedState:n,neighborState:r,animation:i}=this.options;if(!e&&!r&&!n)return;const{target:A}=t,{graph:o}=this.context,s=tw(o.getElementData(A.id)).includes(e)?"unselect":"select",a={},c=this.isMultipleSelect,l=[A.id],u=this.getNeighborIds(t);if(c)if(Object.assign(a,this.getDataStates()),"select"===s){const t=(t,e)=>{t.forEach(t=>{const r=new Set(o.getElementState(t));r.add(e),r.delete(n),a[t]=Array.from(r)})};t(l,e),t(u,r),n&&Object.keys(a).forEach(t=>{const i=a[t];i.includes(e)||i.includes(r)||i.includes(n)||a[t].push(n)})}else{const t=a[A.id];a[A.id]=t.filter(t=>t!==e&&t!==r),t.includes(n)||a[A.id].push(n),u.forEach(t=>{a[t]=a[t].filter(t=>t!==r),a[t].includes(e)||a[t].push(n)})}else if("select"===s){Object.assign(a,this.getClearStates(!!n));const t=(t,e)=>{t.forEach(t=>{a[t]||(a[t]=o.getElementState(t)),a[t].push(e)})};t(l,e),t(u,r),n&&Object.keys(a).forEach(t=>{l.includes(t)||u.includes(t)||a[t].push(n)})}else Object.assign(a,this.getClearStates());yield o.setElementState(a,i)})}getDataStates(){const{graph:t}=this.context,{nodes:e,edges:n,combos:r}=t.getData(),i={};return[...e,...n,...r].forEach(t=>{i[Vm(t)]=tw(t)}),i}getClearStates(t=!1){const{graph:e}=this.context,{state:n,unselectedState:r,neighborState:i}=this.options,A=new Set([n,r,i]),{nodes:o,edges:s,combos:a}=e.getData(),c={};return[...o,...s,...a].forEach(e=>{const n=tw(e),r=n.filter(t=>!A.has(t));(t||r.length!==n.length)&&(c[Vm(e)]=r)}),c}clearState(){return _e(this,void 0,void 0,function*(){const{graph:t}=this.context;yield t.setElementState(this.getClearStates(),this.options.animation)})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}unbindEvents(){const{graph:e}=this.context;qy.forEach(n=>{e.off(`${n}:${t.CommonEvent.CLICK}`,this.onClickSelect)}),e.off(t.CanvasEvent.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}}function nw(t){var e;return!!(null===(e=t.style)||void 0===e?void 0:e.collapsed)}function rw(t,e){if(!t.startsWith(e))return!1;const n=t[e.length];return n>="A"&&n<="Z"}function iw(t,e,n=!0){if(!e)return t;if(!rw(t,e))return t;const r=t.slice(e.length);return n?function(t){var e=ue(t);return e.charAt(0).toLowerCase()+e.substring(1)}(r):r}function Aw(t,e){const n=Object.entries(t).reduce((t,[n,r])=>("className"===n||"class"===n||rw(n,e)&&Object.assign(t,{[iw(n,e)]:r}),t),{});if("opacity"in t){const r=function(t,e){return`${e}${he(t)}`}("opacity",e),i=t.opacity;if(r in t){const e=t[r];Object.assign(n,{opacity:i*e})}else Object.assign(n,{opacity:i})}return n}function ow(t,e){const n=e.length;return Object.keys(t).reduce((r,i)=>{if(i.startsWith(e)){r[i.slice(n)]=t[i]}return r},{})}function sw(t,e){const n="string"==typeof e?[e]:e,r={};return Object.keys(t).forEach(e=>{n.find(t=>e.startsWith(t))||(r[e]=t[e])}),r}function aw(t=0){if("number"==typeof t)return[t,t,t];const[e,n=e,r=e]=t;return[e,n,r]}function cw(t,e){const{datum:n,graph:r}=e;return"function"==typeof t?t.call(r,n):Object.fromEntries(Object.entries(t).map(([t,e])=>"function"==typeof e?[t,e.call(r,n)]:[t,e]))}function lw(t,e){const n=(null==t?void 0:t.style)||{},r=(null==e?void 0:e.style)||{};for(const t in n)t in r||(r[t]=n[t]);return Object.assign({},t,e,{style:r})}function uw(t){if(t)return"string"==typeof t||"function"==typeof t||Array.isArray(t)?{type:"group",field:t=>t.id,color:t,invert:!1}:t}function hw(t){const e="string"==typeof t?Jv("palette",t):t;if("function"!=typeof e)return e}function dw(t,e){let n=2*t;return"string"==typeof e?n=t*Number(e.replace("%",""))/100:"number"==typeof e&&(n=e),isNaN(n)&&(n=2*t),n}function fw(t,e,n=1,r=!1){const i=r?n:1;return dw((t.max[0]-t.min[0])*i,e)}ew.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:["shift"],state:"selected",neighborState:"selected",unselectedState:void 0,degree:0};class gw extends qa{constructor(t){vw(t.style),super(t),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(e,n,r,i,A){var o,s,a,c,l,u,h,d;const f=this.shapeMap[e];if(!1===r)return void(f&&(null===(o=null==A?void 0:A.beforeDestroy)||void 0===o||o.call(A,f),i.removeChild(f),delete this.shapeMap[e],null===(s=null==A?void 0:A.afterDestroy)||void 0===s||s.call(A,f)));const g="string"==typeof n?Jv(t.ExtensionCategory.SHAPE,n):n;if(!g)throw new Error(tm(`Shape ${n} not found`));if(!f||f.destroyed||!(f instanceof g)){f&&(null===(a=null==A?void 0:A.beforeDestroy)||void 0===a||a.call(A,f),null==f||f.destroy(),null===(c=null==A?void 0:A.afterDestroy)||void 0===c||c.call(A,f)),null===(l=null==A?void 0:A.beforeCreate)||void 0===l||l.call(A);const t=new g({className:e,style:r});return i.appendChild(t),this.shapeMap[e]=t,null===(u=null==A?void 0:A.afterCreate)||void 0===u||u.call(A,t),t}return null===(h=null==A?void 0:A.beforeUpdate)||void 0===h||h.call(A,f),Zb(f,r),null===(d=null==A?void 0:A.afterUpdate)||void 0===d||d.call(A,f),f}update(t={}){const e=Object.assign({},this.attributes,t);vw(e),function(t,e){const{zIndex:n,transform:r,transformOrigin:i,visibility:A,cursor:o,clipPath:s,component:a}=e,c=He(e,["zIndex","transform","transformOrigin","visibility","cursor","clipPath","component"]);Object.assign(t.attributes,c),r&&t.setAttribute("transform",r);oe(n)&&t.setAttribute("zIndex",n);i&&t.setAttribute("transformOrigin",i);A&&t.setAttribute("visibility",A);o&&t.setAttribute("cursor",o);s&&t.setAttribute("clipPath",s);a&&t.setAttribute("component",a)}(this,e),this.render(e,this),this.setVisibility()}bindEvents(){}getGraphicStyle(t){return function(t){const{x:e,y:n,z:r,class:i,className:A,transform:o,transformOrigin:s,zIndex:a,visibility:c}=t;return He(t,["x","y","z","class","className","transform","transformOrigin","zIndex","visibility"])}(t)}get compositeShapes(){return[["badges","badge-"],["ports","port-"]]}animate(t,e){if(0===t.length)return null;const n=[];if(void 0!==t[0].x||void 0!==t[0].y||void 0!==t[0].z){const{x:e=0,y:n=0,z:r=0}=this.attributes;t.forEach(t=>{const{x:i=e,y:A=n,z:o=r}=t;Object.assign(t,{transform:o?[["translate3d",i,A,o]]:[["translate",i,A]]})})}const r=super.animate(t,e);if(r&&(pw(this,r),n.push(r)),Array.isArray(t)&&t.length>0){const r=["transform","transformOrigin","x","y","z","zIndex"];if(Object.keys(t[0]).some(t=>!r.includes(t))){Object.entries(this.shapeMap).forEach(([r,i])=>{const A=this[`get${he(r)}Style`];if(Vt(A)){const r=t.map(t=>A.call(this,Object.assign(Object.assign({},this.attributes),t))),o=i.animate(im(r),e);o&&(pw(i,o),n.push(o))}});const r=(r,i)=>{if(!Fe(r)){const A=this[`get${he(i)}Style`];if(Vt(A)){const i=t.map(t=>A.call(this,Object.assign(Object.assign({},this.attributes),t)));Object.entries(i[0]).map(([t])=>{const A=i.map(e=>e[t]),o=r[t];if(o){const t=o.animate(im(A),e);t&&(pw(o,t),n.push(t))}})}}};this.compositeShapes.forEach(([t,e])=>{const n=ow(this.shapeMap,e);r(n,t)})}}return rm(n)}getShape(t){return this.shapeMap[t]}setVisibility(){const{visibility:t}=this.attributes;ry(this,t)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}}function pw(t,e){null==e||e.finished.then(()=>{const n=t.activeAnimations.findIndex(t=>t===e);n>-1&&t.activeAnimations.splice(n,1)})}function vw(t){if(!t)return{};if("x"in t||"y"in t||"z"in t){const{x:e=0,y:n=0,z:r,transform:i}=t,A=am(e,n,r,i);A&&(t.transform=A)}return t}class mw extends gw{constructor(t){super(lw({style:mw.defaultStyleProps},t))}isTextStyle(t){return rw(t,"label")}isBackgroundStyle(t){return rw(t,"background")}getTextStyle(t){const e=this.getGraphicStyle(t),{padding:n}=e;return sw(He(e,["padding"]),"background")}getBackgroundStyle(t){if(!1===t.background)return!1;const e=this.getGraphicStyle(t),{wordWrap:n,wordWrapWidth:r,padding:i}=e,A=Aw(e,"background"),{min:[o,s],center:[a,c],halfExtents:[l,u]}=this.shapeMap.text.getGeometryBounds(),[h,d,f,g]=mm(i),p=2*l+g+d,{width:v,height:m}=A;v&&m?Object.assign(A,{x:a-Number(v)/2,y:c-Number(m)/2}):Object.assign(A,{x:o-g,y:s-h,width:n?Math.min(p,r+g+d):p,height:2*u+h+f});const{radius:y}=A;if("string"==typeof y&&y.endsWith("%")){const t=Number(y.replace("%",""))/100;A.radius=Math.min(+A.width,+A.height)*t}return A}render(t=this.parsedAttributes,e=this){this.upsert("text",hc,this.getTextStyle(t),e),this.upsert("background",lc,this.getBackgroundStyle(t),e)}getGeometryBounds(){return(this.getShape("background")||this.getShape("text")).getGeometryBounds()}}mw.defaultStyleProps={padding:0,fontSize:12,fontFamily:"system-ui, sans-serif",wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:"...",textBaseline:"middle",backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};class yw extends gw{constructor(t){super(lw({style:yw.defaultStyleProps},t))}getBadgeStyle(t){return this.getGraphicStyle(t)}render(t=this.parsedAttributes,e=this){this.upsert("label",mw,this.getBadgeStyle(t),e)}getGeometryBounds(){const t=this.getShape("label");return(t.getShape("background")||t.getShape("text")).getGeometryBounds()}}yw.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:"50%",backgroundOpacity:1};const ww={M:["x","y"],m:["dx","dy"],H:["x"],h:["dx"],V:["y"],v:["dy"],L:["x","y"],l:["dx","dy"],Z:[],z:[],C:["x1","y1","x2","y2","x","y"],c:["dx1","dy1","dx2","dy2","dx","dy"],S:["x2","y2","x","y"],s:["dx2","dy2","dx","dy"],Q:["x1","y1","x","y"],q:["dx1","dy1","dx","dy"],T:["x","y"],t:["dx","dy"],A:["rx","ry","rotation","large-arc","sweep","x","y"],a:["rx","ry","rotation","large-arc","sweep","dx","dy"]};function Bw(t){const e=[],n="string"==typeof t?function(t){const e=t.replace(/[\n\r]/g,"").replace(/-/g," -").replace(/(\d*\.)(\d+)(?=\.)/g,"$1$2 ").trim().split(/\s*,|\s+/),n=[];let r="",i={};for(;e.length>0;){let t=e.shift();t in ww?r=t:e.unshift(t),i={type:r},ww[r].forEach(n=>{t=e.shift(),i[n]=t}),"M"===r?r="L":"m"===r&&(r="l");const[A,...o]=Object.values(i);n.push([A,...o.map(Number)])}return n}(t):t;return n.forEach(t=>{const n=t[0];if("Z"!==n)if("A"!==n)for(let n=1;n<t.length;n+=2)e.push([t[n],t[n+1],0]);else{const n=t.length;e.push([t[n-2],t[n-1],0])}else e.push(e[0])}),e}const bw=t=>{if(t.length<2)return[["M",0,0],["L",0,0]];const e=t[0],n=t[1],r=t[t.length-1],i=t[t.length-2];t.unshift(i,r),t.push(e,n);const A=[["M",r[0],r[1]]];for(let e=1;e<t.length-2;e+=1){const[n,r]=t[e-1],[i,o]=t[e],[s,a]=t[e+1],[c,l]=e!==t.length-2?t[e+2]:[s,a],u=i+(s-n)/6,h=o+(a-r)/6,d=s-(c-i)/6,f=a-(l-o)/6;A.push(["C",u,h,d,f,s,a])}return A};class Ew extends gw{constructor(t){super(lw({style:Ew.defaultStyleProps},t))}getLabelStyle(t){if(!t.label||!t.d||0===t.d.length)return!1;const e=Aw(this.getGraphicStyle(t),"label"),{maxWidth:n,offsetX:r,offsetY:i,autoRotate:A,placement:o,closeToPath:s}=e,a=He(e,["maxWidth","offsetX","offsetY","autoRotate","placement","closeToPath"]),c=this.shapeMap.key,l=null==c?void 0:c.getRenderBounds();return Object.assign(function(t,e,n,r,i,A,o){const[s,a]=Qy(t,e),c={textAlign:"left"===e?"right":"right"===e?"left":"center",textBaseline:"top"===e?"bottom":"bottom"===e?"top":"middle",transform:[["translate",s+n,a+r]]};if("center"===e||!i)return c;const l=Bw(A);if(!l||l.length<=3)return c;const u=l.map((t,e)=>{const n=t,r=l[(e+1)%l.length];return Me(n,r)?null:[n,r]}).filter(Boolean),h=Hy([s,a],u),d=_y([s,a],h);if(d&&h&&(c.transform=[["translate",d[0]+n,d[1]+r]],o)){const t=Math.atan((h[0][1]-h[1][1])/(h[0][0]-h[1][0]));c.transform.push(["rotate",t/Math.PI*180]),c.textAlign="center","right"!==e&&"left"!==e||(c.textBaseline=t>0?"right"===e?"bottom":"top":"right"===e?"top":"bottom")}return c}(l,o,r,i,s,t.d,A),{wordWrapWidth:fw(l,n)},a)}getKeyStyle(t){return this.getGraphicStyle(t)}render(t,e){this.upsert("key",Ac,this.getKeyStyle(t),e),this.upsert("label",mw,this.getLabelStyle(t),e)}}Ew.defaultStyleProps={label:!0,labelPlacement:"bottom",labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};let xw=class extends ec{constructor(t){super(t),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},Fw=this,this.isMutationObserved=!0,this.addEventListener(ia.MOUNTED,this.onMounted),this.addEventListener(ia.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){const{radius:t,clipPath:e,width:n=0,height:r=0}=this.attributes;if(t&&n&&r){const[i,A]=this.getBounds().min,o={x:i,y:A,radius:t,width:n,height:r};if(e)Object.assign(this.parsedStyle.clipPath.style,o);else{const t=new lc({style:o});this.style.clipPath=t}}else e&&(this.style.clipPath=null)}};const Cw=new WeakMap;let Fw=null;const Mw=t=>{if(Fw&&function(t){const e=[];let n=t.parentNode;for(;n;)e.push(n),n=n.parentNode;return e}(Fw).includes(t)){const e=Cw.get(t);e?e.includes(Fw)||e.push(Fw):Cw.set(t,[Fw])}},kw=t=>{const e=Cw.get(t);e&&e.forEach(t=>t.handleRadius())};class Qw extends gw{constructor(t){super(t)}isImage(){const{src:t}=this.attributes;return!!t}getIconStyle(t=this.attributes){const{width:e=0,height:n=0}=t,r=this.getGraphicStyle(t);return this.isImage()?Object.assign({x:-e/2,y:-n/2},r):Object.assign({textBaseline:"middle",textAlign:"center"},r)}render(t=this.attributes,e=this){this.upsert("icon",this.isImage()?xw:hc,this.getIconStyle(t),e)}}class Sw extends gw{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(t,e){const n=super.animate(t,e);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}}class Uw extends Sw{constructor(t){super(lw({style:Uw.defaultStyleProps},t)),this.type="node"}getSize(t=this.attributes){const{size:e}=t;return aw(e)}getKeyStyle(t){const e=this.getGraphicStyle(t);return Object.assign(sw(e,["label","halo","icon","badge","port"]))}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;const e=Aw(this.getGraphicStyle(t),"label"),{placement:n,maxWidth:r,offsetX:i,offsetY:A}=e,o=He(e,["placement","maxWidth","offsetX","offsetY"]),s=this.getShape("key").getLocalBounds();return Object.assign(Xb(s,n,i,A),{wordWrapWidth:fw(s,r)},o)}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getKeyStyle(t),{fill:n}=e,r=He(e,["fill"]),i=Aw(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign(Object.assign({},r),{stroke:n}),i)}getIconStyle(t){if(!1===t.icon||!t.iconText&&!t.iconSrc)return!1;const e=Aw(this.getGraphicStyle(t),"icon");return Object.assign(function(t,e){const n=aw(t);let r={};return e.text&&!e.fontSize&&(r={fontSize:.5*Math.min(...n)}),!e.src||e.width&&e.height||(r={width:.5*n[0],height:.5*n[1]}),r}(t.size,e),e)}getBadgesStyle(t){var e;const n=ow(this.shapeMap,"badge-"),r={};if(Object.keys(n).forEach(t=>{r[t]=!1}),!1===t.badge||!(null===(e=t.badges)||void 0===e?void 0:e.length))return r;const{badges:i=[],badgePalette:A,opacity:o=1}=t,s=He(t,["badges","badgePalette","opacity"]),a=hw(A),c=Aw(this.getGraphicStyle(s),"badge");return i.forEach((t,e)=>{r[e]=Object.assign(Object.assign({backgroundFill:a?a[e%(null==a?void 0:a.length)]:void 0,opacity:o},c),this.getBadgeStyle(t))}),r}getBadgeStyle(t){const e=this.getShape("key"),{placement:n="top",offsetX:r,offsetY:i}=t,A=He(t,["placement","offsetX","offsetY"]),o=Xb(e.getLocalBounds(),n,r,i,!0);return Object.assign(Object.assign({},o),A)}getPortsStyle(t){var e;const n=this.getPorts(),r={};if(Object.keys(n).forEach(t=>{r[t]=!1}),!1===t.port||!(null===(e=t.ports)||void 0===e?void 0:e.length))return r;const i=Aw(this.getGraphicStyle(t),"port"),{ports:A=[]}=t;return A.forEach((e,n)=>{const A=e.key||n,o=Object.assign(Object.assign({},i),e);if(Kb(o))r[A]=!1;else{const[n,i]=this.getPortXY(t,e);r[A]=Object.assign({transform:[["translate",n,i]]},o)}}),r}getPortXY(t,e){const{placement:n="left"}=e,r=this.getShape("key");return _b(function(t,e){if(!t)return e.getLocalBounds();const n=t.canvas.getLayer(),r=e.cloneNode();ry(r,"hidden"),n.appendChild(r);const i=r.getLocalBounds();return r.destroy(),i}(this.context,r),n)}getPorts(){return ow(this.shapeMap,"port-")}getCenter(){return this.getShape("key").getBounds().center}getIntersectPoint(t,e=!1){return function(t,e,n=!1){return Py(t,Qy(e,"center"),[Qy(e,"left-top"),Qy(e,"right-top"),Qy(e,"right-bottom"),Qy(e,"left-bottom")],!1,n).point}(t,this.getShape("key").getBounds(),e)}drawHaloShape(t,e){const n=this.getHaloStyle(t),r=this.getShape("key");this.upsert("halo",r.constructor,n,e)}drawIconShape(t,e){const n=this.getIconStyle(t);this.upsert("icon",Qw,n,e),Mw(this)}drawBadgeShapes(t,e){const n=this.getBadgesStyle(t);Object.keys(n).forEach(t=>{const r=n[t];this.upsert(`badge-${t}`,yw,r,e)})}drawPortShapes(t,e){const n=this.getPortsStyle(t);Object.keys(n).forEach(t=>{const r=n[t],i=`port-${t}`;this.upsert(i,Ya,r,e)})}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",mw,n,e)}_drawKeyShape(t,e){return this.drawKeyShape(t,e)}render(t=this.parsedAttributes,e=this){this._drawKeyShape(t,e),this.getShape("key")&&(this.drawHaloShape(t,e),this.drawIconShape(t,e),this.drawBadgeShapes(t,e),this.drawLabelShape(t,e),this.drawPortShapes(t,e))}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&kw(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}}Uw.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:"none",haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:"200%",labelPlacement:"bottom",labelWordWrap:!1,labelZIndex:0};let Tw=class t extends Uw{constructor(e){super(lw({style:t.defaultStyleProps},e))}drawKeyShape(t,e){return this.upsert("key",Ya,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{r:Math.min(...this.getSize(t))/2})}getIconStyle(t){const e=super.getIconStyle(t),{r:n}=this.getShape("key").attributes,r=2*n*Xy;return!!e&&Object.assign({width:r,height:r},e)}getIntersectPoint(t,e=!1){return Ry(t,this.getShape("key").getBounds(),e)}};Tw.defaultStyleProps={size:32};class Ow extends Uw{constructor(t){super(t)}get parsedAttributes(){return this.attributes}drawKeyShape(t,e){return this.upsert("key",sc,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t);return Object.assign(Object.assign({},e),{points:this.getPoints(t)})}getIntersectPoint(t,e=!1){var n,r;const{points:i}=this.getShape("key").attributes;return Py(t,[+((null===(n=this.attributes)||void 0===n?void 0:n.x)||0),+((null===(r=this.attributes)||void 0===r?void 0:r.y)||0)],i,!0,e).point}}class Nw extends Ow{constructor(t){super(t)}getPoints(t){const[e,n]=this.getSize(t);return function(t,e){return[[0,-e/2],[t/2,0],[0,e/2],[-t/2,0]]}(e,n)}}class Iw extends Tw{constructor(t){super(lw({style:Iw.defaultStyleProps},t))}parseOuterR(){const{size:t}=this.parsedAttributes;return Math.min(...aw(t))/2}parseInnerR(){const{innerR:t}=this.parsedAttributes;return ne(t)?parseInt(t)/100*this.parseOuterR():t}drawDonutShape(t,e){const{donuts:n}=t;if(!(null==n?void 0:n.length))return;const r=n.map(t=>oe(t)?{value:t}:t),i=Aw(this.getGraphicStyle(t),"donut"),A=hw(t.donutPalette);if(!A)return;const o=r.reduce((t,e)=>{var n;return t+(null!==(n=e.value)&&void 0!==n?n:0)},0),s=this.parseOuterR(),a=this.parseInnerR();let c=0;r.forEach((t,n)=>{const{value:l=0,color:u=A[n%A.length]}=t,h=He(t,["value","color"]),d=360*(0===o?1/r.length:l/o);this.upsert(`round${n}`,Ac,Object.assign(Object.assign(Object.assign({},i),{d:Dw(s,a,c,c+d),fill:u}),h),e),c+=d})}render(t,e=this){super.render(t,e),this.drawDonutShape(t,e)}}Iw.defaultStyleProps={innerR:"50%",donuts:[],donutPalette:"tableau"};const Lw=(t,e,n,r)=>[t+Math.sin(r)*n,e-Math.cos(r)*n],Dw=(t=0,e=0,n,r)=>{const[i,A]=[0,0];return Math.abs(n-r)%360<1e-6?((t,e,n,r)=>r<=0||n<=r?[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"]]:[["M",t-n,e],["A",n,n,0,1,1,t+n,e],["A",n,n,0,1,1,t-n,e],["Z"],["M",t+r,e],["A",r,r,0,1,0,t-r,e],["A",r,r,0,1,0,t+r,e],["Z"]])(i,A,t,e):((t,e,n,r,i,A)=>{const[o,s]=[i/360*2*Math.PI,A/360*2*Math.PI],a=[Lw(t,e,r,o),Lw(t,e,n,o),Lw(t,e,n,s),Lw(t,e,r,s)],c=s-o>Math.PI?1:0;return[["M",a[0][0],a[0][1]],["L",a[1][0],a[1][1]],["A",n,n,0,c,1,a[2][0],a[2][1]],["L",a[3][0],a[3][1]],["A",r,r,0,c,0,a[0][0],a[0][1]],["Z"]]})(i,A,t,e,n,r)};class Pw extends Uw{constructor(t){super(lw({style:Pw.defaultStyleProps},t))}drawKeyShape(t,e){return this.upsert("key",Za,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,r]=this.getSize(t);return Object.assign(Object.assign({},e),{rx:n/2,ry:r/2})}getIconStyle(t){const e=super.getIconStyle(t),{rx:n,ry:r}=this.getShape("key").attributes,i=2*Math.min(+n,+r)*Xy;return!!e&&Object.assign({width:i,height:i},e)}getIntersectPoint(t,e=!1){return Ry(t,this.getShape("key").getBounds(),e)}}Pw.defaultStyleProps={size:[45,35]};class Rw extends Ow{constructor(t){super(t)}getOuterR(t){return t.outerR||Math.min(...this.getSize(t))/2}getPoints(t){return[[0,e=this.getOuterR(t)],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]];var e}getIconStyle(t){const e=super.getIconStyle(t),n=this.getOuterR(t)*Xy;return!!e&&Object.assign({width:n,height:n},e)}}function Hw(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var _w=0;function Gw(t){return"__private_"+_w+++"_"+t}
/*!
   * @antv/g-canvas
   * @description A renderer implemented by Canvas 2D API
   * @version 2.2.0
   * @date 12/24/2025, 11:55:53 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */var Kw=Gw("renderState"),jw=function(){function t(e){s(this,t),this.renderQueue=[],Object.defineProperty(this,Kw,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=k(),this.dprMatrix=k(),this.tmpMat4=k(),this.vec3a=ut(),this.vec3b=ut(),this.vec3c=ut(),this.vec3d=ut(),this.canvasRendererPluginOptions=e}return c(t,[{key:"apply",value:function(e,n){var r=this;this.context=e;var i=this.context,A=i.config,o=i.camera,s=i.renderingService,a=i.renderingContext,c=i.pathGeneratorFactory,l=A.renderer.getConfig().enableRenderingOptimization;A.renderer.getConfig().enableDirtyCheck=!1,A.renderer.getConfig().enableDirtyRectangleRendering=!1,this.pathGeneratorFactory=c;var u=e.contextService,h=a.root.ownerDocument.defaultView;s.hooks.init.tap(t.tag,function(){var t=u.getDPR(),e=A.width,n=A.height,i=u.getContext();r.clearRect(i,0,0,e*t,n*t,A.background)}),s.hooks.destroy.tap(t.tag,function(){r.renderQueue=[],Hw(r,Kw)[Kw]={restoreStack:[],prevObject:null,currentContext:null}});var d=function(t,e){for(var i=[t];i.length>0;){var A,o=i.pop();o.isVisible()&&!o.isCulled()&&(l?r.renderDisplayObjectOptimized(o,e,r.context,Hw(r,Kw)[Kw],n):r.renderDisplayObject(o,e,r.context,Hw(r,Kw)[Kw],n));for(var s=(null===(A=o.sortable)||void 0===A||null===(A=A.sorted)||void 0===A?void 0:A.length)>0?o.sortable.sorted:o.childNodes,a=s.length-1;a>=0;a--)i.push(s[a])}};s.hooks.endFrame.tap(t.tag,function(){if(function(){var t,e=u.getContext(),n=u.getDPR(),i=A.width,o=A.height,a=r.canvasRendererPluginOptions,c=a.dirtyObjectNumThreshold,l=a.dirtyObjectRatioThreshold,d=s.getStats(),f=d.total,g=d.rendered,p=g/f;r.clearFullScreen=r.clearFullScreenLastFrame||!(null!==(t=h.context.renderingPlugins[1])&&void 0!==t&&t.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||g>c&&p>l,e&&("function"==typeof e.resetTransform?e.resetTransform():e.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(e,0,0,i*n,o*n,A.background))}(),0!==a.root.childNodes.length){l=A.renderer.getConfig().enableRenderingOptimization,Hw(r,Kw)[Kw]={restoreStack:[],prevObject:null,currentContext:Hw(r,Kw)[Kw].currentContext},Hw(r,Kw)[Kw].currentContext.clear(),r.clearFullScreenLastFrame=!1;var t=u.getContext(),e=u.getDPR();if(K(r.dprMatrix,[e,e,1]),D(r.vpMatrix,r.dprMatrix,o.getOrthoMatrix()),r.clearFullScreen)l?(t.save(),d(a.root,t),t.restore()):d(a.root,t);else{var i=r.safeMergeAABB(r.mergeDirtyAABBs(r.renderQueue));if(br.isEmpty(i))return void(r.renderQueue=[]);var c=r.convertAABB2Rect(i),f=c.x,g=c.y,p=c.width,v=c.height,m=xt(r.vec3a,[f,g,0],r.vpMatrix),w=xt(r.vec3b,[f+p,g,0],r.vpMatrix),B=xt(r.vec3c,[f,g+v,0],r.vpMatrix),b=xt(r.vec3d,[f+p,g+v,0],r.vpMatrix),E=Math.min(m[0],w[0],b[0],B[0]),x=Math.min(m[1],w[1],b[1],B[1]),C=Math.max(m[0],w[0],b[0],B[0]),F=Math.max(m[1],w[1],b[1],B[1]),M=Math.floor(E),k=Math.floor(x),Q=Math.ceil(C-E),S=Math.ceil(F-x);t.save(),r.clearRect(t,M,k,Q,S,A.background),t.beginPath(),t.rect(M,k,Q,S),t.clip(),t.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]),A.renderer.getConfig().enableDirtyRectangleRenderingDebug&&h.dispatchEvent(new Xs(Bc.DIRTY_RECTANGLE,{dirtyRect:{x:M,y:k,width:Q,height:S}}));var U=y(i.getMin(),2),T=U[0],O=U[1],N=y(i.getMax(),2),I=N[0],L=N[1];a.root.ownerDocument.elementsFromBBox(T,O,I,L).sort(function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder}).forEach(function(e){e&&e.isVisible()&&!e.isCulled()&&r.renderDisplayObject(e,t,r.context,Hw(r,Kw)[Kw],n)}),t.restore(),r.renderQueue.forEach(function(t){r.saveDirtyAABB(t)}),r.renderQueue=[]}Hw(r,Kw)[Kw].restoreStack.forEach(function(){t.restore()}),Hw(r,Kw)[Kw].restoreStack=[]}else r.clearFullScreenLastFrame=!0}),s.hooks.render.tap(t.tag,function(t){r.clearFullScreen||r.renderQueue.push(t)})}},{key:"clearRect",value:function(t,e,n,r,i,A){t.clearRect(e,n,r,i),A&&(t.fillStyle=A,t.fillRect(e,n,r,i))}},{key:"renderDisplayObjectOptimized",value:function(t,e,n,r,i){var A=t.nodeName,o=!1,s=this.context.styleRendererFactory[A],a=this.pathGeneratorFactory[A],c=t.parsedStyle.clipPath;if(c){(!r.prevObject||!st(c.getWorldTransform(),r.prevObject.getWorldTransform()))&&(this.applyWorldTransform(e,c),r.prevObject=null);var l=this.pathGeneratorFactory[c.nodeName];l&&(e.save(),o=!0,e.beginPath(),l(e,c.parsedStyle),e.closePath(),e.clip())}if(s){(!r.prevObject||!st(t.getWorldTransform(),r.prevObject.getWorldTransform()))&&this.applyWorldTransform(e,t);var u=!r.prevObject;if(!u){var h=r.prevObject.nodeName;u=A===hr.TEXT?h!==hr.TEXT:A===hr.IMAGE?h!==hr.IMAGE:h===hr.TEXT||h===hr.IMAGE}s.applyStyleToContext(e,t,u,r),r.prevObject=t}a&&(e.beginPath(),a(e,t.parsedStyle),A!==hr.LINE&&A!==hr.PATH&&A!==hr.POLYLINE&&e.closePath()),s&&s.drawToContext(e,t,Hw(this,Kw)[Kw],this,i),o&&e.restore(),t.dirty(!1)}},{key:"renderDisplayObject",value:function(t,e,n,r,i){var A=t.nodeName,o=r.restoreStack[r.restoreStack.length-1];!o||t.compareDocumentPosition(o)&Zs.DOCUMENT_POSITION_CONTAINS||(e.restore(),r.restoreStack.pop());var s=this.context.styleRendererFactory[A],a=this.pathGeneratorFactory[A],c=t.parsedStyle.clipPath;if(c){this.applyWorldTransform(e,c);var l=this.pathGeneratorFactory[c.nodeName];l&&(e.save(),r.restoreStack.push(t),e.beginPath(),l(e,c.parsedStyle),e.closePath(),e.clip())}s&&(this.applyWorldTransform(e,t),e.save(),this.applyAttributesToContext(e,t)),a&&(e.beginPath(),a(e,t.parsedStyle),A!==hr.LINE&&A!==hr.PATH&&A!==hr.POLYLINE&&e.closePath()),s&&(s.render(e,t.parsedStyle,t,n,this,i),e.restore()),t.dirty(!1)}},{key:"applyAttributesToContext",value:function(t,e){var n=e.parsedStyle,r=n.stroke,i=n.fill,A=n.opacity,o=n.lineDash,s=n.lineDashOffset;o&&t.setLineDash(o),zt(s)||(t.lineDashOffset=s),zt(A)||(t.globalAlpha*=A),zt(r)||Array.isArray(r)||r.isNone||(t.strokeStyle=e.attributes.stroke),zt(i)||Array.isArray(i)||i.isNone||(t.fillStyle=e.attributes.fill)}},{key:"convertAABB2Rect",value:function(t){var e=t.getMin(),n=t.getMax(),r=Math.floor(e[0]),i=Math.floor(e[1]);return{x:r,y:i,width:Math.ceil(n[0])-r,height:Math.ceil(n[1])-i}}},{key:"mergeDirtyAABBs",value:function(t){var e=new br;return t.forEach(function(t){var n=t.getRenderBounds();e.add(n);var r=t.renderable.dirtyRenderBounds;r&&e.add(r)}),e}},{key:"saveDirtyAABB",value:function(t){var e=t.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new br);var n=t.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)}},{key:"applyWorldTransform",value:function(t,e,n){n?(S(this.tmpMat4,e.getLocalTransform()),D(this.tmpMat4,n,this.tmpMat4),D(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(S(this.tmpMat4,e.getWorldTransform()),D(this.tmpMat4,this.vpMatrix,this.tmpMat4)),t.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:"safeMergeAABB",value:function(){for(var t=new br,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){t.add(e)}),t}}])}();function Vw(t,e,n,r,i,A,o){var s,a;if("rect"===t.image.nodeName){var c=t.image.parsedStyle,l=c.width,u=c.height;a=r.contextService.getDPR();var h=r.config.offscreenCanvas;(s=A.offscreenCanvasCreator.getOrCreateCanvas(h)).width=l*a,s.height=u*a;var d=A.offscreenCanvasCreator.getOrCreateContext(h),f={restoreStack:[],prevObject:null,currentContext:new Map};t.image.forEach(function(t){i.renderDisplayObject(t,d,r,f,A)}),f.restoreStack.forEach(function(){d.restore()})}return o.getOrCreatePatternSync(e,t,n,s,a,e.getGeometryBounds().min,function(){e.dirty(),r.renderingService.dirty()})}function zw(t,e,n,r){var i;if(t.type===Ji.LinearGradient||t.type===Ji.RadialGradient){var A=e.getGeometryBounds(),s=A&&2*A.halfExtents[0]||1,a=A&&2*A.halfExtents[1]||1,c=A&&A.min||[0,0];i=r.getOrCreateGradient(o(o({type:t.type},t.value),{},{min:c,width:s,height:a}),n)}return i}jw.tag="CanvasRenderer";var Ww=["shadowBlur","shadowOffsetX","shadowOffsetY"],Yw=["lineCap","lineJoin","miterLimit"],Xw={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",filter:"none",globalCompositeOperation:"source-over",strokeStyle:"#000",strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:"butt",lineJoin:"miter",miterLimit:10,fillStyle:"#000",fillOpacity:1},qw={};function Zw(t,e,n,r){var i=r.has(e)?r.get(e):Xw[e];return i!==n&&("lineDash"===e?t.setLineDash(n):t[e]=n,r.set(e,n)),i}var Jw=function(){return c(function t(e){s(this,t),this.imagePool=e},[{key:"applyAttributesToContext",value:function(t,e){}},{key:"render",value:function(t,e,n,r,i,A){}},{key:"applyCommonStyleToContext",value:function(t,e,n,r){var i=n?qw:r.prevObject.parsedStyle,A=e.parsedStyle;(n||A.opacity!==i.opacity)&&Zw(t,"globalAlpha",zt(A.opacity)?Xw.globalAlpha:A.opacity,r.currentContext),(n||A.blend!==i.blend)&&Zw(t,"globalCompositeOperation",zt(A.blend)?Xw.globalCompositeOperation:A.blend,r.currentContext)}},{key:"applyStrokeFillStyleToContext",value:function(t,e,n,r){var i=n?qw:r.prevObject.parsedStyle,A=e.parsedStyle,o=A.lineWidth,s=void 0===o?Xw.lineWidth:o,a=A.fill&&!A.fill.isNone;if(A.stroke&&!A.stroke.isNone&&s>0){if(n||e.attributes.stroke!==r.prevObject.attributes.stroke)Zw(t,"strokeStyle",zt(A.stroke)||Array.isArray(A.stroke)||A.stroke.isNone?Xw.strokeStyle:e.attributes.stroke,r.currentContext);(n||A.lineWidth!==i.lineWidth)&&Zw(t,"lineWidth",zt(A.lineWidth)?Xw.lineWidth:A.lineWidth,r.currentContext),(n||A.lineDash!==i.lineDash)&&Zw(t,"lineDash",A.lineDash||Xw.lineDash,r.currentContext),(n||A.lineDashOffset!==i.lineDashOffset)&&Zw(t,"lineDashOffset",zt(A.lineDashOffset)?Xw.lineDashOffset:A.lineDashOffset,r.currentContext);for(var c=0;c<Yw.length;c++){var l=Yw[c];(n||A[l]!==i[l])&&Zw(t,l,zt(A[l])?Xw[l]:A[l],r.currentContext)}}a&&(n||e.attributes.fill!==r.prevObject.attributes.fill)&&Zw(t,"fillStyle",zt(A.fill)||Array.isArray(A.fill)||A.fill.isNone?Xw.fillStyle:e.attributes.fill,r.currentContext)}},{key:"applyStyleToContext",value:function(t,e,n,r){var i=e.nodeName;this.applyCommonStyleToContext(t,e,n,r),i===hr.IMAGE||this.applyStrokeFillStyleToContext(t,e,n,r)}},{key:"applyShadowAndFilterStyleToContext",value:function(t,e,n,r){var i=e.parsedStyle;if(n){Zw(t,"shadowColor",i.shadowColor.toString(),r.currentContext);for(var A=0;A<Ww.length;A++){var o=Ww[A];Zw(t,o,i[o]||Xw[o],r.currentContext)}}i.filter&&i.filter.length&&Zw(t,"filter",e.attributes.filter,r.currentContext)}},{key:"clearShadowAndFilterStyleForContext",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(e){Zw(t,"shadowColor",Xw.shadowColor,r.currentContext);for(var A=0;A<Ww.length;A++){var o=Ww[A];Zw(t,o,Xw[o],r.currentContext)}}if(n)if(e&&i){var s=t.filter;!zt(s)&&s.indexOf("drop-shadow")>-1&&Zw(t,"filter",s.replace(/drop-shadow\([^)]*\)/,"").trim()||Xw.filter,r.currentContext)}else Zw(t,"filter",Xw.filter,r.currentContext)}},{key:"fillToContext",value:function(t,e,n,r,i){var A=this,o=e.parsedStyle,s=o.fill,a=o.fillRule,c=null;if(Array.isArray(s)&&s.length>0)s.forEach(function(r){var i=Zw(t,"fillStyle",zw(r,e,t,A.imagePool),n.currentContext);c=null!=c?c:i,a?t.fill(a):t.fill()});else{if(bA(s)){var l=Vw(s,e,t,e.ownerDocument.defaultView.context,r,i,this.imagePool);l&&(t.fillStyle=l,c=!0)}a?t.fill(a):t.fill()}null!==c&&Zw(t,"fillStyle",c,n.currentContext)}},{key:"strokeToContext",value:function(t,e,n,r,i){var A=this,o=e.parsedStyle.stroke,s=null;if(Array.isArray(o)&&o.length>0)o.forEach(function(r){var i=Zw(t,"strokeStyle",zw(r,e,t,A.imagePool),n.currentContext);s=null!=s?s:i,t.stroke()});else{if(bA(o)){var a=Vw(o,e,t,e.ownerDocument.defaultView.context,r,i,this.imagePool);if(a){var c=Zw(t,"strokeStyle",a,n.currentContext);s=null!=s?s:c}}t.stroke()}null!==s&&Zw(t,"strokeStyle",s,n.currentContext)}},{key:"drawToContext",value:function(t,e,n,r,i){var A,o=e.nodeName,s=e.parsedStyle,a=s.opacity,c=void 0===a?Xw.globalAlpha:a,l=s.fillOpacity,u=void 0===l?Xw.fillOpacity:l,h=s.strokeOpacity,d=void 0===h?Xw.strokeOpacity:h,f=s.lineWidth,g=void 0===f?Xw.lineWidth:f,p=s.fill&&!s.fill.isNone,v=s.stroke&&!s.stroke.isNone&&g>0;if(p||v){var m=!zt(s.shadowColor)&&s.shadowBlur>0,y="inner"===s.shadowType,w=0===(null===(A=s.fill)||void 0===A?void 0:A.alpha),B=!(!s.filter||!s.filter.length),b=m&&v&&(o===hr.PATH||o===hr.LINE||o===hr.POLYLINE||w||y),E=null;if(p)b||this.applyShadowAndFilterStyleToContext(t,e,m,n),E=Zw(t,"globalAlpha",c*u,n.currentContext),this.fillToContext(t,e,n,r,i),b||this.clearShadowAndFilterStyleForContext(t,m,B,n);if(v){var x=!1,C=Zw(t,"globalAlpha",c*d,n.currentContext);if(E=p?E:C,b&&(this.applyShadowAndFilterStyleToContext(t,e,m,n),x=!0,y)){var F=t.globalCompositeOperation;t.globalCompositeOperation="source-atop",this.strokeToContext(t,e,n,r,i),t.globalCompositeOperation=F,this.clearShadowAndFilterStyleForContext(t,m,B,n,!0)}this.strokeToContext(t,e,n,r,i),x&&this.clearShadowAndFilterStyleForContext(t,m,B,n)}null!==E&&Zw(t,"globalAlpha",E,n.currentContext)}}}])}(),$w=function(t){function e(){return s(this,e),p(this,e,arguments)}return m(e,t),c(e,[{key:"render",value:function(t,e,n,r,i,A){var o=e.fill,s=e.fillRule,a=e.opacity,c=void 0===a?1:a,l=e.fillOpacity,u=void 0===l?1:l,h=e.stroke,d=e.strokeOpacity,f=void 0===d?1:d,g=e.lineWidth,p=void 0===g?1:g,v=e.lineCap,m=e.lineJoin,y=e.shadowType,w=e.shadowColor,B=e.shadowBlur,b=e.filter,E=e.miterLimit,x=o&&!o.isNone,C=h&&!h.isNone&&p>0,F=0===(null==o?void 0:o.alpha),M=!(!b||!b.length),k=!zt(w)&&B>0,Q=n.nodeName,S="inner"===y,U=C&&k&&(Q===hr.PATH||Q===hr.LINE||Q===hr.POLYLINE||F||S);x&&(t.globalAlpha=c*u,U||tB(n,t,k),eB(t,n,o,s,r,i,A,this.imagePool),U||this.clearShadowAndFilter(t,M,k)),C&&(t.globalAlpha=c*f,t.lineWidth=p,zt(E)||(t.miterLimit=E),zt(v)||(t.lineCap=v),zt(m)||(t.lineJoin=m),U&&(S&&(t.globalCompositeOperation="source-atop"),tB(n,t,!0),S&&(nB(t,n,h,r,i,A,this.imagePool),t.globalCompositeOperation=Xw.globalCompositeOperation,this.clearShadowAndFilter(t,M,!0))),nB(t,n,h,r,i,A,this.imagePool))}},{key:"clearShadowAndFilter",value:function(t,e,n){if(n&&(t.shadowColor="transparent",t.shadowBlur=0),e){var r=t.filter;!zt(r)&&r.indexOf("drop-shadow")>-1&&(t.filter=r.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}}}])}(Jw);function tB(t,e,n){var r=t.parsedStyle,i=r.filter,A=r.shadowColor,o=r.shadowBlur,s=r.shadowOffsetX,a=r.shadowOffsetY;i&&i.length&&(e.filter=t.style.filter),n&&(e.shadowColor=A.toString(),e.shadowBlur=o||0,e.shadowOffsetX=s||0,e.shadowOffsetY=a||0)}function eB(t,e,n,r,i,A,o,s){var a=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Array.isArray(n)?n.forEach(function(n){t.fillStyle=zw(n,e,t,s),a||(r?t.fill(r):t.fill())}):(bA(n)&&(t.fillStyle=Vw(n,e,t,i,A,o,s)),a||(r?t.fill(r):t.fill()))}function nB(t,e,n,r,i,A,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];Array.isArray(n)?n.forEach(function(n){t.strokeStyle=zw(n,e,t,o),s||t.stroke()}):(bA(n)&&(t.strokeStyle=Vw(n,e,t,r,i,A,o)),s||t.stroke())}var rB=function(t){function e(){return s(this,e),p(this,e,arguments)}return m(e,t),c(e,[{key:"renderDownSampled",value:function(t,e,n,r){var i=r.src,A=r.imageCache;A.downSampled?t.drawImage(A.downSampled,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3])):this.imagePool.createDownSampledImage(i,n).then(function(){n.ownerDocument&&(n.dirty(),n.ownerDocument.defaultView.context.renderingService.dirty())}).catch(function(t){console.error(t)})}},{key:"renderTile",value:function(t,e,n,r){var i=r.src,A=r.imageCache,o=r.imageRect,s=r.drawRect,a=A.size,c=t.getTransform(),l=c.a,u=c.b,h=c.c,d=c.d,f=c.e,g=c.f;if(t.resetTransform(),null!=A&&A.gridSize){for(var p=[a[0]/o[2],a[1]/o[3]],v=[A.tileSize[0]/p[0],A.tileSize[1]/p[1]],m=[Math.floor((s[0]-o[0])/v[0]),Math.ceil((s[0]+s[2]-o[0])/v[0])],y=m[0],w=m[1],B=[Math.floor((s[1]-o[1])/v[1]),Math.ceil((s[1]+s[3]-o[1])/v[1])],b=B[1],E=B[0];E<=b;E++)for(var x=y;x<=w;x++){var C=A.tiles[E][x];if(C){var F=[Math.floor(o[0]+C.tileX*v[0]),Math.floor(o[1]+C.tileY*v[1]),Math.ceil(v[0]),Math.ceil(v[1])];t.drawImage(C.data,F[0],F[1],F[2],F[3])}}t.setTransform(l,u,h,d,f,g)}else this.imagePool.createImageTiles(i,[],function(){n.ownerDocument&&(n.dirty(),n.ownerDocument.defaultView.context.renderingService.dirty())},n).catch(function(t){console.error(t)})}},{key:"render",value:function(t,n,r){var i=n.x,A=void 0===i?0:i,o=n.y,s=void 0===o?0:o,a=n.width,c=n.height,l=n.src,u=n.shadowColor,h=n.shadowBlur,d=this.imagePool.getImageSync(l,r),f=null==d?void 0:d.img,g=a,p=c;if(f){var v,m,w,B,b,E,x,C,F,M,k,Q,S,T,O;g||(g=f.width),p||(p=f.height),tB(r,t,!zt(u)&&h>0);try{var N=r.ownerDocument.defaultView.getContextService().getDomElement(),I=N.width,L=N.height,D=t.getTransform(),P=D.a,R=D.b,H=function(t,e){var n=xt(ut(),[t[0],t[1],0],e),r=xt(ut(),[t[0]+t[2],t[1],0],e),i=xt(ut(),[t[0],t[1]+t[3],0],e),A=xt(ut(),[t[0]+t[2],t[1]+t[3],0],e);return[Math.min(n[0],r[0],i[0],A[0]),Math.min(n[1],r[1],i[1],A[1]),Math.max(n[0],r[0],i[0],A[0])-Math.min(n[0],r[0],i[0],A[0]),Math.max(n[1],r[1],i[1],A[1])-Math.min(n[1],r[1],i[1],A[1])]}([A,s,g,p],U(P,D.c,0,0,R,D.d,0,0,0,0,1,0,D.e,D.f,0,1)),_=(v=H,m=y([0,0,I,L],4),w=m[0],B=m[1],b=m[2],E=m[3],x=y(v,4),C=x[0],F=x[1],M=x[2],k=x[3],Q=Math.max(w,C),S=Math.max(B,F),T=Math.min(w+b,C+M),O=Math.min(B+E,F+k),T<=Q||O<=S?null:[Q,S,T-Q,O-S]);if(!_)return;if(!r.ownerDocument.defaultView.getConfig().enableLargeImageOptimization)return void e.renderFull(t,n,r,{image:f,drawRect:[A,s,g,p]});if(H[2]/d.size[0]<(d.downSamplingRate||.5))return void this.renderDownSampled(t,n,r,{src:l,imageCache:d,drawRect:[A,s,g,p]});if(!ImagePool.isSupportTile)return void e.renderFull(t,n,r,{image:f,drawRect:[A,s,g,p]});this.renderTile(t,n,r,{src:l,imageCache:d,imageRect:H,drawRect:_})}catch(t){}}}},{key:"drawToContext",value:function(t,e,n,r,i){this.render(t,e.parsedStyle,e)}}],[{key:"renderFull",value:function(t,e,n,r){t.drawImage(r.image,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3]))}}])}($w),iB=function(t){function e(){return s(this,e),p(this,e,arguments)}return m(e,t),c(e,[{key:"render",value:function(t,e,n,r,i,A){n.getBounds();var o=e.lineWidth,s=void 0===o?1:o,a=e.textAlign,c=void 0===a?"start":a,l=e.textBaseline,u=void 0===l?"alphabetic":l,h=e.lineJoin,d=void 0===h?"miter":h,f=e.miterLimit,g=void 0===f?10:f,p=e.letterSpacing,v=void 0===p?0:p,m=e.stroke,y=e.fill,w=e.fillRule,B=e.fillOpacity,b=void 0===B?1:B,E=e.strokeOpacity,x=void 0===E?1:E,C=e.opacity,F=void 0===C?1:C,M=e.metrics,k=e.x,Q=void 0===k?0:k,S=e.y,U=void 0===S?0:S,T=e.dx,O=e.dy,N=e.shadowColor,I=e.shadowBlur,L=e.textDecorationLine,D=M.font,P=M.lines,R=M.height,H=M.lineHeight,_=M.lineMetrics;t.font=D,t.lineWidth=s,t.textAlign="middle"===c?"center":c;var G=u;"alphabetic"===G&&(G="bottom"),t.lineJoin=d,zt(g)||(t.miterLimit=g);var K=U;"middle"===u?K+=-R/2-H/2:"bottom"===u||"alphabetic"===u||"ideographic"===u?K+=-R:"top"!==u&&"hanging"!==u||(K+=-H);var j=Q+(T||0);K+=O||0,1===P.length&&("bottom"===G?(G="middle",K-=.5*R):"top"===G&&(G="middle",K+=.5*R)),t.textBaseline=G,tB(n,t,!zt(N)&&I>0);for(var V=0;V<P.length;V++){var z=s/2+j;K+=H,zt(m)||m.isNone||!s||this.drawLetterSpacing(t,n,P[V],_[V],c,z,K,v,y,w,b,m,x,F,!0,r,i,A),zt(y)||this.drawLetterSpacing(t,n,P[V],_[V],c,z,K,v,y,w,b,m,x,F,!1,r,i,A)}L&&"none"!==L&&this.drawTextDecorations(t,e,n,P,H,j,U+(O||0),r,i,A)}},{key:"drawLetterSpacing",value:function(t,e,n,r,i,A,o,s,a,c,l,u,h,d,f,g,p,v){if(0!==s){var m=t.textAlign;t.textAlign="left";var y=A;"center"===i||"middle"===i?y=A-r.width/2:"right"!==i&&"end"!==i||(y=A-r.width);for(var w=Array.from(n),B=t.measureText(n).width,b=0,E=0;E<w.length;++E){var x=w[E];f?this.strokeText(t,e,x,y,o,u,h,g,p,v):this.fillText(t,e,x,y,o,a,c,l,d,g,p,v),y+=B-(b=t.measureText(n.substring(E+1)).width)+s,B=b}t.textAlign=m}else f?this.strokeText(t,e,n,A,o,u,h,g,p,v):this.fillText(t,e,n,A,o,a,c,l,d,g,p,v)}},{key:"fillText",value:function(t,e,n,r,i,A,o,s,a,c,l,u){var h;eB(t,e,A,o,c,l,u,this.imagePool,!0);var d=!zt(s)&&1!==s;d&&(h=t.globalAlpha,t.globalAlpha=s*a),t.fillText(n,r,i),d&&(t.globalAlpha=h)}},{key:"strokeText",value:function(t,e,n,r,i,A,o,s,a,c){var l;nB(t,e,A,s,a,c,this.imagePool,!0);var u=!zt(o)&&1!==o;u&&(l=t.globalAlpha,t.globalAlpha=o),t.strokeText(n,r,i),u&&(t.globalAlpha=l)}},{key:"drawTextDecorations",value:function(t,e,n,r,i,A,o,s,a,c){var l=e.textDecorationLine,u=e.textDecorationColor,h=e.textDecorationStyle,d=e.textDecorationThickness,f=void 0===d?1:d,g=e.textAlign,p=void 0===g?"start":g,v=e.lineWidth,m=void 0===v?1:v,y=e.metrics;if(l&&"none"!==l){var w=y.lineMetrics,B=l.split(" ");switch(t.lineWidth=f,u&&(t.strokeStyle="rgba(".concat(u.r,", ").concat(u.g,", ").concat(u.b,", ").concat(u.alpha,")")),h){case"dashed":t.setLineDash([5,5]);break;case"dotted":t.setLineDash([2,2]);break;default:t.setLineDash([])}var b=o,E=e.textBaseline,x=void 0===E?"alphabetic":E;"middle"===x?b+=-y.height/2-i/2:"bottom"===x||"alphabetic"===x||"ideographic"===x?b+=-y.height:"top"!==x&&"hanging"!==x||(b+=-i);for(var C=0;C<r.length;C++){b+=i;var F=w[C];if(F){var M=m/2,k=A,Q=A+F.width;"center"===p||"middle"===p?(k=A-F.width/2,Q=A+F.width/2):"right"!==p&&"end"!==p||(k=A-F.width,Q=A),k+=M,Q+=M;var S,U=lr(B);try{for(U.s();!(S=U.n()).done;){var T=S.value,O=b;switch(T){case"underline":O+=2;break;case"overline":O-=i-2;break;case"line-through":O-=i/2;break;default:continue}"wavy"===h?this.drawWavyLine(t,k,Q,O):(t.beginPath(),t.moveTo(k,O),t.lineTo(Q,O),t.stroke())}}catch(t){U.e(t)}finally{U.f()}}}t.setLineDash([])}}},{key:"drawWavyLine",value:function(t,e,n,r){var i=10,A=Math.floor((n-e)/i);t.beginPath(),t.moveTo(e,r);for(var o=0;o<A;o++){var s=e+o*i+2.5,a=r+2,c=e+o*i+5,l=r;t.quadraticCurveTo(s,a,c,l);var u=e+o*i+7.5,h=r-2,d=e+(o+1)*i,f=r;t.quadraticCurveTo(u,h,d,f)}t.stroke()}},{key:"drawToContext",value:function(t,e,n,r,i){this.render(t,e.parsedStyle,e,e.ownerDocument.defaultView.context,r,i)}}])}($w),AB=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,e),(t=p(this,e)).name="canvas-renderer",t.options=n,t}return m(e,t),c(e,[{key:"init",value:function(){var t,e=o({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),n=this.context.imagePool,r=new $w(n),A=(i(i(i(i(i(i(i(i(i(i(t={},hr.CIRCLE,r),hr.ELLIPSE,r),hr.RECT,r),hr.IMAGE,new rB(n)),hr.TEXT,new iB(n)),hr.LINE,r),hr.POLYLINE,r),hr.POLYGON,r),hr.PATH,r),hr.GROUP,void 0),i(i(i(t,hr.HTML,void 0),hr.MESH,void 0),hr.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=A,this.context.styleRendererFactory=A,this.addRenderingPlugin(new jw(e))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(fr),oB=ut(),sB=ut(),aB=ut(),cB=k(),lB=function(){function t(){var e=this;s(this,t),this.isHit=function(t,n,r,i){var A=e.context.pointInPathPickerFactory[t.nodeName];if(A){var o=I(cB,r),s=xt(sB,pt(aB,n[0],n[1],0),o);if(A(t,new Fr(s[0],s[1]),i,e.isPointInPath,e.context,e.runtime))return!0}return!1},this.isPointInPath=function(t,n){var r=e.runtime.offscreenCanvasCreator.getOrCreateContext(e.context.config.offscreenCanvas),i=e.context.pathGeneratorFactory[t.nodeName];return i&&(r.beginPath(),i(r,t.parsedStyle),r.closePath()),r.isPointInPath(n.x,n.y)}}return c(t,[{key:"apply",value:function(e,n){var r,i=this,A=e.renderingService,o=e.renderingContext;this.context=e,this.runtime=n;var s=null===(r=o.root)||void 0===r?void 0:r.ownerDocument;A.hooks.pick.tapPromise(t.tag,function(){var t=cr(sr().mark(function t(e){return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.pick(s,e));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()),A.hooks.pickSync.tap(t.tag,function(t){return i.pick(s,t)})}},{key:"pick",value:function(t,e){var n,r=e.topmost,i=e.position,A=i.x,o=i.y,s=pt(oB,A,o,0),a=[],c=lr(t.elementsFromBBox(s[0],s[1],s[0],s[1]));try{for(c.s();!(n=c.n()).done;){var l=n.value,u=l.getWorldTransform();if(this.isHit(l,s,u,!1)){var h=$o(l);if(h){var d=h.parsedStyle.clipPath;if(this.isHit(d,s,d.getWorldTransform(),!0)){if(r)return e.picked=[l],e;a.push(l)}}else{if(r)return e.picked=[l],e;a.push(l)}}}}catch(t){c.e(t)}finally{c.f()}return e.picked=a,e}}])}();function uB(t,e,n){var r=t.parsedStyle,i=r.cx,A=void 0===i?0:i,o=r.cy,s=void 0===o?0:o,a=r.r,c=r.fill,l=r.stroke,u=r.lineWidth,h=void 0===u?1:u,d=r.increasedLineWidthForHitTesting,f=void 0===d?0:d,g=r.pointerEvents,p=void 0===g?"auto":g,v=(h+f)/2,m=In(A,s,e.x,e.y),w=y(is(p,c,l),2),B=w[0],b=w[1];return B&&b||n?m<=a+v:B?m<=a:!!b&&(m>=a-v&&m<=a+v)}function hB(t,e,n,r){return t/(n*n)+e/(r*r)}function dB(t,e,n){var r=t.parsedStyle,i=r.cx,A=void 0===i?0:i,o=r.cy,s=void 0===o?0:o,a=r.rx,c=r.ry,l=r.fill,u=r.stroke,h=r.lineWidth,d=void 0===h?1:h,f=r.increasedLineWidthForHitTesting,g=void 0===f?0:f,p=r.pointerEvents,v=void 0===p?"auto":p,m=e.x,w=e.y,B=y(is(v,l,u),2),b=B[0],E=B[1],x=(d+g)/2,C=(m-A)*(m-A),F=(w-s)*(w-s);return b&&E||n?hB(C,F,a+x,c+x)<=1:b?hB(C,F,a,c)<=1:!!E&&(hB(C,F,a-x,c-x)>=1&&hB(C,F,a+x,c+x)<=1)}function fB(t,e,n,r,i,A){return i>=t&&i<=t+n&&A>=e&&A<=e+r}function gB(t,e,n,r,i,A,o,s){var a=(Math.atan2(s-e,o-t)+2*Math.PI)%(2*Math.PI),c={x:t+n*Math.cos(a),y:e+n*Math.sin(a)};return In(c.x,c.y,o,s)<=A/2}function pB(t,e,n,r,i,A,o){var s=Math.min(t,n),a=Math.max(t,n),c=Math.min(e,r),l=Math.max(e,r),u=i/2;return A>=s-u&&A<=a+u&&o>=c-u&&o<=l+u&&Kn(t,e,n,r,A,o)<=i/2}function vB(t,e,n,r,i){var A=t.length;if(A<2)return!1;for(var o=0;o<A-1;o++){if(pB(t[o][0],t[o][1],t[o+1][0],t[o+1][1],e,n,r))return!0}if(i){var s=t[0],a=t[A-1];if(pB(s[0],s[1],a[0],a[1],e,n,r))return!0}return!1}lB.tag="CanvasPicker";function mB(t){return Math.abs(t)<1e-6?0:t<0?-1:1}function yB(t,e,n){return(n[0]-t[0])*(e[1]-t[1])===(e[0]-t[0])*(n[1]-t[1])&&Math.min(t[0],e[0])<=n[0]&&n[0]<=Math.max(t[0],e[0])&&Math.min(t[1],e[1])<=n[1]&&n[1]<=Math.max(t[1],e[1])}function wB(t,e,n){var r=!1,i=t.length;if(i<=2)return!1;for(var A=0;A<i;A++){var o=t[A],s=t[(A+1)%i];if(yB(o,s,[e,n]))return!0;mB(o[1]-n)>0!=mB(s[1]-n)>0&&mB(e-(n-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(r=!r)}return r}function BB(t,e,n){for(var r=!1,i=0;i<t.length;i++){if(r=wB(t[i],e,n))break}return r}function bB(t,e,n){var r=t.parsedStyle,i=r.x1,A=r.y1,o=r.x2,s=r.y2,a=r.lineWidth,c=void 0===a?1:a,l=r.increasedLineWidthForHitTesting,u=void 0===l?0:l,h=r.pointerEvents;return!(!y(is(void 0===h?"auto":h,r.fill,r.stroke),2)[1]&&!n||!c)&&pB(i,A,o,s,c+u,e.x,e.y)}function EB(t,e,n,r,i,A){var o=t.parsedStyle,s=o.lineWidth,a=void 0===s?1:s,c=o.increasedLineWidthForHitTesting,l=void 0===c?0:c,u=o.stroke,h=o.fill,d=o.d,f=o.pointerEvents,g=void 0===f?"auto":f,p=d.segments,v=d.hasArc,m=d.polylines,w=d.polygons,B=y(is(g,(null==w?void 0:w.length)&&h,u),2),b=B[0],E=B[1],x=jA(t),C=!1;return b||n?C=v?r(t,e):BB(w,e.x,e.y)||BB(m,e.x,e.y):((E||n)&&(C=function(t,e,n,r,i){for(var A=!1,o=e/2,s=0;s<t.length;s++){var a=t[s],c=a.currentPoint,l=a.params,u=a.prePoint,h=a.box;if(!h||fB(h.x-o,h.y-o,h.width+e,h.height+e,n,r))switch(a.command){case"L":case"Z":if(A=pB(u[0],u[1],c[0],c[1],e,n,r))return!0;break;case"Q":if(A=Jn(u[0],u[1],l[1],l[2],l[3],l[4],n,r)<=e/2)return!0;break;case"C":if(A=Wn(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6],n,r,i)<=e/2)return!0;break;case"A":a.cubicParams||(a.cubicParams=dn(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6],l[7],void 0));for(var d=a.cubicParams,f=u,g=0;g<d.length;g+=6){var p=Wn(f[0],f[1],d[g],d[g+1],d[g+2],d[g+3],d[g+4],d[g+5],n,r,i);if(f=[d[g+4],d[g+5]],A=p<=e/2)return!0}}}return A}(p,a+l,e.x,e.y,x)),C)}function xB(t,e,n){var r=t.parsedStyle,i=r.stroke,A=r.fill,o=r.lineWidth,s=void 0===o?1:o,a=r.increasedLineWidthForHitTesting,c=void 0===a?0:a,l=r.points,u=r.pointerEvents,h=y(is(void 0===u?"auto":u,A,i),2),d=h[0],f=!1;return(h[1]||n)&&(f=vB(l.points,s+c,e.x,e.y,!0)),f||!d&&!n||(f=wB(l.points,e.x,e.y)),f}function CB(t,e,n){var r=t.parsedStyle,i=r.lineWidth,A=void 0===i?1:i,o=r.increasedLineWidthForHitTesting,s=void 0===o?0:o,a=r.points,c=r.pointerEvents;return!(!y(is(void 0===c?"auto":c,r.fill,r.stroke),2)[1]&&!n||!A)&&vB(a.points,A+s,e.x,e.y,!1)}function FB(t,e,n,r,i){var A=t.parsedStyle,o=A.radius,s=A.fill,a=A.stroke,c=A.lineWidth,l=void 0===c?1:c,u=A.increasedLineWidthForHitTesting,h=void 0===u?0:u,d=A.x,f=void 0===d?0:d,g=A.y,p=void 0===g?0:g,v=A.width,m=A.height,w=A.pointerEvents,B=y(is(void 0===w?"auto":w,s,a),2),b=B[0],E=B[1],x=o&&o.some(function(t){return 0!==t}),C=l+h;if(x){var F=!1;return(E||n)&&(F=function(t,e,n,r,i,A,o,s){var a=y(i,4),c=a[0],l=a[1],u=a[2],h=a[3];return pB(t+c,e,t+n-l,e,A,o,s)||pB(t+n,e+l,t+n,e+r-u,A,o,s)||pB(t+n-u,e+r,t+h,e+r,A,o,s)||pB(t,e+r-h,t,e+c,A,o,s)||gB(t+n-l,e+l,l,Math.PI,Math.PI,A,o,s)||gB(t+n-u,e+r-u,u,0,Math.PI,A,o,s)||gB(t+h,e+r-h,h,Math.PI,Math.PI,A,o,s)||gB(t+c,e+c,c,Math.PI,Math.PI,A,o,s)}(f,p,v,m,o.map(function(t){return Ae(t,0,Math.min(Math.abs(v)/2,Math.abs(m)/2))}),C,e.x,e.y)),F||!b&&!n||(F=r(t,e)),F}var M=C/2;return b&&E||n?fB(f-M,p-M,v+M,m+M,e.x,e.y):b?fB(f,p,v,m,e.x,e.y):!!E&&function(t,e,n,r,i,A,o){var s=i/2;return fB(t-s,e-s,n,i,A,o)||fB(t+n-s,e-s,i,r,A,o)||fB(t+s,e+r-s,n,i,A,o)||fB(t-s,e+s,i,r,A,o)}(f,p,v,m,C,e.x,e.y)}function MB(t,e,n,r,i,A){var s=t.parsedStyle,a=s.pointerEvents,c=void 0===a?"auto":a,l=s.x,u=void 0===l?0:l,h=s.y,d=void 0===h?0:h,f=s.width,g=s.height;if("non-transparent-pixel"===c){var p=i.config.offscreenCanvas,v=A.offscreenCanvasCreator.getOrCreateCanvas(p),m=A.offscreenCanvasCreator.getOrCreateContext(p,{willReadFrequently:!0});return v.width=f,v.height=g,i.defaultStyleRendererFactory[hr.IMAGE].render(m,o(o({},t.parsedStyle),{},{x:0,y:0}),t,void 0,void 0,void 0),m.getImageData(e.x-u,e.y-d,1,1).data.every(function(t){return 0!==t})}return!0}function kB(t,e,n,r){var i=t.getGeometryBounds();return e.x>=i.min[0]&&e.y>=i.min[1]&&e.x<=i.max[0]&&e.y<=i.max[1]}var QB=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).name="canvas-picker",t}return m(e,t),c(e,[{key:"init",value:function(){var t,e=(i(i(i(i(i(i(i(i(i(i(t={},hr.CIRCLE,uB),hr.ELLIPSE,dB),hr.RECT,FB),hr.LINE,bB),hr.POLYLINE,CB),hr.POLYGON,xB),hr.PATH,EB),hr.TEXT,kB),hr.GROUP,null),hr.IMAGE,MB),i(i(t,hr.HTML,null),hr.MESH,null));this.context.pointInPathPickerFactory=e,this.addRenderingPlugin(new lB)}},{key:"destroy",value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(fr);function SB(t,e){var n=e.cx,r=void 0===n?0:n,i=e.cy,A=void 0===i?0:i,o=e.r;t.arc(r,A,o,0,2*Math.PI,!1)}function UB(t,e){var n=e.cx,r=void 0===n?0:n,i=e.cy,A=void 0===i?0:i,o=e.rx,s=e.ry;if(t.ellipse)t.ellipse(r,A,o,s,0,0,2*Math.PI,!1);else{var a=o>s?o:s,c=o>s?1:o/s,l=o>s?s/o:1;t.save(),t.scale(c,l),t.arc(r,A,a,0,2*Math.PI)}}function TB(t,e){var n,r,i=e.x1,A=e.y1,o=e.x2,s=e.y2,a=e.markerStart,c=e.markerEnd,l=e.markerStartOffset,u=e.markerEndOffset,h=0,d=0,f=0,g=0,p=0;a&&Ga(a)&&l&&(n=o-i,r=s-A,p=Math.atan2(r,n),h=Math.cos(p)*(l||0),d=Math.sin(p)*(l||0)),c&&Ga(c)&&u&&(n=i-o,r=A-s,p=Math.atan2(r,n),f=Math.cos(p)*(u||0),g=Math.sin(p)*(u||0)),t.moveTo(i+h,A+d),t.lineTo(o+f,s+g)}function OB(t,e){var n,r,i=e.markerStart,A=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,a=e.d,c=a.absolutePath,l=a.segments,u=0,h=0,d=0,f=0,g=0;if(i&&Ga(i)&&o){var p=y(i.parentNode.getStartTangent(),2),v=p[0],m=p[1];n=v[0]-m[0],r=v[1]-m[1],g=Math.atan2(r,n),u=Math.cos(g)*(o||0),h=Math.sin(g)*(o||0)}if(A&&Ga(A)&&s){var w=y(A.parentNode.getEndTangent(),2),B=w[0],b=w[1];n=B[0]-b[0],r=B[1]-b[1],g=Math.atan2(r,n),d=Math.cos(g)*(s||0),f=Math.sin(g)*(s||0)}for(var E=0;E<c.length;E++){var x=c[E],C=x[0],F=c[E+1],M=0===E&&(0!==u||0!==h),k=(E===c.length-1||F&&("M"===F[0]||"Z"===F[0]))&&0!==d&&0!==f,Q=y(M?[u,h]:[0,0],2),S=Q[0],U=Q[1],T=y(k?[d,f]:[0,0],2),O=T[0],N=T[1];switch(C){case"M":t.moveTo(x[1]+S,x[2]+U);break;case"L":t.lineTo(x[1]+O,x[2]+N);break;case"Q":t.quadraticCurveTo(x[1],x[2],x[3]+O,x[4]+N);break;case"C":t.bezierCurveTo(x[1],x[2],x[3],x[4],x[5]+O,x[6]+N);break;case"A":var I=l[E].arcParams,L=I.cx,D=I.cy,P=I.rx,R=I.ry,H=I.startAngle,_=I.endAngle,G=I.xRotation,K=I.sweepFlag;if(t.ellipse)t.ellipse(L,D,P,R,G,H,_,!!(1-K));else{var j=P>R?P:R,V=P>R?1:P/R,z=P>R?R/P:1;t.translate(L,D),t.rotate(G),t.scale(V,z),t.arc(0,0,j,H,_,!!(1-K)),t.scale(1/V,1/z),t.rotate(-G),t.translate(-L,-D)}k&&t.lineTo(x[6]+d,x[7]+f);break;case"Z":t.closePath()}}}function NB(t,e){var n,r,i=e.markerStart,A=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,a=e.points.points,c=a.length,l=a[0][0],u=a[0][1],h=a[c-1][0],d=a[c-1][1],f=0,g=0,p=0,v=0,m=0;i&&Ga(i)&&o&&(n=a[1][0]-a[0][0],r=a[1][1]-a[0][1],m=Math.atan2(r,n),f=Math.cos(m)*(o||0),g=Math.sin(m)*(o||0)),A&&Ga(A)&&s&&(n=a[c-1][0]-a[0][0],r=a[c-1][1]-a[0][1],m=Math.atan2(r,n),p=Math.cos(m)*(s||0),v=Math.sin(m)*(s||0)),t.moveTo(l+(f||p),u+(g||v));for(var y=1;y<c-1;y++){var w=a[y];t.lineTo(w[0],w[1])}t.lineTo(h,d)}function IB(t,e){var n,r,i=e.markerStart,A=e.markerEnd,o=e.markerStartOffset,s=e.markerEndOffset,a=e.points.points,c=a.length,l=a[0][0],u=a[0][1],h=a[c-1][0],d=a[c-1][1],f=0,g=0,p=0,v=0,m=0;i&&Ga(i)&&o&&(n=a[1][0]-a[0][0],r=a[1][1]-a[0][1],m=Math.atan2(r,n),f=Math.cos(m)*(o||0),g=Math.sin(m)*(o||0)),A&&Ga(A)&&s&&(n=a[c-2][0]-a[c-1][0],r=a[c-2][1]-a[c-1][1],m=Math.atan2(r,n),p=Math.cos(m)*(s||0),v=Math.sin(m)*(s||0)),t.moveTo(l+f,u+g);for(var y=1;y<c-1;y++){var w=a[y];t.lineTo(w[0],w[1])}t.lineTo(h+p,d+v)}function LB(t,e){var n=e.x,r=void 0===n?0:n,i=e.y,A=void 0===i?0:i,o=e.radius,s=e.width,a=e.height,c=s,l=a,u=o&&o.some(function(t){return 0!==t});if(u){var h=s>0?1:-1,d=a>0?1:-1,f=h+d===0,g=o.map(function(t){return Ae(t,0,Math.min(Math.abs(c)/2,Math.abs(l)/2))}),p=y(g,4),v=p[0],m=p[1],w=p[2],B=p[3];t.moveTo(h*v+r,A),t.lineTo(c-h*m+r,A),0!==m&&t.arc(c-h*m+r,d*m+A,m,-d*Math.PI/2,h>0?0:Math.PI,f),t.lineTo(c+r,l-d*w+A),0!==w&&t.arc(c-h*w+r,l-d*w+A,w,h>0?0:Math.PI,d>0?Math.PI/2:1.5*Math.PI,f),t.lineTo(h*B+r,l+A),0!==B&&t.arc(h*B+r,l-d*B+A,B,d>0?Math.PI/2:-Math.PI/2,h>0?Math.PI:0,f),t.lineTo(r,d*v+A),0!==v&&t.arc(h*v+r,d*v+A,v,h>0?Math.PI:0,d>0?1.5*Math.PI:Math.PI/2,f)}else t.rect(r,A,c,l)}var DB=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).name="canvas-path-generator",t}return m(e,t),c(e,[{key:"init",value:function(){var t,e=(i(i(i(i(i(i(i(i(i(i(t={},hr.CIRCLE,SB),hr.ELLIPSE,UB),hr.RECT,LB),hr.LINE,TB),hr.POLYLINE,IB),hr.POLYGON,NB),hr.PATH,OB),hr.TEXT,void 0),hr.GROUP,void 0),hr.IMAGE,void 0),i(i(i(t,hr.HTML,void 0),hr.MESH,void 0),hr.FRAGMENT,void 0));this.context.pathGeneratorFactory=e}},{key:"destroy",value:function(){delete this.context.pathGeneratorFactory}}])}(fr),PB=function(){return c(function t(e){s(this,t),this.renderingContext=e.renderingContext,this.canvasConfig=e.config},[{key:"init",value:function(){var t=this.canvasConfig,e=t.container,n=t.canvas;if(n)this.$canvas=n,e&&n.parentElement!==e&&e.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=ne(e)?document.getElementById(e):e,this.$container)){var r=document.createElement("canvas");this.$container.appendChild(r),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=r}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:"getContext",value:function(){return this.context}},{key:"getDomElement",value:function(){return this.$canvas}},{key:"getDPR",value:function(){return this.dpr}},{key:"getBoundingClientRect",value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:"destroy",value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:"resize",value:function(t,e){var n=this.canvasConfig.devicePixelRatio;this.dpr=n,this.$canvas&&(this.$canvas.width=this.dpr*t,this.$canvas.height=this.dpr*e,function(t,e,n){qo&&t.style&&(t.style.width=e+"px",t.style.height=n+"px")}(this.$canvas,t,e)),this.renderingContext.renderReasons.add(ta.CAMERA_CHANGED)}},{key:"applyCursorStyle",value:function(t){this.$container&&this.$container.style&&(this.$container.style.cursor=t)}},{key:"toDataURL",value:(t=cr(sr().mark(function t(){var e,n,r,i=arguments;return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=(e=i.length>0&&void 0!==i[0]?i[0]:{}).type,r=e.encoderOptions,t.abrupt("return",this.context.canvas.toDataURL(n,r));case 1:case"end":return t.stop()}},t,this)})),function(){return t.apply(this,arguments)})}]);var t}(),RB=function(t){function e(){var t;s(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=p(this,e,[].concat(r))).name="canvas-context-register",t}return m(e,t),c(e,[{key:"init",value:function(){this.context.ContextService=PB}},{key:"destroy",value:function(){delete this.context.ContextService}}])}(fr),HB=function(t){function e(t){var n;return s(this,e),(n=p(this,e,[t])).registerPlugin(new RB),n.registerPlugin(new Dc.Plugin),n.registerPlugin(new DB),n.registerPlugin(new AB),n.registerPlugin(new Kc.Plugin),n.registerPlugin(new QB),n.registerPlugin(new Hc.Plugin),n}return m(e,t),c(e)}(gr);class _B extends Uw{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},_B.defaultStyleProps,t.style)})),this.rootPointerEvent=new Ws(null),this.forwardEvents=t=>{const e=this.context.canvas,n=e.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(t,n).forEach(r=>{const i=this.bootstrapEvent(this.rootPointerEvent,r,n,t);Qe(e.context.eventService,"mappingTable.pointerupoutside",[]),e.context.eventService.mapEvent(i)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[t.CommonEvent.CLICK,t.CommonEvent.POINTER_DOWN,t.CommonEvent.POINTER_MOVE,t.CommonEvent.POINTER_UP,t.CommonEvent.POINTER_OVER,t.CommonEvent.POINTER_LEAVE]}getDomElement(){return this.getShape("key").getDomElement()}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.drawPortShapes(t,e)}getKeyStyle(t){const e=Ue(t,["dx","dy","innerHTML","pointerEvents","cursor"]),{dx:n=0,dy:r=0}=e,i=He(e,["dx","dy"]),[A,o]=this.getSize(t);return Object.assign(Object.assign({x:n,y:r},i),{width:A,height:o})}drawKeyShape(t,e){const n=this.getKeyStyle(t),{x:r,y:i,width:A=0,height:o=0}=n,s=this.upsert("key-container",lc,{x:r,y:i,width:A,height:o,opacity:0},e);return this.upsert("key",tc,n,s)}connectedCallback(){if(!(this.context.canvas.getRenderer("main")instanceof HB))return;const t=this.getDomElement();this.events.forEach(e=>{t.addEventListener(e,this.forwardEvents)})}attributeChangedCallback(t,e,n){"zIndex"===t&&e!==n&&(this.getDomElement().style.zIndex=n)}destroy(){const t=this.getDomElement();this.events.forEach(e=>{t.removeEventListener(e,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(t,e){const n=[];if(e.isTouchEvent(t))for(let e=0;e<t.changedTouches.length;e++){const r=t.changedTouches[e];pe(r.button)&&(r.button=0),pe(r.buttons)&&(r.buttons=1),pe(r.isPrimary)&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),pe(r.width)&&(r.width=r.radiusX||1),pe(r.height)&&(r.height=r.radiusY||1),pe(r.tiltX)&&(r.tiltX=0),pe(r.tiltY)&&(r.tiltY=0),pe(r.pointerType)&&(r.pointerType="touch"),pe(r.pointerId)&&(r.pointerId=r.identifier||0),pe(r.pressure)&&(r.pressure=r.force||.5),pe(r.twist)&&(r.twist=0),pe(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=t.type,n.push(r)}else if(e.isMouseEvent(t)){const e=t;pe(e.isPrimary)&&(e.isPrimary=!0),pe(e.width)&&(e.width=1),pe(e.height)&&(e.height=1),pe(e.tiltX)&&(e.tiltX=0),pe(e.tiltY)&&(e.tiltY=0),pe(e.pointerType)&&(e.pointerType="mouse"),pe(e.pointerId)&&(e.pointerId=1),pe(e.pressure)&&(e.pressure=.5),pe(e.twist)&&(e.twist=0),pe(e.tangentialPressure)&&(e.tangentialPressure=0),e.isNormalized=!0,n.push(e)}else n.push(t);return n}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.ctrlKey=e.ctrlKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.screen.x=e.screenX,t.screen.y=e.screenY,t.relatedTarget=null}bootstrapEvent(t,e,n,r){t.view=n,t.originalEvent=null,t.nativeEvent=r,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e);const{x:i,y:A}=this.getViewportXY(e);t.viewport.x=i,t.viewport.y=A;const[o,s]=this.context.canvas.getCanvasByViewport([i,A]);return t.canvas.x=o,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.isTrusted=r.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t}getViewportXY(t){let e,n;const{offsetX:r,offsetY:i,clientX:A,clientY:o}=t;if(zt(r)||zt(i)){const t=this.eventService.client2Viewport({x:A,y:o});e=t.x,n=t.y}else e=r,n=i;return{x:e,y:n}}onframe(){super.onframe();const{opacity:t}=this.attributes;this.getDomElement().style.opacity=`${t}`}}_B.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:"auto"};let GB=class t extends Uw{constructor(e){super(lw({style:t.defaultStyleProps},e))}getKeyStyle(t){const[e,n]=this.getSize(t),r=super.getKeyStyle(t),{fillOpacity:i,opacity:A=i}=r,o=He(r,["fillOpacity","opacity"]);return Object.assign(Object.assign({opacity:A},o),{width:e,height:n,x:-e/2,y:-n/2})}getBounds(){return this.getShape("key").getBounds()}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getShape("key").attributes,{fill:n,stroke:r}=e;He(e,["fill","stroke"]);const i=Aw(this.getGraphicStyle(t),"halo"),A=Number(i.lineWidth),[o,s]=cy(this.getSize(t),[A,A]),{lineWidth:a}=i,c={fill:"transparent",lineWidth:a/2,width:o-a/2,height:s-a/2,x:-(o-a/2)/2,y:-(s-a/2)/2};return Object.assign(Object.assign({},i),c)}getIconStyle(t){const e=super.getIconStyle(t),[n,r]=this.getSize(t);return!!e&&Object.assign({width:n*Xy,height:r*Xy},e)}drawKeyShape(t,e){const n=this.upsert("key",xw,this.getKeyStyle(t),e);return Mw(this),n}drawHaloShape(t,e){this.upsert("halo",lc,this.getHaloStyle(t),e)}update(t){super.update(t),t&&("x"in t||"y"in t||"z"in t)&&kw(this)}};GB.defaultStyleProps={size:32};class KB extends Uw{constructor(t){super(t)}getKeyStyle(t){const[e,n]=this.getSize(t);return Object.assign(Object.assign({},super.getKeyStyle(t)),{width:e,height:n,x:-e/2,y:-n/2})}getIconStyle(t){const e=super.getIconStyle(t),{width:n,height:r}=this.getShape("key").attributes;return!!e&&Object.assign({width:n*Xy,height:r*Xy},e)}drawKeyShape(t,e){return this.upsert("key",lc,this.getKeyStyle(t),e)}}class jB extends Ow{constructor(t){super(t)}getInnerR(t){return t.innerR||3*this.getOuterR(t)/8}getOuterR(t){return Math.min(...this.getSize(t))/2}getPoints(t){return e=this.getOuterR(t),n=this.getInnerR(t),[[0,-e],[n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,n],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-n*Math.cos(Math.PI/10),n*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-n*Math.cos(3*Math.PI/10),-n*Math.sin(3*Math.PI/10)]];var e,n}getIconStyle(t){const e=super.getIconStyle(t),n=2*this.getInnerR(t)*Xy;return!!e&&Object.assign({width:n,height:n},e)}getPortXY(t,e){const{placement:n="top"}=e,r=this.getShape("key").getLocalBounds(),i=function(t,e){const n={};return n.top=[0,-t],n.left=[-t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n["left-bottom"]=[-t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.bottom=[0,e],n["right-bottom"]=[t*Math.cos(3*Math.PI/10),t*Math.sin(3*Math.PI/10)],n.right=n.default=[t*Math.cos(Math.PI/10),-t*Math.sin(Math.PI/10)],n}(this.getOuterR(t),this.getInnerR(t));return _b(r,n,i,!1)}}class VB extends Ow{constructor(t){super(lw({style:VB.defaultStyleProps},t))}getPoints(t){const{direction:e}=t,[n,r]=this.getSize(t);return function(t,e,n){const r=e/2,i=t/2,A={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return A[n]||A.up}(n,r,e)}getPortXY(t,e){const{direction:n}=t,{placement:r="top"}=e,i=this.getShape("key").getLocalBounds(),[A,o]=this.getSize(t),s=function(t,e,n){const r=e/2,i=t/2,A={};"down"===n?(A.bottom=A.default=[0,r],A.right=[i,-r],A.left=[-i,-r]):"left"===n?(A.top=[i,-r],A.bottom=[i,r],A.left=A.default=[-i,0]):"right"===n?(A.top=[-i,-r],A.bottom=[-i,r],A.right=A.default=[i,0]):(A.left=[-i,r],A.top=A.default=[0,-r],A.right=[i,r]);return A}(A,o,n);return _b(i,r,s,!1)}getIconStyle(t){const{icon:e,iconText:n,iconSrc:r,direction:i}=t;if(!1===e||Fe(n||r))return!1;const A=Aw(this.getGraphicStyle(t),"icon"),o=this.getShape("key").getLocalBounds(),[s,a]=function(t,e){const{center:n}=t,[r,i]=bm(t);return["up"===e||"down"===e?n[0]:"right"===e?n[0]-r/6:n[0]+r/6,"left"===e||"right"===e?n[1]:"down"===e?n[1]-i/6:n[1]+i/6]}(o,i),c=2*function(t,e){let[n,r]=bm(t);return[n,r]="up"===e||"down"===e?[n,r]:[r,n],(Math.pow(r,2)-Math.pow(Math.sqrt(Math.pow(n/2,2)+Math.pow(r,2))-n/2,2))/(2*r)}(o,i)*Xy;return Object.assign({x:s,y:a,width:c,height:c},A)}}VB.defaultStyleProps={size:40,direction:"up"};class zB extends Uw{constructor(t){super(lw({style:zB.defaultStyleProps},t)),this.type="combo",this.updateComboPosition(this.parsedAttributes)}getKeySize(t){const{collapsed:e,childrenNode:n=[]}=t;return 0===n.length?this.getEmptyKeySize(t):e?this.getCollapsedKeySize(t):this.getExpandedKeySize(t)}getEmptyKeySize(t){const{padding:e,collapsedSize:n}=t,[r,i,A,o]=mm(e);return cy(aw(n),[o+i,r+A,0])}getCollapsedKeySize(t){return aw(t.collapsedSize)}getExpandedKeySize(t){const e=this.getContentBBox(t);return[wm(e),Bm(e),0]}getContentBBox(t){const{childrenNode:e=[],padding:n}=t,r=e.map(t=>this.context.element.getElement(t)).filter(Boolean);if(0===r.length){const e=new br,{x:n=0,y:r=0,size:i}=t,[A,o]=aw(i);return e.setMinMax([n-A/2,r-o/2,0],[n+A/2,r+o/2,0]),e}const i=Fm(r.map(t=>t.getBounds()));return n?Cm(i,n):i}drawCollapsedMarkerShape(t,e){const n=this.getCollapsedMarkerStyle(t);this.upsert("collapsed-marker",Qw,n,e),Mw(this)}getCollapsedMarkerStyle(t){if(!t.collapsed||!t.collapsedMarker)return!1;const e=Aw(this.getGraphicStyle(t),"collapsedMarker"),{type:n}=e,r=He(e,["type"]),i=this.getShape("key"),[A,o]=Qy(i.getLocalBounds(),"center"),s=Object.assign(Object.assign({},r),{x:A,y:o});if(n){const e=this.getCollapsedMarkerText(n,t);Object.assign(s,{text:e})}return s}getCollapsedMarkerText(t,e){const{childrenData:n=[]}=e,{model:r}=this.context;return"descendant-count"===t?r.getDescendantsData(this.id).length.toString():"child-count"===t?n.length.toString():"node-count"===t?r.getDescendantsData(this.id).filter(t=>"node"===r.getElementType(Vm(t))).length.toString():Vt(t)?t(n):""}getComboPosition(t){const{x:e=0,y:n=0,collapsed:r,childrenData:i=[]}=t;if(0===i.length)return[+e,+n,0];if(r){const{model:t}=this.context,r=t.getDescendantsData(this.id).filter(e=>!t.isCombo(Vm(e)));if(r.length>0&&r.some(ky)){return hy(r.reduce((t,e)=>cy(t,My(e)),[0,0,0]),r.length)}return[+e,+n,0]}return this.getContentBBox(t).center}getComboStyle(t){const[e,n]=this.getComboPosition(t);return{x:e,y:n,transform:[["translate",e,n]]}}updateComboPosition(t){const e=this.getComboStyle(t);Object.assign(this.style,e);const{x:n,y:r}=e;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:r}}),kw(this)}render(t,e=this){super.render(t,e),this.drawCollapsedMarkerShape(t,e)}update(t={}){super.update(t),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(this.attributes.collapsed?t:t.map(t=>{var{x:e,y:n,z:r,transform:i}=t;return He(t,["x","y","z","transform"])}),e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,n))}):n}}zB.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:"center",collapsedMarkerTextBaseline:"middle",collapsedMarkerType:"child-count"};class WB extends zB{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",Ya,this.getKeyStyle(t),e)}getKeyStyle(t){const{collapsed:e}=t,n=super.getKeyStyle(t),[r]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},n),e&&Aw(n,"collapsed")),{r:r/2})}getCollapsedKeySize(t){const[e,n]=aw(t.collapsedSize),r=Math.max(e,n)/2;return[2*r,2*r,0]}getExpandedKeySize(t){const e=this.getContentBBox(t),[n,r]=bm(e),i=Math.sqrt(Math.pow(n,2)+Math.pow(r,2))/2;return[2*i,2*i,0]}getIntersectPoint(t,e=!1){return Ry(t,this.getShape("key").getBounds(),e)}}class YB extends zB{constructor(t){super(t)}drawKeyShape(t,e){return this.upsert("key",lc,this.getKeyStyle(t),e)}getKeyStyle(t){const e=super.getKeyStyle(t),[n,r]=this.getKeySize(t);return Object.assign(Object.assign(Object.assign({},e),t.collapsed&&Aw(e,"collapsed")),{width:n,height:r,x:-n/2,y:-r/2})}}const XB={padding:10};function qB(t,e,n,r,i,A){const{padding:o}=Object.assign(XB,A),s=Em(n,o),a=Em(r,o),c=[t,...i,e];let l=null;const u=[];for(let t=0,e=c.length;t<e-1;t++){const n=t+1,r=c[t],i=c[n],A=Iy(r,i);let h=null;if(0===t)if(n===e-1)if(s.intersects(a))h=Ab(r,i,s,a);else if(Qm(r,s)||Qm(i,a))A||(h=ib(r,i,s,a));else{const t=Um(r,s),e=Um(i,a);h=eb(t,e,$B(t,e)),h.points.unshift(t),h.points.push(e)}else Mm(i,s)?h=Ab(r,i,s,Em(i,o),l):A||(h=nb(r,i,s));else n===e-1?Mm(r,a)?h=Ab(r,i,Em(r,o),a,l):A||(h=rb(r,i,a,l)):A||(h=eb(r,i,l));h?(u.push(...h.points),l=h.direction):l=$B(r,i),n<e-1&&u.push(i)}return u.map(wy)}const ZB={N:"S",S:"N",W:"E",E:"W"},JB={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function $B(t,e){const[n,r]=t,[i,A]=e;return n===i?r>A?"N":"S":r===A?n>i?"W":"E":null}function tb(t,e){return"N"===e||"S"===e?Bm(t):wm(t)}function eb(t,e,n){const r=[t[0],e[1]],i=[e[0],t[1]],A=$B(t,r),o=$B(t,i),s=n?ZB[n]:null,a=A===n||A!==s&&o!==n?r:i;return{points:[a],direction:$B(a,e)}}function nb(t,e,n){if(Qm(t,n)){const r=ob(t,e,n);return{points:[r],direction:$B(r,e)}}{const r=Um(t,n),i=["left","right"].includes(Sm(t,n))?[e[0],r[1]]:[r[0],e[1]];return{points:[i],direction:$B(i,e)}}}function rb(t,e,n,r){const i=Qm(e,n)?e:Um(e,n),A=[[i[0],t[1]],[t[0],i[1]]],o=A.filter(t=>function(t,e){return!Mm(t,e)}(t,n)&&!km(t,n,!0)),s=o.filter(e=>$B(e,t)!==r);if(s.length>0){const n=s.find(e=>$B(t,e)===r)||s[0];return{points:[n],direction:$B(n,e)}}{const i=Oy(e,jt(A,o)[0],tb(n,r)/2);return{points:[ob(i,t,n),i],direction:$B(i,e)}}}function ib(t,e,n,r){let i=nb(t,e,n);const A=By(i.points[0]);if(Mm(A,r)){i=nb(e,t,r);const o=By(i.points[0]);if(Mm(o,n)){const s=Oy(t,A,tb(n,$B(t,A))/2),a=Oy(e,o,tb(r,$B(e,o))/2),c=[(s[0]+a[0])/2,(s[1]+a[1])/2],l=nb(t,c,n),u=rb(c,e,r,l.direction);i.points=[l.points[0],u.points[0]],i.direction=u.direction}}return i}function Ab(t,e,n,r,i){const A=.01,o=Fm([n,r]),s=fy(e,o.center)>fy(t,o.center),[a,c]=s?[e,t]:[t,e],l=Bm(o)+wm(o);let u;if(i){const t=[a[0]+l*Math.cos(JB[i]),a[1]+l*Math.sin(JB[i])];u=Oy(Um(t,o),t,A)}else u=Oy(Um(a,o),a,-.01);let h=ob(u,c,o),d=[Ty(u,2),Ty(h,2)];if(Me(Ty(u),Ty(h))){const t=vy(ly(u,a),[1,0,0])+Math.PI/2;h=[c[0]+l*Math.cos(t),c[1]+l*Math.sin(t),0],h=Ty(Oy(Um(h,o),c,-.01),2);d=[u,ob(u,h,o),h]}return{points:s?d.reverse():d,direction:$B(s?u:h,e)}}function ob(t,e,n){let r=[t[0],e[1]];return Mm(r,n)&&(r=[e[0],t[1]]),r}function sb(t,e,n,r,i){let A="number"==typeof e?e:.5;"start"===e&&(A=0),"end"===e&&(A=.99);const o=Sy(t.getPoint(A)),s=Sy(t.getPoint(A+.01));let a="start"===e?"left":"end"===e?"right":"center";if(Ny(o,s)||!n){const[e,n]=ab(t,A,r,i);return{transform:[["translate",e,n]],textAlign:a}}let c=Math.atan2(s[1]-o[1],s[0]-o[0]);s[0]<o[0]&&(a="center"===a?a:"left"===a?"right":"left",r*=-1,c+=Math.PI);const[l,u]=ab(t,A,r,i,c);return{textAlign:a,transform:[["translate",l,u],["rotate",c/Math.PI*180]]}}function ab(t,e,n,r,i){const[A,o]=Sy(t.getPoint(e));let s=n,a=r;return i&&(s=n*Math.cos(i)-r*Math.sin(i),a=n*Math.sin(i)+r*Math.cos(i)),[A+s,o+a]}function cb(t,e,n,r){if(Me(t,e))return t;const i=ly(e,t),A=[t[0]+n*i[0],t[1]+n*i[1]],o=py(my(i,!1));return A[0]+=r*o[0],A[1]+=r*o[1],A}function lb(t,e,n){return[["M",t[0],t[1]],["C",n[0][0],n[0][1],n[1][0],n[1][1],e[0],e[1]]]}function ub(t,e=0,n=!1){const r=t.length-1,i=t[0],A=t[r],o=t.slice(1,r),s=[["M",i[0],i[1]]];return o.forEach((t,n)=>{const r=o[n-1]||i,a=o[n+1]||A;if(!Ly(r,t,a)&&e){const[n,i]=function(t,e,n,r){const i=gy(t,e),A=gy(n,e),o=Math.min(r,Math.min(i,A)/2),s=[e[0]-o/i*(e[0]-t[0]),e[1]-o/i*(e[1]-t[1])],a=[e[0]-o/A*(e[0]-n[0]),e[1]-o/A*(e[1]-n[1])];return[s,a]}(r,t,a,e);s.push(["L",n[0],n[1]],["Q",t[0],t[1],i[0],i[1]],["L",i[0],i[1]])}else s.push(["L",t[0],t[1]])}),s.push(["L",A[0],A[1]]),n&&s.push(["Z"]),s}function hb(t,e,n,r,i){const A=Em(t),o=t.getCenter();let s=r&&jb(r),a=i&&jb(i);if(!s||!a){const r=(t=>{const e=Math.PI/2,n=Bm(t)/2,r=wm(t)/2,i=Math.atan2(n,r)/2,A=Math.atan2(r,n)/2;return{top:[-e-A,-e+A],"top-right":[-e+A,-i],"right-top":[-e+A,-i],right:[-i,i],"bottom-right":[i,e-A],"right-bottom":[i,e-A],bottom:[e-A,e+A],"bottom-left":[e+A,Math.PI-i],"left-bottom":[e+A,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-e-A],"left-top":[Math.PI+i,-e-A]}})(A),i=r[e][0],c=r[e][1],[l,u]=bm(A),h=Math.max(l,u),d=cy(o,[h*Math.cos(i),h*Math.sin(i),0]),f=cy(o,[h*Math.cos(c),h*Math.sin(c),0]);s=Yb(t,d),a=Yb(t,f),n||([s,a]=[a,s])}return[s,a]}function db(t,e,n,r,i,A){const o=t.getPorts()[i||A],s=t.getPorts()[A||i];let[a,c]=hb(t,e,n,o,s);const l=function(t,e,n,r){const i=t.getCenter();if(Me(e,n)){const t=ly(e,i),A=[r*Math.sign(t[0])||r/2,r*Math.sign(t[1])||-r/2,0];return[cy(e,A),cy(n,uy(A,[1,-1,1]))]}return[Oy(i,e,fy(i,e)+r),Oy(i,n,fy(i,n)+r)]}(t,a,c,r);return o&&(a=Wb(o,l[0])),s&&(c=Wb(s,l.at(-1))),lb(a,c,l)}function fb(t,e,n,r,i,A,o){const s=Gb(t),a=s[A||o],c=s[o||A];let[l,u]=hb(t,n,r,a,c);const h=function(t,e,n,r){const i=[],A=Em(t);if(Me(e,n)){switch(Sm(e,A)){case"left":i.push([e[0]-r,e[1]]),i.push([e[0]-r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"right":i.push([e[0]+r,e[1]]),i.push([e[0]+r,e[1]+r]),i.push([e[0],e[1]+r]);break;case"top":i.push([e[0],e[1]-r]),i.push([e[0]+r,e[1]-r]),i.push([e[0]+r,e[1]]);break;case"bottom":i.push([e[0],e[1]+r]),i.push([e[0]+r,e[1]+r]),i.push([e[0]+r,e[1]])}}else{const t=Sm(e,A),o=Sm(n,A);if(t===o){let A,o;switch(t){case"left":A=Math.min(e[0],n[0])-r,i.push([A,e[1]]),i.push([A,n[1]]);break;case"right":A=Math.max(e[0],n[0])+r,i.push([A,e[1]]),i.push([A,n[1]]);break;case"top":o=Math.min(e[1],n[1])-r,i.push([e[0],o]),i.push([n[0],o]);break;case"bottom":o=Math.max(e[1],n[1])+r,i.push([e[0],o]),i.push([n[0],o])}}else{const s=(t,e)=>({left:[e[0]-r,e[1]],right:[e[0]+r,e[1]],top:[e[0],e[1]-r],bottom:[e[0],e[1]+r]}[t]),a=s(t,e),c=s(o,n),l=ob(a,c,A);i.push(a,l,c)}}return i}(t,l,u,i);return a&&(l=Wb(a,h[0])),c&&(u=Wb(c,h.at(-1))),ub([l,...h,u],e)}function gb(t,e){const n=new Set,r=new Set,i=new Set;return t.forEach(A=>{e(A).forEach(e=>{n.add(e),t.includes(e.source)&&t.includes(e.target)?r.add(e):i.add(e)})}),{edges:Array.from(n),internal:Array.from(r),external:Array.from(i)}}function pb(t,e){const n=[];let r=t;for(;r;){n.push(r);const t=e(Vm(r));if(!t)break;r=t}if(n.some(t=>{var e;return null===(e=t.style)||void 0===e?void 0:e.collapsed})){const t=n.reverse().findIndex(nw);return n[t]||n.at(-1)}return t}const vb=(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",t/2,e/2],["Z"]];var mb=Object.freeze({__proto__:null,circle:(t,e)=>{const n=Math.max(t,e)/2;return[["M",-t/2,0],["A",n,n,0,1,0,2*n-t/2,0],["A",n,n,0,1,0,-t/2,0],["Z"]]},diamond:(t,e)=>[["M",-t/2,0],["L",0,-e/2],["L",t/2,0],["L",0,e/2],["Z"]],rect:(t,e)=>[["M",-t/2,-e/2],["L",t/2,-e/2],["L",t/2,e/2],["L",-t/2,e/2],["Z"]],simple:(t,e)=>[["M",t/2,-e/2],["L",-t/2,0],["L",t/2,0],["L",-t/2,0],["L",t/2,e/2]],triangle:vb,triangleRect:(t,e)=>{const n=t/2,r=t/7,i=t-r;return[["M",-n,0],["L",0,-e/2],["L",0,e/2],["Z"],["M",i-n,-e/2],["L",i+r-n,-e/2],["L",i+r-n,e/2],["L",i-n,e/2],["Z"]]},vee:(t,e)=>[["M",-t/2,0],["L",t/2,-e/2],["L",4*t/5-t/2,0],["L",t/2,e/2],["Z"]]});class yb extends Sw{constructor(t){super(lw({style:yb.defaultStyleProps},t)),this.type="edge"}get sourceNode(){const{sourceNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}get targetNode(){const{targetNode:t}=this.parsedAttributes;return this.context.element.getElement(t)}getKeyStyle(t){const e=this.getGraphicStyle(t),{loop:n}=e,r=He(e,["loop"]),{sourceNode:i,targetNode:A}=this;var o,s;const a={d:n&&(s=A,(o=i)&&s&&o===s)?this.getLoopPath(t):this.getKeyPath(t)};return Ac.PARSED_STYLE_LIST.forEach(t=>{t in r&&(a[t]=r[t])}),a}getLoopPath(t){const{sourcePort:e,targetPort:n}=t,r=this.sourceNode,i=Em(r),A=Math.max(wm(i),Bm(i)),{placement:o,clockwise:s,dist:a=A}=Aw(this.getGraphicStyle(t),"loop");return db(r,o,s,a,e,n)}getEndpoints(t,e=!0,n=[]){const{sourcePort:r,targetPort:i}=t,{sourceNode:A,targetNode:o}=this,[s,a]=function(t,e,n,r){const i=Vb(t,e,n,r),A=Vb(e,t,r,n);return[i,A]}(A,o,r,i);if(!e){return[s?jb(s):A.getCenter(),a?jb(a):o.getCenter()]}const c="function"==typeof n?n():n;return[zb(s||A,c[0]||a||o),zb(a||o,c[c.length-1]||s||A)]}getHaloStyle(t){if(!1===t.halo)return!1;const e=this.getKeyStyle(t),n=Aw(this.getGraphicStyle(t),"halo");return Object.assign(Object.assign({},e),n)}getLabelStyle(t){if(!1===t.label||!t.labelText)return!1;const e=Aw(this.getGraphicStyle(t),"label"),{placement:n,offsetX:r,offsetY:i,autoRotate:A,maxWidth:o}=e,s=He(e,["placement","offsetX","offsetY","autoRotate","maxWidth"]),a=sb(this.shapeMap.key,n,A,r,i),c=this.shapeMap.key.getLocalBounds(),l=function(t,e,n=1){return dw(fy(t[0],t[1])*n,e)}([c.min,c.max],o);return Object.assign({wordWrapWidth:l},a,s)}getBadgeStyle(t){if(!1===t.badge||!t.badgeText)return!1;const e=Aw(t,"badge"),{offsetX:n,offsetY:r,placement:i}=e,A=He(e,["offsetX","offsetY","placement"]);return Object.assign(A,function(t,e,n,r,i){var A,o;const s=2*(null===(A=t.badge)||void 0===A?void 0:A.getGeometryBounds().halfExtents[0])||0,a=2*(null===(o=t.label)||void 0===o?void 0:o.getGeometryBounds().halfExtents[0])||0;return sb(t.key,n,!0,(a?(a/2+s/2)*("suffix"===e?1:-1):0)+r,i)}(this.shapeMap,i,t.labelPlacement,n,r))}drawArrow(t,e){var n;const r="start"===e,i=t["start"===e?"startArrow":"endArrow"],A=this.shapeMap.key;if(i){const e=this.getArrowStyle(t,r),[n,i,o]=r?["markerStart","markerStartOffset","startArrowOffset"]:["markerEnd","markerEndOffset","endArrowOffset"],s=A.parsedStyle[n];if(s)s.attr(e);else{const t=new(e.src?ec:Ac)({style:e});A.style[n]=t}A.style[i]=t[o]||e.width/2+ +e.lineWidth}else{const t=r?"markerStart":"markerEnd";null===(n=A.style[t])||void 0===n||n.destroy(),A.style[t]=null}}getArrowStyle(t,e){const n=this.getShape("key").attributes,r=e?"startArrow":"endArrow",i=Aw(this.getGraphicStyle(t),r),{size:A,type:o}=i,s=He(i,["size","type"]),[a,c]=aw(function(t,e){return e||(t<4?10:4===t?12:2.5*t)}(n.lineWidth,A)),l=(Vt(o)?o:mb[o]||vb)(a,c);return Object.assign(Ue(n,["stroke","strokeOpacity","fillOpacity"]),{width:a,height:c},Object.assign({},l&&{d:l,fill:"simple"===o?"":n.stroke}),s)}drawLabelShape(t,e){const n=this.getLabelStyle(t);this.upsert("label",mw,n,e)}drawHaloShape(t,e){const n=this.getHaloStyle(t);this.upsert("halo",Ac,n,e)}drawBadgeShape(t,e){const n=this.getBadgeStyle(t);this.upsert("badge",yw,n,e)}drawSourceArrow(t){this.drawArrow(t,"start")}drawTargetArrow(t){this.drawArrow(t,"end")}drawKeyShape(t,e){const n=this.getKeyStyle(t);return this.upsert("key",Ac,n,e)}render(t=this.parsedAttributes,e=this){this.drawKeyShape(t,e),this.getShape("key")&&(this.drawSourceArrow(t),this.drawTargetArrow(t),this.drawLabelShape(t,e),this.drawHaloShape(t,e),this.drawBadgeShape(t,e))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(t,e){const n=super.animate(t,e);return n?new Proxy(n,{set:(t,e,n)=>("currentTime"===e&&Promise.resolve().then(()=>this.onframe()),Reflect.set(t,e,n))}):n}}yb.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:"suffix",isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:"80%",labelOffsetX:4,labelOffsetY:0,labelPlacement:"center",labelTextBaseline:"middle",labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:"none",haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:"round",startArrowLineWidth:1,startArrowTransformOrigin:"center",startArrowType:"vee",endArrow:!1,endArrowLineDash:0,endArrowLineJoin:"round",endArrowLineWidth:1,endArrowTransformOrigin:"center",endArrowType:"vee",loopPlacement:"top",loopClockwise:!0};class wb extends yb{constructor(t){super(lw({style:wb.defaultStyleProps},t))}getKeyPath(t){const[e,n]=this.getEndpoints(t),{controlPoints:r,curvePosition:i,curveOffset:A}=t,o=this.getControlPoints(e,n,function(t){return oe(t)?[t,1-t]:t}(i),function(t){return oe(t)?[t,-t]:t}(A),r);return lb(e,n,o)}getControlPoints(t,e,n,r,i){return 2===(null==i?void 0:i.length)?i:[cb(t,e,n[0],r[0]),cb(t,e,n[1],r[1])]}}wb.defaultStyleProps={curvePosition:.5,curveOffset:20};class Bb extends wb{constructor(t){super(lw({style:Bb.defaultStyleProps},t))}getControlPoints(t,e,n,r){const i=e[0]-t[0];return[[t[0]+i*n[0]+r[0],t[1]],[e[0]-i*n[1]+r[1],e[1]]]}}Bb.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};class bb extends wb{constructor(t){super(lw({style:bb.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(t){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(t);const e=My(this.ref);return[this.sourceNode.getIntersectPoint(e,!0),this.targetNode.getIntersectPoint(e)]}toRadialCoordinate(t){const e=My(this.ref);return[fy(t,e),by(ly(t,e))]}getControlPoints(t,e,n,r){const[i,A]=this.toRadialCoordinate(t),[o]=this.toRadialCoordinate(e),s=o-i;return[[t[0]+(s*n[0]+r[0])*Math.cos(A),t[1]+(s*n[0]+r[0])*Math.sin(A)],[e[0]-(s*n[1]-r[0])*Math.cos(A),e[1]-(s*n[1]-r[0])*Math.sin(A)]]}}bb.defaultStyleProps={curvePosition:.5,curveOffset:20};class Eb extends wb{constructor(t){super(lw({style:Eb.defaultStyleProps},t))}getControlPoints(t,e,n,r){const i=e[1]-t[1];return[[t[0],t[1]+i*n[0]+r[0]],[e[0],e[1]-i*n[1]+r[1]]]}}Eb.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};let xb=class t extends yb{constructor(e){super(lw({style:t.defaultStyleProps},e))}getKeyPath(t){const[e,n]=this.getEndpoints(t);return[["M",e[0],e[1]],["L",n[0],n[1]]]}};xb.defaultStyleProps={};const Cb={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:gy},Fb=t=>`${Math.round(t[0])}|||${Math.round(t[1])}`;function Mb(t,e){const n=t=>Math.round(t/e);return oe(t)?n(t):t.map(n)}function kb(t,e){const n=e[0]-t[0],r=e[1]-t[1];return n||r?Math.atan2(r,n):0}function Qb(t,e,n,r){const i=kb(t,e),A=n[Fb(t)];return function(t,e){const n=Math.abs(t-e);return n>Math.PI?2*Math.PI-n:n}(kb(A||r,t),i)}function Sb(t,e,n){return Math.min(...e.map(e=>n(t,e)))}const Ub=(t,e,n,r)=>{if(!e)return[t];const{directionMap:i,offset:A}=r,o=Cm(e.getRenderBounds(),A),s=Object.keys(i).reduce((e,r)=>{if(n.includes(r)){const n=i[r],[A,s]=bm(o),a=[t[0]+n.stepX*A,t[1]+n.stepY*s],c=function(t){const{min:[e,n],max:[r,i]}=t,A=[e,i],o=[r,i],s=[r,n],a=[e,n];return[[A,o],[o,s],[s,a],[a,A]]}(o);for(let n=0;n<c.length;n++){const r=Cy([t,a],c[n]);r&&km(r,o)&&e.push(r)}}return e},[]);return Mm(t,o)||s.push(t),s.map(t=>Mb(t,r.gridSize))},Tb=(t,e,n,r,i,A,o)=>{const s=[];let a=[A[0]===r[0]?r[0]:t[0]*o,A[1]===r[1]?r[1]:t[1]*o];s.unshift(a);let c=t,l=e[Fb(c)];for(;l;){const t=l,r=c;Qb(t,r,e,n)&&(a=[t[0]===r[0]?a[0]:t[0]*o,t[1]===r[1]?a[1]:t[1]*o],s.unshift(a)),l=e[Fb(t)],c=t}const u=i.map(t=>[t[0]*o,t[1]*o]),h=function(t,e,n){let r=t[0],i=n(t[0],e);for(let A=0;A<t.length;A++){const o=t[A],s=n(o,e);s<i&&(r=o,i=s)}return r}(u,a,gy);return s.unshift(h),s};function Ob(t,e,n,r){const i=wy(t.getCenter()),A=wy(e.getCenter()),o=Object.assign(Cb,r),{gridSize:s}=o,a=((t,e)=>{const{offset:n,gridSize:r}=e,i={};return t.forEach(t=>{if(!t||t.destroyed||!t.isVisible())return;const e=Cm(t.getRenderBounds(),n);for(let t=Mb(e.min[0],r);t<=Mb(e.max[0],r);t+=1)for(let n=Mb(e.min[1],r);n<=Mb(e.max[1],r);n+=1)i[`${t}|||${n}`]=!0}),i})(o.enableObstacleAvoidance?n:[t,e],o),c=Mb(i,s),l=Mb(A,s),u=Ub(i,t,o.startDirections,o),h=Ub(A,e,o.endDirections,o);u.forEach(t=>delete a[Fb(t)]),h.forEach(t=>delete a[Fb(t)]);const d={},f={},g={},p={},v={},m=new Nb;for(let t=0;t<u.length;t++){const e=u[t],n=Fb(e);d[n]=e,p[n]=0,v[n]=Sb(e,h,o.distFunc),m.add({id:n,value:v[n]})}const y=h.map(t=>Fb(t));let w,B=o.maximumLoops,b=1/0;for(const[t,e]of Object.entries(d))v[t]<=b&&(b=v[t],w=e);for(;Object.keys(d).length>0&&B>0;){const t=m.minId(!1);if(!t)break;w=d[t];const e=Fb(w);if(y.includes(e))return Tb(w,g,c,A,u,l,s);delete d[e],m.remove(e),f[e]=!0;for(const t of Object.values(o.directionMap)){const n=cy(w,[t.stepX,t.stepY]),r=Fb(n);if(f[r])continue;const i=Qb(w,n,g,c);if(i>o.maxAllowedDirectionChange)continue;if(a[r])continue;d[r]||(d[r]=n);const A=o.penalties[i],l=o.distFunc(w,n)+(isNaN(A)?s:A),u=p[e]+l,y=p[r];y&&u>=y||(g[r]=w,p[r]=u,v[r]=u+Sb(n,h,o.distFunc),m.add({id:r,value:v[r]}))}B-=1}return[]}class Nb{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(t,e){let n=0,r=e-1;for(;r-n>1;){const e=Math.floor((n+r)/2);if(this.arr[e].value>t.value)r=e;else{if(!(this.arr[e].value<t.value))return this.arr.splice(e,0,t),void(this.map[t.id]=!0);n=e}}this.arr.splice(r,0,t),this.map[t.id]=!0}add(t){delete this.map[t.id];const e=this.arr.length;if(!e||this.arr[e-1].value<t.value)return this.arr.push(t),void(this.map[t.id]=!0);this._innerAdd(t,e)}remove(t){this.map[t]&&delete this.map[t]}_clearAndGetMinId(){let t;for(let e=this.arr.length-1;e>=0;e--)this.map[this.arr[e].id]?t=this.arr[e].id:this.arr.splice(e,1);return t}_findFirstId(){for(;this.arr.length;){const t=this.arr.shift();if(this.map[t.id])return t.id}}minId(t){return t?this._clearAndGetMinId():this._findFirstId()}}class Ib extends yb{constructor(t){super(lw({style:Ib.defaultStyleProps},t))}getControlPoints(t){const{router:e}=t,{sourceNode:n,targetNode:r}=this,[i,A]=this.getEndpoints(t,!1);let o=[];if(e)if("shortest-path"===e.type){o=Ob(n,r,this.context.element.getNodes(),e),o.length||(o=qB(i,A,n,r,t.controlPoints,{padding:e.offset}))}else"orth"===e.type&&(o=qB(i,A,n,r,t.controlPoints,e));else o=t.controlPoints;return o}getPoints(t){const e=this.getControlPoints(t),[n,r]=this.getEndpoints(t,!0,e);return[n,...e,r]}getKeyPath(t){return ub(this.getPoints(t),t.radius)}getLoopPath(t){const{sourcePort:e,targetPort:n,radius:r}=t,i=this.sourceNode,A=Em(i),o=Math.max(wm(A),Bm(A))/4,{placement:s,clockwise:a,dist:c=o}=Aw(this.getGraphicStyle(t),"loop");return fb(i,r,s,a,c,e,n)}}Ib.defaultStyleProps={radius:0,controlPoints:[],router:!1};class Lb extends yb{constructor(t){super(lw({style:Lb.defaultStyleProps},t))}getKeyPath(t){const{curvePosition:e,curveOffset:n}=t,[r,i]=this.getEndpoints(t);return function(t,e,n){return[["M",t[0],t[1]],["Q",n[0],n[1],e[0],e[1]]]}(r,i,t.controlPoint||cb(r,i,e,n))}}function Db(t){return t instanceof Uw&&"node"===t.type}function Pb(t){return t instanceof yb}function Rb(t){return t instanceof zB}Lb.defaultStyleProps={curvePosition:.5,curveOffset:30};const Hb={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],"left-top":[0,0],"top-left":[0,0],"left-bottom":[0,1],"bottom-left":[0,1],"right-top":[1,0],"top-right":[1,0],"right-bottom":[1,1],"bottom-right":[1,1],default:[.5,.5]};function _b(t,e,n=Hb,r=!0){const i=[.5,.5],A=ne(e)?ke(n,e.toLocaleLowerCase(),i):e;if(!r&&ne(e))return A;const[o,s]=A||i;return[t.min[0]+wm(t)*o,t.min[1]+Bm(t)*s]}function Gb(t){if(!t)return{};const e=t.getPorts();return(t.attributes.ports||[]).forEach((n,r)=>{var i;const{key:A,placement:o}=n;Kb(n)&&(e[i=A||r]||(e[i]=Qy(t.getShape("key").getBounds(),o)))}),e}function Kb(t){const{r:e}=t;return!e||0===Number(e)}function jb(t){return pm(t)?t:t.getPosition()}function Vb(t,e,n,r){const i=Gb(t);if(n)return i[n];const A=Object.values(i);if(0===A.length)return;const o=A.map(t=>jb(t)),s=function(t,e){const n=Gb(t);if(e)return[jb(n[e])];const r=Object.values(n);return r.length>0?r.map(t=>jb(t)):[t.getCenter()]}(e,r),[a]=function(t,e){let n=1/0,r=[t[0],e[0]];return t.forEach(t=>{e.forEach(e=>{const i=fy(t,e);i<n&&(n=i,r=[t,e])})}),r}(o,s);return A.find(t=>jb(t)===a)}function zb(t,e){return Rb(t)||Db(t)?Yb(t,e):Wb(t,e)}function Wb(t,e){if(!t||!e)return[0,0,0];if(pm(t))return t;if(t.attributes.linkToCenter)return t.getPosition();return Ry(pm(e)?e:Db(e)?e.getCenter():e.getPosition(),t.getBounds())}function Yb(t,e){if(!t||!e)return[0,0,0];const n=pm(e)?e:Db(e)?e.getCenter():e.getPosition();return t.getIntersectPoint(n)||t.getCenter()}function Xb(t,e="bottom",n=0,r=0,i=!1){const A=e.split("-"),[o,s]=Qy(t,e),[a,c]=i?["bottom","top"]:["top","bottom"];return{transform:[["translate",o+n,s+r]],textBaseline:A.includes("top")?c:A.includes("bottom")?a:"middle",textAlign:A.includes("left")?"right":A.includes("right")?"left":"center"}}function qb(t){return"hidden"!==ke(t,["style","visibility"])}function Zb(t,e){"update"in t?t.update(e):t.attr(e)}function Jb(t){return ke(t,"__to_be_destroyed__",!1)}class $b extends oy{constructor(t,e){super(t,Object.assign({},$b.defaultOptions,e)),this.onCollapseExpand=t=>_e(this,void 0,void 0,function*(){if(!this.validate(t))return;const{target:e}=t;if(!(Db(n=e)||Pb(n)||Rb(n)))return;var n;const r=e.id,{model:i,graph:A}=this.context,o=i.getElementDataById(r);if(!o)return!1;const{onCollapse:s,onExpand:a,animation:c,align:l}=this.options;nw(o)?(yield A.expandElement(r,{animation:c,align:l}),null==a||a(r)):(yield A.collapseElement(r,{animation:c,align:l}),null==s||s(r))}),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`node:${e}`,this.onCollapseExpand),t.on(`combo:${e}`,this.onCollapseExpand)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`node:${e}`,this.onCollapseExpand),t.off(`combo:${e}`,this.onCollapseExpand)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}function tE(t,e){const{data:n,style:r}=t,i=He(t,["data","style"]),{data:A,style:o}=e,s=He(e,["data","style"]),a=Object.assign(Object.assign({},i),s);return(n||A)&&Object.assign(a,{data:Object.assign(Object.assign({},n),A)}),(r||o)&&Object.assign(a,{style:Object.assign(Object.assign({},r),o)}),a}function eE(t){const{data:e,style:n}=t,r=He(t,["data","style"]);return e&&(r.data=Object.assign({},e)),n&&(r.style=Object.assign({},n)),r}function nE(t={},e={}){const{states:n=[],data:r={},style:i={},children:A=[]}=t,o=He(t,["states","data","style","children"]),{states:s=[],data:a={},style:c={},children:l=[]}=e,u=(t,e)=>t.length===e.length&&t.every((t,n)=>t===e[n]),h=(t,e)=>{const n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(n=>t[n]===e[n])};return!!h(o,He(e,["states","data","style","children"]))&&(!!u(A,l)&&(!!u(n,s)&&(!!h(r,a)&&!!h(i,c))))}$b.defaultOptions={enable:!0,animation:!0,trigger:t.CommonEvent.DBLCLICK,align:!0};const rE="__internal_override__";function iE(t){return!1!==t[rE]}const AE="g6-create-edge-assist-node-id";class oE extends oy{constructor(t,e){super(t,Object.assign({},oE.defaultOptions,e)),this.drop=t=>_e(this,void 0,void 0,function*(){const{targetType:e}=t;["combo","node"].includes(e)&&this.source?yield this.handleCreateEdge(t):yield this.cancelEdge()}),this.handleCreateEdge=t=>_e(this,void 0,void 0,function*(){var e,n,r;if(!this.validate(t))return;const{graph:i,canvas:A,batch:o,element:s}=this.context,{style:a}=this.options;if(this.source)return this.createEdge(t),void(yield this.cancelEdge());o.startBatch(),A.setCursor("crosshair"),this.source=this.getSelectedNodeIDs([t.target.id])[0];const c=i.getElementData(this.source);i.addNodeData([{id:AE,type:"circle",[rE]:!1,style:{size:1,visibility:"hidden",ports:[{key:"port-1",placement:[.5,.5]}],x:null===(e=c.style)||void 0===e?void 0:e.x,y:null===(n=c.style)||void 0===n?void 0:n.y}}]),i.addEdgeData([{id:"g6-create-edge-assist-edge-id",source:this.source,target:AE,style:Object.assign({pointerEvents:"none"},a)}]),yield null===(r=s.draw({animation:!1}))||void 0===r?void 0:r.finished}),this.updateAssistEdge=t=>_e(this,void 0,void 0,function*(){var e;if(!this.source)return;const{model:n,element:r}=this.context;n.translateNodeTo(AE,[t.client.x,t.client.y]),yield null===(e=r.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished}),this.createEdge=t=>{var e,n;const{graph:r}=this.context,{style:i,onFinish:A,onCreate:o}=this.options;if(void 0===(null===(e=t.target)||void 0===e?void 0:e.id)||void 0===this.source)return;const s=null===(n=this.getSelectedNodeIDs([t.target.id]))||void 0===n?void 0:n[0];var a;const c=o({id:`${this.source}-${s}-${Ne[a=a||"g"]?Ne[a]+=1:Ne[a]=1,a+Ne[a]}`,source:this.source,target:s,style:i});c&&(r.addEdgeData([c]),A(c))},this.cancelEdge=()=>_e(this,void 0,void 0,function*(){var t;if(!this.source)return;const{graph:e,element:n,batch:r}=this.context;e.removeNodeData([AE]),this.source=void 0,yield null===(t=n.draw({animation:!1}))||void 0===t?void 0:t.finished,r.endBatch()}),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{graph:e}=this.context,{trigger:n}=this.options;this.unbindEvents(),"click"===n?(e.on(t.NodeEvent.CLICK,this.handleCreateEdge),e.on(t.ComboEvent.CLICK,this.handleCreateEdge),e.on(t.CanvasEvent.CLICK,this.cancelEdge),e.on(t.EdgeEvent.CLICK,this.cancelEdge)):(e.on(t.NodeEvent.DRAG_START,this.handleCreateEdge),e.on(t.ComboEvent.DRAG_START,this.handleCreateEdge),e.on(t.CommonEvent.POINTER_UP,this.drop)),e.on(t.CommonEvent.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}unbindEvents(){const{graph:e}=this.context;e.off(t.NodeEvent.CLICK,this.handleCreateEdge),e.off(t.ComboEvent.CLICK,this.handleCreateEdge),e.off(t.CanvasEvent.CLICK,this.cancelEdge),e.off(t.EdgeEvent.CLICK,this.cancelEdge),e.off(t.NodeEvent.DRAG_START,this.handleCreateEdge),e.off(t.ComboEvent.DRAG_START,this.handleCreateEdge),e.off(t.CommonEvent.POINTER_UP,this.drop),e.off(t.CommonEvent.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}}oE.defaultOptions={animation:!0,enable:!0,style:{},trigger:"drag",onCreate:t=>t,onFinish:()=>{}};class sE extends oy{constructor(t,e){super(t,Object.assign({},sE.defaultOptions,e)),this.isDragging=!1,this.onDragStart=t=>{this.validate(t)&&(this.isDragging=!0,this.context.canvas.setCursor("grabbing"))},this.onDrag=t=>{var e,n,r,i;if(!this.isDragging||jy.isPinching)return;const A=null!==(n=null===(e=t.movement)||void 0===e?void 0:e.x)&&void 0!==n?n:t.dx,o=null!==(i=null===(r=t.movement)||void 0===r?void 0:r.y)&&void 0!==i?i:t.dy;0!==(A|o)&&this.translate([A,o],!1)},this.onDragEnd=()=>{var t,e;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},this.invokeOnFinish=ye(()=>{var t,e;null===(e=(t=this.options).onFinish)||void 0===e||e.call(t)},300),this.shortcut=new zy(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||"default"}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{trigger:e}=this.options;if(Yt(e)){const{up:t=[],down:n=[],left:r=[],right:i=[]}=e;this.shortcut.bind(t,t=>this.onTranslate([0,1],t)),this.shortcut.bind(n,t=>this.onTranslate([0,-1],t)),this.shortcut.bind(r,t=>this.onTranslate([1,0],t)),this.shortcut.bind(i,t=>this.onTranslate([-1,0],t))}else{const{graph:e}=this.context;e.on(t.CommonEvent.DRAG_START,this.onDragStart),e.on(t.CommonEvent.DRAG,this.onDrag),e.on(t.CommonEvent.DRAG_END,this.onDragEnd)}}onTranslate(t,e){return _e(this,void 0,void 0,function*(){if(!this.validate(e))return;const{sensitivity:n}=this.options,r=-1*n;yield this.translate(uy(t,r),this.options.animation),this.invokeOnFinish()})}translate(t,e){return _e(this,void 0,void 0,function*(){t=this.clampByDirection(t),t=this.clampByRange(t),t=this.clampByRotation(t),yield this.context.graph.translateBy(t,e)})}clampByRotation([t,e]){return Ey([t,e],this.context.graph.getRotation())}clampByDirection([t,e]){const{direction:n}=this.options;return"x"===n?e=0:"y"===n&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:r}=this.context,[i,A]=r.getSize(),[o,s,a,c]=mm(this.options.range),l=[A*o,i*s,A*a,i*c],u=Cm(xm(n.getCanvasCenter()),l),h=ly(n.getViewportCenter(),[t,e,0]);if(!Mm(h,u)){const{min:[n,r],max:[i,A]}=u;(h[0]<n&&t>0||h[0]>i&&t<0)&&(t=0),(h[1]<r&&e>0||h[1]>A&&e<0)&&(e=0)}return[t,e]}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return"function"==typeof e?e(t):!!e}unbindEvents(){this.shortcut.unbindAll();const{graph:e}=this.context;e.off(t.CommonEvent.DRAG_START,this.onDragStart),e.off(t.CommonEvent.DRAG,this.onDrag),e.off(t.CommonEvent.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}}sE.defaultOptions={enable:t=>!("targetType"in t)||"canvas"===t.targetType,sensitivity:10,direction:"both",range:1/0};class aE extends oy{constructor(e,n){super(e,Object.assign({},aE.defaultOptions,n)),this.enable=!1,this.enableElements=["node","combo"],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=t=>_e(this,void 0,void 0,function*(){var e;if("link"!==this.options.dropEffect)return;const{model:n,element:r}=this.context,i=t.target.id;this.target.forEach(t=>{const e=n.getParentData(t,Yv);e&&Vm(e)===i&&n.refreshComboData(i),n.setParent(t,i,Yv)}),yield null===(e=null==r?void 0:r.draw({animation:!0}))||void 0===e?void 0:e.finished}),this.setCursor=e=>{if(this.isDragging)return;const{type:n}=e,{canvas:r}=this.context,{cursor:i}=this.options;n===t.CommonEvent.POINTER_ENTER?r.setCursor((null==i?void 0:i.grab)||"grab"):r.setCursor((null==i?void 0:i.default)||"default")},this.shortcut=new zy(e.graph),this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}bindEvents(){const{graph:e,canvas:n}=this.context,r=n.getLayer().getContextService().$canvas;r&&(r.addEventListener("blur",this.onDragEnd),r.addEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(n=>{e.on(`${n}:${t.CommonEvent.DRAG_START}`,this.onDragStart),e.on(`${n}:${t.CommonEvent.DRAG}`,this.onDrag),e.on(`${n}:${t.CommonEvent.DRAG_END}`,this.onDragEnd),e.on(`${n}:${t.CommonEvent.POINTER_ENTER}`,this.setCursor),e.on(`${n}:${t.CommonEvent.POINTER_LEAVE}`,this.setCursor)}),["link"].includes(this.options.dropEffect)&&(e.on(t.ComboEvent.DROP,this.onDrop),e.on(t.CanvasEvent.DROP,this.onDrop))}getSelectedNodeIDs(t){return Array.from(new Set(this.context.graph.getElementDataByState("node",this.options.state).map(t=>t.id).concat(t)))}getDelta(t){const e=this.context.graph.getZoom();return hy([t.dx,t.dy],e)}onDragStart(t){var e;if(this.enable=this.validate(t),!this.enable)return;const{batch:n,canvas:r,graph:i}=this.context;r.setCursor((null===(e=this.options.cursor)||void 0===e?void 0:e.grabbing)||"grabbing"),this.isDragging=!0,n.startBatch();const A=t.target.id;i.getElementState(A).includes(this.options.state)?this.target=this.getSelectedNodeIDs([A]):this.target=[A],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.options.shadow?this.moveShadow(e):this.moveElement(this.target,e)}onDragEnd(){var t,e,n;if(!this.enable)return;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility="hidden";const{x:t=0,y:e=0}=this.shadow.attributes,[n,r]=ly([+t,+e],this.shadowOrigin);this.moveElement(this.target,[n,r])}this.showEdges(),null===(e=(t=this.options).onFinish)||void 0===e||e.call(t,this.target);const{batch:r,canvas:i}=this.context;r.endBatch(),i.setCursor((null===(n=this.options.cursor)||void 0===n?void 0:n.grab)||"grab"),this.isDragging=!1,this.target=[]}isKeydown(){const{trigger:t}=this.options;return!(null==t?void 0:t.length)||this.shortcut.match(t)}validate(t){if(this.destroyed||Jb(t.target)||this.context.graph.isCollapsingExpanding||!this.isKeydown())return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}clampByRotation([t,e]){return Ey([t,e],this.context.graph.getRotation())}moveElement(t,e){return _e(this,void 0,void 0,function*(){const{graph:n,model:r}=this.context,{dropEffect:i}=this.options;"move"===i&&t.forEach(t=>r.refreshComboData(t)),n.translateElementBy(Object.fromEntries(t.map(t=>[t,this.clampByRotation(e)])),!1)})}moveShadow(t){if(!this.shadow)return;const{x:e=0,y:n=0}=this.shadow.attributes,[r,i]=t;this.shadow.attr({x:+e+r,y:+n+i})}createShadow(t){const e=Aw(this.options,"shadow"),n=Fm(t.map(t=>this.context.element.getElement(t).getBounds())),[r,i]=n.min;this.shadowOrigin=[r,i];const[A,o]=bm(n),s={width:A,height:o,x:r,y:i};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},e),s),{visibility:"visible"})):(this.shadow=new lc({style:Object.assign(Object.assign(Object.assign({$layer:"transient"},e),s),{pointerEvents:"none"})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||0===this.hiddenEdges.length||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){const{hideEdge:t,shadow:e}=this.options;if("none"===t||e)return;const{graph:n}=this.context;this.hiddenEdges="all"===t?n.getEdgeData().map(Vm):Array.from(new Set(this.target.map(e=>n.getRelatedEdgesData(e,t).map(Vm)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){const{graph:e,canvas:n}=this.context,r=n.getLayer().getContextService().$canvas;r&&(r.removeEventListener("blur",this.onDragEnd),r.removeEventListener("contextmenu",this.onDragEnd)),this.enableElements.forEach(n=>{e.off(`${n}:${t.CommonEvent.DRAG_START}`,this.onDragStart),e.off(`${n}:${t.CommonEvent.DRAG}`,this.onDrag),e.off(`${n}:${t.CommonEvent.DRAG_END}`,this.onDragEnd),e.off(`${n}:${t.CommonEvent.POINTER_ENTER}`,this.setCursor),e.off(`${n}:${t.CommonEvent.POINTER_LEAVE}`,this.setCursor)}),e.off(`combo:${t.CommonEvent.DROP}`,this.onDrop),e.off(`canvas:${t.CommonEvent.DROP}`,this.onDrop)}destroy(){var t;this.unbindEvents(),null===(t=this.shadow)||void 0===t||t.destroy(),super.destroy()}}aE.defaultOptions={animation:!0,enable:t=>["node","combo"].includes(t.targetType),trigger:[],dropEffect:"move",state:"selected",hideEdge:"none",shadow:!1,shadowZIndex:100,shadowFill:"#F3F9FF",shadowFillOpacity:.5,shadowStroke:"#1890FF",shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:"default",grab:"grab",grabbing:"grabbing"}};var cE=function(){function t(){this._events={}}return t.prototype.on=function(t,e,n){return this._events[t]||(this._events[t]=[]),this._events[t].push({callback:e,once:!!n}),this},t.prototype.once=function(t,e){return this.on(t,e,!0)},t.prototype.emit=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this._events[t]||[],A=this._events["*"]||[],o=function(r){for(var i=r.length,A=0;A<i;A++)if(r[A]){var o=r[A],s=o.callback;o.once&&(r.splice(A,1),0===r.length&&delete e._events[t],i--,A--),s.apply(e,n)}};o(i),o(A)},t.prototype.off=function(t,e){if(t)if(e){for(var n=this._events[t]||[],r=n.length,i=0;i<r;i++)n[i].callback===e&&(n.splice(i,1),r--,i--);0===n.length&&delete this._events[t]}else delete this._events[t];else this._events={};return this},t.prototype.getEvents=function(){return this._events},t}();function lE(t,e,n,r){for(;t.length;){const i=t.shift();if(n(i))return!0;e.add(i.id),r(i.id).forEach(n=>{e.has(n.id)||(e.add(n.id),t.push(n))})}return!1}function uE(t,e,n,r){if(n(t))return!0;e.add(t.id);for(const i of r(t.id))if(!e.has(i.id)&&uE(i,e,n,r))return!0;return!1}const hE=()=>!0;class dE{graph;nodeFilter;edgeFilter;cacheEnabled;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;allNodesMap=new Map;allEdgesMap=new Map;constructor(t){this.graph=t.graph;const e=t.nodeFilter||hE,n=t.edgeFilter||hE;this.nodeFilter=e,this.edgeFilter=t=>{const{source:r,target:i}=this.graph.getEdgeDetail(t.id);return!(!e(r)||!e(i))&&n(t,r,i)},"auto"===t.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===t.cache?this.cacheEnabled=!0:this.cacheEnabled=!1}clearCache=()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()};refreshCache=()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(t=>t.id))};updateCache=t=>{const e=new Set;t.forEach(t=>{const n=this.bothEdgesMap.get(t);if(n&&n.forEach(t=>e.add(t.id)),this.hasNode(t)){const n=this.graph.getRelatedEdges(t,"in").filter(this.edgeFilter),r=this.graph.getRelatedEdges(t,"out").filter(this.edgeFilter),i=Array.from(new Set([...n,...r]));i.forEach(t=>e.add(t.id)),this.inEdgesMap.set(t,n),this.outEdgesMap.set(t,r),this.bothEdgesMap.set(t,i),this.allNodesMap.set(t,this.graph.getNode(t))}else this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.bothEdgesMap.delete(t),this.allNodesMap.delete(t)}),e.forEach(t=>{this.hasEdge(t)?this.allEdgesMap.set(t,this.graph.getEdge(t)):this.allEdgesMap.delete(t)})};startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}handleGraphChanged=t=>{const e=new Set;t.changes.forEach(n=>{switch(n.type){case"NodeAdded":case"NodeRemoved":e.add(n.value.id);break;case"NodeDataUpdated":e.add(n.id);break;case"EdgeAdded":case"EdgeRemoved":e.add(n.value.source),e.add(n.value.target);break;case"EdgeUpdated":"source"!==n.propertyName&&"target"!==n.propertyName||(e.add(n.oldValue),e.add(n.newValue));break;case"EdgeDataUpdated":if(t.graph.hasEdge(n.id)){const r=t.graph.getEdge(n.id);e.add(r.source),e.add(r.target)}}}),this.updateCache(e)};checkNodeExistence(t){this.getNode(t)}hasNode(t){if(!this.graph.hasNode(t))return!1;const e=this.graph.getNode(t);return this.nodeFilter(e)}areNeighbors(t,e){return this.checkNodeExistence(t),this.getNeighbors(e).some(e=>e.id===t)}getNode(t){const e=this.graph.getNode(t);if(!this.nodeFilter(e))throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),this.cacheEnabled)return"in"===e?this.inEdgesMap.get(t):"out"===e?this.outEdgesMap.get(t):this.bothEdgesMap.get(t);return this.graph.getRelatedEdges(t,e).filter(this.edgeFilter)}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map(t=>this.getNode(t.target));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map(t=>this.getNode(t.source));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}hasEdge(t){if(!this.graph.hasEdge(t))return!1;const e=this.graph.getEdge(t);return this.edgeFilter(e)}getEdge(t){const e=this.graph.getEdge(t);if(!this.edgeFilter(e))throw new Error("Edge not found for id: "+t);return e}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}hasTreeStructure(t){return this.graph.hasTreeStructure(t)}getRoots(t){return this.graph.getRoots(t).filter(this.nodeFilter)}getChildren(t,e){return this.checkNodeExistence(t),this.graph.getChildren(t,e).filter(this.nodeFilter)}getParent(t,e){this.checkNodeExistence(t);const n=this.graph.getParent(t,e);return n&&this.nodeFilter(n)?n:null}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];lE([this.getNode(t)],new Set,e,r)}dfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];uE(this.getNode(t),new Set,e,r)}}let fE=class t extends cE{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(t){super(),t&&(t.nodes&&this.addNodes(t.nodes),t.edges&&this.addEdges(t.edges),t.tree&&this.addTree(t.tree),t.onChanged&&(this.onChanged=t.onChanged))}batch=t=>{this.batchCount+=1,t(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const t=this.changes;this.changes=[];const e={graph:this,changes:t};this.emit("changed",e),this.onChanged(e)}reduceChanges(t){let e=[];return t.forEach(t=>{switch(t.type){case"NodeRemoved":{let n=!1;e=e.filter(e=>{if("NodeAdded"===e.type){const r=e.value.id===t.value.id;return r&&(n=!0),!r}return"NodeDataUpdated"===e.type?e.id!==t.value.id:"TreeStructureChanged"!==e.type||e.nodeId!==t.value.id}),n||e.push(t);break}case"EdgeRemoved":{let n=!1;e=e.filter(e=>{if("EdgeAdded"===e.type){const r=e.value.id===t.value.id;return r&&(n=!0),!r}return"EdgeDataUpdated"!==e.type&&"EdgeUpdated"!==e.type||e.id!==t.value.id}),n||e.push(t);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const n=e.findIndex(e=>e.type===t.type&&e.id===t.id&&(void 0===t.propertyName||e.propertyName===t.propertyName)),r=e[n];r?void 0!==t.propertyName?r.newValue=t.newValue:(e.splice(n,1),e.push(t)):e.push(t);break}case"TreeStructureDetached":e=e.filter(e=>"TreeStructureAttached"===e.type?e.treeKey!==t.treeKey:"TreeStructureChanged"!==e.type||e.treeKey!==t.treeKey),e.push(t);break;case"TreeStructureChanged":{const n=e.find(e=>"TreeStructureChanged"===e.type&&e.treeKey===t.treeKey&&e.nodeId===t.nodeId);n?n.newParentId=t.newParentId:e.push(t);break}default:e.push(t)}}),e}checkNodeExistence(t){this.getNode(t)}hasNode(t){return this.nodeMap.has(t)}areNeighbors(t,e){return this.getNeighbors(e).some(e=>e.id===t)}getNode(t){const e=this.nodeMap.get(t);if(!e)throw new Error("Node not found for id: "+t);return e}getRelatedEdges(t,e){if(this.checkNodeExistence(t),"in"===e){const e=this.inEdgesMap.get(t);return Array.from(e)}if("out"===e){const e=this.outEdgesMap.get(t);return Array.from(e)}{const e=this.bothEdgesMap.get(t);return Array.from(e)}}getDegree(t,e){return this.getRelatedEdges(t,e).length}getSuccessors(t){const e=this.getRelatedEdges(t,"out").map(t=>this.getNode(t.target));return Array.from(new Set(e))}getPredecessors(t){const e=this.getRelatedEdges(t,"in").map(t=>this.getNode(t.source));return Array.from(new Set(e))}getNeighbors(t){const e=this.getPredecessors(t),n=this.getSuccessors(t);return Array.from(new Set([...e,...n]))}doAddNode(t){if(this.hasNode(t.id))throw new Error("Node already exists: "+t.id);this.nodeMap.set(t.id,t),this.inEdgesMap.set(t.id,new Set),this.outEdgesMap.set(t.id,new Set),this.bothEdgesMap.set(t.id,new Set),this.treeIndices.forEach(e=>{e.childrenMap.set(t.id,new Set)}),this.changes.push({type:"NodeAdded",value:t})}addNodes(t){this.batch(()=>{for(const e of t)this.doAddNode(e)})}addNode(t){this.addNodes([t])}doRemoveNode(t){const e=this.getNode(t),n=this.bothEdgesMap.get(t);n?.forEach(t=>this.doRemoveEdge(t.id)),this.nodeMap.delete(t),this.treeIndices.forEach(n=>{n.childrenMap.get(t)?.forEach(t=>{n.parentMap.delete(t.id)});const r=n.parentMap.get(t);r&&n.childrenMap.get(r.id)?.delete(e),n.parentMap.delete(t),n.childrenMap.delete(t)}),this.bothEdgesMap.delete(t),this.inEdgesMap.delete(t),this.outEdgesMap.delete(t),this.changes.push({type:"NodeRemoved",value:e})}removeNodes(t){this.batch(()=>{t.forEach(t=>this.doRemoveNode(t))})}removeNode(t){this.removeNodes([t])}updateNodeDataProperty(t,e,n){const r=this.getNode(t);this.batch(()=>{const i=r.data[e],A=n;r.data[e]=A,this.changes.push({type:"NodeDataUpdated",id:t,propertyName:e,oldValue:i,newValue:A})})}mergeNodeData(t,e){this.batch(()=>{Object.entries(e).forEach(([e,n])=>{this.updateNodeDataProperty(t,e,n)})})}updateNodeData(...t){const e=t[0],n=this.getNode(e);if("string"==typeof t[1])return void this.updateNodeDataProperty(e,t[1],t[2]);let r;if("function"==typeof t[1]){const e=t[1];r=e(n.data)}else"object"==typeof t[1]&&(r=t[1]);this.batch(()=>{const t=n.data,i=r;n.data=r,this.changes.push({type:"NodeDataUpdated",id:e,oldValue:t,newValue:i})})}checkEdgeExistence(t){if(!this.hasEdge(t))throw new Error("Edge not found for id: "+t)}hasEdge(t){return this.edgeMap.has(t)}getEdge(t){return this.checkEdgeExistence(t),this.edgeMap.get(t)}getEdgeDetail(t){const e=this.getEdge(t);return{edge:e,source:this.getNode(e.source),target:this.getNode(e.target)}}doAddEdge(t){if(this.hasEdge(t.id))throw new Error("Edge already exists: "+t.id);this.checkNodeExistence(t.source),this.checkNodeExistence(t.target),this.edgeMap.set(t.id,t);const e=this.inEdgesMap.get(t.target),n=this.outEdgesMap.get(t.source),r=this.bothEdgesMap.get(t.source),i=this.bothEdgesMap.get(t.target);e.add(t),n.add(t),r.add(t),i.add(t),this.changes.push({type:"EdgeAdded",value:t})}addEdges(t){this.batch(()=>{for(const e of t)this.doAddEdge(e)})}addEdge(t){this.addEdges([t])}doRemoveEdge(t){const e=this.getEdge(t),n=this.outEdgesMap.get(e.source),r=this.inEdgesMap.get(e.target),i=this.bothEdgesMap.get(e.source),A=this.bothEdgesMap.get(e.target);n.delete(e),r.delete(e),i.delete(e),A.delete(e),this.edgeMap.delete(t),this.changes.push({type:"EdgeRemoved",value:e})}removeEdges(t){this.batch(()=>{t.forEach(t=>this.doRemoveEdge(t))})}removeEdge(t){this.removeEdges([t])}updateEdgeSource(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const r=n.source,i=e;this.outEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.outEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.source=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"source",oldValue:r,newValue:i})})}updateEdgeTarget(t,e){const n=this.getEdge(t);this.checkNodeExistence(e);const r=n.target,i=e;this.inEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.inEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.target=e,this.batch(()=>{this.changes.push({type:"EdgeUpdated",id:t,propertyName:"target",oldValue:r,newValue:i})})}updateEdgeDataProperty(t,e,n){const r=this.getEdge(t);this.batch(()=>{const i=r.data[e],A=n;r.data[e]=A,this.changes.push({type:"EdgeDataUpdated",id:t,propertyName:e,oldValue:i,newValue:A})})}updateEdgeData(...t){const e=t[0],n=this.getEdge(e);if("string"==typeof t[1])return void this.updateEdgeDataProperty(e,t[1],t[2]);let r;if("function"==typeof t[1]){const e=t[1];r=e(n.data)}else"object"==typeof t[1]&&(r=t[1]);this.batch(()=>{const t=n.data,i=r;n.data=r,this.changes.push({type:"EdgeDataUpdated",id:e,oldValue:t,newValue:i})})}mergeEdgeData(t,e){this.batch(()=>{Object.entries(e).forEach(([e,n])=>{this.updateEdgeDataProperty(t,e,n)})})}checkTreeExistence(t){if(!this.hasTreeStructure(t))throw new Error("Tree structure not found for treeKey: "+t)}hasTreeStructure(t){return this.treeIndices.has(t)}attachTreeStructure(t){this.treeIndices.has(t)||(this.treeIndices.set(t,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:"TreeStructureAttached",treeKey:t})}))}detachTreeStructure(t){this.checkTreeExistence(t),this.treeIndices.delete(t),this.batch(()=>{this.changes.push({type:"TreeStructureDetached",treeKey:t})})}addTree(t,e){this.batch(()=>{this.attachTreeStructure(e);const n=[],r=Array.isArray(t)?t:[t];for(;r.length;){const t=r.shift();n.push(t),t.children&&r.push(...t.children)}this.addNodes(n),n.forEach(t=>{t.children?.forEach(n=>{this.setParent(n.id,t.id,e)})})})}getRoots(t){return this.checkTreeExistence(t),this.getAllNodes().filter(e=>!this.getParent(e.id,t))}getChildren(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);const n=this.treeIndices.get(e).childrenMap.get(t);return Array.from(n||[])}getParent(t,e){this.checkNodeExistence(t),this.checkTreeExistence(e);return this.treeIndices.get(e).parentMap.get(t)||null}getAncestors(t,e){const n=[];let r,i=this.getNode(t);for(;r=this.getParent(i.id,e);)n.push(r),i=r;return n}setParent(t,e,n){this.checkTreeExistence(n);const r=this.treeIndices.get(n);if(!r)return;const i=this.getNode(t),A=r.parentMap.get(t);if(A?.id===e)return;if(null==e)return A&&r.childrenMap.get(A.id)?.delete(i),void r.parentMap.delete(t);const o=this.getNode(e);r.parentMap.set(t,o),A&&r.childrenMap.get(A.id)?.delete(i);let s=r.childrenMap.get(o.id);s||(s=new Set,r.childrenMap.set(o.id,s)),s.add(i),this.batch(()=>{this.changes.push({type:"TreeStructureChanged",treeKey:n,nodeId:t,oldParentId:A?.id,newParentId:o.id})})}dfsTree(t,e,n){return uE(this.getNode(t),new Set,e,t=>this.getChildren(t,n))}bfsTree(t,e,n){return lE([this.getNode(t)],new Set,e,t=>this.getChildren(t,n))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return lE([this.getNode(t)],new Set,e,r)}dfs(t,e,n="out"){const r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return uE(this.getNode(t),new Set,e,r)}clone(){const e=this.getAllNodes().map(t=>({...t,data:{...t.data}})),n=this.getAllEdges().map(t=>({...t,data:{...t.data}})),r=new t({nodes:e,edges:n});return this.treeIndices.forEach(({parentMap:t,childrenMap:e},n)=>{const i=new Map;t.forEach((t,e)=>{i.set(e,r.getNode(t.id))});const A=new Map;e.forEach((t,e)=>{A.set(e,new Set(Array.from(t).map(t=>r.getNode(t.id))))}),r.treeIndices.set(n,{parentMap:i,childrenMap:A})}),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(t){return new dE({graph:this,...t})}};class gE{constructor(t,e){this.context=t,this.options=e||{}}}function pE(t){const{nodes:e,edges:n}=t,r={nodes:[],edges:[],combos:[]};return e.forEach(t=>{const e=t.data._isCombo?r.combos:r.nodes,{x:n,y:i,z:A=0}=t.data;null==e||e.push({id:t.id,style:{x:n,y:i,z:A}})}),n.forEach(t=>{const{id:e,source:n,target:i,data:{points:A=[],controlPoints:o=A.slice(1,A.length-1)}}=t;r.edges.push({id:e,source:n,target:i,style:Object.assign({},(null==o?void 0:o.length)?{controlPoints:o.map(Sy)}:{})})}),r}function vE(t,e,...n){if(e in t)return t[e](...n);if("instance"in t){const r=t.instance;if(e in r)return r[e](...n)}return null}function mE(t,e){if(e in t)return t[e];if("instance"in t){const n=t.instance;if(e in n)return n[e]}return null}class yE extends aE{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(t=>["d3-force","d3-force-3d"].includes(null==t?void 0:t.id))}validate(t){return!!this.context.layout&&(this.forceLayoutInstance?super.validate(t):(em("DragElementForce only works with d3-force or d3-force-3d layout"),!1))}moveElement(t,e){return _e(this,void 0,void 0,function*(){const n=this.forceLayoutInstance;this.context.graph.getNodeData(t).forEach((r,i)=>{const{x:A=0,y:o=0}=r.style||{};n&&vE(n,"setFixedPosition",t[i],[...cy([+A,+o],this.clampByRotation(e))])})})}onDragStart(t){if(this.enable=this.validate(t),!this.enable)return;this.target=this.getSelectedNodeIDs([t.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);const e=this.forceLayoutInstance;e&&mE(e,"simulation").alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(t=>{const{x:n=0,y:r=0}=t.style||{};e&&vE(e,"setFixedPosition",Vm(t),[+n,+r])})}onDrag(t){if(!this.enable)return;const e=this.getDelta(t);this.moveElement(this.target,e)}onDragEnd(){const t=this.forceLayoutInstance;t&&mE(t,"simulation").alphaTarget(0),this.options.fixed||this.context.graph.getNodeData(this.target).forEach(e=>{t&&vE(t,"setFixedPosition",Vm(e),[null,null,null])})}}class wE extends oy{constructor(t,e){super(t,Object.assign({},wE.defaultOptions,e)),this.isZoomEvent=t=>Boolean(t.data&&"scale"in t.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=t=>_e(this,void 0,void 0,function*(){if(!this.validate(t))return;const{graph:e}=this.context,{state:n,nodeFilter:r,edgeFilter:i,comboFilter:A}=this.options,o=(n?e.getElementDataByState("node",n):e.getNodeData()).filter(r),s=(n?e.getElementDataByState("edge",n):e.getEdgeData()).filter(i),a=(n?e.getElementDataByState("combo",n):e.getComboData()).filter(A),c=this.isZoomEvent(t)?this.zoom=Math.max(.01,Math.min(t.data.scale,10)):this.zoom,l=[...o,...a];l.length>0&&l.forEach(t=>this.fixNodeLike(t,c)),this.updateRelatedEdges(),s.length>0&&s.forEach(t=>this.fixEdge(t,c))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(t,e,n)=>{var r;const i=this.cachedStyles.get(t)||[],A=(null===(r=i.find(t=>t.shape===e))||void 0===r?void 0:r.style)||{};return n in A||(A[n]=e.attributes[n],this.cachedStyles.set(t,[...i.filter(t=>t.shape!==e),{shape:e,style:A}])),A[n]},this.scaleEntireElement=(t,e,n)=>{e.setLocalScale(1/n);const r=this.cachedStyles.get(t)||[];r.push({shape:e}),this.cachedStyles.set(t,r)},this.scaleSpecificShapes=(t,e,n)=>{const r=function(t){const e=[],n=t=>{(null==t?void 0:t.children.length)&&t.children.forEach(t=>{e.push(t),n(t)})};return n(t),e}(t);(Array.isArray(n)?n:[n]).forEach(n=>{const{shape:i,fields:A}=n,o="function"==typeof i?i(r):t.getShape(i);o&&(A?A.forEach(n=>{const r=this.getOriginalFieldValue(t.id,o,n);oe(r)&&(o.style[n]=r/e)}):this.scaleEntireElement(t.id,o,e))})},this.skipIfExceedViewport=t=>{const{viewport:e}=this.context;return!(null==e?void 0:e.isInViewport(t.getRenderBounds(),!1,30))},this.fixNodeLike=(t,e)=>{const n=Vm(t),{element:r,model:i}=this.context,A=r.getElement(n);if(!A||this.skipIfExceedViewport(A))return;i.getRelatedEdgesData(n).forEach(t=>this.relatedEdgeToUpdate.add(Vm(t)));const o=this.options[A.type];o?this.scaleSpecificShapes(A,e,o):this.scaleEntireElement(n,A,e)},this.fixEdge=(t,e)=>{const n=Vm(t),r=this.context.element.getElement(n);if(!r||this.skipIfExceedViewport(r))return;const i=this.options.edge;if(!i)return r.style.transformOrigin="center",void this.scaleEntireElement(n,r,e);this.scaleSpecificShapes(r,e,i)},this.updateRelatedEdges=()=>{const{element:t}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(e=>{const n=t.getElement(e);null==n||n.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=t=>_e(this,void 0,void 0,function*(){var e;(null===(e=t.data)||void 0===e?void 0:e.firstRender)||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(t=>{t.forEach(({shape:t,style:e})=>{if(Fe(e))t.setLocalScale(1);else{if(this.options.state)return;Object.entries(e).forEach(([e,n])=>t.style[e]=n)}})});const{graph:t,element:e}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter(e=>e&&"node"===t.getElementType(e));if(n.length>0){const r=new Set;n.forEach(e=>{t.getRelatedEdgesData(e).forEach(t=>r.add(Vm(t)))}),r.forEach(t=>{const n=null==e?void 0:e.getElement(t);null==n||n.update({})})}}}bindEvents(){const{graph:e}=this.context;e.on(t.GraphEvent.AFTER_DRAW,this.resetTransform),e.on(t.GraphEvent.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){const{graph:e}=this.context;e.off(t.GraphEvent.AFTER_DRAW,this.resetTransform),e.off(t.GraphEvent.AFTER_TRANSFORM,this.fixElementSize)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}destroy(){this.unbindEvents(),super.destroy()}}wE.defaultOptions={enable:t=>t.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:"key",fields:["lineWidth"]},{shape:"halo",fields:["lineWidth"]},{shape:"label"}],reset:!1};class BE extends oy{constructor(t,e){super(t,Object.assign({},BE.defaultOptions,e)),this.focus=t=>_e(this,void 0,void 0,function*(){if(!this.validate(t))return;const{graph:e}=this.context;yield e.focusElement(t.target.id,this.options.animation)}),this.shortcut=new zy(t.graph),this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),qy.forEach(n=>{e.on(`${n}:${t.CommonEvent.CLICK}`,this.focus)})}validate(t){if(this.destroyed||!this.isKeydown())return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}isKeydown(){const{trigger:t}=this.options;return!(null==t?void 0:t.length)||this.shortcut.match(t)}unbindEvents(){const{graph:e}=this.context;qy.forEach(n=>{e.off(`${n}:${t.CommonEvent.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),this.shortcut.destroy(),super.destroy()}}BE.defaultOptions={animation:{easing:"ease-in",duration:500},enable:!0,trigger:[]};class bE extends oy{constructor(e,n){super(e,Object.assign({},bE.defaultOptions,n)),this.isFrozen=!1,this.toggleFrozen=t=>{this.isFrozen="dragstart"===t.type},this.hoverElement=e=>{if(!this.validate(e))return;const n=e.type===t.CommonEvent.POINTER_ENTER;this.updateElementsState(e,n);const{onHover:r,onHoverEnd:i}=this.options;n?null==r||r(e):null==i||i(e)},this.updateElementsState=(t,e)=>{if(!this.options.state&&!this.options.inactiveState)return;const{graph:n}=this.context,{state:r,animation:i,inactiveState:A}=this.options,o=this.getActiveIds(t),s={};if(r&&Object.assign(s,this.getElementsState(o,r,e)),A){const t=Wm(n.getData(),!0).filter(t=>!o.includes(t));Object.assign(s,this.getElementsState(t,A,e))}n.setElementState(s,i)},this.getElementsState=(t,e,n)=>{const{graph:r}=this.context,i={};return t.forEach(t=>{const A=r.getElementState(t);i[t]=n?A.includes(e)?A:[...A,e]:A.filter(t=>t!==e)}),i},this.bindEvents()}bindEvents(){const{graph:e}=this.context;this.unbindEvents(),qy.forEach(n=>{e.on(`${n}:${t.CommonEvent.POINTER_ENTER}`,this.hoverElement),e.on(`${n}:${t.CommonEvent.POINTER_LEAVE}`,this.hoverElement)});const n=this.context.canvas.document;n.addEventListener(`${t.CommonEvent.DRAG_START}`,this.toggleFrozen),n.addEventListener(`${t.CommonEvent.DRAG_END}`,this.toggleFrozen)}getActiveIds(t){const{graph:e}=this.context,{degree:n,direction:r}=this.options,i=t.target.id;return n?Jy(e,t.targetType,i,"function"==typeof n?n(t):n,r):[i]}validate(t){if(this.destroyed||this.isFrozen||Jb(t.target)||this.context.graph.isCollapsingExpanding)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}unbindEvents(){const{graph:e}=this.context;qy.forEach(n=>{e.off(`${n}:${t.CommonEvent.POINTER_ENTER}`,this.hoverElement),e.off(`${n}:${t.CommonEvent.POINTER_LEAVE}`,this.hoverElement)});const n=this.context.canvas.document;n.removeEventListener(`${t.CommonEvent.DRAG_START}`,this.toggleFrozen),n.removeEventListener(`${t.CommonEvent.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}}bE.defaultOptions={animation:!1,enable:!0,degree:0,direction:"both",state:"active",inactiveState:void 0};class EE extends Wy{onPointerDown(t){if(!super.validate(t)||!super.isKeydown()||this.points)return;const{canvas:e,graph:n}=this.context;this.pathShape=new Ac({id:"g6-lasso-select",style:this.options.style}),e.appendChild(this.pathShape),this.points=[Yy(t,n)]}onPointerMove(t){var e;if(!this.points)return;const{immediately:n,mode:r}=this.options;this.points.push(Yy(t,this.context.graph)),null===(e=this.pathShape)||void 0===e||e.setAttribute("d",function(t,e=!0){const n=[];return t.forEach((t,e)=>{n.push([0===e?"M":"L",...t])}),e&&n.push(["Z"]),n}(this.points)),n&&"default"===r&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){this.points&&(this.points.length<2||super.updateElementsStates(this.points),this.clearLasso())}clearLasso(){var t;null===(t=this.pathShape)||void 0===t||t.remove(),this.pathShape=void 0,this.points=void 0}}class xE extends oy{constructor(t,e){super(t,Object.assign({},xE.defaultOptions,e)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(t,e,n)=>{t.filter(Boolean).forEach(t=>{"hidden"!==e||t.isVisible()?"visible"===e&&this.hiddenShapes.includes(t)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(t),1):ry(t,e,n):this.hiddenShapes.push(t)})},this.filterShapes=(t,e)=>{if(Vt(e))return n=>!e(t,n);const n=null==e?void 0:e[t];return t=>!t.className||!(null==n?void 0:n.includes(t.className))},this.hideShapes=t=>{if(!this.validate(t)||!this.isVisible)return;const{element:e}=this.context,{shapes:n={}}=this.options;this.setElementsVisibility(e.getNodes(),"hidden",this.filterShapes("node",n)),this.setElementsVisibility(e.getEdges(),"hidden",this.filterShapes("edge",n)),this.setElementsVisibility(e.getCombos(),"hidden",this.filterShapes("combo",n)),this.isVisible=!1},this.showShapes=ye(t=>{if(!this.validate(t)||this.isVisible)return;const{element:e}=this.context;this.setElementsVisibility(e.getNodes(),"visible"),this.setElementsVisibility(e.getEdges(),"visible"),this.setElementsVisibility(e.getCombos(),"visible"),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){const{graph:e}=this.context;e.on(t.GraphEvent.BEFORE_TRANSFORM,this.hideShapes),e.on(t.GraphEvent.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){const{graph:e}=this.context;e.off(t.GraphEvent.BEFORE_TRANSFORM,this.hideShapes),e.off(t.GraphEvent.AFTER_TRANSFORM,this.showShapes)}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}}xE.defaultOptions={enable:!0,debounce:200,shapes:t=>"node"===t};class CE extends oy{constructor(t,e){super(t,Object.assign({},CE.defaultOptions,e)),this.onWheel=t=>_e(this,void 0,void 0,function*(){this.options.preventDefault&&t.preventDefault();const e=t.deltaX,n=t.deltaY;yield this.scroll([-e,-n],t)}),this.shortcut=new zy(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){var e,n;const{trigger:r}=this.options;if(this.shortcut.unbindAll(),Yt(r)){null===(e=this.graphDom)||void 0===e||e.removeEventListener(t.CommonEvent.WHEEL,this.onWheel);const{up:n=[],down:i=[],left:A=[],right:o=[]}=r;this.shortcut.bind(n,t=>this.scroll([0,-10],t)),this.shortcut.bind(i,t=>this.scroll([0,10],t)),this.shortcut.bind(A,t=>this.scroll([-10,0],t)),this.shortcut.bind(o,t=>this.scroll([10,0],t))}else null===(n=this.graphDom)||void 0===n||n.addEventListener(t.CommonEvent.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(t){const{sensitivity:e}=this.options;return t=uy(t,e),t=this.clampByDirection(t),t=this.clampByRange(t)}clampByDirection([t,e]){const{direction:n}=this.options;return"x"===n?e=0:"y"===n&&(t=0),[t,e]}clampByRange([t,e]){const{viewport:n,canvas:r}=this.context,[i,A]=r.getSize(),[o,s,a,c]=mm(this.options.range),l=[A*o,i*s,A*a,i*c],u=Cm(xm(n.getCanvasCenter()),l),h=ly(n.getViewportCenter(),[t,e,0]);if(!Mm(h,u)){const{min:[n,r],max:[i,A]}=u;(h[0]<n&&t>0||h[0]>i&&t<0)&&(t=0),(h[1]<r&&e>0||h[1]>A&&e<0)&&(e=0)}return[t,e]}scroll(t,e){return _e(this,void 0,void 0,function*(){if(!this.validate(e))return;const{onFinish:n}=this.options,r=this.context.graph,i=this.formatDisplacement(t);yield r.translateBy(i,!1),null==n||n()})}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}destroy(){var e;this.shortcut.destroy(),null===(e=this.graphDom)||void 0===e||e.removeEventListener(t.CommonEvent.WHEEL,this.onWheel),super.destroy()}}CE.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};class FE extends oy{constructor(t,e){super(t,Object.assign({},FE.defaultOptions,e)),this.zoom=(t,e,n)=>_e(this,void 0,void 0,function*(){if(!this.validate(e))return;const{graph:r}=this.context;let i=this.options.origin;!i&&"viewport"in e&&(i=Sy(e.viewport));const{sensitivity:A,onFinish:o}=this.options,s=1+Ae(t,-50,50)*A/100,a=r.getZoom();yield r.zoomTo(a*s,n,i),null==o||o()}),this.onReset=()=>_e(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=t=>{this.options.preventDefault&&t.preventDefault()},this.shortcut=new zy(t.graph),this.bindEvents()}update(t){super.update(t),this.bindEvents()}bindEvents(){const{trigger:e}=this.options;if(this.shortcut.unbindAll(),Array.isArray(e))if(e.includes(t.CommonEvent.PINCH))this.shortcut.bind([t.CommonEvent.PINCH],t=>{this.zoom(t.scale,t,!1)});else{const n=this.context.canvas.getContainer();null==n||n.addEventListener(t.CommonEvent.WHEEL,this.preventDefault),this.shortcut.bind([...e,t.CommonEvent.WHEEL],t=>{const{deltaX:e,deltaY:n}=t;this.zoom(-(null!=n?n:e),t,!1)})}if("object"==typeof e){const{zoomIn:t=[],zoomOut:n=[],reset:r=[]}=e;this.shortcut.bind(t,t=>this.zoom(10,t,this.options.animation)),this.shortcut.bind(n,t=>this.zoom(-10,t,this.options.animation)),this.shortcut.bind(r,this.onReset)}}validate(t){if(this.destroyed)return!1;const{enable:e}=this.options;return Vt(e)?e(t):!!e}destroy(){var e;this.shortcut.destroy(),null===(e=this.context.canvas.getContainer())||void 0===e||e.removeEventListener(t.CommonEvent.WHEEL,this.preventDefault),super.destroy()}}function ME(t,e,n,r="height"){const i=t[r],A=e[r];return"center"===n?(i+A)/2:t.height}FE.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};const kE=Object.assign,QE={getId:t=>t.id||t.name,getPreH:t=>t.preH||0,getPreV:t=>t.preV||0,getHGap:t=>t.hgap||18,getVGap:t=>t.vgap||18,getChildren:t=>t.children,getHeight:t=>t.height||36,getWidth(t){const e=t.label||" ";return t.width||18*e.split("").length}};class SE{constructor(t,e){if(this.x=0,this.y=0,this.depth=0,this.children=[],this.hgap=0,this.vgap=0,t instanceof SE||"x"in t&&"y"in t&&"children"in t){const e=t;return this.data=e.data,this.id=e.id,this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.depth=e.depth,this.children=e.children,this.parent=e.parent,this.hgap=e.hgap,this.vgap=e.vgap,this.preH=e.preH,void(this.preV=e.preV)}this.data=t;const n=e.getHGap(t),r=e.getVGap(t);this.preH=e.getPreH(t),this.preV=e.getPreV(t),this.width=e.getWidth(t),this.height=e.getHeight(t),this.width+=this.preH,this.height+=this.preV,this.id=e.getId(t),this.addGap(n,r)}isRoot(){return 0===this.depth}isLeaf(){return 0===this.children.length}addGap(t,e){this.hgap+=t,this.vgap+=e,this.width+=2*t,this.height+=2*e}eachNode(t){let e,n=[this];for(;e=n.shift();)t(e),n=e.children.concat(n)}DFTraverse(t){this.eachNode(t)}BFTraverse(t){let e,n=[this];for(;e=n.shift();)t(e),n=n.concat(e.children)}getBoundingBox(){const t={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(e=>{t.left=Math.min(t.left,e.x),t.top=Math.min(t.top,e.y),t.width=Math.max(t.width,e.x+e.width),t.height=Math.max(t.height,e.y+e.height)}),t}translate(t=0,e=0){this.eachNode(n=>{n.x+=t,n.y+=e,n.x+=n.preH,n.y+=n.preV})}right2left(){const t=this.getBoundingBox();this.eachNode(e=>{e.x=e.x-2*(e.x-t.left)-e.width}),this.translate(t.width,0)}bottom2top(){const t=this.getBoundingBox();this.eachNode(e=>{e.y=e.y-2*(e.y-t.top)-e.height}),this.translate(0,t.height)}}function UE(t,e={},n){e=kE({},QE,e);const r=new SE(t,e),i=[r];let A;if(!n&&!t.collapsed)for(;A=i.shift();)if(!A.data.collapsed){const t=e.getChildren(A.data),n=t?t.length:0;if(A.children=new Array(n),t&&n)for(let r=0;r<n;r++){const n=new SE(t[r],e);A.children[r]=n,i.push(n),n.parent=A,n.depth=A.depth+1}}return r}class TE{constructor(t,e={}){this.options=e,this.rootNode=UE(t,e)}execute(){throw new Error("please override this method")}}let OE=class t{constructor(t=0,e=0,n=0,r=[]){this.x=0,this.prelim=0,this.mod=0,this.shift=0,this.change=0,this.tl=null,this.tr=null,this.el=null,this.er=null,this.msel=0,this.mser=0,this.w=t||0,this.h=e||0,this.y=n||0,this.c=r||[],this.cs=r.length}static fromNode(e,n){if(!e)return null;const r=[];return e.children.forEach(e=>{const i=t.fromNode(e,n);i&&r.push(i)}),n?new t(e.height,e.width,e.x,r):new t(e.width,e.height,e.y,r)}};function NE(t,e,n){n?t.y+=e:t.x+=e,t.children.forEach(t=>{NE(t,e,n)})}function IE(t,e){let n=e?t.y:t.x;return t.children.forEach(t=>{n=Math.min(IE(t,e),n)}),n}function LE(t,e){NE(t,-IE(t,e),e)}function DE(t,e,n){n?e.y=t.x:e.x=t.x,t.c.forEach((t,r)=>{DE(t,e.children[r],n)})}function PE(t,e,n=0){e?(t.x=n,n+=t.width):(t.y=n,n+=t.height),t.children.forEach(t=>{PE(t,e,n)})}function RE(t,e={}){const n=e.isHorizontal;function r(t){0===t.cs?(t.el=t,t.er=t,t.msel=t.mser=0):(t.el=t.c[0].el,t.msel=t.c[0].msel,t.er=t.c[t.cs-1].er,t.mser=t.c[t.cs-1].mser)}function i(t,e,n){let r=t.c[e-1],i=r.mod,c=t.c[e],l=c.mod;for(;null!==r&&null!==c;){n&&a(r)>n.low&&(n=n.nxt);const u=i+r.prelim+r.w-(l+c.prelim);u>0&&(l+=u,n&&A(t,e,n.index,u));const h=a(r),d=a(c);h<=d&&(r=s(r),null!==r&&(i+=r.mod)),h>=d&&(c=o(c),null!==c&&(l+=c.mod))}!r&&c?function(t,e,n,r){const i=t.c[0].el;i.tl=n;const A=r-n.mod-t.c[0].msel;i.mod+=A,i.prelim-=A,t.c[0].el=t.c[e].el,t.c[0].msel=t.c[e].msel}(t,e,c,l):r&&!c&&function(t,e,n,r){const i=t.c[e].er;i.tr=n;const A=r-n.mod-t.c[e].mser;i.mod+=A,i.prelim-=A,t.c[e].er=t.c[e-1].er,t.c[e].mser=t.c[e-1].mser}(t,e,r,i)}function A(t,e,n,r){t.c[e].mod+=r,t.c[e].msel+=r,t.c[e].mser+=r,function(t,e,n,r){if(n!==e-1){const i=e-n;t.c[n+1].shift+=r/i,t.c[e].shift-=r/i,t.c[e].change-=r-r/i}}(t,e,n,r)}function o(t){return 0===t.cs?t.tl:t.c[0]}function s(t){return 0===t.cs?t.tr:t.c[t.cs-1]}function a(t){return t.y+t.h}function c(t,e,n){for(;null!==n&&t>=n.low;)n=n.nxt;return{low:t,index:e,nxt:n}}PE(t,n);const l=OE.fromNode(t,n);return l&&(function t(e){if(0===e.cs)return void r(e);t(e.c[0]);let n=c(a(e.c[0].el),0,null);for(let r=1;r<e.cs;++r){t(e.c[r]);const A=a(e.c[r].er);i(e,r,n),n=c(A,r,n)}!function(t){t.prelim=(t.c[0].prelim+t.c[0].mod+t.c[t.cs-1].mod+t.c[t.cs-1].prelim+t.c[t.cs-1].w)/2-t.w/2}(e),r(e)}(l),function t(e,n){n+=e.mod,e.x=e.prelim+n,function(t){let e=0,n=0;for(let r=0;r<t.cs;r++)e+=t.c[r].shift,n+=e+t.c[r].change,t.c[r].mod+=n}(e);for(let r=0;r<e.cs;r++)t(e.c[r],n)}(l,0),DE(l,t,n),LE(t,n)),t}function HE(t,e){const n=UE(t.data,e,!0),r=UE(t.data,e,!0),i=t.children.length,A=Math.round(i/2),o=e.getSide||function(t,e){return e<A?"right":"left"};for(let e=0;e<i;e++){const i=t.children[e];"right"===o(i,e)?r.children.push(i):n.children.push(i)}return n.eachNode(t=>{t.isRoot()||(t.side="left")}),r.eachNode(t=>{t.isRoot()||(t.side="right")}),{left:n,right:r}}const _E=["LR","RL","TB","BT","H","V"],GE=["LR","RL","H"],KE=_E[0];function jE(t,e,n){const r=e.direction||KE;if(e.isHorizontal=(t=>GE.indexOf(t)>-1)(r),-1===_E.indexOf(r))throw new TypeError(`Invalid direction: ${r}`);if(r===_E[0])n(t,e);else if(r===_E[1])n(t,e),t.right2left();else if(r===_E[2])n(t,e);else if(r===_E[3])n(t,e),t.bottom2top();else if(r===_E[4]||r===_E[5]){const{left:r,right:i}=HE(t,e);n(r,e),n(i,e),e.isHorizontal?r.right2left():r.bottom2top(),i.translate(r.x-i.x,r.y-i.y),t.x=r.x,t.y=i.y;const A=t.getBoundingBox();e.isHorizontal?A.top<0&&t.translate(0,-A.top):A.left<0&&t.translate(-A.left,0)}let i=e.fixedRoot;return void 0===i&&(i=!0),i&&t.translate(-(t.x+t.width/2+t.hgap),-(t.y+t.height/2+t.vgap)),function(t,e){if(e.radial){const[n,r]=e.isHorizontal?["x","y"]:["y","x"],i={x:1/0,y:1/0},A={x:-1/0,y:-1/0};let o=0;t.DFTraverse(t=>{o++;const{x:e,y:n}=t;i.x=Math.min(i.x,e),i.y=Math.min(i.y,n),A.x=Math.max(A.x,e),A.y=Math.max(A.y,n)});const s=A[r]-i[r];if(0===s)return;const a=2*Math.PI/o;t.DFTraverse(e=>{const A=e[r],o=i[r],c=e[n],l=t[n],u=(A-o)/s*(2*Math.PI-a)+a,h=c-l;e.x=Math.cos(u)*h,e.y=Math.sin(u)*h})}}(t,e),t}let VE=class extends TE{execute(){return jE(this.rootNode,this.options,RE)}};const zE={};function WE(t,e){const n=kE({},zE,e);return new VE(t,n).execute()}let YE=class{constructor(t=0,e=[]){this.x=0,this.y=0,this.leftChild=null,this.rightChild=null,this.isLeaf=!1,this.height=t,this.children=e}};const XE={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function qE(t,e,n){n?(e.x=t.x,e.y=t.y):(e.x=t.y,e.y=t.x),t.children.forEach((t,r)=>{qE(t,e.children[r],n)})}function ZE(t,e={}){const n=kE({},XE,e);let r=0,i=null;const A=function t(e){e.width=0,e.depth&&e.depth>r&&(r=e.depth);const n=e.children,i=n.length,A=new YE(0,[]);return n.forEach((e,n)=>{const r=t(e);A.children.push(r),0===n&&(A.leftChild=r),n===i-1&&(A.rightChild=r)}),A.originNode=e,A.isLeaf=e.isLeaf(),A}(t);return function t(e){if(e.isLeaf||0===e.children.length)e.drawingDepth=r;else{const n=e.children.map(e=>t(e)),r=Math.min(...n);e.drawingDepth=r-1}return e.drawingDepth}(A),function t(e){e.x=e.drawingDepth*n.rankSep,e.isLeaf?(e.y=0,i&&(e.y=i.y+i.height+n.nodeSep,e.originNode.parent!==i.originNode.parent&&(e.y+=n.subTreeSep)),i=e):(e.children.forEach(e=>{t(e)}),e.y=(e.leftChild.y+e.rightChild.y)/2)}(A),qE(A,t,n.isHorizontal),t}class JE extends TE{execute(){return this.rootNode.width=0,jE(this.rootNode,this.options,ZE)}}const $E={};function tx(t,e){const n=kE({},$E,e);return new JE(t,n).execute()}function ex(t,e,n,r){let i=null;t.eachNode(t=>{!function(t,e,n,r,i){const A=("function"==typeof n?n(t):n)*t.depth;if(!r)try{if(t.parent&&t.id===t.parent.children[0].id)return t.x+=A,void(t.y=e?e.y:0)}catch{}if(t.x+=A,e){if(t.y=e.y+ME(e,t,i),e.parent&&t.parent&&t.parent.id!==e.parent.id){const n=e.parent,r=n.y+ME(n,t,i);t.y=r>t.y?r:t.y}}else t.y=0}(t,i,e,n,r),i=t})}const nx=["LR","RL","H"],rx=nx[0];class ix extends TE{execute(){const t=this.options,e=this.rootNode;t.isHorizontal=!0;const{indent:n=20,dropCap:r=!0,direction:i=rx,align:A}=t;if(i&&-1===nx.indexOf(i))throw new TypeError(`Invalid direction: ${i}`);if(i===nx[0])ex(e,n,r,A);else if(i===nx[1])ex(e,n,r,A),e.right2left();else if(i===nx[2]){const{left:i,right:o}=HE(e,t);ex(i,n,r,A),i.right2left(),ex(o,n,r,A);const s=i.getBoundingBox();o.translate(s.width,0),e.x=o.x-e.width/2}return e}}const Ax={};function ox(t,e){const n=kE({},Ax,e);return new ix(t,n).execute()}function sx(t,e){let n=0;return t.children.length?t.children.forEach(t=>{n+=sx(t,e)}):n=t.height,t._subTreeSep=e.getSubTreeSep(t.data),t.totalHeight=Math.max(t.height,n)+2*t._subTreeSep,t.totalHeight}function ax(t){const e=t.children,n=e.length;if(n){e.forEach(t=>{ax(t)});const r=e[0],i=e[n-1],A=i.y-r.y+i.height;let o=0;if(e.forEach(t=>{o+=t.totalHeight}),A>t.height)t.y=r.y+A/2-t.height/2;else if(1!==e.length||t.height>o){const n=t.y+(t.height-A)/2-r.y;e.forEach(t=>{t.translate(0,n)})}else t.y=(r.y+r.height/2+i.y+i.height/2)/2-t.height/2}}const cx={getSubTreeSep:()=>0};function lx(t,e={}){return e=kE({},cx,e),t.parent={x:0,width:0,height:0,y:0},t.BFTraverse(t=>{t.x=t.parent.x+t.parent.width}),t.parent=void 0,sx(t,e),t.startY=0,t.y=t.totalHeight/2-t.height/2,t.eachNode(t=>{const e=t.children,n=e.length;if(n){const r=e[0];if(r.startY=t.startY+t._subTreeSep,1===n)r.y=t.y+t.height/2-r.height/2;else{r.y=r.startY+r.totalHeight/2-r.height/2;for(let t=1;t<n;t++){const n=e[t];n.startY=e[t-1].startY+e[t-1].totalHeight,n.y=n.startY+n.totalHeight/2-n.height/2}}}}),ax(t),t}class ux extends TE{execute(){return jE(this.rootNode,this.options,lx)}}const hx={};function dx(t,e){const n=kE({},hx,e);return new ux(t,n).execute()}const fx=(t,e)=>{if("next"!==t&&"prev"!==t)return e},gx=t=>{t.prev.next=t.next,t.next.prev=t.prev,delete t.next,delete t.prev};let px=class{constructor(){const t={};t.prev=t,t.next=t.prev,this.shortcut=t}dequeue(){const t=this.shortcut,e=t.prev;if(e&&e!==t)return gx(e),e}enqueue(t){const e=this.shortcut;t.prev&&t.next&&gx(t),t.next=e.next,e.next.prev=t,e.next=t,t.prev=e}toString(){const t=[],e=this.shortcut;let n=e.prev;for(;n!==e;)t.push(JSON.stringify(n,fx)),n=null==n?void 0:n.prev;return`[${t.join(", ")}]`}},vx=class extends px{};const mx=()=>1,yx=(t,e,n)=>{let r=[];const i=e[e.length-1],A=e[0];let o;for(;t.getAllNodes().length;){for(;o=A.dequeue();)wx(t,e,n,o);for(;o=i.dequeue();)wx(t,e,n,o);if(t.getAllNodes().length)for(let i=e.length-2;i>0;--i)if(o=e[i].dequeue(),o){r=r.concat(wx(t,e,n,o,!0));break}}return r},wx=(t,e,n,r,i)=>{var A,o;const s=[];return t.hasNode(r.v)&&(null===(A=t.getRelatedEdges(r.v,"in"))||void 0===A||A.forEach(r=>{const A=r.data.weight,o=t.getNode(r.source);i&&s.push({v:r.source,w:r.target,in:0,out:0}),void 0===o.data.out&&(o.data.out=0),o.data.out-=A,bx(e,n,Object.assign({v:o.id},o.data))}),null===(o=t.getRelatedEdges(r.v,"out"))||void 0===o||o.forEach(r=>{const i=r.data.weight,A=r.target,o=t.getNode(A);void 0===o.data.in&&(o.data.in=0),o.data.in-=i,bx(e,n,Object.assign({v:o.id},o.data))}),t.removeNode(r.v)),i?s:void 0},Bx=(t,e)=>{const n=new fE;let r=0,i=0;t.getAllNodes().forEach(t=>{n.addNode({id:t.id,data:{v:t.id,in:0,out:0}})}),t.getAllEdges().forEach(t=>{const A=n.getRelatedEdges(t.source,"out").find(e=>e.target===t.target),o=(null==e?void 0:e(t))||1;A?n.updateEdgeData(null==A?void 0:A.id,Object.assign(Object.assign({},A.data),{weight:A.data.weight+o})):n.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:o}}),i=Math.max(i,n.getNode(t.source).data.out+=o),r=Math.max(r,n.getNode(t.target).data.in+=o)});const A=[],o=i+r+3;for(let t=0;t<o;t++)A.push(new vx);const s=r+1;return n.getAllNodes().forEach(t=>{bx(A,s,Object.assign({v:t.id},n.getNode(t.id).data))}),{buckets:A,zeroIdx:s,graph:n}},bx=(t,e,n)=>{n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)},Ex=(t,e)=>{const n=((t,e)=>{var n;if(t.getAllNodes().length<=1)return[];const r=Bx(t,e||mx);return null===(n=yx(r.graph,r.buckets,r.zeroIdx).map(e=>t.getRelatedEdges(e.v,"out").filter(({target:t})=>t===e.w)))||void 0===n?void 0:n.flat()})(t,t=>t.data.weight||1);null==n||n.forEach(e=>{const n=e.data;t.removeEdge(e.id),n.forwardName=e.data.name,n.reversed=!0,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign({},n)})})},xx=(t,e,n,r)=>{let i;do{i=`${r}${Math.random()}`}while(t.hasNode(i));return n.dummy=e,t.addNode({id:i,data:n}),i},Cx=t=>{const e=new fE;return t.getAllNodes().forEach(n=>{t.getChildren(n.id).length||e.addNode(Object.assign({},n))}),t.getAllEdges().forEach(t=>{e.addEdge(t)}),e},Fx=(t,e)=>{const n=Number(t.x),r=Number(t.y),i=Number(e.x)-n,A=Number(e.y)-r;let o,s,a=Number(t.width)/2,c=Number(t.height)/2;return i||A?(Math.abs(A)*a>Math.abs(i)*c?(A<0&&(c=-c),o=c*i/A,s=c):(i<0&&(a=-a),o=a,s=a*A/i),{x:n+o,y:r+s}):{x:0,y:0}},Mx=t=>{const e=[],n=Qx(t)+1;for(let t=0;t<n;t++)e.push([]);t.getAllNodes().forEach(t=>{const n=t.data.rank;void 0!==n&&e[n]&&e[n].push(t.id)});for(let r=0;r<n;r++)e[r]=e[r].sort((e,n)=>{return r=t.getNode(e).data.order,i=t.getNode(n).data.order,Number(r)-Number(i);var r,i});return e},kx=(t,e,n,r)=>{const i={width:0,height:0};return oe(n)&&oe(r)&&(i.rank=n,i.order=r),xx(t,"border",i,e)},Qx=t=>{let e;return t.getAllNodes().forEach(t=>{const n=t.data.rank;void 0!==n&&(void 0===e||n>e)&&(e=n)}),e||(e=0),e},Sx=(t,e)=>t.reduce((t,n)=>e(t)>e(n)?n:t),Ux=(t,e,n,r,i,A)=>{r.includes(e.id)||(r.push(e.id),n||A.push(e.id),i(e.id).forEach(e=>Ux(t,e,n,r,i,A)),n&&A.push(e.id))},Tx=(t,e,n,r)=>{const i=Array.isArray(e)?e:[e],A=e=>t.getNeighbors(e),o=[],s=[];return i.forEach(e=>{if(!t.hasNode(e.id))throw new Error(`Graph does not have node: ${e}`);Ux(t,e,"post"===n,s,A,o)}),o},Ox=(t,e,n,r,i,A)=>{const o={rank:A,borderType:e,width:0,height:0},s=i.data[e][A-1],a=xx(t,"border",o,n);i.data[e][A]=a,t.setParent(a,r),s&&t.addEdge({id:`e${Math.random()}`,source:s,target:a,data:{weight:1}})},Nx=t=>{t.getAllNodes().forEach(t=>{Ix(t)}),t.getAllEdges().forEach(t=>{Ix(t)})},Ix=t=>{const e=t.data.width;t.data.width=t.data.height,t.data.height=e},Lx=t=>{t.getAllNodes().forEach(t=>{Dx(t.data)}),t.getAllEdges().forEach(t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach(t=>Dx(t)),t.data.hasOwnProperty("y")&&Dx(t.data)})},Dx=t=>{(null==t?void 0:t.y)&&(t.y=-t.y)},Px=t=>{t.getAllNodes().forEach(t=>{Rx(t.data)}),t.getAllEdges().forEach(t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach(t=>Rx(t)),t.data.hasOwnProperty("x")&&Rx(t.data)})},Rx=t=>{const e=t.x;t.x=t.y,t.y=e},Hx=(t,e,n,r,i,A,o)=>{const s=t.getChildren(o);if(!(null==s?void 0:s.length))return void(o!==e&&t.addEdge({id:`e${Math.random()}`,source:e,target:o,data:{weight:0,minlen:n}}));const a=kx(t,"_bt"),c=kx(t,"_bb"),l=t.getNode(o);t.setParent(a,o),l.data.borderTop=a,t.setParent(c,o),l.data.borderBottom=c,null==s||s.forEach(s=>{Hx(t,e,n,r,i,A,s.id);const l=s.data.borderTop?s.data.borderTop:s.id,u=s.data.borderBottom?s.data.borderBottom:s.id,h=s.data.borderTop?r:2*r,d=l!==u?1:i-A[o]+1;t.addEdge({id:`e${Math.random()}`,source:a,target:l,data:{minlen:d,weight:h,nestingEdge:!0}}),t.addEdge({id:`e${Math.random()}`,source:u,target:c,data:{minlen:d,weight:h,nestingEdge:!0}})}),t.getParent(o)||t.addEdge({id:`e${Math.random()}`,source:e,target:a,data:{weight:0,minlen:i+A[o]}})},_x=t=>{const e={},n=(r,i)=>{const A=t.getChildren(r);null==A||A.forEach(t=>n(t.id,i+1)),e[r]=i};return t.getRoots().forEach(t=>n(t.id,1)),e},Gx=t=>{let e=0;return t.getAllEdges().forEach(t=>{e+=t.data.weight}),e},Kx="edge-label",jx=(t,e,n)=>{let r=e.source,i=t.getNode(r).data.rank;const A=e.target,o=t.getNode(A).data.rank,s=e.data.labelRank;if(o===i+1)return;let a,c,l;for(t.removeEdge(e.id),l=0,++i;i<o;++l,++i)e.data.points=[],c={originalEdge:e,width:0,height:0,rank:i},a=xx(t,"edge",c,"_d"),i===s&&(c.width=e.data.width,c.height=e.data.height,c.dummy=Kx,c.labelpos=e.data.labelpos),t.addEdge({id:`e${Math.random()}`,source:r,target:a,data:{weight:e.data.weight}}),0===l&&n.push(a),r=a;t.addEdge({id:`e${Math.random()}`,source:r,target:A,data:{weight:e.data.weight}})},Vx=t=>{let e;for(;t.hasNode(e=`_root${Math.random()}`););return e},zx=(t,e,n)=>{const r=((t,e)=>null==t?void 0:t.reduce((t,n,r)=>(t[n]=e[r],t),{}))(n,n.map((t,e)=>e)),i=e.map(e=>{const n=t.getRelatedEdges(e,"out").map(t=>({pos:r[t.target]||0,weight:t.data.weight}));return null==n?void 0:n.sort((t,e)=>t.pos-e.pos)}),A=i.flat().filter(t=>void 0!==t);let o=1;for(;o<n.length;)o<<=1;const s=2*o-1;o-=1;const a=Array(s).fill(0,0,s);let c=0;return null==A||A.forEach(t=>{if(t){let e=t.pos+o;a[e]+=t.weight;let n=0;for(;e>0;)e%2&&(n+=a[e+1]),e=e-1>>1,a[e]+=t.weight;c+=t.weight*n}}),c},Wx=(t,e)=>{let n=0;for(let r=1;r<(null==e?void 0:e.length);r+=1)n+=zx(t,e[r-1],e[r]);return n},Yx=t=>{const e={},n=t.getAllNodes(),r=n.map(t=>{var e;return null!==(e=t.data.rank)&&void 0!==e?e:-1/0}),i=Math.max(...r),A=[];for(let t=0;t<i+1;t++)A.push([]);const o=n.sort((e,n)=>t.getNode(e.id).data.rank-t.getNode(n.id).data.rank),s=o.filter(e=>void 0!==t.getNode(e.id).data.fixorder),a=s.sort((e,n)=>t.getNode(e.id).data.fixorder-t.getNode(n.id).data.fixorder);return null==a||a.forEach(n=>{isNaN(t.getNode(n.id).data.rank)||A[t.getNode(n.id).data.rank].push(n.id),e[n.id]=!0}),null==o||o.forEach(n=>t.dfsTree(n.id,t=>{if(e.hasOwnProperty(t.id))return!0;e[t.id]=!0,isNaN(t.data.rank)||A[t.data.rank].push(t.id)})),A},Xx=t=>{var e,n;const r=[];for(;null==t?void 0:t.length;){const i=t.pop();r.push(i),null===(e=i.in.reverse())||void 0===e||e.forEach(t=>{return(e=i,t=>{t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&qx(e,t)})(t);var e}),null===(n=i.out)||void 0===n||n.forEach(e=>{return(n=i,e=>{e.in.push(n),0===--e.indegree&&t.push(e)})(e);var n})}const i=r.filter(t=>!t.merged),A=["vs","i","barycenter","weight"];return i.map(t=>{const e={};return null==A||A.forEach(n=>{void 0!==t[n]&&(e[n]=t[n])}),e})},qx=(t,e)=>{var n;let r=0,i=0;t.weight&&(r+=t.barycenter*t.weight,i+=t.weight),e.weight&&(r+=e.barycenter*e.weight,i+=e.weight),t.vs=null===(n=e.vs)||void 0===n?void 0:n.concat(t.vs),t.barycenter=r/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0},Zx=(t,e,n)=>{let r,i=n;for(;e.length&&(r=e[e.length-1]).i<=i;)e.pop(),null==t||t.push(r.vs),i++;return i},Jx=(t,e)=>(n,r)=>{if(void 0!==n.fixorder&&void 0!==r.fixorder)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(e&&void 0!==n.order&&void 0!==r.order){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return t?r.i-n.i:n.i-r.i},$x=(t,e,n,r,i,A)=>{var o,s,a,c;let l=t.getChildren(e).map(t=>t.id);const u=t.getNode(e),h=u?u.data.borderLeft:void 0,d=u?u.data.borderRight:void 0,f={};h&&(l=null==l?void 0:l.filter(t=>t!==h&&t!==d));const g=((t,e)=>e.map(e=>{const n=t.getRelatedEdges(e,"in");if(!(null==n?void 0:n.length))return{v:e};const r={sum:0,weight:0};return null==n||n.forEach(e=>{const n=t.getNode(e.source);r.sum+=e.data.weight*n.data.order,r.weight+=e.data.weight}),{v:e,barycenter:r.sum/r.weight,weight:r.weight}}))(t,l||[]);null==g||g.forEach(e=>{var i;if(null===(i=t.getChildren(e.v))||void 0===i?void 0:i.length){const i=$x(t,e.v,n,r,A);f[e.v]=i,i.hasOwnProperty("barycenter")&&eC(e,i)}});const p=((t,e)=>{var n,r,i;const A={};null==t||t.forEach((t,e)=>{A[t.v]={i:e,indegree:0,in:[],out:[],vs:[t.v]};const n=A[t.v];void 0!==t.barycenter&&(n.barycenter=t.barycenter,n.weight=t.weight)}),null===(n=e.getAllEdges())||void 0===n||n.forEach(t=>{const e=A[t.source],n=A[t.target];void 0!==e&&void 0!==n&&(n.indegree++,e.out.push(A[t.target]))});const o=null===(i=(r=Object.values(A)).filter)||void 0===i?void 0:i.call(r,t=>!t.indegree);return Xx(o)})(g,n);tC(p,f),null===(o=p.filter(t=>t.vs.length>0))||void 0===o||o.forEach(e=>{const n=t.getNode(e.vs[0]);n&&(e.fixorder=n.data.fixorder,e.order=n.data.order)});const v=((t,e,n,r)=>{const i=((t,e)=>{const n={lhs:[],rhs:[]};return null==t||t.forEach(t=>{e(t)?n.lhs.push(t):n.rhs.push(t)}),n})(t,t=>{const e=t.hasOwnProperty("fixorder")&&!isNaN(t.fixorder);return r?!e&&t.hasOwnProperty("barycenter"):e||t.hasOwnProperty("barycenter")}),A=i.lhs,o=i.rhs.sort((t,e)=>-t.i- -e.i),s=[];let a=0,c=0,l=0;null==A||A.sort(Jx(!!e,!!n)),l=Zx(s,o,l),null==A||A.forEach(t=>{var e;l+=null===(e=t.vs)||void 0===e?void 0:e.length,s.push(t.vs),a+=t.barycenter*t.weight,c+=t.weight,l=Zx(s,o,l)});const u={vs:s.flat()};return c&&(u.barycenter=a/c,u.weight=c),u})(p,r,i,A);if(h&&(v.vs=[h,v.vs,d].flat(),null===(s=t.getPredecessors(h))||void 0===s?void 0:s.length)){const e=t.getNode((null===(a=t.getPredecessors(h))||void 0===a?void 0:a[0].id)||""),n=t.getNode((null===(c=t.getPredecessors(d))||void 0===c?void 0:c[0].id)||"");v.hasOwnProperty("barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+e.data.order+n.data.order)/(v.weight+2),v.weight+=2}return v},tC=(t,e)=>{null==t||t.forEach(t=>{var n;const r=null===(n=t.vs)||void 0===n?void 0:n.map(t=>e[t]?e[t].vs:t);t.vs=r.flat()})},eC=(t,e)=>{void 0!==t.barycenter?(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight):(t.barycenter=e.barycenter,t.weight=e.weight)},nC=(t,e,n)=>e.map(e=>((t,e,n)=>{const r=Vx(t),i=new fE({tree:[{id:r,children:[],data:{}}]});return t.getAllNodes().forEach(A=>{const o=t.getParent(A.id);(A.data.rank===e||A.data.minRank<=e&&e<=A.data.maxRank)&&(i.hasNode(A.id)||i.addNode(Object.assign({},A)),(null==o?void 0:o.id)&&!i.hasNode(null==o?void 0:o.id)&&i.addNode(Object.assign({},o)),i.setParent(A.id,(null==o?void 0:o.id)||r),t.getRelatedEdges(A.id,n).forEach(e=>{const n=e.source===A.id?e.target:e.source;i.hasNode(n)||i.addNode(Object.assign({},t.getNode(n)));const r=i.getRelatedEdges(n,"out").find(({target:t})=>t===A.id),o=void 0!==r?r.data.weight:0;r?i.updateEdgeData(r.id,Object.assign(Object.assign({},r.data),{weight:e.data.weight+o})):i.addEdge({id:e.id,source:n,target:A.id,data:{weight:e.data.weight+o}})}),A.data.hasOwnProperty("minRank")&&i.updateNodeData(A.id,Object.assign(Object.assign({},A.data),{borderLeft:A.data.borderLeft[e],borderRight:A.data.borderRight[e]})))}),i})(t,e,n)),rC=(t,e,n,r)=>{const i=new fE;null==t||t.forEach(t=>{var A;const o=t.getRoots()[0].id,s=$x(t,o,i,e,n,r);for(let e=0;e<(null===(A=s.vs)||void 0===A?void 0:A.length);e++){const n=t.getNode(s.vs[e]);n&&(n.data.order=e)}((t,e,n)=>{const r={};let i;null==n||n.forEach(n=>{let A,o,s=t.getParent(n);for(;s;){if(A=t.getParent(s.id),A?(o=r[A.id],r[A.id]=s.id):(o=i,i=s.id),o&&o!==s.id)return e.hasNode(o)||e.addNode({id:o,data:{}}),e.hasNode(s.id)||e.addNode({id:s.id,data:{}}),void(e.hasEdge(`e${o}-${s.id}`)||e.addEdge({id:`e${o}-${s.id}`,source:o,target:s.id,data:{}}));s=A}})})(t,i,s.vs)})},iC=(t,e)=>{null==e||e.forEach(e=>{null==e||e.forEach((e,n)=>{t.getNode(e).data.order=n})})},AC=(t,e)=>{const n=(t=>{const e={};let n=0;const r=i=>{const A=n;t.getChildren(i).forEach(t=>r(t.id)),e[i]={low:A,lim:n++}};return t.getRoots().forEach(t=>r(t.id)),e})(t);e.forEach(e=>{var r,i;let A=e,o=t.getNode(A);const s=o.data.originalEdge;if(!s)return;const a=((t,e,n,r)=>{var i,A;const o=[],s=[],a=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);let l,u;l=n;do{l=null===(i=t.getParent(l))||void 0===i?void 0:i.id,o.push(l)}while(l&&(e[l].low>a||c>e[l].lim));for(u=l,l=r;l&&l!==u;)s.push(l),l=null===(A=t.getParent(l))||void 0===A?void 0:A.id;return{lca:u,path:o.concat(s.reverse())}})(t,n,s.source,s.target),c=a.path,l=a.lca;let u=0,h=c[u],d=!0;for(;A!==s.target;){if(o=t.getNode(A),d){for(;h!==l&&(null===(r=t.getNode(h))||void 0===r?void 0:r.data.maxRank)<o.data.rank;)u++,h=c[u];h===l&&(d=!1)}if(!d){for(;u<c.length-1&&(null===(i=t.getNode(c[u+1]))||void 0===i?void 0:i.data.minRank)<=o.data.rank;)u++;h=c[u]}t.hasNode(h)&&t.setParent(A,h),A=t.getSuccessors(A)[0].id}})},oC=(t,e)=>{const n={};function r(e,r){const i=function(t){return JSON.stringify(t.slice(1))}(e);r.get(i)||(!function(e,r,i,A,o){var s,a;let c;for(let l=r;l<i;l++)c=e[l],(null===(s=t.getNode(c))||void 0===s?void 0:s.data.dummy)&&(null===(a=t.getPredecessors(c))||void 0===a||a.forEach(e=>{const r=t.getNode(e.id);r.data.dummy&&(r.data.order<A||r.data.order>o)&&aC(n,e.id,c)}))}(...e),r.set(i,!0))}const i=(e,n)=>{let i,A=-1,o=0;const s=new Map;return null==n||n.forEach((a,c)=>{var l;if("border"===(null===(l=t.getNode(a))||void 0===l?void 0:l.data.dummy)){const e=t.getPredecessors(a)||[];e.length&&(i=t.getNode(e[0].id).data.order,r([n,o,c,A,i],s),o=c,A=i)}r([n,o,n.length,i,e.length],s)}),n};return(null==e?void 0:e.length)&&e.reduce(i),n},sC=(t,e)=>{var n,r;if(null===(n=t.getNode(e))||void 0===n?void 0:n.data.dummy)return null===(r=t.getPredecessors(e))||void 0===r?void 0:r.find(e=>t.getNode(e.id).data.dummy)},aC=(t,e,n)=>{let r=e,i=n;if(r>i){const t=r;r=i,i=t}let A=t[r];A||(t[r]=A={}),A[i]=!0},cC=(t,e,n)=>{let r=e,i=n;if(r>n){r=n,i=e}return!!t[r]},lC=(t,e,n,r,i,A)=>{const o=new fE,s=uC(r,i,A);return null==e||e.forEach(e=>{let r;null==e||e.forEach(e=>{const i=n[e];if(o.hasNode(i)||o.addNode({id:i,data:{}}),r){const A=n[r],a=o.getRelatedEdges(A,"out").find(t=>t.target===i);a?o.updateEdgeData(a.id,Object.assign(Object.assign({},a.data),{weight:Math.max(s(t,e,r),a.data.weight||0)})):o.addEdge({id:`e${Math.random()}`,source:A,target:i,data:{weight:Math.max(s(t,e,r),0)}})}r=e})}),o};const uC=(t,e,n)=>(r,i,A)=>{const o=r.getNode(i),s=r.getNode(A);let a=0,c=0;if(a+=o.data.width/2,o.data.hasOwnProperty("labelpos"))switch((o.data.labelpos||"").toLowerCase()){case"l":c=-o.data.width/2;break;case"r":c=o.data.width/2}if(c&&(a+=n?c:-c),c=0,a+=(o.data.dummy?e:t)/2,a+=(s.data.dummy?e:t)/2,a+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||"").toLowerCase()){case"l":c=s.data.width/2;break;case"r":c=-s.data.width/2}return c&&(a+=n?c:-c),c=0,a},hC=(t,e)=>t.getNode(e).data.width||0,dC=(t,e)=>{const{align:n,nodesep:r=0,edgesep:i=0}=e||{},A=Mx(t),o=Object.assign(((t,e)=>{const n={},r=(e,r)=>{let i=0,A=0;const o=e.length,s=null==r?void 0:r[(null==r?void 0:r.length)-1];return null==r||r.forEach((e,a)=>{var c;const l=sC(t,e),u=l?t.getNode(l.id).data.order:o;(l||e===s)&&(null===(c=r.slice(A,a+1))||void 0===c||c.forEach(e=>{var r;null===(r=t.getPredecessors(e))||void 0===r||r.forEach(r=>{var A;const o=t.getNode(r.id),s=o.data.order;!(s<i||u<s)||o.data.dummy&&(null===(A=t.getNode(e))||void 0===A?void 0:A.data.dummy)||aC(n,r.id,e)})}),A=a+1,i=u)}),r};return(null==e?void 0:e.length)&&e.reduce(r),n})(t,A),oC(t,A)),s={};let a=[];["u","d"].forEach(e=>{a="u"===e?A:Object.values(A).reverse(),["l","r"].forEach(n=>{"r"===n&&(a=a.map(t=>Object.values(t).reverse()));const A=("u"===e?t.getPredecessors:t.getSuccessors).bind(t),c=((t,e,n,r)=>{const i={},A={},o={};return null==e||e.forEach(t=>{null==t||t.forEach((t,e)=>{i[t]=t,A[t]=t,o[t]=e})}),null==e||e.forEach(t=>{let e=-1;null==t||t.forEach(t=>{let s=r(t).map(t=>t.id);if(s.length){s=s.sort((t,e)=>o[t]-o[e]);const r=(s.length-1)/2;for(let a=Math.floor(r),c=Math.ceil(r);a<=c;++a){const r=s[a];A[t]===t&&e<o[r]&&!cC(n,t,r)&&(A[r]=t,A[t]=i[t]=i[r],e=o[r])}}})}),{root:i,align:A}})(0,a,o,A),l=((t,e,n,r,i,A,o)=>{var s;const a={},c=lC(t,e,n,i,A,o),l=o?"borderLeft":"borderRight",u=(t,e)=>{let n=c.getAllNodes(),r=n.pop();const i={};for(;r;)i[r.id]?t(r.id):(i[r.id]=!0,n.push(r),n=n.concat(e(r.id))),r=n.pop()};return u(t=>{a[t]=(c.getRelatedEdges(t,"in")||[]).reduce((t,e)=>Math.max(t,(a[e.source]||0)+e.data.weight),0)},c.getPredecessors.bind(c)),u(e=>{const n=(c.getRelatedEdges(e,"out")||[]).reduce((t,e)=>Math.min(t,(a[e.target]||0)-e.data.weight),Number.POSITIVE_INFINITY),r=t.getNode(e);n!==Number.POSITIVE_INFINITY&&r.data.borderType!==l&&(a[e]=Math.max(a[e],n))},c.getSuccessors.bind(c)),null===(s=Object.values(r))||void 0===s||s.forEach(t=>{a[t]=a[n[t]]}),a})(t,a,c.root,c.align,r,i,"r"===n);"r"===n&&Object.keys(l).forEach(t=>l[t]=-l[t]),s[e+n]=l})});const c=((t,e)=>Sx(Object.values(e),e=>{var n;let r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return null===(n=Object.keys(e))||void 0===n||n.forEach(n=>{const A=e[n],o=hC(t,n)/2;r=Math.max(A+o,r),i=Math.min(A-o,i)}),r-i}))(t,s);return c&&function(t,e){const n=Object.values(e),r=Math.min(...n),i=Math.max(...n);["u","d"].forEach(n=>{["l","r"].forEach(A=>{const o=n+A,s=t[o];let a;if(s===e)return;const c=Object.values(s);a="l"===A?r-Math.min(...c):i-Math.max(...c),a&&(t[o]={},Object.keys(s).forEach(e=>{t[o][e]=s[e]+a}))})})}(s,c),((t,e)=>{const n={};return Object.keys(t.ul).forEach(r=>{if(e)n[r]=t[e.toLowerCase()][r];else{const e=Object.values(t).map(t=>t[r]);n[r]=(e[0]+e[1])/2}}),n})(s,n)},fC=(t,e)=>{var n;const r=Cx(t);((t,e)=>{const{ranksep:n=0}=e||{},r=Mx(t);let i=0;null==r||r.forEach(e=>{const r=e.map(e=>t.getNode(e).data.height),A=Math.max(...r,0);null==e||e.forEach(e=>{t.getNode(e).data.y=i+A/2}),i+=A+n})})(r,e);const i=dC(r,e);null===(n=Object.keys(i))||void 0===n||n.forEach(t=>{r.getNode(t).data.x=i[t]})},gC=t=>{const e={},n=r=>{var i;const A=t.getNode(r);if(!A)return 0;if(e[r])return A.data.rank;let o;return e[r]=!0,null===(i=t.getRelatedEdges(r,"out"))||void 0===i||i.forEach(t=>{const e=n(t.target)-t.data.minlen;e&&(void 0===o||e<o)&&(o=e)}),o||(o=0),A.data.rank=o,o};t.getAllNodes().filter(e=>0===t.getRelatedEdges(e.id,"in").length).forEach(t=>n(t.id))},pC=(t,e)=>t.getNode(e.target).data.rank-t.getNode(e.source).data.rank-e.data.minlen,vC=(t,e)=>{const n=r=>{e.getRelatedEdges(r,"both").forEach(i=>{const A=i.source,o=r===A?i.target:A;t.hasNode(o)||pC(e,i)||(t.addNode({id:o,data:{}}),t.addEdge({id:i.id,source:r,target:o,data:{}}),n(o))})};return t.getAllNodes().forEach(t=>n(t.id)),t.getAllNodes().length},mC=(t,e)=>{const n=r=>{var i;null===(i=e.getRelatedEdges(r,"both"))||void 0===i||i.forEach(i=>{const A=i.source,o=r===A?i.target:A;t.hasNode(o)||void 0===e.getNode(o).data.layer&&pC(e,i)||(t.addNode({id:o,data:{}}),t.addEdge({id:i.id,source:r,target:o,data:{}}),n(o))})};return t.getAllNodes().forEach(t=>n(t.id)),t.getAllNodes().length},yC=(t,e)=>Sx(e.getAllEdges(),n=>t.hasNode(n.source)!==t.hasNode(n.target)?pC(e,n):1/0),wC=(t,e,n)=>{t.getAllNodes().forEach(t=>{const r=e.getNode(t.id);r.data.rank||(r.data.rank=0),r.data.rank+=n})},BC=t=>{const e=(t=>{const e=new fE;return t.getAllNodes().forEach(t=>{e.addNode(Object.assign({},t))}),t.getAllEdges().forEach(t=>{const n=e.getRelatedEdges(t.source,"out").find(e=>e.target===t.target);n?e.updateEdgeData(null==n?void 0:n.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+t.data.weight||0,minlen:Math.max(n.data.minlen,t.data.minlen||1)})):e.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||0,minlen:t.data.minlen||1}})}),e})(t);gC(e);const n=(t=>{const e=new fE({tree:[]}),n=t.getAllNodes()[0],r=t.getAllNodes().length;let i,A;for(e.addNode(n);vC(e,t)<r;)i=yC(e,t),A=e.hasNode(i.source)?pC(t,i):-pC(t,i),wC(e,t,A);return e})(e);let r,i;for(CC(n),bC(n,e);r=MC(n);)i=kC(n,e,r),QC(n,e,r,i)},bC=(t,e)=>{let n=Tx(t,t.getAllNodes(),"post");n=n.slice(0,(null==n?void 0:n.length)-1),n.forEach(n=>{EC(t,e,n)})},EC=(t,e,n)=>{const r=t.getNode(n).data.parent,i=t.getRelatedEdges(n,"both").find(t=>t.target===r||t.source===r);i.data.cutvalue=xC(t,e,n)},xC=(t,e,n)=>{const r=t.getNode(n).data.parent;let i=!0,A=e.getRelatedEdges(n,"out").find(t=>t.target===r),o=0;return A||(i=!1,A=e.getRelatedEdges(r,"out").find(t=>t.target===n)),o=A.data.weight,e.getRelatedEdges(n,"both").forEach(e=>{const A=e.source===n,s=A?e.target:e.source;if(s!==r){const r=A===i,a=e.data.weight;if(o+=r?a:-a,UC(t,n,s)){const e=t.getRelatedEdges(n,"both").find(t=>t.source===s||t.target===s).data.cutvalue;o+=r?-e:e}}}),o},CC=(t,e=t.getAllNodes()[0].id)=>{FC(t,{},1,e)},FC=(t,e,n,r,i)=>{var A;const o=n;let s=n;const a=t.getNode(r);return e[r]=!0,null===(A=t.getNeighbors(r))||void 0===A||A.forEach(n=>{e[n.id]||(s=FC(t,e,s,n.id,r))}),a.data.low=o,a.data.lim=s++,i?a.data.parent=i:delete a.data.parent,s},MC=t=>t.getAllEdges().find(t=>t.data.cutvalue<0),kC=(t,e,n)=>{let r=n.source,i=n.target;e.getRelatedEdges(r,"out").find(t=>t.target===i)||(r=n.target,i=n.source);const A=t.getNode(r),o=t.getNode(i);let s=A,a=!1;A.data.lim>o.data.lim&&(s=o,a=!0);const c=e.getAllEdges().filter(e=>a===TC(t.getNode(e.source),s)&&a!==TC(t.getNode(e.target),s));return Sx(c,t=>pC(e,t))},QC=(t,e,n,r)=>{const i=t.getRelatedEdges(n.source,"both").find(t=>t.source===n.target||t.target===n.target);i&&t.removeEdge(i.id),t.addEdge({id:`e${Math.random()}`,source:r.source,target:r.target,data:{}}),CC(t),bC(t,e),SC(t,e)},SC=(t,e)=>{const n=t.getAllNodes().find(t=>!t.data.parent);let r=Tx(t,n,"pre");r=r.slice(1),r.forEach(n=>{const r=t.getNode(n).data.parent;let i=e.getRelatedEdges(n,"out").find(t=>t.target===r),A=!1;!i&&e.hasNode(r)&&(i=e.getRelatedEdges(r,"out").find(t=>t.target===n),A=!0),e.getNode(n).data.rank=(e.hasNode(r)&&e.getNode(r).data.rank||0)+(A?null==i?void 0:i.data.minlen:-(null==i?void 0:i.data.minlen))})},UC=(t,e,n)=>t.getRelatedEdges(e,"both").find(t=>t.source===n||t.target===n),TC=(t,e)=>e.data.low<=t.data.lim&&t.data.lim<=e.data.lim,OC=gC,NC=t=>{(t=>{const e={};let n;const r=i=>{var A;const o=t.getNode(i);if(!o)return 0;if(e[i])return o.data.rank;let s;return e[i]=!0,null===(A=t.getRelatedEdges(i,"out"))||void 0===A||A.forEach(t=>{const e=r(t.target)-t.data.minlen;e&&(void 0===s||e<s)&&(s=e)}),s||(s=0),(void 0===n||s<n)&&(n=s),o.data.rank=s,s};t.getAllNodes().filter(e=>0===t.getRelatedEdges(e.id,"in").length).forEach(t=>{t&&r(t.id)}),void 0===n&&(n=0);const i={},A=(e,n)=>{var r;const o=t.getNode(e),s=isNaN(o.data.layer)?n:o.data.layer;(void 0===o.data.rank||o.data.rank<s)&&(o.data.rank=s),i[e]||(i[e]=!0,null===(r=t.getRelatedEdges(e,"out"))||void 0===r||r.forEach(t=>{A(t.target,s+t.data.minlen)}))};t.getAllNodes().forEach(t=>{const e=t.data;e&&(isNaN(e.layer)?e.rank-=n:A(t.id,e.layer))})})(t),(t=>{const e=new fE({tree:[]}),n=t.getAllNodes()[0],r=t.getAllNodes().length;let i,A;for(e.addNode(n);mC(e,t)<r;)i=yC(e,t),A=e.hasNode(i.source)?pC(t,i):-pC(t,i),wC(e,t,A)})(t)},IC=t=>{BC(t)},LC=(t,e)=>{const{ranker:n,rankdir:r="tb",nodeOrder:i,keepNodeOrder:A,align:o,nodesep:s=50,edgesep:a=20,ranksep:c=50}=e;tF(t),Ex(t);const{nestingRoot:l,nodeRankFactor:u}=(t=>{const e=xx(t,"root",{},"_root"),n=_x(t);let r=Math.max(...Object.values(n));Math.abs(r)===1/0&&(r=1);const i=r-1,A=2*i+1;t.getAllEdges().forEach(t=>{t.data.minlen*=A});const o=Gx(t)+1;return t.getRoots().forEach(r=>{Hx(t,e,A,o,i,n,r.id)}),{nestingRoot:e,nodeRankFactor:A}})(t);((t,e)=>{switch(e){case"network-simplex":IC(t);break;case"tight-tree":default:NC(t);break;case"longest-path":OC(t)}})(Cx(t),n),zC(t),((t,e=0)=>{const n=t.getAllNodes(),r=n.filter(t=>void 0!==t.data.rank).map(t=>t.data.rank),i=Math.min(...r),A=[];n.forEach(t=>{const e=(t.data.rank||0)-i;A[e]||(A[e]=[]),A[e].push(t.id)});let o=0;for(let n=0;n<A.length;n++){const r=A[n];void 0===r?n%e!==0&&(o-=1):o&&(null==r||r.forEach(e=>{const n=t.getNode(e);n&&(n.data.rank=n.data.rank||0,n.data.rank+=o)}))}})(t,u),((t,e)=>{e&&t.removeNode(e),t.getAllEdges().forEach(e=>{e.data.nestingEdge&&t.removeEdge(e.id)})})(t,l),(t=>{const e=t.getAllNodes().filter(t=>void 0!==t.data.rank).map(t=>t.data.rank),n=Math.min(...e);t.getAllNodes().forEach(t=>{t.data.hasOwnProperty("rank")&&n!==1/0&&(t.data.rank-=n)})})(t),WC(t),YC(t);const h=[];((t,e)=>{t.getAllEdges().forEach(n=>jx(t,n,e))})(t,h),AC(t,h),(t=>{const e=n=>{const r=t.getChildren(n),i=t.getNode(n);if((null==r?void 0:r.length)&&r.forEach(t=>e(t.id)),i.data.hasOwnProperty("minRank")){i.data.borderLeft=[],i.data.borderRight=[];for(let e=i.data.minRank,r=i.data.maxRank+1;e<r;e+=1)Ox(t,"borderLeft","_bl",n,i,e),Ox(t,"borderRight","_br",n,i,e)}};t.getRoots().forEach(t=>e(t.id))})(t),A&&((t,e)=>{const n=t.getAllNodes().filter(e=>{var n;return!(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length)}),r=n.map(t=>t.data.rank),i=Math.max(...r),A=[];for(let t=0;t<i+1;t++)A[t]=[];null==e||e.forEach(e=>{const n=t.getNode(e);n&&!n.data.dummy&&(isNaN(n.data.rank)||(n.data.fixorder=A[n.data.rank].length,A[n.data.rank].push(e)))})})(t,i),((t,e)=>{const n=Qx(t),r=[],i=[];for(let t=1;t<n+1;t++)r.push(t);for(let t=n-1;t>-1;t--)i.push(t);const A=nC(t,r,"in"),o=nC(t,i,"out");let s=Yx(t);iC(t,s);let a,c=Number.POSITIVE_INFINITY;for(let n=0,r=0;r<4;++n,++r){rC(n%2?A:o,n%4>=2,!1,e),s=Mx(t);const i=Wx(t,s);i<c&&(r=0,a=me(s),c=i)}s=Yx(t),iC(t,s);for(let n=0,r=0;r<4;++n,++r){rC(n%2?A:o,n%4>=2,!0,e),s=Mx(t);const i=Wx(t,s);i<c&&(r=0,a=me(s),c=i)}iC(t,a)})(t,A),eF(t),((t,e)=>{const n=e.toLowerCase();"lr"!==n&&"rl"!==n||Nx(t)})(t,r),fC(t,{align:o,nodesep:s,edgesep:a,ranksep:c}),nF(t),$C(t),((t,e)=>{e.forEach(e=>{let n=t.getNode(e);const{data:r}=n,i=r.originalEdge;let A;i&&t.addEdge(i);let o=e;for(;n.data.dummy;)A=t.getSuccessors(o)[0],t.removeNode(o),i.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===Kx&&(i.data.x=n.data.x,i.data.y=n.data.y,i.data.width=n.data.width,i.data.height=n.data.height),o=A.id,n=t.getNode(o)})})(t,h),ZC(t),((t,e)=>{const n=e.toLowerCase();"bt"!==n&&"rl"!==n||Lx(t),"lr"!==n&&"rl"!==n||(Px(t),Nx(t))})(t,r);const{width:d,height:f}=XC(t);return qC(t),JC(t),(t=>{t.getAllEdges().forEach(e=>{const n=e.data;if(n.reversed){t.removeEdge(e.id);const r=n.forwardName;delete n.reversed,delete n.forwardName,t.addEdge({id:e.id,source:e.target,target:e.source,data:Object.assign(Object.assign({},n),{forwardName:r})})}})})(t),{width:d,height:f}},DC=(t,e)=>{t.getAllNodes().forEach(n=>{const r=t.getNode(n.id);if(e.hasNode(n.id)){const t=e.getNode(n.id);r.data.fixorder=t.data._order,delete t.data._order}else delete r.data.fixorder})},PC=(t,e)=>{t.getAllNodes().forEach(n=>{var r;const i=t.getNode(n.id);if(i){const t=e.getNode(n.id);i.data.x=t.data.x,i.data.y=t.data.y,i.data._order=t.data.order,i.data._rank=t.data.rank,(null===(r=e.getChildren(n.id))||void 0===r?void 0:r.length)&&(i.data.width=t.data.width,i.data.height=t.data.height)}}),t.getAllEdges().forEach(n=>{const r=t.getEdge(n.id),i=e.getEdge(n.id);r.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty("x")&&(r.data.x=i.data.x,r.data.y=i.data.y)})},RC=["width","height","layer","fixorder"],HC={width:0,height:0},_C=["minlen","weight","width","height","labeloffset"],GC={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},KC=["labelpos"],jC=t=>{const e=new fE({tree:[]});return t.getAllNodes().forEach(n=>{const r=iF(t.getNode(n.id).data),i=Object.assign(Object.assign({},HC),r),A=rF(i,RC);e.hasNode(n.id)||e.addNode({id:n.id,data:Object.assign({},A)});const o=t.hasTreeStructure("combo")?t.getParent(n.id,"combo"):t.getParent(n.id);zt(o)||(e.hasNode(o.id)||e.addNode(Object.assign({},o)),e.setParent(n.id,o.id))}),t.getAllEdges().forEach(n=>{const r=iF(t.getEdge(n.id).data),i={};null==KC||KC.forEach(t=>{void 0!==r[t]&&(i[t]=r[t])}),e.addEdge({id:n.id,source:n.source,target:n.target,data:Object.assign({},GC,rF(r,_C),i)})}),e},VC=(t,e)=>{const{ranksep:n=0,rankdir:r}=e;return t.getAllNodes().forEach(t=>{isNaN(t.data.layer)||t.data.layer||(t.data.layer=0)}),t.getAllEdges().forEach(t=>{var e;t.data.minlen*=2,"c"!==(null===(e=t.data.labelpos)||void 0===e?void 0:e.toLowerCase())&&("TB"===r||"BT"===r?t.data.width+=t.data.labeloffset:t.data.height+=t.data.labeloffset)}),n/2},zC=t=>{t.getAllEdges().forEach(e=>{if(e.data.width&&e.data.height){const n=t.getNode(e.source),r={e:e,rank:(t.getNode(e.target).data.rank-n.data.rank)/2+n.data.rank};xx(t,"edge-proxy",r,"_ep")}})},WC=t=>{let e=0;return t.getAllNodes().forEach(n=>{var r,i;n.data.borderTop&&(n.data.minRank=null===(r=t.getNode(n.data.borderTop))||void 0===r?void 0:r.data.rank,n.data.maxRank=null===(i=t.getNode(n.data.borderBottom))||void 0===i?void 0:i.data.rank,e=Math.max(e,n.data.maxRank||-1/0))}),e},YC=t=>{t.getAllNodes().forEach(e=>{"edge-proxy"===e.data.dummy&&(t.getEdge(e.data.e.id).data.labelRank=e.data.rank,t.removeNode(e.id))})},XC=(t,e)=>{let n,r,i=0,A=0;const{marginx:o=0,marginy:s=0}={},a=t=>{if(!t.data)return;const e=t.data.x,o=t.data.y,s=t.data.width,a=t.data.height;isNaN(e)||isNaN(s)||(void 0===n&&(n=e-s/2),n=Math.min(n,e-s/2),i=Math.max(i,e+s/2)),isNaN(o)||isNaN(a)||(void 0===r&&(r=o-a/2),r=Math.min(r,o-a/2),A=Math.max(A,o+a/2))};return t.getAllNodes().forEach(t=>{a(t)}),t.getAllEdges().forEach(t=>{(null==t?void 0:t.data.hasOwnProperty("x"))&&a(t)}),n-=o,r-=s,t.getAllNodes().forEach(t=>{t.data.x-=n,t.data.y-=r}),t.getAllEdges().forEach(t=>{var e;null===(e=t.data.points)||void 0===e||e.forEach(t=>{t.x-=n,t.y-=r}),t.data.hasOwnProperty("x")&&(t.data.x-=n),t.data.hasOwnProperty("y")&&(t.data.y-=r)}),{width:i-n+o,height:A-r+s}},qC=t=>{t.getAllEdges().forEach(e=>{const n=t.getNode(e.source),r=t.getNode(e.target);let i,A;e.data.points?(i=e.data.points[0],A=e.data.points[e.data.points.length-1]):(e.data.points=[],i={x:r.data.x,y:r.data.y},A={x:n.data.x,y:n.data.y}),e.data.points.unshift(Fx(n.data,i)),e.data.points.push(Fx(r.data,A))})},ZC=t=>{t.getAllEdges().forEach(t=>{if(t.data.hasOwnProperty("x"))switch("l"!==t.data.labelpos&&"r"!==t.data.labelpos||(t.data.width-=t.data.labeloffset),t.data.labelpos){case"l":t.data.x-=t.data.width/2+t.data.labeloffset;break;case"r":t.data.x+=t.data.width/2+t.data.labeloffset}})},JC=t=>{t.getAllEdges().forEach(t=>{var e;t.data.reversed&&(null===(e=t.data.points)||void 0===e||e.reverse())})},$C=t=>{t.getAllNodes().forEach(e=>{var n,r,i;if(null===(n=t.getChildren(e.id))||void 0===n?void 0:n.length){const n=t.getNode(e.id),A=t.getNode(n.data.borderTop),o=t.getNode(n.data.borderBottom),s=t.getNode(n.data.borderLeft[(null===(r=n.data.borderLeft)||void 0===r?void 0:r.length)-1]),a=t.getNode(n.data.borderRight[(null===(i=n.data.borderRight)||void 0===i?void 0:i.length)-1]);n.data.width=Math.abs((null==a?void 0:a.data.x)-(null==s?void 0:s.data.x))||10,n.data.height=Math.abs((null==o?void 0:o.data.y)-(null==A?void 0:A.data.y))||10,n.data.x=((null==s?void 0:s.data.x)||0)+n.data.width/2,n.data.y=((null==A?void 0:A.data.y)||0)+n.data.height/2}}),t.getAllNodes().forEach(e=>{"border"===e.data.dummy&&t.removeNode(e.id)})},tF=t=>{t.getAllEdges().forEach(e=>{if(e.source===e.target){const n=t.getNode(e.source);n.data.selfEdges||(n.data.selfEdges=[]),n.data.selfEdges.push(e),t.removeEdge(e.id)}})},eF=t=>{const e=Mx(t);null==e||e.forEach(e=>{let n=0;null==e||e.forEach((e,r)=>{var i;const A=t.getNode(e);A.data.order=r+n,null===(i=A.data.selfEdges)||void 0===i||i.forEach(e=>{xx(t,"selfedge",{width:e.data.width,height:e.data.height,rank:A.data.rank,order:r+ ++n,e:e},"_se")}),delete A.data.selfEdges})})},nF=t=>{t.getAllNodes().forEach(e=>{const n=t.getNode(e.id);if("selfedge"===n.data.dummy){const r=t.getNode(n.data.e.source),i=r.data.x+r.data.width/2,A=r.data.y,o=n.data.x-i,s=r.data.height/2;t.hasEdge(n.data.e.id)?t.updateEdgeData(n.data.e.id,n.data.e.data):t.addEdge({id:n.data.e.id,source:n.data.e.source,target:n.data.e.target,data:n.data.e.data}),t.removeNode(e.id),n.data.e.data.points=[{x:i+2*o/3,y:A-s},{x:i+5*o/6,y:A-s},{y:A,x:i+o},{x:i+5*o/6,y:A+s},{x:i+2*o/3,y:A+s}],n.data.e.data.x=n.data.x,n.data.e.data.y=n.data.y}})},rF=(t,e)=>{const n={};return null==e||e.forEach(e=>{void 0!==t[e]&&(n[e]=+t[e])}),n},iF=(t={})=>{const e={};return Object.keys(t).forEach(n=>{e[n.toLowerCase()]=t[n]}),e},AF=Array.isArray,oF=t=>{const e=[],n=t.length;for(let r=0;r<n;r+=1){e[r]=[];for(let i=0;i<n;i+=1)r===i?e[r][i]=0:0!==t[r][i]&&t[r][i]?e[r][i]=t[r][i]:e[r][i]=1/0}for(let t=0;t<n;t+=1)for(let r=0;r<n;r+=1)for(let i=0;i<n;i+=1)e[r][i]>e[r][t]+e[t][i]&&(e[r][i]=e[r][t]+e[t][i]);return e},sF=(t,e)=>{const{nodes:n,edges:r}=t,i=[],A={};if(!n)throw new Error("invalid nodes data!");return n&&n.forEach((t,e)=>{A[t.id]=e;i.push([])}),null==r||r.forEach(t=>{const{source:e,target:n}=t,r=A[e],o=A[n];void 0!==r&&void 0!==o&&(i[r][o]=1,i[o][r]=1)}),i},aF=(t,e)=>Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),cF=(t,e,n,r="TB",i,A={})=>{if(!(null==e?void 0:e.length))return;const{stopBranchFn:o,stopAllFn:s}=A;for(let a=0;a<e.length;a++){const c=e[a];if(t.hasNode(c.id)&&!(null==o?void 0:o(c))){if(null==s?void 0:s(c))return;"TB"===r&&n(c),cF(t,t.getChildren(c.id,i),n,r,i,A),"TB"!==r&&n(c)}}},lF=t=>{if(null===t)return t;if(t instanceof Date)return new Date(t.getTime());if(t instanceof Array){const e=[];return t.forEach(t=>{e.push(t)}),e.map(t=>lF(t))}if("object"==typeof t){const e={};return Object.keys(t).forEach(n=>{e[n]=lF(t[n])}),e}return t},uF=(t,e)=>{const n=lF(t);return n.data=n.data||{},e&&(oe(n.data.x)||(n.data.x=Math.random()*e[0]),oe(n.data.y)||(n.data.y=Math.random()*e[1])),n};function hF(t){if(!t)return[0,0,0];if(oe(t))return[t,t,t];if(0===t.length)return[0,0,0];const[e,n=e,r=e]=t;return[e,n,r]}function dF(t,e){let n;return n=Vt(e)?e:oe(e)?()=>e:()=>t,n}function fF(t,e,n=!0){return e||0===e?Vt(e)?e:oe(e)?()=>e:Array.isArray(e)?()=>n?Math.max(...e)||t:e:Yt(e)&&e.width&&e.height?()=>n?Math.max(e.width,e.height)||t:[e.width,e.height]:()=>t:e=>{const{size:r}=e.data||{};return r?Array.isArray(r)?n?Math.max(...r)||t:r:Yt(r)&&r.width&&r.height?n?Math.max(r.width,r.height)||t:[r.width,r.height]:r:t}}const gF=(t,e,n=10)=>{let r;const i="function"==typeof e?e:()=>e||0;r=t?Array.isArray(t)?e=>t:Vt(t)?t:e=>t:t=>{var e,r,i;if(null===(e=t.data)||void 0===e?void 0:e.bboxSize)return null===(r=t.data)||void 0===r?void 0:r.bboxSize;if(null===(i=t.data)||void 0===i?void 0:i.size){const e=t.data.size;return Array.isArray(e)?e:Yt(e)?[e.width,e.height]:e}return n};return t=>{const e=r(t),n=i(t);return Math.max(...hF(e))+n}},pF={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null};class vF{constructor(t={}){this.options=t,this.id="antv-dagre",this.options=Object.assign(Object.assign({},pF),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,e)})}genericDagreLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),{nodeSize:i,align:A,rankdir:o="TB",ranksep:s,nodesep:a,ranksepFunc:c,nodesepFunc:l,edgeLabelSpace:u,ranker:h,nodeOrder:d,begin:f,controlPoints:g,radial:p,sortByCombo:v,preset:m}=r,y=new fE({tree:[]}),w=dF(s||50,c),B=dF(a||50,l);let b=B,E=w;"LR"!==o&&"RL"!==o||(b=w,E=B);const x=fF(10,i,!1),C=e.getAllNodes(),F=e.getAllEdges();let M;C.forEach(t=>{const e=hF(x(t)),n=E(t),r=b(t),i=e[0]+2*r,A=e[1]+2*n,o=t.data.layer;oe(o)?y.addNode({id:t.id,data:{width:i,height:A,layer:o}}):y.addNode({id:t.id,data:{width:i,height:A}})}),v&&(y.attachTreeStructure("combo"),C.forEach(t=>{const{parentId:e}=t.data;void 0!==e&&y.hasNode(e)&&y.setParent(t.id,e,"combo")})),F.forEach(t=>{y.addEdge({id:t.id,source:t.source,target:t.target,data:{weight:t.data.weight||1}})}),(null==m?void 0:m.length)&&(M=new fE({nodes:m})),((t,e)=>{const{edgeLabelSpace:n,keepNodeOrder:r,prevGraph:i,rankdir:A,ranksep:o}=e;!r&&i&&DC(t,i);const s=jC(t);let a;n&&(e.ranksep=VC(s,{rankdir:A,ranksep:o}));try{a=LC(s,e)}catch(t){if("Not possible to find intersection inside of the rectangle"===t.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",t);throw t}PC(t,s)})(y,{prevGraph:M,edgeLabelSpace:u,keepNodeOrder:!!d,nodeOrder:d||[],acyclicer:"greedy",ranker:h,rankdir:o,nodesep:a,align:A});const k=[0,0];if(f){let t=1/0,e=1/0;y.getAllNodes().forEach(n=>{t>n.data.x&&(t=n.data.x),e>n.data.y&&(e=n.data.y)}),y.getAllEdges().forEach(n=>{var r;null===(r=n.data.points)||void 0===r||r.forEach(n=>{t>n.x&&(t=n.x),e>n.y&&(e=n.y)})}),k[0]=f[0]-t,k[1]=f[1]-e}const Q="LR"===o||"RL"===o;if(p);else{const t=new Set,e="BT"===o||"RL"===o?(t,e)=>e-t:(t,e)=>t-e;y.getAllNodes().forEach(e=>{e.data.x=e.data.x+k[0],e.data.y=e.data.y+k[1],t.add(Q?e.data.x:e.data.y)});const n=Array.from(t).sort(e),r=Q?(t,e)=>t.x!==e.x:(t,e)=>t.y!==e.y,i=Q?(t,e,n)=>{const r=Math.max(e.y,n.y),i=Math.min(e.y,n.y);return t.filter(t=>t.y<=r&&t.y>=i)}:(t,e,n)=>{const r=Math.max(e.x,n.x),i=Math.min(e.x,n.x);return t.filter(t=>t.x<=r&&t.x>=i)};y.getAllEdges().forEach((t,e)=>{var A;u&&g&&"loop"!==t.data.type&&(t.data.controlPoints=mF(null===(A=t.data.points)||void 0===A?void 0:A.map(({x:t,y:e})=>({x:t+k[0],y:e+k[1]})),y.getNode(t.source),y.getNode(t.target),n,Q,r,i))})}let S=[];S=y.getAllNodes().map(t=>uF(t));const U=y.getAllEdges();t&&(S.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}),U.forEach(t=>{e.mergeEdgeData(t.id,{controlPoints:t.data.controlPoints})}));return{nodes:S,edges:U}})}}const mF=(t,e,n,r,i,A,o)=>{let s=(null==t?void 0:t.slice(1,t.length-1))||[];if(e&&n){let{x:t,y:a}=e.data,{x:c,y:l}=n.data;if(i&&(t=e.data.y,a=e.data.x,c=n.data.y,l=n.data.x),l!==a&&t!==c){const u=r.indexOf(a),h=r[u+1];if(h){const t=s[0],e=i?{x:(a+h)/2,y:(null==t?void 0:t.y)||c}:{x:(null==t?void 0:t.x)||c,y:(a+h)/2};t&&!A(t,e)||s.unshift(e)}const d=r.indexOf(l),f=Math.abs(d-u);if(1===f)s=o(s,e.data,n.data),s.length||s.push(i?{x:(a+l)/2,y:t}:{x:t,y:(a+l)/2});else if(f>1){const e=r[d-1];if(e){const n=s[s.length-1],r=i?{x:(l+e)/2,y:(null==n?void 0:n.y)||c}:{x:(null==n?void 0:n.x)||t,y:(l+e)/2};n&&!A(n,r)||s.push(r)}}}}return s},yF=(t,e,n)=>{const r=t.getAllNodes(),i=t.getAllEdges();if(!(null==r?void 0:r.length)){return{nodes:[],edges:i}}if(1===r.length){e&&t.mergeNodeData(r[0].id,{x:n[0],y:n[1]});return{nodes:[Object.assign(Object.assign({},r[0]),{data:Object.assign(Object.assign({},r[0].data),{x:n[0],y:n[1]})})],edges:i}}},wF={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1};class BF{constructor(t={}){this.options=t,this.id="circular",this.options=Object.assign(Object.assign({},wF),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,t,e)})}genericCircularLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),{width:i,height:A,center:o,divisions:s,startAngle:a=0,endAngle:c=2*Math.PI,angleRatio:l,ordering:u,clockwise:h,nodeSpacing:d,nodeSize:f}=r,g=e.getAllNodes(),p=e.getAllEdges(),[v,m,y]=EF(i,A,o),w=null==g?void 0:g.length;if(!w||1===w)return yF(e,t,y);const B=(c-a)/w;let{radius:b,startRadius:E,endRadius:x}=r;if(d){const t=dF(10,d),e=fF(10,f);let n=-1/0;g.forEach(t=>{const r=e(t);n<r&&(n=r)});let r=0;g.forEach((e,i)=>{r+=0===i?n||10:(t(e)||0)+(n||10)}),b=r/(2*Math.PI)}else b||E||x?!E&&x?E=x:E&&!x&&(x=E):b=Math.min(m,v)/2;const C=B*l;let F=[];F="topology"===u?bF(e,g):"topology-directed"===u?bF(e,g,!0):"degree"===u?function(t,e){const n=[];return e.forEach((t,e)=>{n.push(uF(t))}),n.sort((e,n)=>t.getDegree(e.id,"both")-t.getDegree(n.id,"both")),n}(e,g):g.map(t=>uF(t));const M=Math.ceil(w/s);for(let t=0;t<w;++t){let e=b;e||null===E||null===x||(e=E+t*(x-E)/(w-1)),e||(e=10+100*t/(w-1));let n=a+t%M*C+2*Math.PI/s*Math.floor(t/M);h||(n=c-t%M*C-2*Math.PI/s*Math.floor(t/M)),F[t].data.x=y[0]+Math.cos(n)*e,F[t].data.y=y[1]+Math.sin(n)*e}t&&F.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})});return{nodes:F,edges:p}})}}const bF=(t,e,n=!1)=>{const r=[uF(e[0])],i={},A=e.length;i[e[0].id]=!0;let o=0;return e.forEach((s,a)=>{if(0!==a)if(a!==A-1&&t.getDegree(s.id,"both")===t.getDegree(e[a+1].id,"both")&&!t.areNeighbors(r[o].id,s.id)||i[s.id]){const a=n?t.getSuccessors(r[o].id):t.getNeighbors(r[o].id);let c=!1;for(let e=0;e<a.length;e++){const n=a[e];if(t.getDegree(n.id)===t.getDegree(s.id)&&!i[n.id]){r.push(uF(n)),i[n.id]=!0,c=!0;break}}let l=0;for(;!c&&(i[e[l].id]||(r.push(uF(e[l])),i[e[l].id]=!0,c=!0),l++,l!==A););}else r.push(uF(s)),i[s.id]=!0,o++}),r};const EF=(t,e,n)=>{let r=t,i=e,A=n;return r||"undefined"==typeof window||(r=window.innerWidth),i||"undefined"==typeof window||(i=window.innerHeight),A||(A=[r/2,i/2]),[r,i,A]},xF={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"};class CF{constructor(t={}){this.options=t,this.id="concentric",this.options=Object.assign(Object.assign({},xF),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,t,e)})}genericConcentricLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),{center:i,width:A,height:o,sortBy:s,maxLevelDiff:a,sweep:c,clockwise:l,equidistant:u,preventOverlap:h,startAngle:d=1.5*Math.PI,nodeSize:f,nodeSpacing:g}=r,p=e.getAllNodes(),v=e.getAllEdges(),m=A||"undefined"==typeof window?A:window.innerWidth,y=o||"undefined"==typeof window?o:window.innerHeight,w=i||[m/2,y/2];if(!(null==p?void 0:p.length)||1===p.length)return yF(e,t,w);const B=[];let b,E=0;AF(f)?b=Math.max(f[0],f[1]):Vt(f)?(b=-1/0,p.forEach(t=>{const e=Math.max(...hF(f(t)));e>b&&(b=e)})):b=f,AF(g)?E=Math.max(g[0],g[1]):oe(g)&&(E=g),p.forEach(t=>{const e=uF(t);B.push(e);let n=b;const{data:r}=e;AF(r.size)?n=Math.max(r.size[0],r.size[1]):oe(r.size)?n=r.size:Yt(r.size)&&(n=Math.max(r.size.width,r.size.height)),b=Math.max(b,n),Vt(g)&&(E=Math.max(g(t),E))});const x={};B.forEach((t,e)=>{x[t.id]=e});let C=s;ne(C)&&void 0!==B[0].data[C]||(C="degree"),"degree"===C?B.sort((t,n)=>e.getDegree(n.id,"both")-e.getDegree(t.id,"both")):B.sort((t,e)=>e.data[C]-t.data[C]);const F=B[0],M=(a||("degree"===C?e.getDegree(F.id,"both"):F.data[C]))/4,k=[{nodes:[]}];let Q=k[0];B.forEach(t=>{if(Q.nodes.length>0){const n="degree"===C?Math.abs(e.getDegree(Q.nodes[0].id,"both")-e.getDegree(t.id,"both")):Math.abs(Q.nodes[0].data[C]-t.data[C]);M&&n>=M&&(Q={nodes:[]},k.push(Q))}Q.nodes.push(t)});let S=b+E;if(!h){const t=k.length>0&&k[0].nodes.length>1,e=(Math.min(m,y)/2-S)/(k.length+(t?1:0));S=Math.min(S,e)}let U=0;if(k.forEach(t=>{const e=void 0===c?2*Math.PI-2*Math.PI/t.nodes.length:c;if(t.dTheta=e/Math.max(1,t.nodes.length-1),t.nodes.length>1&&h){const e=Math.cos(t.dTheta)-Math.cos(0),n=Math.sin(t.dTheta)-Math.sin(0),r=Math.sqrt(S*S/(e*e+n*n));U=Math.max(r,U)}t.r=U,U+=S}),u){let t=0,e=0;for(let n=0;n<k.length;n++){const r=(k[n].r||0)-e;t=Math.max(t,r)}e=0,k.forEach((n,r)=>{0===r&&(e=n.r||0),n.r=e,e+=t})}k.forEach(t=>{const e=t.dTheta||0,n=t.r||0;t.nodes.forEach((t,r)=>{const i=d+(l?1:-1)*e*r;t.data.x=w[0]+n*Math.cos(i),t.data.y=w[1]+n*Math.sin(i)})}),t&&B.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}));return{nodes:B,edges:v}})}}function FF(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,A,o,s,a,c,l,u,h,d=t._root,f={data:r},g=t._x0,p=t._y0,v=t._x1,m=t._y1;if(!d)return t._root=f,t;for(;d.length;)if((c=e>=(A=(g+v)/2))?g=A:v=A,(l=n>=(o=(p+m)/2))?p=o:m=o,i=d,!(d=d[u=l<<1|c]))return i[u]=f,t;if(s=+t._x.call(null,d.data),a=+t._y.call(null,d.data),e===s&&n===a)return f.next=d,i?i[u]=f:t._root=f,t;do{i=i?i[u]=new Array(4):t._root=new Array(4),(c=e>=(A=(g+v)/2))?g=A:v=A,(l=n>=(o=(p+m)/2))?p=o:m=o}while((u=l<<1|c)==(h=(a>=o)<<1|s>=A));return i[h]=d,i[u]=f,t}function MF(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function kF(t){return t[0]}function QF(t){return t[1]}function SF(t,e,n){var r=new UF(null==e?kF:e,null==n?QF:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function UF(t,e,n,r,i,A){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=A,this._root=void 0}function TF(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var OF=SF.prototype=UF.prototype;function NF(t,e,n,r,i){if(isNaN(e)||isNaN(n)||isNaN(r))return t;var A,o,s,a,c,l,u,h,d,f,g,p,v=t._root,m={data:i},y=t._x0,w=t._y0,B=t._z0,b=t._x1,E=t._y1,x=t._z1;if(!v)return t._root=m,t;for(;v.length;)if((h=e>=(o=(y+b)/2))?y=o:b=o,(d=n>=(s=(w+E)/2))?w=s:E=s,(f=r>=(a=(B+x)/2))?B=a:x=a,A=v,!(v=v[g=f<<2|d<<1|h]))return A[g]=m,t;if(c=+t._x.call(null,v.data),l=+t._y.call(null,v.data),u=+t._z.call(null,v.data),e===c&&n===l&&r===u)return m.next=v,A?A[g]=m:t._root=m,t;do{A=A?A[g]=new Array(8):t._root=new Array(8),(h=e>=(o=(y+b)/2))?y=o:b=o,(d=n>=(s=(w+E)/2))?w=s:E=s,(f=r>=(a=(B+x)/2))?B=a:x=a}while((g=f<<2|d<<1|h)==(p=(u>=a)<<2|(l>=s)<<1|c>=o));return A[p]=v,A[g]=m,t}function IF(t,e,n,r,i,A,o){this.node=t,this.x0=e,this.y0=n,this.z0=r,this.x1=i,this.y1=A,this.z1=o}OF.copy=function(){var t,e,n=new UF(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=TF(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=TF(e));return n},OF.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return FF(this.cover(e,n),e,n,t)},OF.addAll=function(t){var e,n,r,i,A=t.length,o=new Array(A),s=new Array(A),a=1/0,c=1/0,l=-1/0,u=-1/0;for(n=0;n<A;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<a&&(a=r),r>l&&(l=r),i<c&&(c=i),i>u&&(u=i));if(a>l||c>u)return this;for(this.cover(a,c).cover(l,u),n=0;n<A;++n)FF(this,o[n],s[n],t[n]);return this},OF.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,A=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,A=(r=Math.floor(e))+1;else{for(var o,s,a=i-n||1,c=this._root;n>t||t>=i||r>e||e>=A;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=c,c=o,a*=2,s){case 0:i=n+a,A=r+a;break;case 1:n=i-a,A=r+a;break;case 2:i=n+a,r=A-a;break;case 3:n=i-a,r=A-a}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=A,this},OF.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},OF.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},OF.find=function(t,e,n){var r,i,A,o,s,a,c,l=this._x0,u=this._y0,h=this._x1,d=this._y1,f=[],g=this._root;for(g&&f.push(new MF(g,l,u,h,d)),null==n?n=1/0:(l=t-n,u=e-n,h=t+n,d=e+n,n*=n);a=f.pop();)if(!(!(g=a.node)||(i=a.x0)>h||(A=a.y0)>d||(o=a.x1)<l||(s=a.y1)<u))if(g.length){var p=(i+o)/2,v=(A+s)/2;f.push(new MF(g[3],p,v,o,s),new MF(g[2],i,v,p,s),new MF(g[1],p,A,o,v),new MF(g[0],i,A,p,v)),(c=(e>=v)<<1|t>=p)&&(a=f[f.length-1],f[f.length-1]=f[f.length-1-c],f[f.length-1-c]=a)}else{var m=t-+this._x.call(null,g.data),y=e-+this._y.call(null,g.data),w=m*m+y*y;if(w<n){var B=Math.sqrt(n=w);l=t-B,u=e-B,h=t+B,d=e+B,r=g.data}}return r},OF.remove=function(t){if(isNaN(A=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,A,o,s,a,c,l,u,h,d=this._root,f=this._x0,g=this._y0,p=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((c=A>=(s=(f+p)/2))?f=s:p=s,(l=o>=(a=(g+v)/2))?g=a:v=a,e=d,!(d=d[u=l<<1|c]))return this;if(!d.length)break;(e[u+1&3]||e[u+2&3]||e[u+3&3])&&(n=e,h=u)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[u]=i:delete e[u],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[h]=d:this._root=d),this):(this._root=i,this)},OF.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},OF.root=function(){return this._root},OF.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},OF.visit=function(t){var e,n,r,i,A,o,s=[],a=this._root;for(a&&s.push(new MF(a,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(a=e.node,r=e.x0,i=e.y0,A=e.x1,o=e.y1)&&a.length){var c=(r+A)/2,l=(i+o)/2;(n=a[3])&&s.push(new MF(n,c,l,A,o)),(n=a[2])&&s.push(new MF(n,r,l,c,o)),(n=a[1])&&s.push(new MF(n,c,i,A,l)),(n=a[0])&&s.push(new MF(n,r,i,c,l))}return this},OF.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new MF(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var A,o=e.x0,s=e.y0,a=e.x1,c=e.y1,l=(o+a)/2,u=(s+c)/2;(A=i[0])&&n.push(new MF(A,o,s,l,u)),(A=i[1])&&n.push(new MF(A,l,s,a,u)),(A=i[2])&&n.push(new MF(A,o,u,l,c)),(A=i[3])&&n.push(new MF(A,l,u,a,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},OF.x=function(t){return arguments.length?(this._x=t,this):this._x},OF.y=function(t){return arguments.length?(this._y=t,this):this._y};const LF=(t,e,n,r,i,A)=>Math.sqrt((t-r)**2+(e-i)**2+(n-A)**2);function DF(t){return t[0]}function PF(t){return t[1]}function RF(t){return t[2]}function HF(t,e,n,r){var i=new _F(null==e?DF:e,null==n?PF:n,null==r?RF:r,NaN,NaN,NaN,NaN,NaN,NaN);return null==t?i:i.addAll(t)}function _F(t,e,n,r,i,A,o,s,a){this._x=t,this._y=e,this._z=n,this._x0=r,this._y0=i,this._z0=A,this._x1=o,this._y1=s,this._z1=a,this._root=void 0}function GF(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var KF=HF.prototype=_F.prototype;KF.copy=function(){var t,e,n=new _F(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),r=this._root;if(!r)return n;if(!r.length)return n._root=GF(r),n;for(t=[{source:r,target:n._root=new Array(8)}];r=t.pop();)for(var i=0;i<8;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(8)}):r.target[i]=GF(e));return n},KF.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t),r=+this._z.call(null,t);return NF(this.cover(e,n,r),e,n,r,t)},KF.addAll=function(t){Array.isArray(t)||(t=Array.from(t));const e=t.length,n=new Float64Array(e),r=new Float64Array(e),i=new Float64Array(e);let A=1/0,o=1/0,s=1/0,a=-1/0,c=-1/0,l=-1/0;for(let u,h,d,f,g=0;g<e;++g)isNaN(h=+this._x.call(null,u=t[g]))||isNaN(d=+this._y.call(null,u))||isNaN(f=+this._z.call(null,u))||(n[g]=h,r[g]=d,i[g]=f,h<A&&(A=h),h>a&&(a=h),d<o&&(o=d),d>c&&(c=d),f<s&&(s=f),f>l&&(l=f));if(A>a||o>c||s>l)return this;this.cover(A,o,s).cover(a,c,l);for(let A=0;A<e;++A)NF(this,n[A],r[A],i[A],t[A]);return this},KF.cover=function(t,e,n){if(isNaN(t=+t)||isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,A=this._z0,o=this._x1,s=this._y1,a=this._z1;if(isNaN(r))o=(r=Math.floor(t))+1,s=(i=Math.floor(e))+1,a=(A=Math.floor(n))+1;else{for(var c,l,u=o-r||1,h=this._root;r>t||t>=o||i>e||e>=s||A>n||n>=a;)switch(l=(n<A)<<2|(e<i)<<1|t<r,(c=new Array(8))[l]=h,h=c,u*=2,l){case 0:o=r+u,s=i+u,a=A+u;break;case 1:r=o-u,s=i+u,a=A+u;break;case 2:o=r+u,i=s-u,a=A+u;break;case 3:r=o-u,i=s-u,a=A+u;break;case 4:o=r+u,s=i+u,A=a-u;break;case 5:r=o-u,s=i+u,A=a-u;break;case 6:o=r+u,i=s-u,A=a-u;break;case 7:r=o-u,i=s-u,A=a-u}this._root&&this._root.length&&(this._root=h)}return this._x0=r,this._y0=i,this._z0=A,this._x1=o,this._y1=s,this._z1=a,this},KF.data=function(){var t=[];return this.visit(function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)}),t},KF.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1],+t[0][2]).cover(+t[1][0],+t[1][1],+t[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},KF.find=function(t,e,n,r){var i,A,o,s,a,c,l,u,h,d=this._x0,f=this._y0,g=this._z0,p=this._x1,v=this._y1,m=this._z1,y=[],w=this._root;for(w&&y.push(new IF(w,d,f,g,p,v,m)),null==r?r=1/0:(d=t-r,f=e-r,g=n-r,p=t+r,v=e+r,m=n+r,r*=r);u=y.pop();)if(!(!(w=u.node)||(A=u.x0)>p||(o=u.y0)>v||(s=u.z0)>m||(a=u.x1)<d||(c=u.y1)<f||(l=u.z1)<g))if(w.length){var B=(A+a)/2,b=(o+c)/2,E=(s+l)/2;y.push(new IF(w[7],B,b,E,a,c,l),new IF(w[6],A,b,E,B,c,l),new IF(w[5],B,o,E,a,b,l),new IF(w[4],A,o,E,B,b,l),new IF(w[3],B,b,s,a,c,E),new IF(w[2],A,b,s,B,c,E),new IF(w[1],B,o,s,a,b,E),new IF(w[0],A,o,s,B,b,E)),(h=(n>=E)<<2|(e>=b)<<1|t>=B)&&(u=y[y.length-1],y[y.length-1]=y[y.length-1-h],y[y.length-1-h]=u)}else{var x=t-+this._x.call(null,w.data),C=e-+this._y.call(null,w.data),F=n-+this._z.call(null,w.data),M=x*x+C*C+F*F;if(M<r){var k=Math.sqrt(r=M);d=t-k,f=e-k,g=n-k,p=t+k,v=e+k,m=n+k,i=w.data}}return i},KF.findAllWithinRadius=function(t,e,n,r){const i=[],A=t-r,o=e-r,s=n-r,a=t+r,c=e+r,l=n+r;return this.visit((u,h,d,f,g,p,v)=>{if(!u.length)do{const A=u.data;LF(t,e,n,this._x(A),this._y(A),this._z(A))<=r&&i.push(A)}while(u=u.next);return h>a||d>c||f>l||g<A||p<o||v<s}),i},KF.remove=function(t){if(isNaN(A=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t))||isNaN(s=+this._z.call(null,t)))return this;var e,n,r,i,A,o,s,a,c,l,u,h,d,f,g,p=this._root,v=this._x0,m=this._y0,y=this._z0,w=this._x1,B=this._y1,b=this._z1;if(!p)return this;if(p.length)for(;;){if((u=A>=(a=(v+w)/2))?v=a:w=a,(h=o>=(c=(m+B)/2))?m=c:B=c,(d=s>=(l=(y+b)/2))?y=l:b=l,e=p,!(p=p[f=d<<2|h<<1|u]))return this;if(!p.length)break;(e[f+1&7]||e[f+2&7]||e[f+3&7]||e[f+4&7]||e[f+5&7]||e[f+6&7]||e[f+7&7])&&(n=e,g=f)}for(;p.data!==t;)if(r=p,!(p=p.next))return this;return(i=p.next)&&delete p.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(p=e[0]||e[1]||e[2]||e[3]||e[4]||e[5]||e[6]||e[7])&&p===(e[7]||e[6]||e[5]||e[4]||e[3]||e[2]||e[1]||e[0])&&!p.length&&(n?n[g]=p:this._root=p),this):(this._root=i,this)},KF.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},KF.root=function(){return this._root},KF.size=function(){var t=0;return this.visit(function(e){if(!e.length)do{++t}while(e=e.next)}),t},KF.visit=function(t){var e,n,r,i,A,o,s,a,c=[],l=this._root;for(l&&c.push(new IF(l,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=c.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,A=e.z0,o=e.x1,s=e.y1,a=e.z1)&&l.length){var u=(r+o)/2,h=(i+s)/2,d=(A+a)/2;(n=l[7])&&c.push(new IF(n,u,h,d,o,s,a)),(n=l[6])&&c.push(new IF(n,r,h,d,u,s,a)),(n=l[5])&&c.push(new IF(n,u,i,d,o,h,a)),(n=l[4])&&c.push(new IF(n,r,i,d,u,h,a)),(n=l[3])&&c.push(new IF(n,u,h,A,o,s,d)),(n=l[2])&&c.push(new IF(n,r,h,A,u,s,d)),(n=l[1])&&c.push(new IF(n,u,i,A,o,h,d)),(n=l[0])&&c.push(new IF(n,r,i,A,u,h,d))}return this},KF.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new IF(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));e=n.pop();){var i=e.node;if(i.length){var A,o=e.x0,s=e.y0,a=e.z0,c=e.x1,l=e.y1,u=e.z1,h=(o+c)/2,d=(s+l)/2,f=(a+u)/2;(A=i[0])&&n.push(new IF(A,o,s,a,h,d,f)),(A=i[1])&&n.push(new IF(A,h,s,a,c,d,f)),(A=i[2])&&n.push(new IF(A,o,d,a,h,l,f)),(A=i[3])&&n.push(new IF(A,h,d,a,c,l,f)),(A=i[4])&&n.push(new IF(A,o,s,f,h,d,u)),(A=i[5])&&n.push(new IF(A,h,s,f,c,d,u)),(A=i[6])&&n.push(new IF(A,o,d,f,h,l,u)),(A=i[7])&&n.push(new IF(A,h,d,f,c,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.z0,e.x1,e.y1,e.z1);return this},KF.x=function(t){return arguments.length?(this._x=t,this):this._x},KF.y=function(t){return arguments.length?(this._y=t,this):this._y},KF.z=function(t){return arguments.length?(this._z=t,this):this._z};function jF(t,e,n,r,i=2){const A=e/n,o=t.getAllNodes(),s=o.map((t,e)=>{const{nodeStrength:n,x:r,y:i,z:o,size:s}=t.data;return{x:r,y:i,z:o,size:s,index:e,id:t.id,vx:0,vy:0,vz:0,weight:A*n}}),a=(2===i?SF(s,t=>t.x,t=>t.y):HF(s,t=>t.x,t=>t.y,t=>t.z)).visitAfter(VF),c=new Map;return s.forEach(t=>{c.set(t.id,t),function(t,e,n){e.visit((e,r,i,A,o)=>zF(e,r,i,A,o,t,n))}(t,a,i)}),s.map((t,e)=>{const{id:n,data:i}=o[e],{mass:A=1}=i;r[n]={x:t.vx/A,y:t.vy/A,z:t.vz/A}}),r}function VF(t){let e=0,n=0,r=0,i=0,A=0;const o=t.length;if(o){for(let s=0;s<o;s++){const o=t[s];o&&o.weight&&(e+=o.weight,n+=o.x*o.weight,r+=o.y*o.weight,i+=o.z*o.weight,A+=o.size*o.weight)}t.x=n/e,t.y=r/e,t.z=i/e,t.size=A/e,t.weight=e}else{const e=t;t.x=e.data.x,t.y=e.data.y,t.z=e.data.z,t.size=e.data.size,t.weight=e.data.weight}}const zF=(t,e,n,r,i,A,o)=>{var s;if((null===(s=t.data)||void 0===s?void 0:s.id)===A.id)return;const a=[n,r,i][o-1],c=A.x-t.x||.1,l=A.y-t.y||.1,u=A.z-t.z||.1,h=[c,l,u],d=a-e;let f=0;for(let t=0;t<o;t++)f+=h[t]*h[t];const g=Math.sqrt(f)*f;if(d*d*.81<f){const e=t.weight/g;return A.vx+=c*e,A.vy+=l*e,A.vz+=u*e,!0}if(t.length)return!1;if(t.data!==A){const e=t.data.weight/g;A.vx+=c*e,A.vy+=l*e,A.vz+=u*e}};const WF={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"};class YF{constructor(t={}){this.options=t,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},WF),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericForceLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,t,e)})}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;(this.judgingDistance>this.lastOptions.minMovement||e<1)&&e<t;e++)this.runOneStep(this.lastCalcGraph,this.lastGraph,e,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0})),e}genericForceLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),i=e.getAllNodes(),A=e.getAllEdges(),o=this.formatOptions(r,e),{dimensions:s,width:a,height:c,nodeSize:l,getMass:u,nodeStrength:h,edgeStrength:d,linkDistance:f}=o,g=i.map((t,e)=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{x:oe(t.data.x)?t.data.x:Math.random()*a,y:oe(t.data.y)?t.data.y:Math.random()*c,z:oe(t.data.z)?t.data.z:Math.random()*Math.sqrt(a*c),size:l(t)||30,mass:u(t),nodeStrength:h(t)})})),p=A.map(t=>Object.assign(Object.assign({},t),{data:Object.assign(Object.assign({},t.data),{edgeStrength:d(t),linkDistance:f(t,e.getNode(t.source),e.getNode(t.target))})}));if(!(null==i?void 0:i.length))return this.lastResult={nodes:[],edges:A},{nodes:[],edges:A};const v={};i.forEach((t,e)=>{v[t.id]={x:0,y:0,z:0}});const m=new fE({nodes:g,edges:p});this.formatCentripetal(o,m);const{maxIteration:y,minMovement:w,onTick:B}=o;if(this.lastLayoutNodes=g,this.lastLayoutEdges=p,this.lastAssign=t,this.lastGraph=e,this.lastCalcGraph=m,this.lastOptions=o,this.lastVelMap=v,"undefined"==typeof window)return;let b=0;return new Promise(n=>{this.timeInterval=window.setInterval(()=>{i&&this.running||n({nodes:$F(e,g),edges:A}),this.runOneStep(m,e,b,v,o),this.updatePosition(e,m,v,o),t&&g.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===s?t.data.z:void 0})),null==B||B({nodes:$F(e,g),edges:A}),b++,(b>=y||this.judgingDistance<w)&&(window.clearInterval(this.timeInterval),n({nodes:$F(e,g),edges:A}))},0),this.running=!0})})}formatOptions(t,e){const n=Object.assign({},t),{width:r,height:i,getMass:A}=t;n.width=r||"undefined"==typeof window?r:window.innerWidth,n.height=i||"undefined"==typeof window?i:window.innerHeight,t.center||(n.center=[n.width/2,n.height/2]),A||(n.getMass=t=>{let n=1;oe(null==t?void 0:t.data.mass)&&(n=null==t?void 0:t.data.mass);const r=e.getDegree(t.id,"both");return!r||r<5?n:5*r*n}),n.nodeSize=gF(t.nodeSize,t.nodeSpacing);const o=t.linkDistance?dF(1,t.linkDistance):t=>1+n.nodeSize(e.getNode(t.source))+n.nodeSize(e.getNode(t.target));return n.linkDistance=o,n.nodeStrength=dF(1,t.nodeStrength),n.edgeStrength=dF(1,t.edgeStrength),n}formatCentripetal(t,e){const{dimensions:n,centripetalOptions:r,center:i,clusterNodeStrength:A,leafCluster:o,clustering:s,nodeClusterBy:a}=t,c=e.getAllNodes(),l=r||{leaf:2,single:2,others:1,center:t=>({x:i[0],y:i[1],z:3===n?i[2]:void 0})};let u,h;if("function"!=typeof A&&(t.clusterNodeStrength=t=>A),o&&a&&(u=XF(e,a),h=Array.from(new Set(null==c?void 0:c.map(t=>t.data[a])))||[],t.centripetalOptions=Object.assign(l,{single:100,leaf:e=>{const{siblingLeaves:n,sameTypeLeaves:r}=u[e.id]||{};return(null==r?void 0:r.length)===(null==n?void 0:n.length)||1===(null==h?void 0:h.length)?1:t.clusterNodeStrength(e)},others:1,center:t=>{const n=e.getDegree(t.id,"both");if(!n)return{x:100,y:100,z:0};let r;if(1===n){const{sameTypeLeaves:e=[]}=u[t.id]||{};1===e.length?r=void 0:e.length>1&&(r=JF(e))}else r=void 0;return{x:null==r?void 0:r.x,y:null==r?void 0:r.y,z:null==r?void 0:r.z}}})),s&&a){u||(u=XF(e,a)),h||(h=Array.from(new Set(c.map(t=>t.data[a])))),h=h.filter(t=>void 0!==t);const n={};h.forEach(t=>{const r=c.filter(e=>e.data[a]===t).map(t=>e.getNode(t.id));n[t]=JF(r)}),t.centripetalOptions=Object.assign(l,{single:e=>t.clusterNodeStrength(e),leaf:e=>t.clusterNodeStrength(e),others:e=>t.clusterNodeStrength(e),center:t=>{const e=n[t.data[a]];return{x:null==e?void 0:e.x,y:null==e?void 0:e.y,z:null==e?void 0:e.z}}})}const{leaf:d,single:f,others:g}=t.centripetalOptions||{};d&&"function"!=typeof d&&(t.centripetalOptions.leaf=()=>d),f&&"function"!=typeof f&&(t.centripetalOptions.single=()=>f),g&&"function"!=typeof g&&(t.centripetalOptions.others=()=>g)}runOneStep(t,e,n,r,i){const A={},o=t.getAllNodes(),s=t.getAllEdges();if(!(null==o?void 0:o.length))return;const{monitor:a}=i;if(this.calRepulsive(t,A,i),s&&this.calAttractive(t,A,i),this.calGravity(t,e,A,i),this.updateVelocity(t,A,r,i),a){a({energy:this.calTotalEnergy(A,o),nodes:e.getAllNodes(),edges:e.getAllEdges(),iterations:n})}}calTotalEnergy(t,e){if(!(null==e?void 0:e.length))return 0;let n=0;return e.forEach((e,r)=>{const i=t[e.id].x,A=t[e.id].y,o=3===this.options.dimensions?t[e.id].z:0,s=i*i+A*A+o*o,{mass:a=1}=e.data;n+=a*s*.5}),n}calRepulsive(t,e,n){const{dimensions:r,factor:i,coulombDisScale:A}=n;jF(t,i,A*A,e,r)}calAttractive(t,e,n){const{dimensions:r,nodeSize:i}=n;t.getAllEdges().forEach((n,A)=>{const{source:o,target:s}=n,a=t.getNode(o),c=t.getNode(s);if(!a||!c)return;let l=c.data.x-a.data.x,u=c.data.y-a.data.y,h=3===r?c.data.z-a.data.z:0;l||u||(l=.01*Math.random(),u=.01*Math.random(),3!==r||h||(h=.01*Math.random()));const d=Math.sqrt(l*l+u*u+h*h);if(d<i(a)+i(c))return;const f=l/d,g=u/d,p=h/d,{linkDistance:v=200,edgeStrength:m=200}=n.data||{},y=(v-d)*m,w=1/(a.data.mass||1),B=1/(c.data.mass||1),b=f*y,E=g*y,x=p*y;e[o].x-=b*w,e[o].y-=E*w,e[o].z-=x*w,e[s].x+=b*B,e[s].y+=E*B,e[s].z+=x*B})}calGravity(t,e,n,r){const{getCenter:i}=r,A=t.getAllNodes(),o=e.getAllNodes(),s=e.getAllEdges(),{width:a,height:c,center:l,gravity:u,centripetalOptions:h}=r;A&&A.forEach(r=>{const{id:A,data:d}=r,{mass:f,x:g,y:p,z:v}=d,m=e.getNode(A);let y=0,w=0,B=0,b=u;const E=t.getDegree(A,"in"),x=t.getDegree(A,"out"),C=t.getDegree(A,"both"),F=null==i?void 0:i(m,C);if(F){const[t,e,n]=F;y=g-t,w=p-e,b=n}else y=g-l[0],w=p-l[1],B=v-l[2];if(b&&(n[A].x-=b*y/f,n[A].y-=b*w/f,n[A].z-=b*B/f),h){const{leaf:t,single:e,others:r,center:i}=h,{x:l,y:u,z:d,centerStrength:y}=(null==i?void 0:i(m,o,s,a,c))||{x:0,y:0,z:0,centerStrength:0};if(!oe(l)||!oe(u))return;const w=(g-l)/f,B=(p-u)/f,b=(v-d)/f;if(y&&(n[A].x-=y*w,n[A].y-=y*B,n[A].z-=y*b),0===C){const t=e(m);if(!t)return;return n[A].x-=t*w,n[A].y-=t*B,void(n[A].z-=t*b)}if(0===E||0===x){const e=t(m,o,s);if(!e)return;return n[A].x-=e*w,n[A].y-=e*B,void(n[A].z-=e*b)}const F=r(m);if(!F)return;n[A].x-=F*w,n[A].y-=F*B,n[A].z-=F*b}})}updateVelocity(t,e,n,r){const{damping:i,maxSpeed:A,interval:o,dimensions:s}=r,a=t.getAllNodes();(null==a?void 0:a.length)&&a.forEach(t=>{const{id:r}=t;let a=(n[r].x+e[r].x*o)*i||.01,c=(n[r].y+e[r].y*o)*i||.01,l=3===s?(n[r].z+e[r].z*o)*i||.01:0;const u=Math.sqrt(a*a+c*c+l*l);if(u>A){const t=A/u;a*=t,c*=t,l*=t}n[r]={x:a,y:c,z:l}})}updatePosition(t,e,n,r){const{distanceThresholdMode:i,interval:A,dimensions:o}=r,s=e.getAllNodes();if(!(null==s?void 0:s.length))return void(this.judgingDistance=0);let a=0;"max"===i?this.judgingDistance=-1/0:"min"===i&&(this.judgingDistance=1/0),s.forEach(r=>{const{id:s}=r,c=t.getNode(s);if(oe(c.data.fx)&&oe(c.data.fy))return void e.mergeNodeData(s,{x:c.data.fx,y:c.data.fy,z:3===o?c.data.fz:void 0});const l=n[s].x*A,u=n[s].y*A,h=3===o?n[s].z*A:0;e.mergeNodeData(s,{x:r.data.x+l,y:r.data.y+u,z:r.data.z+h});const d=Math.sqrt(l*l+u*u+h*h);switch(i){case"max":this.judgingDistance<d&&(this.judgingDistance=d);break;case"min":this.judgingDistance>d&&(this.judgingDistance=d);break;default:a+=d}}),i&&"mean"!==i||(this.judgingDistance=a/s.length)}}const XF=(t,e)=>{const n=t.getAllNodes();if(!(null==n?void 0:n.length))return{};const r={};return n.forEach((n,i)=>{1===t.getDegree(n.id,"both")&&(r[n.id]=qF(t,"leaf",n,e))}),r},qF=(t,e,n,r)=>{const i=t.getDegree(n.id,"in"),A=t.getDegree(n.id,"out");let o=n,s=[];0===i?(o=t.getSuccessors(n.id)[0],s=t.getNeighbors(o.id)):0===A&&(o=t.getPredecessors(n.id)[0],s=t.getNeighbors(o.id)),s=s.filter(e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out"));return{coreNode:o,siblingLeaves:s,sameTypeLeaves:ZF(t,e,r,n,s)}},ZF=(t,e,n,r,i)=>{const A=r.data[n]||"";let o=(null==i?void 0:i.filter(t=>t.data[n]===A))||[];return o=o.filter(e=>0===t.getDegree(e.id,"in")||0===t.getDegree(e.id,"out")),o},JF=t=>{const e={x:0,y:0};t.forEach(t=>{const{x:n,y:r}=t.data;e.x+=n||0,e.y+=r||0});const n=t.length||1;return{x:e.x/n,y:e.y/n}},$F=(t,e)=>e.map(e=>{const{id:n,data:r}=e,i=t.getNode(n);return Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},i.data),{x:r.x,y:r.y,z:r.z})})});var tM={};const eM=Object.prototype.toString;function nM(t){const e=eM.call(t);return e.endsWith("Array]")&&!e.includes("Big")}var rM=b(Object.freeze({__proto__:null,isAnyArray:nM}));var iM=Object.freeze({__proto__:null,default:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nM(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!nM(n.output))throw new TypeError("output option must be an array if specified");e=n.output}else e=new Array(t.length);var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nM(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,A=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(A<=r||A>t.length||!Number.isInteger(A))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[r],s=r+1;s<A;s++)t[s]<o&&(o=t[s]);return o}(t),i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!nM(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var n=e.fromIndex,r=void 0===n?0:n,i=e.toIndex,A=void 0===i?t.length:i;if(r<0||r>=t.length||!Number.isInteger(r))throw new Error("fromIndex must be a positive integer smaller than length");if(A<=r||A>t.length||!Number.isInteger(A))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var o=t[r],s=r+1;s<A;s++)t[s]>o&&(o=t[s]);return o}(t);if(r===i)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var A=n.min,o=void 0===A?n.autoMinMax?r:0:A,s=n.max,a=void 0===s?n.autoMinMax?i:1:s;if(o>=a)throw new RangeError("min option must be smaller than max option");for(var c=(a-o)/(i-r),l=0;l<t.length;l++)e[l]=(t[l]-r)*c+o;return e}}),AM=b(iM);Object.defineProperty(tM,"__esModule",{value:!0});var oM=rM,sM=AM;const aM=" ".repeat(2),cM=" ".repeat(4);function lM(t,e={}){const{maxRows:n=15,maxColumns:r=10,maxNumSize:i=8,padMinus:A="auto"}=e;return`${t.constructor.name} {\n${aM}[\n${cM}${function(t,e,n,r,i){const{rows:A,columns:o}=t,s=Math.min(A,e),a=Math.min(o,n),c=[];if("auto"===i){i=!1;t:for(let e=0;e<s;e++)for(let n=0;n<a;n++)if(t.get(e,n)<0){i=!0;break t}}for(let e=0;e<s;e++){let n=[];for(let A=0;A<a;A++)n.push(uM(t.get(e,A),r,i));c.push(`${n.join(" ")}`)}a!==o&&(c[c.length-1]+=` ... ${o-n} more columns`);s!==A&&c.push(`... ${A-e} more rows`);return c.join(`\n${cM}`)}(t,n,r,i,A)}\n${aM}]\n${aM}rows: ${t.rows}\n${aM}columns: ${t.columns}\n}`}function uM(t,e,n){return(t>=0&&n?` ${hM(t,e-1)}`:hM(t,e)).padEnd(e)}function hM(t,e){let n=t.toString();if(n.length<=e)return n;let r=t.toFixed(e);if(r.length>e&&(r=t.toFixed(Math.max(0,e-(r.length-e)))),r.length<=e&&!r.startsWith("0.000")&&!r.startsWith("-0.000"))return r;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function dM(t,e,n){let r=n?t.rows:t.rows-1;if(e<0||e>r)throw new RangeError("Row index out of range")}function fM(t,e,n){let r=n?t.columns:t.columns-1;if(e<0||e>r)throw new RangeError("Column index out of range")}function gM(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function pM(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function vM(t,e){if(!oM.isAnyArray(e))throw new TypeError("row indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.rows)throw new RangeError("row indices are out of range")}function mM(t,e){if(!oM.isAnyArray(e))throw new TypeError("column indices must be an array");for(let n=0;n<e.length;n++)if(e[n]<0||e[n]>=t.columns)throw new RangeError("column indices are out of range")}function yM(t,e,n,r,i){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(BM("startRow",e),BM("endRow",n),BM("startColumn",r),BM("endColumn",i),e>n||r>i||e<0||e>=t.rows||n<0||n>=t.rows||r<0||r>=t.columns||i<0||i>=t.columns)throw new RangeError("Submatrix indices are out of range")}function wM(t,e=0){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function BM(t,e){if("number"!=typeof e)throw new TypeError(`${t} must be a number`)}function bM(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}class EM{static from1DArray(t,e,n){if(t*e!==n.length)throw new RangeError("data length does not match given dimensions");let r=new FM(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)r.set(i,t,n[i*e+t]);return r}static rowVector(t){let e=new FM(1,t.length);for(let n=0;n<t.length;n++)e.set(0,n,t[n]);return e}static columnVector(t){let e=new FM(t.length,1);for(let n=0;n<t.length;n++)e.set(n,0,t[n]);return e}static zeros(t,e){return new FM(t,e)}static ones(t,e){return new FM(t,e).fill(1)}static rand(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{random:r=Math.random}=n;let i=new FM(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++)i.set(n,t,r());return i}static randInt(t,e,n={}){if("object"!=typeof n)throw new TypeError("options must be an object");const{min:r=0,max:i=1e3,random:A=Math.random}=n;if(!Number.isInteger(r))throw new TypeError("min must be an integer");if(!Number.isInteger(i))throw new TypeError("max must be an integer");if(r>=i)throw new RangeError("min must be smaller than max");let o=i-r,s=new FM(t,e);for(let n=0;n<t;n++)for(let t=0;t<e;t++){let e=r+Math.round(A()*o);s.set(n,t,e)}return s}static eye(t,e,n){void 0===e&&(e=t),void 0===n&&(n=1);let r=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<r;t++)i.set(t,t,n);return i}static diag(t,e,n){let r=t.length;void 0===e&&(e=r),void 0===n&&(n=e);let i=Math.min(r,e,n),A=this.zeros(e,n);for(let e=0;e<i;e++)A.set(e,e,t[e]);return A}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new FM(n,r);for(let A=0;A<n;A++)for(let n=0;n<r;n++)i.set(A,n,Math.min(t.get(A,n),e.get(A,n)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let n=t.rows,r=t.columns,i=new this(n,r);for(let A=0;A<n;A++)for(let n=0;n<r;n++)i.set(A,n,Math.max(t.get(A,n),e.get(A,n)));return i}static checkMatrix(t){return EM.isMatrix(t)?t:new FM(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.call(this,e,n);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let n=0;n<this.columns;n++)t[e].push(this.get(e,n))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);t++}return r}isReducedEchelonForm(){let t=0,e=0,n=-1,r=!0,i=!1;for(;t<this.rows&&r;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>n?(i=!0,n=e):(r=!1,i=!0);for(let n=e+1;n<this.rows;n++)0!==this.get(t,n)&&(r=!1);t++}return r}echelonForm(){let t=this.clone(),e=0,n=0;for(;e<t.rows&&n<t.columns;){let r=e;for(let i=e;i<t.rows;i++)t.get(i,n)>t.get(r,n)&&(r=i);if(0===t.get(r,n))n++;else{t.swapRows(e,r);let i=t.get(e,n);for(let r=n;r<t.columns;r++)t.set(e,r,t.get(e,r)/i);for(let r=e+1;r<t.rows;r++){let i=t.get(r,n)/t.get(e,n);t.set(r,n,0);for(let A=n+1;A<t.columns;A++)t.set(r,A,t.get(r,A)-t.get(e,A)*i)}e++,n++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,n=t.rows,r=n-1;for(;r>=0;)if(0===t.maxRow(r))r--;else{let i=0,A=!1;for(;i<n&&!1===A;)1===t.get(r,i)?A=!0:i++;for(let n=0;n<r;n++){let A=t.get(n,i);for(let o=i;o<e;o++){let e=t.get(n,o)-A*t.get(r,o);t.set(n,o,e)}}r--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:n=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(n)||n<=0)throw new TypeError("columns must be a positive integer");let r=new FM(this.rows*e,this.columns*n);for(let t=0;t<e;t++)for(let e=0;e<n;e++)r.setSubMatrix(this,this.rows*t,this.columns*e);return r}fill(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,t);return this}neg(){return this.mulS(-1)}getRow(t){dM(this,t);let e=[];for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}getRowVector(t){return FM.rowVector(this.getRow(t))}setRow(t,e){dM(this,t),e=gM(this,e);for(let n=0;n<this.columns;n++)this.set(t,n,e[n]);return this}swapRows(t,e){dM(this,t),dM(this,e);for(let n=0;n<this.columns;n++){let r=this.get(t,n);this.set(t,n,this.get(e,n)),this.set(e,n,r)}return this}getColumn(t){fM(this,t);let e=[];for(let n=0;n<this.rows;n++)e.push(this.get(n,t));return e}getColumnVector(t){return FM.columnVector(this.getColumn(t))}setColumn(t,e){fM(this,t),e=pM(this,e);for(let n=0;n<this.rows;n++)this.set(n,t,e[n]);return this}swapColumns(t,e){fM(this,t),fM(this,e);for(let n=0;n<this.rows;n++){let r=this.get(n,t);this.set(n,t,this.get(n,e)),this.set(n,e,r)}return this}addRowVector(t){t=gM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[n]);return this}subRowVector(t){t=gM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[n]);return this}mulRowVector(t){t=gM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[n]);return this}divRowVector(t){t=gM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[n]);return this}addColumnVector(t){t=pM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t[e]);return this}subColumnVector(t){t=pM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t[e]);return this}mulColumnVector(t){t=pM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t[e]);return this}divColumnVector(t){t=pM(this,t);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t[e]);return this}mulRow(t,e){dM(this,t);for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this}mulColumn(t,e){fM(this,t);for(let n=0;n<this.rows;n++)this.set(n,t,this.get(n,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){bM(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[e]&&(t[e]=this.get(e,n));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t[n]&&(t[n]=this.get(e,n));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){bM(this);let t=this.get(0,0),e=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<t&&(t=this.get(n,r),e[0]=n,e[1]=r);return e}maxRow(t){if(dM(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxRowIndex(t){dM(this,t),bM(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r),n[1]=r);return n}minRow(t){if(dM(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let n=1;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minRowIndex(t){dM(this,t),bM(this);let e=this.get(t,0),n=[t,0];for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r),n[1]=r);return n}maxColumn(t){if(fM(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)>e&&(e=this.get(n,t));return e}maxColumnIndex(t){fM(this,t),bM(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t),n[0]=r);return n}minColumn(t){if(fM(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let n=1;n<this.rows;n++)this.get(n,t)<e&&(e=this.get(n,t));return e}minColumnIndex(t){fM(this,t),bM(this);let e=this.get(0,t),n=[0,t];for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t),n[0]=r);return n}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let n=0;n<t;n++)e.push(this.get(n,n));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t+=this.get(e,n),this.set(e,n,t);return this}dot(t){EM.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let n=0;for(let r=0;r<e.length;r++)n+=e[r]*t[r];return n}mmul(t){t=FM.checkMatrix(t);let e=this.rows,n=this.columns,r=t.columns,i=new FM(e,r),A=new Float64Array(n);for(let o=0;o<r;o++){for(let e=0;e<n;e++)A[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let r=0;r<n;r++)e+=this.get(t,r)*A[r];i.set(t,o,e)}}return i}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=FM.eye(this.rows),n=this;for(let r=t;r>=1;r/=2)1&r&&(e=e.mmul(n)),n=n.mmul(n);return e}strassen2x2(t){t=FM.checkMatrix(t);let e=new FM(2,2);const n=this.get(0,0),r=t.get(0,0),i=this.get(0,1),A=t.get(0,1),o=this.get(1,0),s=t.get(1,0),a=this.get(1,1),c=t.get(1,1),l=(n+a)*(r+c),u=(o+a)*r,h=n*(A-c),d=a*(s-r),f=(n+i)*c,g=l+d-f+(i-a)*(s+c),p=h+f,v=u+d,m=l-u+h+(o-n)*(r+A);return e.set(0,0,g),e.set(0,1,p),e.set(1,0,v),e.set(1,1,m),e}strassen3x3(t){t=FM.checkMatrix(t);let e=new FM(3,3);const n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),A=this.get(1,0),o=this.get(1,1),s=this.get(1,2),a=this.get(2,0),c=this.get(2,1),l=this.get(2,2),u=t.get(0,0),h=t.get(0,1),d=t.get(0,2),f=t.get(1,0),g=t.get(1,1),p=t.get(1,2),v=t.get(2,0),m=t.get(2,1),y=t.get(2,2),w=(n-A)*(-h+g),B=(-n+A+o)*(u-h+g),b=(A+o)*(-u+h),E=n*u,x=(-n+a+c)*(u-d+p),C=(-n+a)*(d-p),F=(a+c)*(-u+d),M=(-i+c+l)*(g+v-m),k=(i-l)*(g-m),Q=i*v,S=(c+l)*(-v+m),U=(-i+o+s)*(p+v-y),T=(i-s)*(p-y),O=(o+s)*(-v+y),N=E+Q+r*f,I=(n+r+i-A-o-c-l)*g+B+b+E+M+Q+S,L=E+x+F+(n+r+i-o-s-a-c)*p+Q+U+O,D=w+o*(-u+h+f-g-p-v+y)+B+E+Q+U+T,P=w+B+b+E+s*m,R=Q+U+T+O+A*d,H=E+x+C+c*(-u+d+f-g-p-v+m)+M+k+Q,_=M+k+Q+S+a*h,G=E+x+C+F+l*y;return e.set(0,0,N),e.set(0,1,I),e.set(0,2,L),e.set(1,0,D),e.set(1,1,P),e.set(1,2,R),e.set(2,0,H),e.set(2,1,_),e.set(2,2,G),e}mmulStrassen(t){t=FM.checkMatrix(t);let e=this.clone(),n=e.rows,r=e.columns,i=t.rows,A=t.columns;function o(t,e,n){let r=t.rows,i=t.columns;if(r===e&&i===n)return t;{let r=EM.zeros(e,n);return r=r.setSubMatrix(t,0,0),r}}r!==i&&console.warn(`Multiplying ${n} x ${r} and ${i} x ${A} matrix: dimensions do not match.`);let s=Math.max(n,i),a=Math.max(r,A);return e=o(e,s,a),function t(e,n,r,i){if(r<=512||i<=512)return e.mmul(n);r%2==1&&i%2==1?(e=o(e,r+1,i+1),n=o(n,r+1,i+1)):r%2==1?(e=o(e,r+1,i),n=o(n,r+1,i)):i%2==1&&(e=o(e,r,i+1),n=o(n,r,i+1));let A=parseInt(e.rows/2,10),s=parseInt(e.columns/2,10),a=e.subMatrix(0,A-1,0,s-1),c=n.subMatrix(0,A-1,0,s-1),l=e.subMatrix(0,A-1,s,e.columns-1),u=n.subMatrix(0,A-1,s,n.columns-1),h=e.subMatrix(A,e.rows-1,0,s-1),d=n.subMatrix(A,n.rows-1,0,s-1),f=e.subMatrix(A,e.rows-1,s,e.columns-1),g=n.subMatrix(A,n.rows-1,s,n.columns-1),p=t(EM.add(a,f),EM.add(c,g),A,s),v=t(EM.add(h,f),c,A,s),m=t(a,EM.sub(u,g),A,s),y=t(f,EM.sub(d,c),A,s),w=t(EM.add(a,l),g,A,s),B=t(EM.sub(h,a),EM.add(c,u),A,s),b=t(EM.sub(l,f),EM.add(d,g),A,s),E=EM.add(p,y);E.sub(w),E.add(b);let x=EM.add(m,w),C=EM.add(v,y),F=EM.sub(p,v);F.add(m),F.add(B);let M=EM.zeros(2*E.rows,2*E.columns);return M=M.setSubMatrix(E,0,0),M=M.setSubMatrix(x,E.rows,0),M=M.setSubMatrix(C,0,E.columns),M=M.setSubMatrix(F,E.rows,E.columns),M.subMatrix(0,r-1,0,i-1)}(e,t=o(t,s,a),s,a)}scaleRows(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new FM(this.rows,this.columns);for(let t=0;t<this.rows;t++){const i=this.getRow(t);i.length>0&&sM(i,{min:e,max:n,output:i}),r.setRow(t,i)}return r}scaleColumns(t={}){if("object"!=typeof t)throw new TypeError("options must be an object");const{min:e=0,max:n=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(n))throw new TypeError("max must be a number");if(e>=n)throw new RangeError("min must be smaller than max");let r=new FM(this.rows,this.columns);for(let t=0;t<this.columns;t++){const i=this.getColumn(t);i.length&&sM(i,{min:e,max:n,output:i}),r.setColumn(t,i)}return r}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let n=0;n<t;n++){let t=this.get(e,n),r=this.get(e,this.columns-1-n);this.set(e,n,r),this.set(e,this.columns-1-n,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let n=0;n<t;n++){let t=this.get(n,e),r=this.get(this.rows-1-n,e);this.set(n,e,r),this.set(this.rows-1-n,e,t)}return this}kroneckerProduct(t){t=FM.checkMatrix(t);let e=this.rows,n=this.columns,r=t.rows,i=t.columns,A=new FM(e*r,n*i);for(let o=0;o<e;o++)for(let e=0;e<n;e++)for(let n=0;n<r;n++)for(let s=0;s<i;s++)A.set(r*o+n,i*e+s,this.get(o,e)*t.get(n,s));return A}kroneckerSum(t){if(t=FM.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,n=t.rows,r=this.kroneckerProduct(FM.eye(n,n)),i=FM.eye(e,e).kroneckerProduct(t);return r.add(i)}transpose(){let t=new FM(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)t.set(n,e,this.get(e,n));return t}sortRows(t=xM){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=xM){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,n,r){yM(this,t,e,n,r);let i=new FM(e-t+1,r-n+1);for(let A=t;A<=e;A++)for(let e=n;e<=r;e++)i.set(A-t,e-n,this.get(A,e));return i}subMatrixRow(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.columns-1),e>n||e<0||e>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");let r=new FM(t.length,n-e+1);for(let i=0;i<t.length;i++)for(let A=e;A<=n;A++){if(t[i]<0||t[i]>=this.rows)throw new RangeError(`Row index out of range: ${t[i]}`);r.set(i,A-e,this.get(t[i],A))}return r}subMatrixColumn(t,e,n){if(void 0===e&&(e=0),void 0===n&&(n=this.rows-1),e>n||e<0||e>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");let r=new FM(n-e+1,t.length);for(let i=0;i<t.length;i++)for(let A=e;A<=n;A++){if(t[i]<0||t[i]>=this.columns)throw new RangeError(`Column index out of range: ${t[i]}`);r.set(A-e,i,this.get(A,t[i]))}return r}setSubMatrix(t,e,n){if((t=FM.checkMatrix(t)).isEmpty())return this;yM(this,e,e+t.rows-1,n,n+t.columns-1);for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)this.set(e+r,n+i,t.get(r,i));return this}selection(t,e){vM(this,t),mM(this,e);let n=new FM(t.length,e.length);for(let r=0;r<t.length;r++){let i=t[r];for(let t=0;t<e.length;t++){let A=e[t];n.set(r,t,this.get(i,A))}}return n}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let n=0;n<t;n++)e+=this.get(n,n);return e}clone(){return this.constructor.copy(this,new FM(this.rows,this.columns))}static copy(t,e){for(const[n,r,i]of t.entries())e.set(n,r,i);return e}sum(t){switch(t){case"row":return function(t){let e=wM(t.rows);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]+=t.get(n,r);return e}(this);case"column":return function(t){let e=wM(t.columns);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]+=t.get(n,r);return e}(this);case void 0:return function(t){let e=0;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e+=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=wM(t.rows,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[n]*=t.get(n,r);return e}(this);case"column":return function(t){let e=wM(t.columns,1);for(let n=0;n<t.rows;++n)for(let r=0;r<t.columns;++r)e[r]*=t.get(n,r);return e}(this);case void 0:return function(t){let e=1;for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)e*=t.get(n,r);return e}(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{unbiased:n=!0,mean:r=this.mean(t)}=e;if("boolean"!=typeof n)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!oM.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,A=[];for(let o=0;o<r;o++){let r=0,s=0,a=0;for(let e=0;e<i;e++)a=t.get(o,e)-n[o],r+=a,s+=a*a;e?A.push((s-r*r/i)/(i-1)):A.push((s-r*r/i)/i)}return A}(this,n,r);case"column":if(!oM.isAnyArray(r))throw new TypeError("mean must be an array");return function(t,e,n){const r=t.rows,i=t.columns,A=[];for(let o=0;o<i;o++){let i=0,s=0,a=0;for(let e=0;e<r;e++)a=t.get(e,o)-n[o],i+=a,s+=a*a;e?A.push((s-i*i/r)/(r-1)):A.push((s-i*i/r)/r)}return A}(this,n,r);case void 0:if("number"!=typeof r)throw new TypeError("mean must be a number");return function(t,e,n){const r=t.rows,i=t.columns,A=r*i;let o=0,s=0,a=0;for(let e=0;e<r;e++)for(let r=0;r<i;r++)a=t.get(e,r)-n,o+=a,s+=a*a;return e?(s-o*o/A)/(A-1):(s-o*o/A)/A}(this,n,r);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);const n=this.variance(t,e);if(void 0===t)return Math.sqrt(n);for(let t=0;t<n.length;t++)n[t]=Math.sqrt(n[t]);return n}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");const{center:n=this.mean(t)}=e;switch(t){case"row":if(!oM.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[n])}(this,n),this;case"column":if(!oM.isAnyArray(n))throw new TypeError("center must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e[r])}(this,n),this;case void 0:if("number"!=typeof n)throw new TypeError("center must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)-e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw new TypeError("options must be an object");let n=e.scale;switch(t){case"row":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.rows;n++){let r=0;for(let e=0;e<t.columns;e++)r+=t.get(n,e)**2/(t.columns-1);e.push(Math.sqrt(r))}return e}(this);else if(!oM.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[n])}(this,n),this;case"column":if(void 0===n)n=function(t){const e=[];for(let n=0;n<t.columns;n++){let r=0;for(let e=0;e<t.rows;e++)r+=t.get(e,n)**2/(t.rows-1);e.push(Math.sqrt(r))}return e}(this);else if(!oM.isAnyArray(n))throw new TypeError("scale must be an array");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e[r])}(this,n),this;case void 0:if(void 0===n)n=function(t){const e=t.size-1;let n=0;for(let r=0;r<t.columns;r++)for(let i=0;i<t.rows;i++)n+=t.get(i,r)**2/e;return Math.sqrt(n)}(this);else if("number"!=typeof n)throw new TypeError("scale must be a number");return function(t,e){for(let n=0;n<t.rows;n++)for(let r=0;r<t.columns;r++)t.set(n,r,t.get(n,r)/e)}(this,n),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return lM(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function xM(t,e){return t-e}function CM(t){return t.every(t=>"number"==typeof t)}EM.prototype.klass="Matrix","undefined"!=typeof Symbol&&(EM.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return lM(this)}),EM.random=EM.rand,EM.randomInt=EM.randInt,EM.diagonal=EM.diag,EM.prototype.diagonal=EM.prototype.diag,EM.identity=EM.eye,EM.prototype.negate=EM.prototype.neg,EM.prototype.tensorProduct=EM.prototype.kroneckerProduct;let FM=class t extends EM{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let n=0;n<t;n++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(e,n){if(super(),t.isMatrix(e))this.#t(e.rows,e.columns),t.copy(e,this);else if(Number.isInteger(e)&&e>=0)this.#t(e,n);else{if(!oM.isAnyArray(e))throw new TypeError("First argument must be a positive number or an array");{const t=e;if("number"!=typeof(n=(e=t.length)?t[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let r=0;r<e;r++){if(t[r].length!==n)throw new RangeError("Inconsistent array dimensions");if(!CM(t[r]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(t[r]))}this.rows=e,this.columns=n}}}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}removeRow(t){return dM(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),dM(this,t,!0),e=Float64Array.from(gM(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){fM(this,t);for(let e=0;e<this.rows;e++){const n=new Float64Array(this.columns-1);for(let r=0;r<t;r++)n[r]=this.data[e][r];for(let r=t+1;r<this.columns;r++)n[r-1]=this.data[e][r];this.data[e]=n}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),fM(this,t,!0),e=pM(this,e);for(let n=0;n<this.rows;n++){const r=new Float64Array(this.columns+1);let i=0;for(;i<t;i++)r[i]=this.data[n][i];for(r[i++]=e[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}};!function(t,e){t.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)+t.get(e,n));return this},t.add=function(t,n){return new e(t).add(n)},t.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)-t.get(e,n));return this},t.sub=function(t,n){return new e(t).sub(n)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t.get(e,n));return this},t.mul=function(t,n){return new e(t).mul(n)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)/t.get(e,n));return this},t.div=function(t,n){return new e(t).div(n)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)%t.get(e,n));return this},t.mod=function(t,n){return new e(t).mod(n)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)&t.get(e,n));return this},t.and=function(t,n){return new e(t).and(n)},t.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)|t.get(e,n));return this},t.or=function(t,n){return new e(t).or(n)},t.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)^t.get(e,n));return this},t.xor=function(t,n){return new e(t).xor(n)},t.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)<<t.get(e,n));return this},t.leftShift=function(t,n){return new e(t).leftShift(n)},t.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>t.get(e,n));return this},t.signPropagatingRightShift=function(t,n){return new e(t).signPropagatingRightShift(n)},t.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)>>>t.get(e,n));return this},t.rightShift=function(t,n){return new e(t).rightShift(n)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){return new e(t).not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){return new e(t).abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){return new e(t).acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){return new e(t).acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){return new e(t).asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){return new e(t).asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){return new e(t).atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){return new e(t).atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){return new e(t).cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){return new e(t).ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){return new e(t).clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){return new e(t).cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){return new e(t).cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){return new e(t).exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){return new e(t).expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){return new e(t).floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){return new e(t).fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){return new e(t).log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){return new e(t).log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){return new e(t).log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){return new e(t).log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){return new e(t).round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){return new e(t).sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){return new e(t).sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){return new e(t).sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){return new e(t).sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){return new e(t).tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){return new e(t).tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){return new e(t).trunc()},t.pow=function(t,n){return new e(t).pow(n)},t.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)**t.get(e,n));return this}}(EM,FM);class MM extends EM{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return FM.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),FM.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=FM.copy(t,new FM(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new FM(t,t);else if(this.#e=new FM(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new MM(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())t.set(e,n,r);return t}toMatrix(){return new FM(this)}get(t,e){return this.#e.get(t,e)}set(t,e,n){return this.#e.set(t,e,n),this.#e.set(e,t,n),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const n=e.slice();return n.splice(t,1),this.#e.addRow(t,n),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[n,r]of t.entries())r||e.push(n);e.reverse();for(const t of e)this.removeCross(t);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let n=0,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=++r);return e}static fromCompact(t){const e=t.length,n=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const r=new MM(n);for(let i=0,A=0,o=0;o<e;o++)r.set(i,A,t[o]),++i>=n&&(i=++A);return r}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield[t,e,n],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const n=this.get(t,e);yield n,++e>=this.diagonalSize&&(e=++t)}}}MM.prototype.klassType="SymmetricMatrix";class kM extends MM{static isDistanceMatrix(t){return MM.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,n){return t===e&&(n=0),super.set(t,e,n)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new MM(this)}clone(){const t=new kM(this.diagonalSize);for(const[e,n,r]of this.upperRightEntries())e!==n&&t.set(e,n,r);return t}toCompact(){const{diagonalSize:t}=this,e=new Array((t-1)*t/2);for(let n=1,r=0,i=0;i<e.length;i++)e[i]=this.get(r,n),++n>=t&&(n=1+ ++r);return e}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const n=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(n))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const r=new this(n);for(let i=1,A=0,o=0;o<e;o++)r.set(i,A,t[o]),++i>=n&&(i=1+ ++A);return r}}kM.prototype.klassSubType="DistanceMatrix";class QM extends EM{constructor(t,e,n){super(),this.matrix=t,this.rows=e,this.columns=n}}class SM extends QM{constructor(t,e,n){vM(t,e),mM(t,n),super(t,e.length,n.length),this.rowIndices=e,this.columnIndices=n}set(t,e,n){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],n),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class UM extends EM{constructor(t,e={}){const{rows:n=1}=e;if(t.length%n!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=t.length/n,this.data=t}set(t,e,n){let r=this._calculateIndex(t,e);return this.data[r]=n,this}get(t,e){let n=this._calculateIndex(t,e);return this.data[n]}_calculateIndex(t,e){return t*this.columns+e}}class TM extends EM{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,n){return this.data[t][e]=n,this}get(t,e){return this.data[t][e]}}class OM{constructor(t){let e,n,r,i,A,o,s,a,c,l=(t=TM.checkMatrix(t)).clone(),u=l.rows,h=l.columns,d=new Float64Array(u),f=1;for(e=0;e<u;e++)d[e]=e;for(a=new Float64Array(u),n=0;n<h;n++){for(e=0;e<u;e++)a[e]=l.get(e,n);for(e=0;e<u;e++){for(c=Math.min(e,n),A=0,r=0;r<c;r++)A+=l.get(e,r)*a[r];a[e]-=A,l.set(e,n,a[e])}for(i=n,e=n+1;e<u;e++)Math.abs(a[e])>Math.abs(a[i])&&(i=e);if(i!==n){for(r=0;r<h;r++)o=l.get(i,r),l.set(i,r,l.get(n,r)),l.set(n,r,o);s=d[i],d[i]=d[n],d[n]=s,f=-f}if(n<u&&0!==l.get(n,n))for(e=n+1;e<u;e++)l.set(e,n,l.get(e,n)/l.get(n,n))}this.LU=l,this.pivotVector=d,this.pivotSign=f}isSingular(){let t=this.LU,e=t.columns;for(let n=0;n<e;n++)if(0===t.get(n,n))return!0;return!1}solve(t){t=FM.checkMatrix(t);let e=this.LU;if(e.rows!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let n,r,i,A=t.columns,o=t.subMatrixRow(this.pivotVector,0,A-1),s=e.columns;for(i=0;i<s;i++)for(n=i+1;n<s;n++)for(r=0;r<A;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*e.get(n,i));for(i=s-1;i>=0;i--){for(r=0;r<A;r++)o.set(i,r,o.get(i,r)/e.get(i,i));for(n=0;n<i;n++)for(r=0;r<A;r++)o.set(n,r,o.get(n,r)-o.get(i,r)*e.get(n,i))}return o}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,n=t.columns;for(let r=0;r<n;r++)e*=t.get(r,r);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new FM(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i>e?r.set(i,e,t.get(i,e)):i===e?r.set(i,e,1):r.set(i,e,0);return r}get upperTriangularMatrix(){let t=this.LU,e=t.rows,n=t.columns,r=new FM(e,n);for(let i=0;i<e;i++)for(let e=0;e<n;e++)i<=e?r.set(i,e,t.get(i,e)):r.set(i,e,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function NM(t,e){let n=0;return Math.abs(t)>Math.abs(e)?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0!==e?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0}class IM{constructor(t){let e,n,r,i,A=(t=TM.checkMatrix(t)).clone(),o=t.rows,s=t.columns,a=new Float64Array(s);for(r=0;r<s;r++){let t=0;for(e=r;e<o;e++)t=NM(t,A.get(e,r));if(0!==t){for(A.get(r,r)<0&&(t=-t),e=r;e<o;e++)A.set(e,r,A.get(e,r)/t);for(A.set(r,r,A.get(r,r)+1),n=r+1;n<s;n++){for(i=0,e=r;e<o;e++)i+=A.get(e,r)*A.get(e,n);for(i=-i/A.get(r,r),e=r;e<o;e++)A.set(e,n,A.get(e,n)+i*A.get(e,r))}}a[r]=-t}this.QR=A,this.Rdiag=a}solve(t){t=FM.checkMatrix(t);let e=this.QR,n=e.rows;if(t.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let r,i,A,o,s=t.columns,a=t.clone(),c=e.columns;for(A=0;A<c;A++)for(i=0;i<s;i++){for(o=0,r=A;r<n;r++)o+=e.get(r,A)*a.get(r,i);for(o=-o/e.get(A,A),r=A;r<n;r++)a.set(r,i,a.get(r,i)+o*e.get(r,A))}for(A=c-1;A>=0;A--){for(i=0;i<s;i++)a.set(A,i,a.get(A,i)/this.Rdiag[A]);for(r=0;r<A;r++)for(i=0;i<s;i++)a.set(r,i,a.get(r,i)-a.get(A,i)*e.get(r,A))}return a.subMatrix(0,c-1,0,s-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,n=this.QR,r=n.columns,i=new FM(r,r);for(t=0;t<r;t++)for(e=0;e<r;e++)t<e?i.set(t,e,n.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,n,r,i=this.QR,A=i.rows,o=i.columns,s=new FM(A,o);for(n=o-1;n>=0;n--){for(t=0;t<A;t++)s.set(t,n,0);for(s.set(n,n,1),e=n;e<o;e++)if(0!==i.get(n,n)){for(r=0,t=n;t<A;t++)r+=i.get(t,n)*s.get(t,e);for(r=-r/i.get(n,n),t=n;t<A;t++)s.set(t,e,s.get(t,e)+r*i.get(t,n))}}return s}}let LM=class{constructor(t,e={}){if((t=TM.checkMatrix(t)).isEmpty())throw new Error("Matrix must be non-empty");let n=t.rows,r=t.columns;const{computeLeftSingularVectors:i=!0,computeRightSingularVectors:A=!0,autoTranspose:o=!1}=e;let s,a=Boolean(i),c=Boolean(A),l=!1;if(n<r)if(o){s=t.transpose(),n=s.rows,r=s.columns,l=!0;let e=a;a=c,c=e}else s=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=t.clone();let u=Math.min(n,r),h=Math.min(n+1,r),d=new Float64Array(h),f=new FM(n,u),g=new FM(r,r),p=new Float64Array(r),v=new Float64Array(n),m=new Float64Array(h);for(let t=0;t<h;t++)m[t]=t;let y=Math.min(n-1,r),w=Math.max(0,Math.min(r-2,n)),B=Math.max(y,w);for(let t=0;t<B;t++){if(t<y){d[t]=0;for(let e=t;e<n;e++)d[t]=NM(d[t],s.get(e,t));if(0!==d[t]){s.get(t,t)<0&&(d[t]=-d[t]);for(let e=t;e<n;e++)s.set(e,t,s.get(e,t)/d[t]);s.set(t,t,s.get(t,t)+1)}d[t]=-d[t]}for(let e=t+1;e<r;e++){if(t<y&&0!==d[t]){let r=0;for(let i=t;i<n;i++)r+=s.get(i,t)*s.get(i,e);r=-r/s.get(t,t);for(let i=t;i<n;i++)s.set(i,e,s.get(i,e)+r*s.get(i,t))}p[e]=s.get(t,e)}if(a&&t<y)for(let e=t;e<n;e++)f.set(e,t,s.get(e,t));if(t<w){p[t]=0;for(let e=t+1;e<r;e++)p[t]=NM(p[t],p[e]);if(0!==p[t]){p[t+1]<0&&(p[t]=0-p[t]);for(let e=t+1;e<r;e++)p[e]/=p[t];p[t+1]+=1}if(p[t]=-p[t],t+1<n&&0!==p[t]){for(let e=t+1;e<n;e++)v[e]=0;for(let e=t+1;e<n;e++)for(let n=t+1;n<r;n++)v[e]+=p[n]*s.get(e,n);for(let e=t+1;e<r;e++){let r=-p[e]/p[t+1];for(let i=t+1;i<n;i++)s.set(i,e,s.get(i,e)+r*v[i])}}if(c)for(let e=t+1;e<r;e++)g.set(e,t,p[e])}}let b=Math.min(r,n+1);if(y<r&&(d[y]=s.get(y,y)),n<b&&(d[b-1]=0),w+1<b&&(p[w]=s.get(w,b-1)),p[b-1]=0,a){for(let t=y;t<u;t++){for(let e=0;e<n;e++)f.set(e,t,0);f.set(t,t,1)}for(let t=y-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<u;e++){let r=0;for(let i=t;i<n;i++)r+=f.get(i,t)*f.get(i,e);r=-r/f.get(t,t);for(let i=t;i<n;i++)f.set(i,e,f.get(i,e)+r*f.get(i,t))}for(let e=t;e<n;e++)f.set(e,t,-f.get(e,t));f.set(t,t,1+f.get(t,t));for(let e=0;e<t-1;e++)f.set(e,t,0)}else{for(let e=0;e<n;e++)f.set(e,t,0);f.set(t,t,1)}}if(c)for(let t=r-1;t>=0;t--){if(t<w&&0!==p[t])for(let e=t+1;e<r;e++){let n=0;for(let i=t+1;i<r;i++)n+=g.get(i,t)*g.get(i,e);n=-n/g.get(t+1,t);for(let i=t+1;i<r;i++)g.set(i,e,g.get(i,e)+n*g.get(i,t))}for(let e=0;e<r;e++)g.set(e,t,0);g.set(t,t,1)}let E=b-1,x=Number.EPSILON;for(;b>0;){let t,e;for(t=b-2;t>=-1&&-1!==t;t--){const e=Number.MIN_VALUE+x*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(p[t])<=e||Number.isNaN(p[t])){p[t]=0;break}}if(t===b-2)e=4;else{let n;for(n=b-1;n>=t&&n!==t;n--){let e=(n!==b?Math.abs(p[n]):0)+(n!==t+1?Math.abs(p[n-1]):0);if(Math.abs(d[n])<=x*e){d[n]=0;break}}n===t?e=3:n===b-1?e=1:(e=2,t=n)}switch(t++,e){case 1:{let e=p[b-2];p[b-2]=0;for(let n=b-2;n>=t;n--){let i=NM(d[n],e),A=d[n]/i,o=e/i;if(d[n]=i,n!==t&&(e=-o*p[n-1],p[n-1]=A*p[n-1]),c)for(let t=0;t<r;t++)i=A*g.get(t,n)+o*g.get(t,b-1),g.set(t,b-1,-o*g.get(t,n)+A*g.get(t,b-1)),g.set(t,n,i)}break}case 2:{let e=p[t-1];p[t-1]=0;for(let r=t;r<b;r++){let i=NM(d[r],e),A=d[r]/i,o=e/i;if(d[r]=i,e=-o*p[r],p[r]=A*p[r],a)for(let e=0;e<n;e++)i=A*f.get(e,r)+o*f.get(e,t-1),f.set(e,t-1,-o*f.get(e,r)+A*f.get(e,t-1)),f.set(e,r,i)}break}case 3:{const e=Math.max(Math.abs(d[b-1]),Math.abs(d[b-2]),Math.abs(p[b-2]),Math.abs(d[t]),Math.abs(p[t])),i=d[b-1]/e,A=d[b-2]/e,o=p[b-2]/e,s=d[t]/e,l=p[t]/e,u=((A+i)*(A-i)+o*o)/2,h=i*o*(i*o);let v=0;0===u&&0===h||(v=u<0?0-Math.sqrt(u*u+h):Math.sqrt(u*u+h),v=h/(u+v));let m=(s+i)*(s-i)+v,y=s*l;for(let e=t;e<b-1;e++){let i=NM(m,y);0===i&&(i=Number.MIN_VALUE);let A=m/i,o=y/i;if(e!==t&&(p[e-1]=i),m=A*d[e]+o*p[e],p[e]=A*p[e]-o*d[e],y=o*d[e+1],d[e+1]=A*d[e+1],c)for(let t=0;t<r;t++)i=A*g.get(t,e)+o*g.get(t,e+1),g.set(t,e+1,-o*g.get(t,e)+A*g.get(t,e+1)),g.set(t,e,i);if(i=NM(m,y),0===i&&(i=Number.MIN_VALUE),A=m/i,o=y/i,d[e]=i,m=A*p[e]+o*d[e+1],d[e+1]=-o*p[e]+A*d[e+1],y=o*p[e+1],p[e+1]=A*p[e+1],a&&e<n-1)for(let t=0;t<n;t++)i=A*f.get(t,e)+o*f.get(t,e+1),f.set(t,e+1,-o*f.get(t,e)+A*f.get(t,e+1)),f.set(t,e,i)}p[b-2]=m;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,c))for(let e=0;e<=E;e++)g.set(e,t,-g.get(e,t));for(;t<E&&!(d[t]>=d[t+1]);){let e=d[t];if(d[t]=d[t+1],d[t+1]=e,c&&t<r-1)for(let n=0;n<r;n++)e=g.get(n,t+1),g.set(n,t+1,g.get(n,t)),g.set(n,t,e);if(a&&t<n-1)for(let r=0;r<n;r++)e=f.get(r,t+1),f.set(r,t+1,f.get(r,t)),f.set(r,t,e);t++}b--}}if(l){let t=g;g=f,f=t}this.m=n,this.n=r,this.s=d,this.U=f,this.V=g}solve(t){let e=t,n=this.threshold,r=this.s.length,i=FM.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=n?i.set(t,t,0):i.set(t,t,1/this.s[t]);let A=this.U,o=this.rightSingularVectors,s=o.mmul(i),a=o.rows,c=A.rows,l=FM.zeros(a,c);for(let t=0;t<a;t++)for(let e=0;e<c;e++){let n=0;for(let i=0;i<r;i++)n+=s.get(t,i)*A.get(e,i);l.set(t,e,n)}return l.mmul(e)}solveForDiagonal(t){return this.solve(FM.diag(t))}inverse(){let t=this.V,e=this.threshold,n=t.rows,r=t.columns,i=new FM(n,this.s.length);for(let A=0;A<n;A++)for(let n=0;n<r;n++)Math.abs(this.s[n])>e&&i.set(A,n,t.get(A,n)/this.s[n]);let A=this.U,o=A.rows,s=A.columns,a=new FM(n,o);for(let t=0;t<n;t++)for(let e=0;e<o;e++){let n=0;for(let r=0;r<s;r++)n+=i.get(t,r)*A.get(e,r);a.set(t,e,n)}return a}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,n=this.s;for(let r=0,i=n.length;r<i;r++)n[r]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return FM.diag(this.s)}};function DM(t,e,n=!1){return t=TM.checkMatrix(t),e=TM.checkMatrix(e),n?new LM(t).solve(e):t.isSquare()?new OM(t).solve(e):new IM(t).solve(e)}function PM(t,e){let n=[];for(let r=0;r<t;r++)r!==e&&n.push(r);return n}function RM(t,e,n,r=1e-9,i=1e-9){if(t>i)return new Array(e.rows+1).fill(0);{let t=e.addRow(n,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<r&&t.set(e,0,0);return t.to1DArray()}}class HM{constructor(t,e={}){const{assumeSymmetric:n=!1}=e;if(!(t=TM.checkMatrix(t)).isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let r,i,A=t.columns,o=new FM(A,A),s=new Float64Array(A),a=new Float64Array(A),c=t,l=!1;if(l=!!n||t.isSymmetric(),l){for(r=0;r<A;r++)for(i=0;i<A;i++)o.set(r,i,c.get(r,i));!function(t,e,n,r){let i,A,o,s,a,c,l,u;for(a=0;a<t;a++)n[a]=r.get(t-1,a);for(s=t-1;s>0;s--){for(u=0,o=0,c=0;c<s;c++)u+=Math.abs(n[c]);if(0===u)for(e[s]=n[s-1],a=0;a<s;a++)n[a]=r.get(s-1,a),r.set(s,a,0),r.set(a,s,0);else{for(c=0;c<s;c++)n[c]/=u,o+=n[c]*n[c];for(i=n[s-1],A=Math.sqrt(o),i>0&&(A=-A),e[s]=u*A,o-=i*A,n[s-1]=i-A,a=0;a<s;a++)e[a]=0;for(a=0;a<s;a++){for(i=n[a],r.set(a,s,i),A=e[a]+r.get(a,a)*i,c=a+1;c<=s-1;c++)A+=r.get(c,a)*n[c],e[c]+=r.get(c,a)*i;e[a]=A}for(i=0,a=0;a<s;a++)e[a]/=o,i+=e[a]*n[a];for(l=i/(o+o),a=0;a<s;a++)e[a]-=l*n[a];for(a=0;a<s;a++){for(i=n[a],A=e[a],c=a;c<=s-1;c++)r.set(c,a,r.get(c,a)-(i*e[c]+A*n[c]));n[a]=r.get(s-1,a),r.set(s,a,0)}}n[s]=o}for(s=0;s<t-1;s++){if(r.set(t-1,s,r.get(s,s)),r.set(s,s,1),o=n[s+1],0!==o){for(c=0;c<=s;c++)n[c]=r.get(c,s+1)/o;for(a=0;a<=s;a++){for(A=0,c=0;c<=s;c++)A+=r.get(c,s+1)*r.get(c,a);for(c=0;c<=s;c++)r.set(c,a,r.get(c,a)-A*n[c])}}for(c=0;c<=s;c++)r.set(c,s+1,0)}for(a=0;a<t;a++)n[a]=r.get(t-1,a),r.set(t-1,a,0);r.set(t-1,t-1,1),e[0]=0}(A,a,s,o),function(t,e,n,r){let i,A,o,s,a,c,l,u,h,d,f,g,p,v,m,y;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let w=0,B=0,b=Number.EPSILON;for(c=0;c<t;c++){for(B=Math.max(B,Math.abs(n[c])+Math.abs(e[c])),l=c;l<t&&!(Math.abs(e[l])<=b*B);)l++;if(l>c)do{for(i=n[c],u=(n[c+1]-i)/(2*e[c]),h=NM(u,1),u<0&&(h=-h),n[c]=e[c]/(u+h),n[c+1]=e[c]*(u+h),d=n[c+1],A=i-n[c],o=c+2;o<t;o++)n[o]-=A;for(w+=A,u=n[l],f=1,g=f,p=f,v=e[c+1],m=0,y=0,o=l-1;o>=c;o--)for(p=g,g=f,y=m,i=f*e[o],A=f*u,h=NM(u,e[o]),e[o+1]=m*h,m=e[o]/h,f=u/h,u=f*n[o]-m*i,n[o+1]=A+m*(f*i+m*n[o]),a=0;a<t;a++)A=r.get(a,o+1),r.set(a,o+1,m*r.get(a,o)+f*A),r.set(a,o,f*r.get(a,o)-m*A);u=-m*y*p*v*e[c]/d,e[c]=m*u,n[c]=f*u}while(Math.abs(e[c])>b*B);n[c]=n[c]+w,e[c]=0}for(o=0;o<t-1;o++){for(a=o,u=n[o],s=o+1;s<t;s++)n[s]<u&&(a=s,u=n[s]);if(a!==o)for(n[a]=n[o],n[o]=u,s=0;s<t;s++)u=r.get(s,o),r.set(s,o,r.get(s,a)),r.set(s,a,u)}}(A,a,s,o)}else{let t=new FM(A,A),e=new Float64Array(A);for(i=0;i<A;i++)for(r=0;r<A;r++)t.set(r,i,c.get(r,i));!function(t,e,n,r){let i,A,o,s,a,c,l,u=0,h=t-1;for(c=u+1;c<=h-1;c++){for(l=0,s=c;s<=h;s++)l+=Math.abs(e.get(s,c-1));if(0!==l){for(o=0,s=h;s>=c;s--)n[s]=e.get(s,c-1)/l,o+=n[s]*n[s];for(A=Math.sqrt(o),n[c]>0&&(A=-A),o-=n[c]*A,n[c]=n[c]-A,a=c;a<t;a++){for(i=0,s=h;s>=c;s--)i+=n[s]*e.get(s,a);for(i/=o,s=c;s<=h;s++)e.set(s,a,e.get(s,a)-i*n[s])}for(s=0;s<=h;s++){for(i=0,a=h;a>=c;a--)i+=n[a]*e.get(s,a);for(i/=o,a=c;a<=h;a++)e.set(s,a,e.get(s,a)-i*n[a])}n[c]=l*n[c],e.set(c,c-1,l*A)}}for(s=0;s<t;s++)for(a=0;a<t;a++)r.set(s,a,s===a?1:0);for(c=h-1;c>=u+1;c--)if(0!==e.get(c,c-1)){for(s=c+1;s<=h;s++)n[s]=e.get(s,c-1);for(a=c;a<=h;a++){for(A=0,s=c;s<=h;s++)A+=n[s]*r.get(s,a);for(A=A/n[c]/e.get(c,c-1),s=c;s<=h;s++)r.set(s,a,r.get(s,a)+A*n[s])}}}(A,t,e,o),function(t,e,n,r,i){let A,o,s,a,c,l,u,h,d,f,g,p,v,m,y,w=t-1,B=0,b=t-1,E=Number.EPSILON,x=0,C=0,F=0,M=0,k=0,Q=0,S=0,U=0;for(A=0;A<t;A++)for((A<B||A>b)&&(n[A]=i.get(A,A),e[A]=0),o=Math.max(A-1,0);o<t;o++)C+=Math.abs(i.get(A,o));for(;w>=B;){for(a=w;a>B&&(Q=Math.abs(i.get(a-1,a-1))+Math.abs(i.get(a,a)),0===Q&&(Q=C),!(Math.abs(i.get(a,a-1))<E*Q));)a--;if(a===w)i.set(w,w,i.get(w,w)+x),n[w]=i.get(w,w),e[w]=0,w--,U=0;else if(a===w-1){if(u=i.get(w,w-1)*i.get(w-1,w),F=(i.get(w-1,w-1)-i.get(w,w))/2,M=F*F+u,S=Math.sqrt(Math.abs(M)),i.set(w,w,i.get(w,w)+x),i.set(w-1,w-1,i.get(w-1,w-1)+x),h=i.get(w,w),M>=0){for(S=F>=0?F+S:F-S,n[w-1]=h+S,n[w]=n[w-1],0!==S&&(n[w]=h-u/S),e[w-1]=0,e[w]=0,h=i.get(w,w-1),Q=Math.abs(h)+Math.abs(S),F=h/Q,M=S/Q,k=Math.sqrt(F*F+M*M),F/=k,M/=k,o=w-1;o<t;o++)S=i.get(w-1,o),i.set(w-1,o,M*S+F*i.get(w,o)),i.set(w,o,M*i.get(w,o)-F*S);for(A=0;A<=w;A++)S=i.get(A,w-1),i.set(A,w-1,M*S+F*i.get(A,w)),i.set(A,w,M*i.get(A,w)-F*S);for(A=B;A<=b;A++)S=r.get(A,w-1),r.set(A,w-1,M*S+F*r.get(A,w)),r.set(A,w,M*r.get(A,w)-F*S)}else n[w-1]=h+F,n[w]=h+F,e[w-1]=S,e[w]=-S;w-=2,U=0}else{if(h=i.get(w,w),d=0,u=0,a<w&&(d=i.get(w-1,w-1),u=i.get(w,w-1)*i.get(w-1,w)),10===U){for(x+=h,A=B;A<=w;A++)i.set(A,A,i.get(A,A)-h);Q=Math.abs(i.get(w,w-1))+Math.abs(i.get(w-1,w-2)),h=d=.75*Q,u=-.4375*Q*Q}if(30===U&&(Q=(d-h)/2,Q=Q*Q+u,Q>0)){for(Q=Math.sqrt(Q),d<h&&(Q=-Q),Q=h-u/((d-h)/2+Q),A=B;A<=w;A++)i.set(A,A,i.get(A,A)-Q);x+=Q,h=d=u=.964}for(U+=1,c=w-2;c>=a&&(S=i.get(c,c),k=h-S,Q=d-S,F=(k*Q-u)/i.get(c+1,c)+i.get(c,c+1),M=i.get(c+1,c+1)-S-k-Q,k=i.get(c+2,c+1),Q=Math.abs(F)+Math.abs(M)+Math.abs(k),F/=Q,M/=Q,k/=Q,c!==a)&&!(Math.abs(i.get(c,c-1))*(Math.abs(M)+Math.abs(k))<E*(Math.abs(F)*(Math.abs(i.get(c-1,c-1))+Math.abs(S)+Math.abs(i.get(c+1,c+1)))));)c--;for(A=c+2;A<=w;A++)i.set(A,A-2,0),A>c+2&&i.set(A,A-3,0);for(s=c;s<=w-1&&(m=s!==w-1,s!==c&&(F=i.get(s,s-1),M=i.get(s+1,s-1),k=m?i.get(s+2,s-1):0,h=Math.abs(F)+Math.abs(M)+Math.abs(k),0!==h&&(F/=h,M/=h,k/=h)),0!==h);s++)if(Q=Math.sqrt(F*F+M*M+k*k),F<0&&(Q=-Q),0!==Q){for(s!==c?i.set(s,s-1,-Q*h):a!==c&&i.set(s,s-1,-i.get(s,s-1)),F+=Q,h=F/Q,d=M/Q,S=k/Q,M/=F,k/=F,o=s;o<t;o++)F=i.get(s,o)+M*i.get(s+1,o),m&&(F+=k*i.get(s+2,o),i.set(s+2,o,i.get(s+2,o)-F*S)),i.set(s,o,i.get(s,o)-F*h),i.set(s+1,o,i.get(s+1,o)-F*d);for(A=0;A<=Math.min(w,s+3);A++)F=h*i.get(A,s)+d*i.get(A,s+1),m&&(F+=S*i.get(A,s+2),i.set(A,s+2,i.get(A,s+2)-F*k)),i.set(A,s,i.get(A,s)-F),i.set(A,s+1,i.get(A,s+1)-F*M);for(A=B;A<=b;A++)F=h*r.get(A,s)+d*r.get(A,s+1),m&&(F+=S*r.get(A,s+2),r.set(A,s+2,r.get(A,s+2)-F*k)),r.set(A,s,r.get(A,s)-F),r.set(A,s+1,r.get(A,s+1)-F*M)}}}if(0===C)return;for(w=t-1;w>=0;w--)if(F=n[w],M=e[w],0===M)for(a=w,i.set(w,w,1),A=w-1;A>=0;A--){for(u=i.get(A,A)-F,k=0,o=a;o<=w;o++)k+=i.get(A,o)*i.get(o,w);if(e[A]<0)S=u,Q=k;else if(a=A,0===e[A]?i.set(A,w,0!==u?-k/u:-k/(E*C)):(h=i.get(A,A+1),d=i.get(A+1,A),M=(n[A]-F)*(n[A]-F)+e[A]*e[A],l=(h*Q-S*k)/M,i.set(A,w,l),i.set(A+1,w,Math.abs(h)>Math.abs(S)?(-k-u*l)/h:(-Q-d*l)/S)),l=Math.abs(i.get(A,w)),E*l*l>1)for(o=A;o<=w;o++)i.set(o,w,i.get(o,w)/l)}else if(M<0)for(a=w-1,Math.abs(i.get(w,w-1))>Math.abs(i.get(w-1,w))?(i.set(w-1,w-1,M/i.get(w,w-1)),i.set(w-1,w,-(i.get(w,w)-F)/i.get(w,w-1))):(y=_M(0,-i.get(w-1,w),i.get(w-1,w-1)-F,M),i.set(w-1,w-1,y[0]),i.set(w-1,w,y[1])),i.set(w,w-1,0),i.set(w,w,1),A=w-2;A>=0;A--){for(f=0,g=0,o=a;o<=w;o++)f+=i.get(A,o)*i.get(o,w-1),g+=i.get(A,o)*i.get(o,w);if(u=i.get(A,A)-F,e[A]<0)S=u,k=f,Q=g;else if(a=A,0===e[A]?(y=_M(-f,-g,u,M),i.set(A,w-1,y[0]),i.set(A,w,y[1])):(h=i.get(A,A+1),d=i.get(A+1,A),p=(n[A]-F)*(n[A]-F)+e[A]*e[A]-M*M,v=2*(n[A]-F)*M,0===p&&0===v&&(p=E*C*(Math.abs(u)+Math.abs(M)+Math.abs(h)+Math.abs(d)+Math.abs(S))),y=_M(h*k-S*f+M*g,h*Q-S*g-M*f,p,v),i.set(A,w-1,y[0]),i.set(A,w,y[1]),Math.abs(h)>Math.abs(S)+Math.abs(M)?(i.set(A+1,w-1,(-f-u*i.get(A,w-1)+M*i.get(A,w))/h),i.set(A+1,w,(-g-u*i.get(A,w)-M*i.get(A,w-1))/h)):(y=_M(-k-d*i.get(A,w-1),-Q-d*i.get(A,w),S,M),i.set(A+1,w-1,y[0]),i.set(A+1,w,y[1]))),l=Math.max(Math.abs(i.get(A,w-1)),Math.abs(i.get(A,w))),E*l*l>1)for(o=A;o<=w;o++)i.set(o,w-1,i.get(o,w-1)/l),i.set(o,w,i.get(o,w)/l)}for(A=0;A<t;A++)if(A<B||A>b)for(o=A;o<t;o++)r.set(A,o,i.get(A,o));for(o=t-1;o>=B;o--)for(A=B;A<=b;A++){for(S=0,s=B;s<=Math.min(o,b);s++)S+=r.get(A,s)*i.get(s,o);r.set(A,o,S)}}(A,a,s,o,t)}this.n=A,this.e=a,this.d=s,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,n=this.n,r=this.e,i=this.d,A=new FM(n,n);for(t=0;t<n;t++){for(e=0;e<n;e++)A.set(t,e,0);A.set(t,t,i[t]),r[t]>0?A.set(t,t+1,r[t]):r[t]<0&&A.set(t,t-1,r[t])}return A}}function _M(t,e,n,r){let i,A;return Math.abs(n)>Math.abs(r)?(i=r/n,A=n+i*r,[(t+i*e)/A,(e-i*t)/A]):(i=n/r,A=r+i*n,[(i*t+e)/A,(i*e-t)/A])}class GM{constructor(t){if(!(t=TM.checkMatrix(t)).isSymmetric())throw new Error("Matrix is not symmetric");let e,n,r,i=t,A=i.rows,o=new FM(A,A),s=!0;for(n=0;n<A;n++){let t=0;for(r=0;r<n;r++){let A=0;for(e=0;e<r;e++)A+=o.get(r,e)*o.get(n,e);A=(i.get(n,r)-A)/o.get(r,r),o.set(n,r,A),t+=A*A}for(t=i.get(n,n)-t,s&&=t>0,o.set(n,n,Math.sqrt(Math.max(t,0))),r=n+1;r<A;r++)o.set(n,r,0)}this.L=o,this.positiveDefinite=s}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=TM.checkMatrix(t);let e=this.L,n=e.rows;if(t.rows!==n)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let r,i,A,o=t.columns,s=t.clone();for(A=0;A<n;A++)for(i=0;i<o;i++){for(r=0;r<A;r++)s.set(A,i,s.get(A,i)-s.get(r,i)*e.get(A,r));s.set(A,i,s.get(A,i)/e.get(A,A))}for(A=n-1;A>=0;A--)for(i=0;i<o;i++){for(r=A+1;r<n;r++)s.set(A,i,s.get(A,i)-s.get(r,i)*e.get(r,A));s.set(A,i,s.get(A,i)/e.get(A,A))}return s}get lowerTriangularMatrix(){return this.L}}class KM{constructor(t,e={}){t=TM.checkMatrix(t);let{Y:n}=e;const{scaleScores:r=!1,maxIterations:i=1e3,terminationCriteria:A=1e-10}=e;let o;if(n){if(n=oM.isAnyArray(n)&&"number"==typeof n[0]?FM.columnVector(n):TM.checkMatrix(n),n.rows!==t.rows)throw new Error("Y should have the same number of rows as X");o=n.getColumnVector(0)}else o=t.getColumnVector(0);let s,a,c,l,u=1;for(let e=0;e<i&&u>A;e++)c=t.transpose().mmul(o).div(o.transpose().mmul(o).get(0,0)),c=c.div(c.norm()),s=t.mmul(c).div(c.transpose().mmul(c).get(0,0)),e>0&&(u=s.clone().sub(l).pow(2).sum()),l=s.clone(),n?(a=n.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),a=a.div(a.norm()),o=n.mmul(a).div(a.transpose().mmul(a).get(0,0))):o=s;if(n){let e=t.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0));e=e.div(e.norm());let r=t.clone().sub(s.clone().mmul(e.transpose())),i=o.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),A=n.clone().sub(s.clone().mulS(i.get(0,0)).mmul(a.transpose()));this.t=s,this.p=e.transpose(),this.w=c.transpose(),this.q=a,this.u=o,this.s=s.transpose().mmul(s),this.xResidual=r,this.yResidual=A,this.betas=i}else this.w=c.transpose(),this.s=s.transpose().mmul(s).sqrt(),this.t=r?s.clone().div(this.s.get(0,0)):s,this.xResidual=t.sub(s.mmul(c.transpose()))}}tM.AbstractMatrix=EM,tM.CHO=GM,tM.CholeskyDecomposition=GM,tM.DistanceMatrix=kM,tM.EVD=HM,tM.EigenvalueDecomposition=HM,tM.LU=OM,tM.LuDecomposition=OM;var jM=tM.Matrix=FM;tM.MatrixColumnSelectionView=class extends QM{constructor(t,e){mM(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,n){return this.matrix.set(t,this.columnIndices[e],n),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},tM.MatrixColumnView=class extends QM{constructor(t,e){fM(t,e),super(t,t.rows,1),this.column=e}set(t,e,n){return this.matrix.set(t,this.column,n),this}get(t){return this.matrix.get(t,this.column)}},tM.MatrixFlipColumnView=class extends QM{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(t,this.columns-e-1,n),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},tM.MatrixFlipRowView=class extends QM{constructor(t){super(t,t.rows,t.columns)}set(t,e,n){return this.matrix.set(this.rows-t-1,e,n),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},tM.MatrixRowSelectionView=class extends QM{constructor(t,e){vM(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,n){return this.matrix.set(this.rowIndices[t],e,n),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},tM.MatrixRowView=class extends QM{constructor(t,e){dM(t,e),super(t,1,t.columns),this.row=e}set(t,e,n){return this.matrix.set(this.row,e,n),this}get(t,e){return this.matrix.get(this.row,e)}},tM.MatrixSelectionView=SM,tM.MatrixSubView=class extends QM{constructor(t,e,n,r,i){yM(t,e,n,r,i),super(t,n-e+1,i-r+1),this.startRow=e,this.startColumn=r}set(t,e,n){return this.matrix.set(this.startRow+t,this.startColumn+e,n),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},tM.MatrixTransposeView=class extends QM{constructor(t){super(t,t.columns,t.rows)}set(t,e,n){return this.matrix.set(e,t,n),this}get(t,e){return this.matrix.get(e,t)}},tM.NIPALS=KM,tM.Nipals=KM,tM.QR=IM,tM.QrDecomposition=IM,tM.SVD=LM;var VM=tM.SingularValueDecomposition=LM;tM.SymmetricMatrix=MM,tM.WrapperMatrix1D=UM,tM.WrapperMatrix2D=TM,tM.correlation=function(t,e=t,n={}){t=new FM(t);let r=!1;if("object"!=typeof e||FM.isMatrix(e)||oM.isAnyArray(e)?e=new FM(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0,scale:A=!0}=n;i&&(t.center("column"),r||e.center("column")),A&&(t.scale("column"),r||e.scale("column"));const o=t.standardDeviation("column",{unbiased:!0}),s=r?o:e.standardDeviation("column",{unbiased:!0}),a=t.transpose().mmul(e);for(let e=0;e<a.rows;e++)for(let n=0;n<a.columns;n++)a.set(e,n,a.get(e,n)*(1/(o[e]*s[n]))*(1/(t.rows-1)));return a},tM.covariance=function(t,e=t,n={}){t=new FM(t);let r=!1;if("object"!=typeof e||FM.isMatrix(e)||oM.isAnyArray(e)?e=new FM(e):(n=e,e=t,r=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:i=!0}=n;i&&(t=t.center("column"),r||(e=e.center("column")));const A=t.transpose().mmul(e);for(let e=0;e<A.rows;e++)for(let n=0;n<A.columns;n++)A.set(e,n,A.get(e,n)*(1/(t.rows-1)));return A};var zM=tM.default=FM;tM.determinant=function t(e){if((e=FM.checkMatrix(e)).isSquare()){if(0===e.columns)return 1;let n,r,i,A;if(2===e.columns)return n=e.get(0,0),r=e.get(0,1),i=e.get(1,0),A=e.get(1,1),n*A-r*i;if(3===e.columns){let A,o,s;return A=new SM(e,[1,2],[1,2]),o=new SM(e,[1,2],[0,2]),s=new SM(e,[1,2],[0,1]),n=e.get(0,0),r=e.get(0,1),i=e.get(0,2),n*t(A)-r*t(o)+i*t(s)}return new OM(e).determinant}throw Error("determinant can only be calculated for a square matrix")},tM.inverse=function(t,e=!1){return t=TM.checkMatrix(t),e?new LM(t).inverse():DM(t,FM.eye(t.rows))},tM.linearDependencies=function(t,e={}){const{thresholdValue:n=1e-9,thresholdError:r=1e-9}=e;let i=(t=FM.checkMatrix(t)).rows,A=new FM(i,i);for(let e=0;e<i;e++){let o=FM.columnVector(t.getRow(e)),s=t.subMatrixRow(PM(i,e)).transpose(),a=new LM(s).solve(o),c=FM.sub(o,s.mmul(a)).abs().max();A.setRow(e,RM(c,a,e,n,r))}return A},tM.pseudoInverse=function(t,e=Number.EPSILON){if((t=FM.checkMatrix(t)).isEmpty())return t.transpose();let n=new LM(t,{autoTranspose:!0}),r=n.leftSingularVectors,i=n.rightSingularVectors,A=n.diagonal;for(let t=0;t<A.length;t++)Math.abs(A[t])>e?A[t]=1/A[t]:A[t]=0;return i.mmul(FM.diag(A).mmul(r.transpose()))},tM.solve=DM,tM.wrap=function(t,e){if(oM.isAnyArray(t))return t[0]&&oM.isAnyArray(t[0])?new TM(t):new UM(t,e);throw new Error("the argument is not an array")};const WM=jM,YM=VM;zM.Matrix&&zM.Matrix;const XM={center:[0,0],linkDistance:50};class qM{constructor(t={}){this.options=t,this.id="mds",this.options=Object.assign(Object.assign({},XM),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,t,e)})}genericMDSLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),{center:i=[0,0],linkDistance:A=50}=r,o=e.getAllNodes(),s=e.getAllEdges();if(!(null==o?void 0:o.length)||1===o.length)return yF(e,t,i);const a=sF({nodes:o,edges:s}),c=oF(a);ZM(c);const l=((t,e)=>{const n=[];return t.forEach(t=>{const r=[];t.forEach(t=>{r.push(t*e)}),n.push(r)}),n})(c,A),u=JM(l),h=[];u.forEach((t,e)=>{const n=uF(o[e]);n.data.x=t[0]+i[0],n.data.y=t[1]+i[1],h.push(n)}),t&&h.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}));return{nodes:h,edges:s}})}}const ZM=t=>{let e=-999999;t.forEach(t=>{t.forEach(t=>{t!==1/0&&e<t&&(e=t)})}),t.forEach((n,r)=>{n.forEach((n,i)=>{n===1/0&&(t[r][i]=e)})})},JM=t=>{const e=WM.mul(WM.pow(t,2),-.5),n=e.mean("row"),r=e.mean("column"),i=e.mean();e.add(i).subRowVector(n).subColumnVector(r);const A=new YM(e),o=WM.sqrt(A.diagonalMatrix).diagonal();return A.leftSingularVectors.toJSON().map(t=>WM.mul([t],[o]).toJSON()[0].splice(0,2))};function $M(t){return!!t.tick&&!!t.stop}const tk={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},ek={center:[0,0],comboPadding:10,treeKey:"combo"};class nk{constructor(t={}){this.options=t,this.id="comboCombined",this.options=Object.assign(Object.assign({},ek),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,t,e)})}genericComboCombinedLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:i,treeKey:A,outerLayout:o}=r,s=e.getAllNodes().filter(t=>!t.data._isCombo),a=e.getAllNodes().filter(t=>t.data._isCombo),c=e.getAllEdges(),l=null==s?void 0:s.length;if(!l||1===l)return yF(e,t,i);const u=[],h=new Map;s.forEach(t=>{h.set(t.id,t)});const d=new Map;a.forEach(t=>{d.set(t.id,t)});const f=new Map,g=this.getInnerGraphs(e,A,h,d,c,r,f);yield Promise.all(g);const p=new Map,v=[],m=new Map;let y=!0;e.getRoots(A).forEach(t=>{const n=f.get(t.id),r=d.get(t.id)||h.get(t.id),i={id:t.id,data:Object.assign(Object.assign({},t.data),{x:n.data.x||r.data.x,y:n.data.y||r.data.y,fx:n.data.fx||r.data.fx,fy:n.data.fy||r.data.fy,mass:n.data.mass||r.data.mass,size:n.data.size})};v.push(i),p.set(t.id,!0),isNaN(i.data.x)||0===i.data.x||isNaN(i.data.y)||0===i.data.y?(i.data.x=100*Math.random(),i.data.y=100*Math.random()):y=!1,cF(e,[t],e=>{e.id!==t.id&&m.set(e.id,t.id)},"TB",A)});const w=[];let B;if(c.forEach(t=>{const e=m.get(t.source)||t.source,n=m.get(t.target)||t.target;e!==n&&p.has(e)&&p.has(n)&&w.push({id:t.id,source:e,target:n,data:{}})}),null==v?void 0:v.length){if(1===v.length)v[0].data.x=i[0],v[0].data.y=i[1];else{const t=new fE({nodes:v,edges:w}),e=o||new YF;if(y&&tk[e.id]){const e=v.length<100?new qM:new CF;yield e.assign(t)}const n=Object.assign({center:i,kg:5,preventOverlap:!0,animate:!1},"force"===e.id?{gravity:1,factor:4,linkDistance:(t,e,n)=>(Math.max(...e.data.size)||32)/2+(Math.max(...n.data.size)||32)/2+200}:{});B=yield rk(e,t,n)}f.forEach(t=>{var e;const n=B.nodes.find(e=>e.id===t.id);if(n){const{x:e,y:r}=n.data;t.data.visited=!0,t.data.x=e,t.data.y=r,u.push({id:t.id,data:{x:e,y:r}})}const{x:r,y:i}=t.data;null===(e=t.data.nodes)||void 0===e||e.forEach(t=>{u.push({id:t.id,data:{x:t.data.x+r,y:t.data.y+i}})})}),f.forEach(({data:t})=>{const{x:e,y:n,visited:r,nodes:i}=t;null==i||i.forEach(t=>{if(!r){const r=u.find(e=>e.id===t.id);r.data.x+=e||0,r.data.y+=n||0}})})}t&&u.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})});return{nodes:u,edges:c}})}initVals(t){const e=Object.assign({},t),{nodeSize:n,spacing:r,comboPadding:i}=t;let A,o,s;if(o=oe(r)?()=>r:Vt(r)?r:()=>0,e.spacing=o,n)if(Vt(n))A=t=>{const e=n(t),r=o(t);if(AF(t.size)){return((t.size[0]>t.size[1]?t.size[0]:t.size[1])+r)/2}return((e||32)+r)/2};else if(AF(n)){const t=(n[0]>n[1]?n[0]:n[1])/2;A=e=>t+o(e)/2}else{const t=n/2;A=e=>t+o(e)/2}else A=t=>{const e=o(t);if(t.size){if(AF(t.size)){return((t.size[0]>t.size[1]?t.size[0]:t.size[1])+e)/2}if(Yt(t.size)){return((t.size.width>t.size.height?t.size.width:t.size.height)+e)/2}return(t.size+e)/2}return 32+e/2};return e.nodeSize=A,s=oe(i)?()=>i:AF(i)?()=>Math.max.apply(null,i):Vt(i)?i:()=>0,e.comboPadding=s,e}getInnerGraphs(t,e,n,r,i,A,o){const{nodeSize:s,comboPadding:a,spacing:c,innerLayout:l}=A,u=l||new CF({}),h={center:[0,0],preventOverlap:!0,nodeSpacing:c},d=[],f=t=>{let e=(null==a?void 0:a(t))||10;return AF(e)&&(e=Math.max(...e)),{size:e?[2*e,2*e]:[30,30],padding:e}};return t.getRoots(e).forEach(A=>{o.set(A.id,{id:A.id,data:{nodes:[],size:f(A).size}});let a=Promise.resolve();cF(t,[A],A=>{var c;if(!A.data._isCombo)return;const{size:l,padding:d}=f(A);if(null===(c=t.getChildren(A.id,e))||void 0===c?void 0:c.length){const c=o.get(A.id);o.set(A.id,{id:A.id,data:Object.assign({nodes:[]},null==c?void 0:c.data)});const l=new Map,f=t.getChildren(A.id,e).map(t=>{if(t.data._isCombo)return o.has(t.id)||o.set(t.id,{id:t.id,data:Object.assign({},t.data)}),l.set(t.id,!0),o.get(t.id);const e=n.get(t.id)||r.get(t.id);return l.set(t.id,!0),{id:t.id,data:Object.assign(Object.assign({},e.data),t.data)}}),g={nodes:f,edges:i.filter(t=>l.has(t.source)&&l.has(t.target))};let p=1/0;f.forEach(t=>{var e;let{size:n}=t.data;n||(n=(null===(e=o.get(t.id))||void 0===e?void 0:e.data.size)||(null==s?void 0:s(t))||[30,30]),oe(n)&&(n=[n,n]);const[r,i]=n;p>r&&(p=r),p>i&&(p=i),t.data.size=n}),a=a.then(()=>_e(this,void 0,void 0,function*(){const t=new fE(g);yield rk(u,t,h,!0);const{minX:e,minY:n,maxX:r,maxY:i}=(t=>{let e=1/0,n=1/0,r=-1/0,i=-1/0;return t.forEach(t=>{let A=t.data.size;AF(A)?1===A.length&&(A=[A[0],A[0]]):oe(A)?A=[A,A]:(void 0===A||isNaN(A))&&(A=[30,30]);const o=[A[0]/2,A[1]/2],s=t.data.x-o[0],a=t.data.x+o[0],c=t.data.y-o[1],l=t.data.y+o[1];e>s&&(e=s),n>c&&(n=c),r<a&&(r=a),i<l&&(i=l)}),{minX:e,minY:n,maxX:r,maxY:i}})(f),s=(r+e)/2,a=(i+n)/2;g.nodes.forEach(t=>{t.data.x-=s,t.data.y-=a});const c=[Math.max(r-e,p)+2*d,Math.max(i-n,p)+2*d];o.get(A.id).data.size=c,o.get(A.id).data.nodes=f}))}else o.set(A.id,{id:A.id,data:Object.assign(Object.assign({},A.data),{size:l})});return!0},"BT",e),d.push(a)}),d}}function rk(t,e,n,r){var i;return _e(this,void 0,void 0,function*(){return $M(t)?(t.execute(e,n),t.stop(),t.tick(null!==(i=n.iterations)&&void 0!==i?i:300)):r?yield t.assign(e,n):yield t.execute(e,n)})}function ik(t,e){var n,r=1;function i(){var i,A,o=n.length,s=0,a=0;for(i=0;i<o;++i)s+=(A=n[i]).x,a+=A.y;for(s=(s/o-t)*r,a=(a/o-e)*r,i=0;i<o;++i)(A=n[i]).x-=s,A.y-=a}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i}function Ak(t){return function(){return t}}function ok(t){return 1e-6*(t()-.5)}function sk(t){return t.x+t.vx}function ak(t){return t.y+t.vy}function ck(t){var e,n,r,i=1,A=1;function o(){for(var t,o,a,c,l,u,h,d=e.length,f=0;f<A;++f)for(o=SF(e,sk,ak).visitAfter(s),t=0;t<d;++t)a=e[t],u=n[a.index],h=u*u,c=a.x+a.vx,l=a.y+a.vy,o.visit(g);function g(t,e,n,A,o){var s=t.data,d=t.r,f=u+d;if(!s)return e>c+f||A<c-f||n>l+f||o<l-f;if(s.index>a.index){var g=c-s.x-s.vx,p=l-s.y-s.vy,v=g*g+p*p;v<f*f&&(0===g&&(v+=(g=ok(r))*g),0===p&&(v+=(p=ok(r))*p),v=(f-(v=Math.sqrt(v)))/v*i,a.vx+=(g*=v)*(f=(d*=d)/(h+d)),a.vy+=(p*=v)*f,s.vx-=g*(f=1-f),s.vy-=p*f)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function a(){if(e){var r,i,A=e.length;for(n=new Array(A),r=0;r<A;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=Ak(null==t?1:+t)),o.initialize=function(t,n){e=t,r=n,a()},o.iterations=function(t){return arguments.length?(A=+t,o):A},o.strength=function(t){return arguments.length?(i=+t,o):i},o.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ak(+e),a(),o):t},o}function lk(t){return t.index}function uk(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function hk(t){var e,n,r,i,A,o,s=lk,a=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=Ak(30),l=1;function u(r){for(var i=0,s=t.length;i<l;++i)for(var a,c,u,h,d,f,g,p=0;p<s;++p)c=(a=t[p]).source,h=(u=a.target).x+u.vx-c.x-c.vx||ok(o),d=u.y+u.vy-c.y-c.vy||ok(o),h*=f=((f=Math.sqrt(h*h+d*d))-n[p])/f*r*e[p],d*=f,u.vx-=h*(g=A[p]),u.vy-=d*g,c.vx+=h*(g=1-g),c.vy+=d*g}function h(){if(r){var o,a,c=r.length,l=t.length,u=new Map(r.map((t,e)=>[s(t,e,r),t]));for(o=0,i=new Array(c);o<l;++o)(a=t[o]).index=o,"object"!=typeof a.source&&(a.source=uk(u,a.source)),"object"!=typeof a.target&&(a.target=uk(u,a.target)),i[a.source.index]=(i[a.source.index]||0)+1,i[a.target.index]=(i[a.target.index]||0)+1;for(o=0,A=new Array(l);o<l;++o)a=t[o],A[o]=i[a.source.index]/(i[a.source.index]+i[a.target.index]);e=new Array(l),d(),n=new Array(l),f()}}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+a(t[n],n,t)}function f(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),u.initialize=function(t,e){r=t,o=e,h()},u.links=function(e){return arguments.length?(t=e,h(),u):t},u.id=function(t){return arguments.length?(s=t,u):s},u.iterations=function(t){return arguments.length?(l=+t,u):l},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:Ak(+t),d(),u):a},u.distance=function(t){return arguments.length?(c="function"==typeof t?t:Ak(+t),f(),u):c},u}var dk={value:()=>{}};function fk(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new gk(r)}function gk(t){this._=t}function pk(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function vk(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=dk,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}gk.prototype=fk.prototype={constructor:gk,on:function(t,e){var n,r,i=this._,A=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),o=-1,s=A.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=A[o]).type)i[n]=vk(i[n],t.name,e);else if(null==e)for(n in i)i[n]=vk(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=A[o]).type)&&(n=pk(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new gk(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),A=0;A<n;++A)i[A]=arguments[A+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(A=0,n=(r=this._[t]).length;A<n;++A)r[A].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,A=r.length;i<A;++i)r[i].value.apply(e,n)}};var mk,yk,wk=0,Bk=0,bk=0,Ek=0,xk=0,Ck=0,Fk="object"==typeof performance&&performance.now?performance:Date,Mk="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function kk(){return xk||(Mk(Qk),xk=Fk.now()+Ck)}function Qk(){xk=0}function Sk(){this._call=this._time=this._next=null}function Uk(t,e,n){var r=new Sk;return r.restart(t,e,n),r}function Tk(){xk=(Ek=Fk.now())+Ck,wk=Bk=0;try{!function(){kk(),++wk;for(var t,e=mk;e;)(t=xk-e._time)>=0&&e._call.call(void 0,t),e=e._next;--wk}()}finally{wk=0,function(){var t,e,n=mk,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:mk=e);yk=t,Nk(r)}(),xk=0}}function Ok(){var t=Fk.now(),e=t-Ek;e>1e3&&(Ck-=e,Ek=t)}function Nk(t){wk||(Bk&&(Bk=clearTimeout(Bk)),t-xk>24?(t<1/0&&(Bk=setTimeout(Tk,t-Fk.now()-Ck)),bk&&(bk=clearInterval(bk))):(bk||(Ek=Fk.now(),bk=setInterval(Ok,1e3)),wk=1,Mk(Tk)))}Sk.prototype=Uk.prototype={constructor:Sk,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?kk():+n)+(null==e?0:+e),this._next||yk===this||(yk?yk._next=this:mk=this,yk=this),this._call=t,this._time=n,Nk()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nk())}};const Ik=4294967296;function Lk(t){return t.x}function Dk(t){return t.y}var Pk=Math.PI*(3-Math.sqrt(5));function Rk(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),A=0,o=.6,s=new Map,a=Uk(u),c=fk("tick","end"),l=function(){let t=1;return()=>(t=(1664525*t+1013904223)%Ik)/Ik}();function u(){h(),c.call("tick",e),n<r&&(a.stop(),c.call("end",e))}function h(r){var a,c,l=t.length;void 0===r&&(r=1);for(var u=0;u<r;++u)for(n+=(A-n)*i,s.forEach(function(t){t(n)}),a=0;a<l;++a)null==(c=t[a]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return e}function d(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),A=n*Pk;e.x=i*Math.cos(A),e.y=i*Math.sin(A)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function f(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),d(),e={tick:h,restart:function(){return a.restart(u),e},stop:function(){return a.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),s.forEach(f),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(A=+t,e):A},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},randomSource:function(t){return arguments.length?(l=t,s.forEach(f),e):l},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,f(n)),e):s.get(t)},find:function(e,n,r){var i,A,o,s,a,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(o=(i=e-(s=t[c]).x)*i+(A=n-s.y)*A)<r&&(a=s,r=o);return a},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}function Hk(){var t,e,n,r,i,A=Ak(-30),o=1,s=1/0,a=.81;function c(n){var i,A=t.length,o=SF(t,Lk,Dk).visitAfter(u);for(r=n,i=0;i<A;++i)e=t[i],o.visit(h)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+A(n,e,t)}}function u(t){var e,n,r,A,o,s=0,a=0;if(t.length){for(r=A=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,a+=n,r+=n*e.x,A+=n*e.y);t.x=r/a,t.y=A/a}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function h(t,A,c,l){if(!t.value)return!0;var u=t.x-e.x,h=t.y-e.y,d=l-A,f=u*u+h*h;if(d*d/a<f)return f<s&&(0===u&&(f+=(u=ok(n))*u),0===h&&(f+=(h=ok(n))*h),f<o&&(f=Math.sqrt(o*f)),e.vx+=u*t.value*r/f,e.vy+=h*t.value*r/f),!0;if(!(t.length||f>=s)){(t.data!==e||t.next)&&(0===u&&(f+=(u=ok(n))*u),0===h&&(f+=(h=ok(n))*h),f<o&&(f=Math.sqrt(o*f)));do{t.data!==e&&(d=i[t.data.index]*r/f,e.vx+=u*d,e.vy+=h*d)}while(t=t.next)}}return c.initialize=function(e,r){t=e,n=r,l()},c.strength=function(t){return arguments.length?(A="function"==typeof t?t:Ak(+t),l(),c):A},c.distanceMin=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.distanceMax=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.theta=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c}function _k(t,e,n){var r,i,A,o=Ak(.1);function s(t){for(var o=0,s=r.length;o<s;++o){var a=r[o],c=a.x-e||1e-6,l=a.y-n||1e-6,u=Math.sqrt(c*c+l*l),h=(A[o]-u)*i[o]*t/u;a.vx+=c*h,a.vy+=l*h}}function a(){if(r){var e,n=r.length;for(i=new Array(n),A=new Array(n),e=0;e<n;++e)A[e]=+t(r[e],e,r),i[e]=isNaN(A[e])?0:+o(r[e],e,r)}}return"function"!=typeof t&&(t=Ak(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,a()},s.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ak(+t),a(),s):o},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ak(+e),a(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s}function Gk(t){var e,n,r,i=Ak(.1);function A(t){for(var i,A=0,o=e.length;A<o;++A)(i=e[A]).vx+=(r[A]-i.x)*n[A]*t}function o(){if(e){var A,o=e.length;for(n=new Array(o),r=new Array(o),A=0;A<o;++A)n[A]=isNaN(r[A]=+t(e[A],A,e))?0:+i(e[A],A,e)}}return"function"!=typeof t&&(t=Ak(null==t?0:+t)),A.initialize=function(t){e=t,o()},A.strength=function(t){return arguments.length?(i="function"==typeof t?t:Ak(+t),o(),A):i},A.x=function(e){return arguments.length?(t="function"==typeof e?e:Ak(+e),o(),A):t},A}function Kk(t){var e,n,r,i=Ak(.1);function A(t){for(var i,A=0,o=e.length;A<o;++A)(i=e[A]).vy+=(r[A]-i.y)*n[A]*t}function o(){if(e){var A,o=e.length;for(n=new Array(o),r=new Array(o),A=0;A<o;++A)n[A]=isNaN(r[A]=+t(e[A],A,e))?0:+i(e[A],A,e)}}return"function"!=typeof t&&(t=Ak(null==t?0:+t)),A.initialize=function(t){e=t,o()},A.strength=function(t){return arguments.length?(i="function"==typeof t?t:Ak(+t),o(),A):i},A.y=function(e){return arguments.length?(t="function"==typeof e?e:Ak(+e),o(),A):t},A}class jk{constructor(t){this.id="d3-force",this.config={inputNodeAttrs:["x","y","vx","vy","fx","fy"],outputNodeAttrs:["x","y","vx","vy"],simulationAttrs:["alpha","alphaMin","alphaDecay","alphaTarget","velocityDecay","randomSource"]},this.forceMap={link:hk,manyBody:Hk,center:ik,collide:ck,radial:_k,x:Gk,y:Kk},this.options={link:{id:t=>t.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},xe(this.options,t),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericLayout(!0,t,e)})}stop(){this.simulation.stop()}tick(t){return this.simulation.tick(t),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(t,e){const n=this.context.nodes.find(e=>e.id===t);n&&e.forEach((t,e)=>{if("number"==typeof t||null===t){n[["fx","fy","fz"][e]]=t}})}getOptions(t){var e,n;const r=xe({},this.options,t);return r.collide&&void 0===(null===(e=r.collide)||void 0===e?void 0:e.radius)&&(r.collide=r.collide||{},r.collide.radius=null!==(n=r.nodeSize)&&void 0!==n?n:10),void 0===r.iterations&&(r.link&&void 0===r.link.iterations&&(r.iterations=r.link.iterations),r.collide&&void 0===r.collide.iterations&&(r.iterations=r.collide.iterations)),this.context.options=r,r}genericLayout(t,e,n){var r;return _e(this,void 0,void 0,function*(){const i=this.getOptions(n),A=e.getAllNodes().map(({id:t,data:e})=>Object.assign(Object.assign({id:t},e),Ue(e.data,this.config.inputNodeAttrs))),o=e.getAllEdges().map(t=>Object.assign({},t));Object.assign(this.context,{assign:t,nodes:A,edges:o,graph:e});const s=new Promise(t=>{this.resolver=t}),a=this.setSimulation(i);return a.nodes(A),null===(r=a.force("link"))||void 0===r||r.links(o),s})}getResult(){const{assign:t,nodes:e,edges:n,graph:r}=this.context,i=e.map(t=>({id:t.id,data:Object.assign(Object.assign({},t.data),Ue(t,this.config.outputNodeAttrs))})),A=n.map(({id:t,source:e,target:n,data:r})=>({id:t,source:"object"==typeof e?e.id:e,target:"object"==typeof n?n.id:n,data:r}));return t&&i.forEach(t=>r.mergeNodeData(t.id,t.data)),{nodes:i,edges:A}}initSimulation(){return Rk()}setSimulation(t){const e=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||(this.simulation=e.on("tick",()=>{var e;return null===(e=t.onTick)||void 0===e?void 0:e.call(t,this.getResult())}).on("end",()=>{var t;return null===(t=this.resolver)||void 0===t?void 0:t.call(this,this.getResult())})),Vk(e,this.config.simulationAttrs.map(e=>[e,t[e]])),Object.entries(this.forceMap).forEach(([n,r])=>{const i=n;if(t[n]){let n=e.force(i);n||(n=r(),e.force(i,n)),Vk(n,Object.entries(t[i]))}else e.force(i,null)}),e}}const Vk=(t,e)=>e.reduce((e,[n,r])=>e[n]&&void 0!==r?e[n].call(t,r):e,t);var zk,Wk,Yk,Xk,qk,Zk,Jk,$k,tQ,eQ,nQ,rQ,iQ,AQ,oQ,sQ,aQ,cQ,lQ,uQ,hQ,dQ,fQ,gQ,pQ,vQ,mQ,yQ,wQ,BQ,bQ,EQ,xQ,CQ,FQ,MQ,kQ,QQ,SQ,UQ,TQ,OQ,NQ,IQ,LQ,DQ,PQ,RQ,HQ,_Q,GQ,KQ,jQ,VQ,zQ,WQ,YQ,XQ,qQ,ZQ,JQ,$Q,tS,eS,nS,rS,iS,AS,oS,sS,aS,cS,lS,uS,hS,dS,fS,gS,pS,vS,mS,yS,wS,BS,bS,ES,xS,CS,FS,MS,kS,QS,SS,US,TS,OS,NS,IS,LS,DS,PS,RS,HS,_S,GS,KS,jS,VS;function zS(){if(Xk)return Yk;return Xk=1,Yk=function(t,e){return t===e||t!=t&&e!=e}}function WS(){if(Zk)return qk;Zk=1;var t=zS();return qk=function(e,n){for(var r=e.length;r--;)if(t(e[r][0],n))return r;return-1},qk}function YS(){if(sQ)return oQ;sQ=1;var t=Wk?zk:(Wk=1,zk=function(){this.__data__=[],this.size=0}),e=function(){if($k)return Jk;$k=1;var t=WS(),e=Array.prototype.splice;return Jk=function(n){var r=this.__data__,i=t(r,n);return!(i<0||(i==r.length-1?r.pop():e.call(r,i,1),--this.size,0))},Jk}(),n=function(){if(eQ)return tQ;eQ=1;var t=WS();return tQ=function(e){var n=this.__data__,r=t(n,e);return r<0?void 0:n[r][1]},tQ}(),r=function(){if(rQ)return nQ;rQ=1;var t=WS();return nQ=function(e){return t(this.__data__,e)>-1}}(),i=function(){if(AQ)return iQ;AQ=1;var t=WS();return iQ=function(e,n){var r=this.__data__,i=t(r,e);return i<0?(++this.size,r.push([e,n])):r[i][1]=n,this},iQ}();function A(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}return A.prototype.clear=t,A.prototype.delete=e,A.prototype.get=n,A.prototype.has=r,A.prototype.set=i,oQ=A}function XS(){if(vQ)return pQ;vQ=1;var t="object"==typeof w&&w&&w.Object===Object&&w;return pQ=t}function qS(){if(yQ)return mQ;yQ=1;var t=XS(),e="object"==typeof self&&self&&self.Object===Object&&self,n=t||e||Function("return this")();return mQ=n}function ZS(){if(BQ)return wQ;BQ=1;var t=qS().Symbol;return wQ=t}function JS(){if(MQ)return FQ;MQ=1;var t=ZS(),e=function(){if(EQ)return bQ;EQ=1;var t=ZS(),e=Object.prototype,n=e.hasOwnProperty,r=e.toString,i=t?t.toStringTag:void 0;return bQ=function(t){var e=n.call(t,i),A=t[i];try{t[i]=void 0;var o=!0}catch(t){}var s=r.call(t);return o&&(e?t[i]=A:delete t[i]),s}}(),n=function(){if(CQ)return xQ;CQ=1;var t=Object.prototype.toString;return xQ=function(e){return t.call(e)}}(),r=t?t.toStringTag:void 0;return FQ=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":r&&r in Object(t)?e(t):n(t)}}function $S(){if(QQ)return kQ;return QQ=1,kQ=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}}function tU(){if(UQ)return SQ;UQ=1;var t=JS(),e=$S();return SQ=function(n){if(!e(n))return!1;var r=t(n);return"[object Function]"==r||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}}function eU(){if(IQ)return NQ;IQ=1;var t,e=function(){if(OQ)return TQ;OQ=1;var t=qS()["__core-js_shared__"];return TQ=t}(),n=(t=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||""))?"Symbol(src)_1."+t:"";return NQ=function(t){return!!n&&n in t}}function nU(){if(DQ)return LQ;DQ=1;var t=Function.prototype.toString;return LQ=function(e){if(null!=e){try{return t.call(e)}catch(t){}try{return e+""}catch(t){}}return""}}function rU(){if(KQ)return GQ;KQ=1;var t=function(){if(RQ)return PQ;RQ=1;var t=tU(),e=eU(),n=$S(),r=nU(),i=/^\[object .+?Constructor\]$/,A=Function.prototype,o=Object.prototype,s=A.toString,a=o.hasOwnProperty,c=RegExp("^"+s.call(a).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");return PQ=function(A){return!(!n(A)||e(A))&&(t(A)?c:i).test(r(A))}}(),e=_Q?HQ:(_Q=1,HQ=function(t,e){return null==t?void 0:t[e]});return GQ=function(n,r){var i=e(n,r);return t(i)?i:void 0}}function iU(){if(VQ)return jQ;VQ=1;var t=rU()(qS(),"Map");return jQ=t}function AU(){if(WQ)return zQ;WQ=1;var t=rU()(Object,"create");return zQ=t}function oU(){if(AS)return iS;AS=1;var t=function(){if(XQ)return YQ;XQ=1;var t=AU();return YQ=function(){this.__data__=t?t(null):{},this.size=0}}(),e=ZQ?qQ:(ZQ=1,qQ=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}),n=function(){if($Q)return JQ;$Q=1;var t=AU(),e=Object.prototype.hasOwnProperty;return JQ=function(n){var r=this.__data__;if(t){var i=r[n];return"__lodash_hash_undefined__"===i?void 0:i}return e.call(r,n)?r[n]:void 0},JQ}(),r=function(){if(eS)return tS;eS=1;var t=AU(),e=Object.prototype.hasOwnProperty;return tS=function(n){var r=this.__data__;return t?void 0!==r[n]:e.call(r,n)},tS}(),i=function(){if(rS)return nS;rS=1;var t=AU();return nS=function(e,n){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=t&&void 0===n?"__lodash_hash_undefined__":n,this},nS}();function A(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}return A.prototype.clear=t,A.prototype.delete=e,A.prototype.get=n,A.prototype.has=r,A.prototype.set=i,iS=A}function sU(){if(uS)return lS;uS=1;var t=cS?aS:(cS=1,aS=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t});return lS=function(e,n){var r=e.__data__;return t(n)?r["string"==typeof n?"string":"hash"]:r.map},lS}function aU(){if(BS)return wS;BS=1;var t=function(){if(sS)return oS;sS=1;var t=oU(),e=YS(),n=iU();return oS=function(){this.size=0,this.__data__={hash:new t,map:new(n||e),string:new t}}}(),e=function(){if(dS)return hS;dS=1;var t=sU();return hS=function(e){var n=t(this,e).delete(e);return this.size-=n?1:0,n}}(),n=function(){if(gS)return fS;gS=1;var t=sU();return fS=function(e){return t(this,e).get(e)}}(),r=function(){if(vS)return pS;vS=1;var t=sU();return pS=function(e){return t(this,e).has(e)}}(),i=function(){if(yS)return mS;yS=1;var t=sU();return mS=function(e,n){var r=t(this,e),i=r.size;return r.set(e,n),this.size+=r.size==i?0:1,this},mS}();function A(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}return A.prototype.clear=t,A.prototype.delete=e,A.prototype.get=n,A.prototype.has=r,A.prototype.set=i,wS=A}function cU(){if(CS)return xS;CS=1;var t=YS(),e=function(){if(cQ)return aQ;cQ=1;var t=YS();return aQ=function(){this.__data__=new t,this.size=0}}(),n=(uQ||(uQ=1,lQ=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}),lQ),r=dQ?hQ:(dQ=1,hQ=function(t){return this.__data__.get(t)}),i=gQ?fQ:(gQ=1,fQ=function(t){return this.__data__.has(t)}),A=function(){if(ES)return bS;ES=1;var t=YS(),e=iU(),n=aU();return bS=function(r,i){var A=this.__data__;if(A instanceof t){var o=A.__data__;if(!e||o.length<199)return o.push([r,i]),this.size=++A.size,this;A=this.__data__=new n(o)}return A.set(r,i),this.size=A.size,this},bS}();function o(e){var n=this.__data__=new t(e);this.size=n.size}return o.prototype.clear=e,o.prototype.delete=n,o.prototype.get=r,o.prototype.has=i,o.prototype.set=A,xS=o}function lU(){if(MS)return FS;return MS=1,FS=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t},FS}function uU(){if(QS)return kS;QS=1;var t=rU(),e=function(){try{var e=t(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();return kS=e}function hU(){if(US)return SS;US=1;var t=uU();return SS=function(e,n,r){"__proto__"==n&&t?t(e,n,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[n]=r}}function dU(){if(OS)return TS;OS=1;var t=hU(),e=zS(),n=Object.prototype.hasOwnProperty;return TS=function(r,i,A){var o=r[i];n.call(r,i)&&e(o,A)&&(void 0!==A||i in r)||t(r,i,A)}}function fU(){if(IS)return NS;IS=1;var t=dU(),e=hU();return NS=function(n,r,i,A){var o=!i;i||(i={});for(var s=-1,a=r.length;++s<a;){var c=r[s],l=A?A(i[c],n[c],c,i,n):void 0;void 0===l&&(l=n[c]),o?e(i,c,l):t(i,c,l)}return i},NS}function gU(){if(RS)return PS;return RS=1,PS=function(t){return null!=t&&"object"==typeof t}}function pU(){if(KS)return GS;KS=1;var t=function(){if(_S)return HS;_S=1;var t=JS(),e=gU();return HS=function(n){return e(n)&&"[object Arguments]"==t(n)}}(),e=gU(),n=Object.prototype,r=n.hasOwnProperty,i=n.propertyIsEnumerable,A=t(function(){return arguments}())?t:function(t){return e(t)&&r.call(t,"callee")&&!i.call(t,"callee")};return GS=A}function vU(){if(VS)return jS;VS=1;var t=Array.isArray;return jS=t}var mU,yU,wU,BU,bU,EU,xU,CU,FU,MU,kU,QU={exports:{}};function SU(){return wU||(wU=1,function(t,e){var n=qS(),r=yU?mU:(yU=1,mU=function(){return!1}),i=e&&!e.nodeType&&e,A=i&&t&&!t.nodeType&&t,o=A&&A.exports===i?n.Buffer:void 0,s=(o?o.isBuffer:void 0)||r;t.exports=s}(QU,QU.exports)),QU.exports}function UU(){if(bU)return BU;bU=1;var t=/^(?:0|[1-9]\d*)$/;return BU=function(e,n){var r=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==r||"symbol"!=r&&t.test(e))&&e>-1&&e%1==0&&e<n},BU}function TU(){if(xU)return EU;xU=1;return EU=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}}function OU(){if(kU)return MU;return kU=1,MU=function(t){return function(e){return t(e)}}}var NU,IU,LU,DU,PU,RU,HU,_U,GU,KU,jU,VU,zU,WU,YU,XU,qU,ZU,JU,$U,tT,eT,nT,rT,iT,AT,oT,sT={exports:{}};function aT(){return NU||(NU=1,function(t,e){var n=XS(),r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,A=i&&i.exports===r&&n.process,o=function(){try{var t=i&&i.require&&i.require("util").types;return t||A&&A.binding&&A.binding("util")}catch(t){}}();t.exports=o}(sT,sT.exports)),sT.exports}function cT(){if(LU)return IU;LU=1;var t=function(){if(FU)return CU;FU=1;var t=JS(),e=TU(),n=gU(),r={};return r["[object Float32Array]"]=r["[object Float64Array]"]=r["[object Int8Array]"]=r["[object Int16Array]"]=r["[object Int32Array]"]=r["[object Uint8Array]"]=r["[object Uint8ClampedArray]"]=r["[object Uint16Array]"]=r["[object Uint32Array]"]=!0,r["[object Arguments]"]=r["[object Array]"]=r["[object ArrayBuffer]"]=r["[object Boolean]"]=r["[object DataView]"]=r["[object Date]"]=r["[object Error]"]=r["[object Function]"]=r["[object Map]"]=r["[object Number]"]=r["[object Object]"]=r["[object RegExp]"]=r["[object Set]"]=r["[object String]"]=r["[object WeakMap]"]=!1,CU=function(i){return n(i)&&e(i.length)&&!!r[t(i)]}}(),e=OU(),n=aT(),r=n&&n.isTypedArray,i=r?e(r):t;return IU=i}function lT(){if(PU)return DU;PU=1;var t=(DS||(DS=1,LS=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}),LS),e=pU(),n=vU(),r=SU(),i=UU(),A=cT(),o=Object.prototype.hasOwnProperty;return DU=function(s,a){var c=n(s),l=!c&&e(s),u=!c&&!l&&r(s),h=!c&&!l&&!u&&A(s),d=c||l||u||h,f=d?t(s.length,String):[],g=f.length;for(var p in s)!a&&!o.call(s,p)||d&&("length"==p||u&&("offset"==p||"parent"==p)||h&&("buffer"==p||"byteLength"==p||"byteOffset"==p)||i(p,g))||f.push(p);return f},DU}function uT(){if(HU)return RU;HU=1;var t=Object.prototype;return RU=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||t)}}function hT(){if(GU)return _U;return GU=1,_U=function(t,e){return function(n){return t(e(n))}},_U}function dT(){if(zU)return VU;zU=1;var t=uT(),e=function(){if(jU)return KU;jU=1;var t=hT()(Object.keys,Object);return KU=t}(),n=Object.prototype.hasOwnProperty;return VU=function(r){if(!t(r))return e(r);var i=[];for(var A in Object(r))n.call(r,A)&&"constructor"!=A&&i.push(A);return i}}function fT(){if(YU)return WU;YU=1;var t=tU(),e=TU();return WU=function(n){return null!=n&&e(n.length)&&!t(n)}}function gT(){if(qU)return XU;qU=1;var t=lT(),e=dT(),n=fT();return XU=function(r){return n(r)?t(r):e(r)}}function pT(){if(nT)return eT;nT=1;var t=$S(),e=uT(),n=tT?$U:(tT=1,$U=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}),r=Object.prototype.hasOwnProperty;return eT=function(i){if(!t(i))return n(i);var A=e(i),o=[];for(var s in i)("constructor"!=s||!A&&r.call(i,s))&&o.push(s);return o}}function vT(){if(iT)return rT;iT=1;var t=lT(),e=pT(),n=fT();return rT=function(r){return n(r)?t(r,!0):e(r)}}var mT,yT,wT,BT,bT,ET,xT,CT,FT,MT,kT,QT,ST,UT,TT,OT,NT,IT,LT,DT,PT,RT,HT,_T,GT,KT,jT,VT,zT,WT,YT,XT,qT,ZT,JT,$T,tO,eO,nO,rO,iO,AO,oO,sO,aO,cO,lO,uO,hO,dO,fO,gO,pO,vO,mO,yO,wO,BO,bO,EO,xO,CO,FO,MO,kO,QO,SO,UO,TO,OO,NO,IO,LO,DO,PO,RO,HO,_O,GO,KO,jO,VO,zO,WO,YO,XO,qO,ZO,JO,$O,tN,eN,nN,rN,iN,AN,oN,sN,aN,cN,lN,uN,hN,dN,fN,gN,pN,vN,mN,yN,wN,BN,bN,EN,xN,CN,FN,MN,kN,QN,SN,UN,TN,ON,NN,IN,LN,DN,PN,RN,HN,_N,GN,KN,jN,VN,zN,WN,YN,XN,qN,ZN,JN,$N,tI,eI,nI,rI,iI,AI,oI,sI,aI,cI,lI,uI,hI,dI,fI,gI,pI,vI,mI,yI,wI,BI,bI,EI,xI,CI,FI,MI,kI,QI,SI,UI,TI,OI,NI,II,LI,DI,PI,RI,HI,_I,GI,KI,jI,VI,zI,WI,YI,XI,qI,ZI,JI,$I,tL,eL,nL,rL,iL,AL,oL,sL,aL,cL,lL,uL,hL,dL,fL,gL,pL,vL,mL,yL,wL,BL,bL,EL,xL,CL,FL,ML,kL,QL,SL,UL,TL,OL,NL,IL,LL,DL,PL,RL,HL,_L,GL,KL,jL,VL,zL,WL,YL,XL,qL,ZL,JL,$L,tD,eD,nD,rD,iD,AD,oD,sD,aD,cD,lD,uD,hD,dD,fD,gD,pD,vD,mD,yD,wD,BD,bD,ED,xD,CD,FD,MD,kD={exports:{}};function QD(){return mT||(mT=1,function(t,e){var n=qS(),r=e&&!e.nodeType&&e,i=r&&t&&!t.nodeType&&t,A=i&&i.exports===r?n.Buffer:void 0,o=A?A.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=o?o(n):new t.constructor(n);return t.copy(r),r}}(kD,kD.exports)),kD.exports}function SD(){if(wT)return yT;return wT=1,yT=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e},yT}function UD(){if(bT)return BT;return bT=1,BT=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,A=[];++n<r;){var o=t[n];e(o,n,t)&&(A[i++]=o)}return A},BT}function TD(){if(xT)return ET;return xT=1,ET=function(){return[]}}function OD(){if(FT)return CT;FT=1;var t=UD(),e=TD(),n=Object.prototype.propertyIsEnumerable,r=Object.getOwnPropertySymbols;return CT=r?function(e){return null==e?[]:(e=Object(e),t(r(e),function(t){return n.call(e,t)}))}:e}function ND(){if(ST)return QT;return ST=1,QT=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t},QT}function ID(){if(TT)return UT;TT=1;var t=hT()(Object.getPrototypeOf,Object);return UT=t}function LD(){if(NT)return OT;NT=1;var t=ND(),e=ID(),n=OD(),r=TD(),i=Object.getOwnPropertySymbols;return OT=i?function(r){for(var i=[];r;)t(i,n(r)),r=e(r);return i}:r}function DD(){if(PT)return DT;PT=1;var t=ND(),e=vU();return DT=function(n,r,i){var A=r(n);return e(n)?A:t(A,i(n))}}function PD(){if(HT)return RT;HT=1;var t=DD(),e=OD(),n=gT();return RT=function(r){return t(r,n,e)}}function RD(){if(YT)return WT;YT=1;var t=rU()(qS(),"Set");return WT=t}function HD(){if(JT)return ZT;JT=1;var t=function(){if(jT)return KT;jT=1;var t=rU()(qS(),"DataView");return KT=t}(),e=iU(),n=function(){if(zT)return VT;zT=1;var t=rU()(qS(),"Promise");return VT=t}(),r=RD(),i=function(){if(qT)return XT;qT=1;var t=rU()(qS(),"WeakMap");return XT=t}(),A=JS(),o=nU(),s="[object Map]",a="[object Promise]",c="[object Set]",l="[object WeakMap]",u="[object DataView]",h=o(t),d=o(e),f=o(n),g=o(r),p=o(i),v=A;return(t&&v(new t(new ArrayBuffer(1)))!=u||e&&v(new e)!=s||n&&v(n.resolve())!=a||r&&v(new r)!=c||i&&v(new i)!=l)&&(v=function(t){var e=A(t),n="[object Object]"==e?t.constructor:void 0,r=n?o(n):"";if(r)switch(r){case h:return u;case d:return s;case f:return a;case g:return c;case p:return l}return e}),ZT=v}function _D(){if(nO)return eO;nO=1;var t=qS().Uint8Array;return eO=t}function GD(){if(iO)return rO;iO=1;var t=_D();return rO=function(e){var n=new e.constructor(e.byteLength);return new t(n).set(new t(e)),n}}function KD(){if(hO)return uO;hO=1;var t=GD();return uO=function(e,n){var r=n?t(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}}function jD(){if(fO)return dO;fO=1;var t=GD(),e=function(){if(oO)return AO;oO=1;var t=GD();return AO=function(e,n){var r=n?t(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}}(),n=function(){if(aO)return sO;aO=1;var t=/\w*$/;return sO=function(e){var n=new e.constructor(e.source,t.exec(e));return n.lastIndex=e.lastIndex,n}}(),r=function(){if(lO)return cO;lO=1;var t=ZS(),e=t?t.prototype:void 0,n=e?e.valueOf:void 0;return cO=function(t){return n?Object(n.call(t)):{}}}(),i=KD();return dO=function(A,o,s){var a=A.constructor;switch(o){case"[object ArrayBuffer]":return t(A);case"[object Boolean]":case"[object Date]":return new a(+A);case"[object DataView]":return e(A,s);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return i(A,s);case"[object Map]":case"[object Set]":return new a;case"[object Number]":case"[object String]":return new a(A);case"[object RegExp]":return n(A);case"[object Symbol]":return r(A)}}}function VD(){if(pO)return gO;pO=1;var t=$S(),e=Object.create,n=function(){function n(){}return function(r){if(!t(r))return{};if(e)return e(r);n.prototype=r;var i=new n;return n.prototype=void 0,i}}();return gO=n}function zD(){if(mO)return vO;mO=1;var t=VD(),e=ID(),n=uT();return vO=function(r){return"function"!=typeof r.constructor||n(r)?{}:t(e(r))}}function WD(){if(bO)return BO;bO=1;var t=function(){if(wO)return yO;wO=1;var t=HD(),e=gU();return yO=function(n){return e(n)&&"[object Map]"==t(n)}}(),e=OU(),n=aT(),r=n&&n.isMap,i=r?e(r):t;return BO=i}function YD(){if(FO)return CO;FO=1;var t=function(){if(xO)return EO;xO=1;var t=HD(),e=gU();return EO=function(n){return e(n)&&"[object Set]"==t(n)}}(),e=OU(),n=aT(),r=n&&n.isSet,i=r?e(r):t;return CO=i}function XD(){if(kO)return MO;kO=1;var t=cU(),e=lU(),n=dU(),r=function(){if(JU)return ZU;JU=1;var t=fU(),e=gT();return ZU=function(n,r){return n&&t(r,e(r),n)}}(),i=function(){if(oT)return AT;oT=1;var t=fU(),e=vT();return AT=function(n,r){return n&&t(r,e(r),n)}}(),A=QD(),o=SD(),s=function(){if(kT)return MT;kT=1;var t=fU(),e=OD();return MT=function(n,r){return t(n,e(n),r)}}(),a=function(){if(LT)return IT;LT=1;var t=fU(),e=LD();return IT=function(n,r){return t(n,e(n),r)}}(),c=PD(),l=function(){if(GT)return _T;GT=1;var t=DD(),e=LD(),n=vT();return _T=function(r){return t(r,n,e)}}(),u=HD(),h=function(){if(tO)return $T;tO=1;var t=Object.prototype.hasOwnProperty;return $T=function(e){var n=e.length,r=new e.constructor(n);return n&&"string"==typeof e[0]&&t.call(e,"index")&&(r.index=e.index,r.input=e.input),r},$T}(),d=jD(),f=zD(),g=vU(),p=SU(),v=WD(),m=$S(),y=YD(),w=gT(),B=vT(),b="[object Arguments]",E="[object Function]",x="[object Object]",C={};return C[b]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C[x]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C[E]=C["[object WeakMap]"]=!1,MO=function F(M,k,Q,S,U,T){var O,N=1&k,I=2&k,L=4&k;if(Q&&(O=U?Q(M,S,U,T):Q(M)),void 0!==O)return O;if(!m(M))return M;var D=g(M);if(D){if(O=h(M),!N)return o(M,O)}else{var P=u(M),R=P==E||"[object GeneratorFunction]"==P;if(p(M))return A(M,N);if(P==x||P==b||R&&!U){if(O=I||R?{}:f(M),!N)return I?a(M,i(O,M)):s(M,r(O,M))}else{if(!C[P])return U?M:{};O=d(M,P,N)}}T||(T=new t);var H=T.get(M);if(H)return H;T.set(M,O),y(M)?M.forEach(function(t){O.add(F(t,k,Q,t,M,T))}):v(M)&&M.forEach(function(t,e){O.set(e,F(t,k,Q,e,M,T))});var _=D?void 0:(L?I?l:c:I?B:w)(M);return e(_||M,function(t,e){_&&(t=M[e=t]),n(O,e,F(t,k,Q,e,M,T))}),O},MO}function qD(){if(SO)return QO;SO=1;var t=XD();return QO=function(e){return t(e,4)}}function ZD(){if(TO)return UO;return TO=1,UO=function(t){return function(){return t}}}function JD(){if(LO)return IO;LO=1;var t=(NO||(NO=1,OO=function(t){return function(e,n,r){for(var i=-1,A=Object(e),o=r(e),s=o.length;s--;){var a=o[t?s:++i];if(!1===n(A[a],a,A))break}return e}}),OO),e=t();return IO=e}function $D(){if(PO)return DO;PO=1;var t=JD(),e=gT();return DO=function(n,r){return n&&t(n,r,e)}}function tP(){if(GO)return _O;GO=1;var t=$D(),e=function(){if(HO)return RO;HO=1;var t=fT();return RO=function(e,n){return function(r,i){if(null==r)return r;if(!t(r))return e(r,i);for(var A=r.length,o=n?A:-1,s=Object(r);(n?o--:++o<A)&&!1!==i(s[o],o,s););return r}},RO}(),n=e(t);return _O=n}function eP(){if(jO)return KO;return jO=1,KO=function(t){return t}}function nP(){if(zO)return VO;zO=1;var t=eP();return VO=function(e){return"function"==typeof e?e:t}}function rP(){if(YO)return WO;YO=1;var t=lU(),e=tP(),n=nP(),r=vU();return WO=function(i,A){return(r(i)?t:e)(i,n(A))}}function iP(){return qO?XO:(qO=1,XO=rP())}function AP(){if(iN)return rN;iN=1;var t=aU(),e=tN?$O:(tN=1,$O=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}),n=nN?eN:(nN=1,eN=function(t){return this.__data__.has(t)});function r(e){var n=-1,r=null==e?0:e.length;for(this.__data__=new t;++n<r;)this.add(e[n])}return r.prototype.add=r.prototype.push=e,r.prototype.has=n,rN=r}function oP(){if(aN)return sN;return aN=1,sN=function(t,e){return t.has(e)}}function sP(){if(lN)return cN;lN=1;var t=AP(),e=(oN||(oN=1,AN=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}),AN),n=oP();return cN=function(r,i,A,o,s,a){var c=1&A,l=r.length,u=i.length;if(l!=u&&!(c&&u>l))return!1;var h=a.get(r),d=a.get(i);if(h&&d)return h==i&&d==r;var f=-1,g=!0,p=2&A?new t:void 0;for(a.set(r,i),a.set(i,r);++f<l;){var v=r[f],m=i[f];if(o)var y=c?o(m,v,f,i,r,a):o(v,m,f,r,i,a);if(void 0!==y){if(y)continue;g=!1;break}if(p){if(!e(i,function(t,e){if(!n(p,e)&&(v===t||s(v,t,A,o,a)))return p.push(e)})){g=!1;break}}else if(v!==m&&!s(v,m,A,o,a)){g=!1;break}}return a.delete(r),a.delete(i),g},cN}function aP(){if(fN)return dN;return fN=1,dN=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n},dN}function cP(){if(pN)return gN;pN=1;var t=ZS(),e=_D(),n=zS(),r=sP(),i=(hN||(hN=1,uN=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}),uN),A=aP(),o=t?t.prototype:void 0,s=o?o.valueOf:void 0;return gN=function(t,o,a,c,l,u,h){switch(a){case"[object DataView]":if(t.byteLength!=o.byteLength||t.byteOffset!=o.byteOffset)return!1;t=t.buffer,o=o.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=o.byteLength||!u(new e(t),new e(o)));case"[object Boolean]":case"[object Date]":case"[object Number]":return n(+t,+o);case"[object Error]":return t.name==o.name&&t.message==o.message;case"[object RegExp]":case"[object String]":return t==o+"";case"[object Map]":var d=i;case"[object Set]":var f=1&c;if(d||(d=A),t.size!=o.size&&!f)return!1;var g=h.get(t);if(g)return g==o;c|=2,h.set(t,o);var p=r(d(t),d(o),c,l,u,h);return h.delete(t),p;case"[object Symbol]":if(s)return s.call(t)==s.call(o)}return!1}}function lP(){if(wN)return yN;wN=1;var t=cU(),e=sP(),n=cP(),r=function(){if(mN)return vN;mN=1;var t=PD(),e=Object.prototype.hasOwnProperty;return vN=function(n,r,i,A,o,s){var a=1&i,c=t(n),l=c.length;if(l!=t(r).length&&!a)return!1;for(var u=l;u--;){var h=c[u];if(!(a?h in r:e.call(r,h)))return!1}var d=s.get(n),f=s.get(r);if(d&&f)return d==r&&f==n;var g=!0;s.set(n,r),s.set(r,n);for(var p=a;++u<l;){var v=n[h=c[u]],m=r[h];if(A)var y=a?A(m,v,h,r,n,s):A(v,m,h,n,r,s);if(!(void 0===y?v===m||o(v,m,i,A,s):y)){g=!1;break}p||(p="constructor"==h)}if(g&&!p){var w=n.constructor,B=r.constructor;w==B||!("constructor"in n)||!("constructor"in r)||"function"==typeof w&&w instanceof w&&"function"==typeof B&&B instanceof B||(g=!1)}return s.delete(n),s.delete(r),g},vN}(),i=HD(),A=vU(),o=SU(),s=cT(),a="[object Arguments]",c="[object Array]",l="[object Object]",u=Object.prototype.hasOwnProperty;return yN=function(h,d,f,g,p,v){var m=A(h),y=A(d),w=m?c:i(h),B=y?c:i(d),b=(w=w==a?l:w)==l,E=(B=B==a?l:B)==l,x=w==B;if(x&&o(h)){if(!o(d))return!1;m=!0,b=!1}if(x&&!b)return v||(v=new t),m||s(h)?e(h,d,f,g,p,v):n(h,d,w,f,g,p,v);if(!(1&f)){var C=b&&u.call(h,"__wrapped__"),F=E&&u.call(d,"__wrapped__");if(C||F){var M=C?h.value():h,k=F?d.value():d;return v||(v=new t),p(M,k,f,g,v)}}return!!x&&(v||(v=new t),r(h,d,f,g,p,v))}}function uP(){if(bN)return BN;bN=1;var t=lP(),e=gU();return BN=function n(r,i,A,o,s){return r===i||(null==r||null==i||!e(r)&&!e(i)?r!=r&&i!=i:t(r,i,A,o,n,s))},BN}function hP(){if(FN)return CN;FN=1;var t=$S();return CN=function(e){return e==e&&!t(e)}}function dP(){if(SN)return QN;return SN=1,QN=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}}function fP(){if(TN)return UN;TN=1;var t=function(){if(xN)return EN;xN=1;var t=cU(),e=uP();return EN=function(n,r,i,A){var o=i.length,s=o,a=!A;if(null==n)return!s;for(n=Object(n);o--;){var c=i[o];if(a&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++o<s;){var l=(c=i[o])[0],u=n[l],h=c[1];if(a&&c[2]){if(void 0===u&&!(l in n))return!1}else{var d=new t;if(A)var f=A(u,h,l,n,r,d);if(!(void 0===f?e(h,u,3,A,d):f))return!1}}return!0},EN}(),e=function(){if(kN)return MN;kN=1;var t=hP(),e=gT();return MN=function(n){for(var r=e(n),i=r.length;i--;){var A=r[i],o=n[A];r[i]=[A,o,t(o)]}return r},MN}(),n=dP();return UN=function(r){var i=e(r);return 1==i.length&&i[0][2]?n(i[0][0],i[0][1]):function(e){return e===r||t(e,r,i)}}}function gP(){if(NN)return ON;NN=1;var t=JS(),e=gU();return ON=function(n){return"symbol"==typeof n||e(n)&&"[object Symbol]"==t(n)}}function pP(){if(LN)return IN;LN=1;var t=vU(),e=gP(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;return IN=function(i,A){if(t(i))return!1;var o=typeof i;return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=i&&!e(i))||(r.test(i)||!n.test(i)||null!=A&&i in Object(A))}}function vP(){if(HN)return RN;HN=1;var t=function(){if(PN)return DN;PN=1;var t=aU();function e(n,r){if("function"!=typeof n||null!=r&&"function"!=typeof r)throw new TypeError("Expected a function");var i=function(){var t=arguments,e=r?r.apply(this,t):t[0],A=i.cache;if(A.has(e))return A.get(e);var o=n.apply(this,t);return i.cache=A.set(e,o)||A,o};return i.cache=new(e.Cache||t),i}return e.Cache=t,DN=e}();return RN=function(e){var n=t(e,function(t){return 500===r.size&&r.clear(),t}),r=n.cache;return n}}function mP(){if(jN)return KN;return jN=1,KN=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i},KN}function yP(){if(YN)return WN;YN=1;var t=function(){if(zN)return VN;zN=1;var t=ZS(),e=mP(),n=vU(),r=gP(),i=t?t.prototype:void 0,A=i?i.toString:void 0;return VN=function t(i){if("string"==typeof i)return i;if(n(i))return e(i,t)+"";if(r(i))return A?A.call(i):"";var o=i+"";return"0"==o&&1/i==-1/0?"-0":o},VN}();return WN=function(e){return null==e?"":t(e)}}function wP(){if(qN)return XN;qN=1;var t=vU(),e=pP(),n=function(){if(GN)return _N;GN=1;var t=vP(),e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=t(function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(e,function(t,e,i,A){r.push(i?A.replace(n,"$1"):e||t)}),r});return _N=r}(),r=yP();return XN=function(i,A){return t(i)?i:e(i,A)?[i]:n(r(i))}}function BP(){if(JN)return ZN;JN=1;var t=gP();return ZN=function(e){if("string"==typeof e||t(e))return e;var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}}function bP(){if(tI)return $N;tI=1;var t=wP(),e=BP();return $N=function(n,r){for(var i=0,A=(r=t(r,n)).length;null!=n&&i<A;)n=n[e(r[i++])];return i&&i==A?n:void 0},$N}function EP(){if(oI)return AI;oI=1;var t=wP(),e=pU(),n=vU(),r=UU(),i=TU(),A=BP();return AI=function(o,s,a){for(var c=-1,l=(s=t(s,o)).length,u=!1;++c<l;){var h=A(s[c]);if(!(u=null!=o&&a(o,h)))break;o=o[h]}return u||++c!=l?u:!!(l=null==o?0:o.length)&&i(l)&&r(h,l)&&(n(o)||e(o))},AI}function xP(){if(aI)return sI;aI=1;var t=iI?rI:(iI=1,rI=function(t,e){return null!=t&&e in Object(t)}),e=EP();return sI=function(n,r){return null!=n&&e(n,r,t)}}function CP(){if(lI)return cI;lI=1;var t=uP(),e=function(){if(nI)return eI;nI=1;var t=bP();return eI=function(e,n,r){var i=null==e?void 0:t(e,n);return void 0===i?r:i}}(),n=xP(),r=pP(),i=hP(),A=dP(),o=BP();return cI=function(s,a){return r(s)&&i(a)?A(o(s),a):function(r){var i=e(r,s);return void 0===i&&i===a?n(r,s):t(a,i,3)}}}function FP(){if(hI)return uI;return hI=1,uI=function(t){return function(e){return null==e?void 0:e[t]}}}function MP(){if(pI)return gI;pI=1;var t=FP(),e=function(){if(fI)return dI;fI=1;var t=bP();return dI=function(e){return function(n){return t(n,e)}}}(),n=pP(),r=BP();return gI=function(i){return n(i)?t(r(i)):e(i)}}function kP(){if(mI)return vI;mI=1;var t=fP(),e=CP(),n=eP(),r=vU(),i=MP();return vI=function(A){return"function"==typeof A?A:null==A?n:"object"==typeof A?r(A)?e(A[0],A[1]):t(A):i(A)}}function QP(){if(wI)return yI;wI=1;var t=UD(),e=function(){if(JO)return ZO;JO=1;var t=tP();return ZO=function(e,n){var r=[];return t(e,function(t,e,i){n(t,e,i)&&r.push(t)}),r},ZO}(),n=kP(),r=vU();return yI=function(i,A){return(r(i)?t:e)(i,n(A,3))}}function SP(){if(xI)return EI;xI=1;var t=function(){if(bI)return BI;bI=1;var t=Object.prototype.hasOwnProperty;return BI=function(e,n){return null!=e&&t.call(e,n)}}(),e=EP();return EI=function(n,r){return null!=n&&e(n,r,t)}}function UP(){if(FI)return CI;FI=1;var t=dT(),e=HD(),n=pU(),r=vU(),i=fT(),A=SU(),o=uT(),s=cT(),a=Object.prototype.hasOwnProperty;return CI=function(c){if(null==c)return!0;if(i(c)&&(r(c)||"string"==typeof c||"function"==typeof c.splice||A(c)||s(c)||n(c)))return!c.length;var l=e(c);if("[object Map]"==l||"[object Set]"==l)return!c.size;if(o(c))return!t(c).length;for(var u in c)if(a.call(c,u))return!1;return!0}}function TP(){if(kI)return MI;return kI=1,MI=function(t){return void 0===t}}function OP(){if(SI)return QI;SI=1;var t=tP(),e=fT();return QI=function(n,r){var i=-1,A=e(n)?Array(n.length):[];return t(n,function(t,e,n){A[++i]=r(t,e,n)}),A},QI}function NP(){if(TI)return UI;TI=1;var t=mP(),e=kP(),n=OP(),r=vU();return UI=function(i,A){return(r(i)?t:n)(i,e(A,3))}}function IP(){if(PI)return DI;PI=1;var t=(NI||(NI=1,OI=function(t,e,n,r){var i=-1,A=null==t?0:t.length;for(r&&A&&(n=t[++i]);++i<A;)n=e(n,t[i],i,t);return n}),OI),e=tP(),n=kP(),r=(LI||(LI=1,II=function(t,e,n,r,i){return i(t,function(t,i,A){n=r?(r=!1,t):e(n,t,i,A)}),n}),II),i=vU();return DI=function(A,o,s){var a=i(A)?t:r,c=arguments.length<3;return a(A,n(o,4),s,c,e)},DI}function LP(){if(YI)return WI;YI=1;var t=function(){if(GI)return _I;GI=1;var t=FP()("length");return _I=t}(),e=function(){if(jI)return KI;jI=1;var t=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");return KI=function(e){return t.test(e)}}(),n=function(){if(zI)return VI;zI=1;var t="\\ud800-\\udfff",e="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",A="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",s="(?:"+n+"|"+r+")?",a="[\\ufe0e\\ufe0f]?",c=a+s+"(?:\\u200d(?:"+[i,A,o].join("|")+")"+a+s+")*",l="(?:"+[i+n+"?",n,A,o,e].join("|")+")",u=RegExp(r+"(?="+r+")|"+l+c,"g");return VI=function(t){for(var e=u.lastIndex=0;u.test(t);)++e;return e}}();return WI=function(r){return e(r)?n(r):t(r)}}function DP(){if(qI)return XI;qI=1;var t=dT(),e=HD(),n=fT(),r=function(){if(HI)return RI;HI=1;var t=JS(),e=vU(),n=gU();return RI=function(r){return"string"==typeof r||!e(r)&&n(r)&&"[object String]"==t(r)}}(),i=LP();return XI=function(A){if(null==A)return 0;if(n(A))return r(A)?i(A):A.length;var o=e(A);return"[object Map]"==o||"[object Set]"==o?A.size:t(A).length}}function PP(){if(JI)return ZI;JI=1;var t=lU(),e=VD(),n=$D(),r=kP(),i=ID(),A=vU(),o=SU(),s=tU(),a=$S(),c=cT();return ZI=function(l,u,h){var d=A(l),f=d||o(l)||c(l);if(u=r(u,4),null==h){var g=l&&l.constructor;h=f?d?new g:[]:a(l)&&s(g)?e(i(l)):{}}return(f?t:n)(l,function(t,e,n){return u(h,t,e,n)}),h},ZI}function RP(){if(nL)return eL;nL=1;var t=ND(),e=function(){if(tL)return $I;tL=1;var t=ZS(),e=pU(),n=vU(),r=t?t.isConcatSpreadable:void 0;return $I=function(t){return n(t)||e(t)||!!(r&&t&&t[r])}}();return eL=function n(r,i,A,o,s){var a=-1,c=r.length;for(A||(A=e),s||(s=[]);++a<c;){var l=r[a];i>0&&A(l)?i>1?n(l,i-1,A,o,s):t(s,l):o||(s[s.length]=l)}return s},eL}function HP(){if(oL)return AL;oL=1;var t=iL?rL:(iL=1,rL=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}),e=Math.max;return AL=function(n,r,i){return r=e(void 0===r?n.length-1:r,0),function(){for(var A=arguments,o=-1,s=e(A.length-r,0),a=Array(s);++o<s;)a[o]=A[r+o];o=-1;for(var c=Array(r+1);++o<r;)c[o]=A[o];return c[r]=i(a),t(n,this,c)}},AL}function _P(){if(hL)return uL;hL=1;var t=function(){if(aL)return sL;aL=1;var t=ZD(),e=uU(),n=eP();return sL=e?function(n,r){return e(n,"toString",{configurable:!0,enumerable:!1,value:t(r),writable:!0})}:n}(),e=function(){if(lL)return cL;lL=1;var t=Date.now;return cL=function(e){var n=0,r=0;return function(){var i=t(),A=16-(i-r);if(r=i,A>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}},cL}(),n=e(t);return uL=n}function GP(){if(fL)return dL;fL=1;var t=eP(),e=HP(),n=_P();return dL=function(r,i){return n(e(r,i,t),r+"")}}function KP(){if(pL)return gL;return pL=1,gL=function(t,e,n,r){for(var i=t.length,A=n+(r?1:-1);r?A--:++A<i;)if(e(t[A],A,t))return A;return-1},gL}function jP(){if(bL)return BL;bL=1;var t=KP(),e=mL?vL:(mL=1,vL=function(t){return t!=t}),n=(wL||(wL=1,yL=function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}),yL);return BL=function(r,i,A){return i==i?n(r,i,A):t(r,e,A)}}function VP(){if(SL)return QL;SL=1;var t=RD(),e=kL?ML:(kL=1,ML=function(){}),n=aP(),r=t&&1/n(new t([,-0]))[1]==1/0?function(e){return new t(e)}:e;return QL=r}function zP(){if(TL)return UL;TL=1;var t=AP(),e=function(){if(xL)return EL;xL=1;var t=jP();return EL=function(e,n){return!(null==e||!e.length)&&t(e,n,0)>-1}}(),n=(FL||(FL=1,CL=function(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}),CL),r=oP(),i=VP(),A=aP();return UL=function(o,s,a){var c=-1,l=e,u=o.length,h=!0,d=[],f=d;if(a)h=!1,l=n;else if(u>=200){var g=s?null:i(o);if(g)return A(g);h=!1,l=r,f=new t}else f=s?[]:d;t:for(;++c<u;){var p=o[c],v=s?s(p):p;if(p=a||0!==p?p:0,h&&v==v){for(var m=f.length;m--;)if(f[m]===v)continue t;s&&f.push(v),d.push(p)}else l(f,v,a)||(f!==d&&f.push(v),d.push(p))}return d},UL}function WP(){if(NL)return OL;NL=1;var t=fT(),e=gU();return OL=function(n){return e(n)&&t(n)}}function YP(){if(LL)return IL;LL=1;var t=RP(),e=GP(),n=zP(),r=WP(),i=e(function(e){return n(t(e,1,r,!0))});return IL=i}function XP(){if(HL)return RL;HL=1;var t=function(){if(PL)return DL;PL=1;var t=mP();return DL=function(e,n){return t(n,function(t){return e[t]})}}(),e=gT();return RL=function(n){return null==n?[]:t(n,e(n))}}function qP(){if(GL)return _L;var t;GL=1;try{t={clone:qD(),constant:ZD(),each:iP(),filter:QP(),has:SP(),isArray:vU(),isEmpty:UP(),isFunction:tU(),isUndefined:TP(),keys:gT(),map:NP(),reduce:IP(),size:DP(),transform:PP(),union:YP(),values:XP()}}catch(t){}return t||(t=window._),_L=t}function ZP(){if(jL)return KL;jL=1;var t=qP();KL=n;var e="\0";function n(n){this._isDirected=!t.has(n,"directed")||n.directed,this._isMultigraph=!!t.has(n,"multigraph")&&n.multigraph,this._isCompound=!!t.has(n,"compound")&&n.compound,this._label=void 0,this._defaultNodeLabelFn=t.constant(void 0),this._defaultEdgeLabelFn=t.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[e]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function r(t,e){t[e]?t[e]++:t[e]=1}function i(t,e){--t[e]||delete t[e]}function A(e,n,r,i){var A=""+n,o=""+r;if(!e&&A>o){var s=A;A=o,o=s}return A+""+o+""+(t.isUndefined(i)?"\0":i)}function o(t,e){return A(t,e.v,e.w,e.name)}return n.prototype._nodeCount=0,n.prototype._edgeCount=0,n.prototype.isDirected=function(){return this._isDirected},n.prototype.isMultigraph=function(){return this._isMultigraph},n.prototype.isCompound=function(){return this._isCompound},n.prototype.setGraph=function(t){return this._label=t,this},n.prototype.graph=function(){return this._label},n.prototype.setDefaultNodeLabel=function(e){return t.isFunction(e)||(e=t.constant(e)),this._defaultNodeLabelFn=e,this},n.prototype.nodeCount=function(){return this._nodeCount},n.prototype.nodes=function(){return t.keys(this._nodes)},n.prototype.sources=function(){var e=this;return t.filter(this.nodes(),function(n){return t.isEmpty(e._in[n])})},n.prototype.sinks=function(){var e=this;return t.filter(this.nodes(),function(n){return t.isEmpty(e._out[n])})},n.prototype.setNodes=function(e,n){var r=arguments,i=this;return t.each(e,function(t){r.length>1?i.setNode(t,n):i.setNode(t)}),this},n.prototype.setNode=function(n,r){return t.has(this._nodes,n)?(arguments.length>1&&(this._nodes[n]=r),this):(this._nodes[n]=arguments.length>1?r:this._defaultNodeLabelFn(n),this._isCompound&&(this._parent[n]=e,this._children[n]={},this._children[e][n]=!0),this._in[n]={},this._preds[n]={},this._out[n]={},this._sucs[n]={},++this._nodeCount,this)},n.prototype.node=function(t){return this._nodes[t]},n.prototype.hasNode=function(e){return t.has(this._nodes,e)},n.prototype.removeNode=function(e){var n=this;if(t.has(this._nodes,e)){var r=function(t){n.removeEdge(n._edgeObjs[t])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],t.each(this.children(e),function(t){n.setParent(t)}),delete this._children[e]),t.each(t.keys(this._in[e]),r),delete this._in[e],delete this._preds[e],t.each(t.keys(this._out[e]),r),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},n.prototype.setParent=function(n,r){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(t.isUndefined(r))r=e;else{for(var i=r+="";!t.isUndefined(i);i=this.parent(i))if(i===n)throw new Error("Setting "+r+" as parent of "+n+" would create a cycle");this.setNode(r)}return this.setNode(n),this._removeFromParentsChildList(n),this._parent[n]=r,this._children[r][n]=!0,this},n.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},n.prototype.parent=function(t){if(this._isCompound){var n=this._parent[t];if(n!==e)return n}},n.prototype.children=function(n){if(t.isUndefined(n)&&(n=e),this._isCompound){var r=this._children[n];if(r)return t.keys(r)}else{if(n===e)return this.nodes();if(this.hasNode(n))return[]}},n.prototype.predecessors=function(e){var n=this._preds[e];if(n)return t.keys(n)},n.prototype.successors=function(e){var n=this._sucs[e];if(n)return t.keys(n)},n.prototype.neighbors=function(e){var n=this.predecessors(e);if(n)return t.union(n,this.successors(e))},n.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},n.prototype.filterNodes=function(e){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;t.each(this._nodes,function(t,r){e(r)&&n.setNode(r,t)}),t.each(this._edgeObjs,function(t){n.hasNode(t.v)&&n.hasNode(t.w)&&n.setEdge(t,r.edge(t))});var i={};function A(t){var e=r.parent(t);return void 0===e||n.hasNode(e)?(i[t]=e,e):e in i?i[e]:A(e)}return this._isCompound&&t.each(n.nodes(),function(t){n.setParent(t,A(t))}),n},n.prototype.setDefaultEdgeLabel=function(e){return t.isFunction(e)||(e=t.constant(e)),this._defaultEdgeLabelFn=e,this},n.prototype.edgeCount=function(){return this._edgeCount},n.prototype.edges=function(){return t.values(this._edgeObjs)},n.prototype.setPath=function(e,n){var r=this,i=arguments;return t.reduce(e,function(t,e){return i.length>1?r.setEdge(t,e,n):r.setEdge(t,e),e}),this},n.prototype.setEdge=function(){var e,n,i,o,s=!1,a=arguments[0];"object"==typeof a&&null!==a&&"v"in a?(e=a.v,n=a.w,i=a.name,2===arguments.length&&(o=arguments[1],s=!0)):(e=a,n=arguments[1],i=arguments[3],arguments.length>2&&(o=arguments[2],s=!0)),e=""+e,n=""+n,t.isUndefined(i)||(i=""+i);var c=A(this._isDirected,e,n,i);if(t.has(this._edgeLabels,c))return s&&(this._edgeLabels[c]=o),this;if(!t.isUndefined(i)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(n),this._edgeLabels[c]=s?o:this._defaultEdgeLabelFn(e,n,i);var l=function(t,e,n,r){var i=""+e,A=""+n;if(!t&&i>A){var o=i;i=A,A=o}var s={v:i,w:A};r&&(s.name=r);return s}(this._isDirected,e,n,i);return e=l.v,n=l.w,Object.freeze(l),this._edgeObjs[c]=l,r(this._preds[n],e),r(this._sucs[e],n),this._in[n][c]=l,this._out[e][c]=l,this._edgeCount++,this},n.prototype.edge=function(t,e,n){var r=1===arguments.length?o(this._isDirected,arguments[0]):A(this._isDirected,t,e,n);return this._edgeLabels[r]},n.prototype.hasEdge=function(e,n,r){var i=1===arguments.length?o(this._isDirected,arguments[0]):A(this._isDirected,e,n,r);return t.has(this._edgeLabels,i)},n.prototype.removeEdge=function(t,e,n){var r=1===arguments.length?o(this._isDirected,arguments[0]):A(this._isDirected,t,e,n),s=this._edgeObjs[r];return s&&(t=s.v,e=s.w,delete this._edgeLabels[r],delete this._edgeObjs[r],i(this._preds[e],t),i(this._sucs[t],e),delete this._in[e][r],delete this._out[t][r],this._edgeCount--),this},n.prototype.inEdges=function(e,n){var r=this._in[e];if(r){var i=t.values(r);return n?t.filter(i,function(t){return t.v===n}):i}},n.prototype.outEdges=function(e,n){var r=this._out[e];if(r){var i=t.values(r);return n?t.filter(i,function(t){return t.w===n}):i}},n.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))},KL}function JP(){return YL?WL:(YL=1,WL={Graph:ZP(),version:zL?VL:(zL=1,VL="2.1.8")})}function $P(){if(qL)return XL;qL=1;var t=qP(),e=ZP();function n(e){return t.map(e.nodes(),function(n){var r=e.node(n),i=e.parent(n),A={v:n};return t.isUndefined(r)||(A.value=r),t.isUndefined(i)||(A.parent=i),A})}function r(e){return t.map(e.edges(),function(n){var r=e.edge(n),i={v:n.v,w:n.w};return t.isUndefined(n.name)||(i.name=n.name),t.isUndefined(r)||(i.value=r),i})}return XL={write:function(e){var i={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:n(e),edges:r(e)};t.isUndefined(e.graph())||(i.value=t.clone(e.graph()));return i},read:function(n){var r=new e(n.options).setGraph(n.value);return t.each(n.nodes,function(t){r.setNode(t.v,t.value),t.parent&&r.setParent(t.v,t.parent)}),t.each(n.edges,function(t){r.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),r}},XL}function tR(){if(JL)return ZL;JL=1;var t=qP();return ZL=function(e){var n,r={},i=[];function A(i){t.has(r,i)||(r[i]=!0,n.push(i),t.each(e.successors(i),A),t.each(e.predecessors(i),A))}return t.each(e.nodes(),function(t){n=[],A(t),n.length&&i.push(n)}),i},ZL}function eR(){if(tD)return $L;tD=1;var t=qP();function e(){this._arr=[],this._keyIndices={}}return $L=e,e.prototype.size=function(){return this._arr.length},e.prototype.keys=function(){return this._arr.map(function(t){return t.key})},e.prototype.has=function(e){return t.has(this._keyIndices,e)},e.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},e.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},e.prototype.add=function(e,n){var r=this._keyIndices;if(e=String(e),!t.has(r,e)){var i=this._arr,A=i.length;return r[e]=A,i.push({key:e,priority:n}),this._decrease(A),!0}return!1},e.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},e.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},e.prototype._heapify=function(t){var e=this._arr,n=2*t,r=n+1,i=t;n<e.length&&(i=e[n].priority<e[i].priority?n:i,r<e.length&&(i=e[r].priority<e[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))},e.prototype._decrease=function(t){for(var e,n=this._arr,r=n[t].priority;0!==t&&!(n[e=t>>1].priority<r);)this._swap(t,e),t=e},e.prototype._swap=function(t,e){var n=this._arr,r=this._keyIndices,i=n[t],A=n[e];n[t]=A,n[e]=i,r[A.key]=t,r[i.key]=e},$L}function nR(){if(nD)return eD;nD=1;var t=qP(),e=eR();eD=function(t,r,i,A){return function(t,n,r,i){var A,o,s={},a=new e,c=function(t){var e=t.v!==A?t.v:t.w,n=s[e],i=r(t),c=o.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);c<n.distance&&(n.distance=c,n.predecessor=A,a.decrease(e,c))};t.nodes().forEach(function(t){var e=t===n?0:Number.POSITIVE_INFINITY;s[t]={distance:e},a.add(t,e)});for(;a.size()>0&&(A=a.removeMin(),(o=s[A]).distance!==Number.POSITIVE_INFINITY);)i(A).forEach(c);return s}(t,String(r),i||n,A||function(e){return t.outEdges(e)})};var n=t.constant(1);return eD}function rR(){if(iD)return rD;iD=1;var t=nR(),e=qP();return rD=function(n,r,i){return e.transform(n.nodes(),function(e,A){e[A]=t(n,A,r,i)},{})},rD}function iR(){if(oD)return AD;oD=1;var t=qP();return AD=function(e){var n=0,r=[],i={},A=[];function o(s){var a=i[s]={onStack:!0,lowlink:n,index:n++};if(r.push(s),e.successors(s).forEach(function(e){t.has(i,e)?i[e].onStack&&(a.lowlink=Math.min(a.lowlink,i[e].index)):(o(e),a.lowlink=Math.min(a.lowlink,i[e].lowlink))}),a.lowlink===a.index){var c,l=[];do{c=r.pop(),i[c].onStack=!1,l.push(c)}while(s!==c);A.push(l)}}return e.nodes().forEach(function(e){t.has(i,e)||o(e)}),A},AD}function AR(){if(aD)return sD;aD=1;var t=qP(),e=iR();return sD=function(n){return t.filter(e(n),function(t){return t.length>1||1===t.length&&n.hasEdge(t[0],t[0])})},sD}function oR(){if(lD)return cD;lD=1;var t=qP();cD=function(t,n,r){return function(t,e,n){var r={},i=t.nodes();return i.forEach(function(t){r[t]={},r[t][t]={distance:0},i.forEach(function(e){t!==e&&(r[t][e]={distance:Number.POSITIVE_INFINITY})}),n(t).forEach(function(n){var i=n.v===t?n.w:n.v,A=e(n);r[t][i]={distance:A,predecessor:t}})}),i.forEach(function(t){var e=r[t];i.forEach(function(n){var A=r[n];i.forEach(function(n){var r=A[t],i=e[n],o=A[n],s=r.distance+i.distance;s<o.distance&&(o.distance=s,o.predecessor=i.predecessor)})})}),r}(t,n||e,r||function(e){return t.outEdges(e)})};var e=t.constant(1);return cD}function sR(){if(hD)return uD;hD=1;var t=qP();function e(e){var r={},i={},A=[];if(t.each(e.sinks(),function o(s){if(t.has(i,s))throw new n;t.has(r,s)||(i[s]=!0,r[s]=!0,t.each(e.predecessors(s),o),delete i[s],A.push(s))}),t.size(r)!==e.nodeCount())throw new n;return A}function n(){}return uD=e,e.CycleException=n,n.prototype=new Error,uD}function aR(){if(fD)return dD;fD=1;var t=sR();return dD=function(e){try{t(e)}catch(e){if(e instanceof t.CycleException)return!1;throw e}return!0},dD}function cR(){if(pD)return gD;pD=1;var t=qP();function e(n,r,i,A,o,s){t.has(A,r)||(A[r]=!0,i||s.push(r),t.each(o(r),function(t){e(n,t,i,A,o,s)}),i&&s.push(r))}return gD=function(n,r,i){t.isArray(r)||(r=[r]);var A=(n.isDirected()?n.successors:n.neighbors).bind(n),o=[],s={};return t.each(r,function(t){if(!n.hasNode(t))throw new Error("Graph does not have node: "+t);e(n,t,"post"===i,s,A,o)}),o},gD}function lR(){if(mD)return vD;mD=1;var t=cR();return vD=function(e,n){return t(e,n,"post")},vD}function uR(){if(wD)return yD;wD=1;var t=cR();return yD=function(e,n){return t(e,n,"pre")},yD}function hR(){if(bD)return BD;bD=1;var t=qP(),e=ZP(),n=eR();return BD=function(r,i){var A,o=new e,s={},a=new n;function c(t){var e=t.v===A?t.w:t.v,n=a.priority(e);if(void 0!==n){var r=i(t);r<n&&(s[e]=A,a.decrease(e,r))}}if(0===r.nodeCount())return o;t.each(r.nodes(),function(t){a.add(t,Number.POSITIVE_INFINITY),o.setNode(t)}),a.decrease(r.nodes()[0],0);var l=!1;for(;a.size()>0;){if(A=a.removeMin(),t.has(s,A))o.setEdge(A,s[A]);else{if(l)throw new Error("Input graph is not connected: "+r);l=!0}r.nodeEdges(A).forEach(c)}return o},BD}try{MD=function(){if(FD)return CD;FD=1;var t=JP();return CD={Graph:t.Graph,json:$P(),alg:xD?ED:(xD=1,ED={components:tR(),dijkstra:nR(),dijkstraAll:rR(),findCycles:AR(),floydWarshall:oR(),isAcyclic:aR(),postorder:lR(),preorder:uR(),prim:hR(),tarjan:iR(),topsort:sR()}),version:t.version}}()}catch(kE){}MD||(MD=window.graphlib);var dR,fR,gR,pR,vR,mR,yR,wR,BR,bR,ER,xR,CR,FR,MR,kR,QR,SR,UR,TR,OR,NR,IR,LR,DR,PR,RR,HR,_R,GR,KR,jR,VR,zR,WR,YR,XR,qR,ZR,JR,$R,tH,eH,nH,rH,iH,AH,oH,sH,aH,cH,lH,uH,hH,dH,fH,gH,pH,vH,mH,yH,wH,BH,bH,EH,xH,CH,FH,MH,kH,QH,SH,UH,TH,OH,NH,IH,LH,DH,PH,RH,HH,_H,GH,KH,jH,VH,zH,WH,YH,XH,qH,ZH,JH=MD;function $H(){if(pR)return gR;pR=1;var t=zS(),e=fT(),n=UU(),r=$S();return gR=function(i,A,o){if(!r(o))return!1;var s=typeof A;return!!("number"==s?e(o)&&n(A,o.length):"string"==s&&A in o)&&t(o[A],i)},gR}function t_(){if(xR)return ER;xR=1;var t=function(){if(bR)return BR;bR=1;var t=/\s/;return BR=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n},BR}(),e=/^\s+/;return ER=function(n){return n?n.slice(0,t(n)+1).replace(e,""):n}}function e_(){if(kR)return MR;kR=1;var t=function(){if(FR)return CR;FR=1;var t=t_(),e=$S(),n=gP(),r=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,A=/^0o[0-7]+$/i,o=parseInt;return CR=function(s){if("number"==typeof s)return s;if(n(s))return NaN;if(e(s)){var a="function"==typeof s.valueOf?s.valueOf():s;s=e(a)?a+"":a}if("string"!=typeof s)return 0===s?s:+s;s=t(s);var c=i.test(s);return c||A.test(s)?o(s.slice(2),c?2:8):r.test(s)?NaN:+s}}(),e=1/0;return MR=function(n){return n?(n=t(n))===e||n===-1/0?17976931348623157e292*(n<0?-1:1):n==n?n:0:0===n?n:0}}function n_(){if(TR)return UR;TR=1;var t=KP(),e=kP(),n=function(){if(SR)return QR;SR=1;var t=e_();return QR=function(e){var n=t(e),r=n%1;return n==n?r?n-r:n:0}}(),r=Math.max;return UR=function(i,A,o){var s=null==i?0:i.length;if(!s)return-1;var a=null==o?0:n(o);return a<0&&(a=r(s+a,0)),t(i,e(A,3),a)},UR}function r_(){if(LR)return IR;LR=1;var t=RP();return IR=function(e){return(null==e?0:e.length)?t(e,1):[]}}function i_(){if(jR)return KR;jR=1;var t=gP();return KR=function(e,n,r){for(var i=-1,A=e.length;++i<A;){var o=e[i],s=n(o);if(null!=s&&(void 0===a?s==s&&!t(s):r(s,a)))var a=s,c=o}return c},KR}function A_(){if(qR)return XR;qR=1;var t=hU(),e=zS();return XR=function(n,r,i){(void 0!==i&&!e(n[r],i)||void 0===i&&!(r in n))&&t(n,r,i)}}function o_(){if(tH)return $R;return tH=1,$R=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}}function s_(){if(iH)return rH;iH=1;var t=A_(),e=QD(),n=KD(),r=SD(),i=zD(),A=pU(),o=vU(),s=WP(),a=SU(),c=tU(),l=$S(),u=function(){if(JR)return ZR;JR=1;var t=JS(),e=ID(),n=gU(),r=Function.prototype,i=Object.prototype,A=r.toString,o=i.hasOwnProperty,s=A.call(Object);return ZR=function(r){if(!n(r)||"[object Object]"!=t(r))return!1;var i=e(r);if(null===i)return!0;var a=o.call(i,"constructor")&&i.constructor;return"function"==typeof a&&a instanceof a&&A.call(a)==s}}(),h=cT(),d=o_(),f=function(){if(nH)return eH;nH=1;var t=fU(),e=vT();return eH=function(n){return t(n,e(n))}}();return rH=function(g,p,v,m,y,w,B){var b=d(g,v),E=d(p,v),x=B.get(E);if(x)t(g,v,x);else{var C=w?w(b,E,v+"",g,p,B):void 0,F=void 0===C;if(F){var M=o(E),k=!M&&a(E),Q=!M&&!k&&h(E);C=E,M||k||Q?o(b)?C=b:s(b)?C=r(b):k?(F=!1,C=e(E,!0)):Q?(F=!1,C=n(E,!0)):C=[]:u(E)||A(E)?(C=b,A(b)?C=f(b):l(b)&&!c(b)||(C=i(E))):F=!1}F&&(B.set(E,C),y(C,E,m,w,B),B.delete(E)),t(g,v,C)}}}function a_(){if(hH)return uH;return hH=1,uH=function(t,e){return t<e}}function c_(){if(bH)return BH;bH=1;var t=bP(),e=function(){if(wH)return yH;wH=1;var t=dU(),e=wP(),n=UU(),r=$S(),i=BP();return yH=function(A,o,s,a){if(!r(A))return A;for(var c=-1,l=(o=e(o,A)).length,u=l-1,h=A;null!=h&&++c<l;){var d=i(o[c]),f=s;if("__proto__"===d||"constructor"===d||"prototype"===d)return A;if(c!=u){var g=h[d];void 0===(f=a?a(g,d,h):void 0)&&(f=r(g)?g:n(o[c+1])?[]:{})}t(h,d,f),h=h[d]}return A},yH}(),n=wP();return BH=function(r,i,A){for(var o=-1,s=i.length,a={};++o<s;){var c=i[o],l=t(r,c);A(l,c)&&e(a,n(c,r),l)}return a},BH}function l_(){if(TH)return UH;TH=1;var t=function(){if(SH)return QH;SH=1;var t=Math.ceil,e=Math.max;return QH=function(n,r,i,A){for(var o=-1,s=e(t((r-n)/(i||1)),0),a=Array(s);s--;)a[A?s:++o]=n,n+=i;return a},QH}(),e=$H(),n=e_();return UH=function(r){return function(i,A,o){return o&&"number"!=typeof o&&e(i,A,o)&&(A=o=void 0),i=n(i),void 0===A?(A=i,i=0):A=n(A),o=void 0===o?i<A?1:-1:n(o),t(i,A,o,r)}},UH}function u_(){if(HH)return RH;HH=1;var t=function(){if(PH)return DH;PH=1;var t=gP();return DH=function(e,n){if(e!==n){var r=void 0!==e,i=null===e,A=e==e,o=t(e),s=void 0!==n,a=null===n,c=n==n,l=t(n);if(!a&&!l&&!o&&e>n||o&&s&&c&&!a&&!l||i&&s&&c||!r&&c||!A)return 1;if(!i&&!o&&!l&&e<n||l&&r&&A&&!i&&!o||a&&r&&A||!s&&A||!c)return-1}return 0}}();return RH=function(e,n,r){for(var i=-1,A=e.criteria,o=n.criteria,s=A.length,a=r.length;++i<s;){var c=t(A[i],o[i]);if(c)return i>=a?c:c*("desc"==r[i]?-1:1)}return e.index-n.index},RH}function h_(){if(GH)return _H;GH=1;var t=mP(),e=bP(),n=kP(),r=OP(),i=(LH||(LH=1,IH=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}),IH),A=OU(),o=u_(),s=eP(),a=vU();return _H=function(c,l,u){l=l.length?t(l,function(t){return a(t)?function(n){return e(n,1===t.length?t[0]:t)}:t}):[s];var h=-1;l=t(l,A(n));var d=r(c,function(e,n,r){return{criteria:t(l,function(t){return t(e)}),index:++h,value:e}});return i(d,function(t,e){return o(t,e,u)})},_H}try{ZH={cloneDeep:function(){if(fR)return dR;fR=1;var t=XD();return dR=function(e){return t(e,5)}}(),constant:ZD(),defaults:function(){if(mR)return vR;mR=1;var t=GP(),e=zS(),n=$H(),r=vT(),i=Object.prototype,A=i.hasOwnProperty,o=t(function(t,o){t=Object(t);var s=-1,a=o.length,c=a>2?o[2]:void 0;for(c&&n(o[0],o[1],c)&&(a=1);++s<a;)for(var l=o[s],u=r(l),h=-1,d=u.length;++h<d;){var f=u[h],g=t[f];(void 0===g||e(g,i[f])&&!A.call(t,f))&&(t[f]=l[f])}return t});return vR=o}(),each:iP(),filter:QP(),find:function(){if(NR)return OR;NR=1;var t=function(){if(wR)return yR;wR=1;var t=kP(),e=fT(),n=gT();return yR=function(r){return function(i,A,o){var s=Object(i);if(!e(i)){var a=t(A,3);i=n(i),A=function(t){return a(s[t],t,s)}}var c=r(i,A,o);return c>-1?s[a?i[c]:c]:void 0}},yR}(),e=t(n_());return OR=e}(),flatten:r_(),forEach:rP(),forIn:function(){if(PR)return DR;PR=1;var t=JD(),e=nP(),n=vT();return DR=function(r,i){return null==r?r:t(r,e(i),n)}}(),has:SP(),isUndefined:TP(),last:(HR||(HR=1,RR=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}),RR),map:NP(),mapValues:function(){if(GR)return _R;GR=1;var t=hU(),e=$D(),n=kP();return _R=function(r,i){var A={};return i=n(i,3),e(r,function(e,n,r){t(A,n,i(e,n,r))}),A}}(),max:function(){if(YR)return WR;YR=1;var t=i_(),e=zR?VR:(zR=1,VR=function(t,e){return t>e}),n=eP();return WR=function(r){return r&&r.length?t(r,n,e):void 0}}(),merge:function(){if(lH)return cH;lH=1;var t=function(){if(oH)return AH;oH=1;var t=cU(),e=A_(),n=JD(),r=s_(),i=$S(),A=vT(),o=o_();return AH=function s(a,c,l,u,h){a!==c&&n(c,function(n,A){if(h||(h=new t),i(n))r(a,c,A,l,s,u,h);else{var d=u?u(o(a,A),n,A+"",a,c,h):void 0;void 0===d&&(d=n),e(a,A,d)}},A)},AH}(),e=function(){if(aH)return sH;aH=1;var t=GP(),e=$H();return sH=function(n){return t(function(t,r){var i=-1,A=r.length,o=A>1?r[A-1]:void 0,s=A>2?r[2]:void 0;for(o=n.length>3&&"function"==typeof o?(A--,o):void 0,s&&e(r[0],r[1],s)&&(o=A<3?void 0:o,A=1),t=Object(t);++i<A;){var a=r[i];a&&n(t,a,i,o)}return t})},sH}(),n=e(function(e,n,r){t(e,n,r)});return cH=n}(),min:function(){if(fH)return dH;fH=1;var t=i_(),e=a_(),n=eP();return dH=function(r){return r&&r.length?t(r,n,e):void 0}}(),minBy:function(){if(pH)return gH;pH=1;var t=i_(),e=kP(),n=a_();return gH=function(r,i){return r&&r.length?t(r,e(i,2),n):void 0}}(),now:function(){if(mH)return vH;mH=1;var t=qS();return vH=function(){return t.Date.now()}}(),pick:function(){if(kH)return MH;kH=1;var t=function(){if(xH)return EH;xH=1;var t=c_(),e=xP();return EH=function(n,r){return t(n,r,function(t,r){return e(n,r)})}}(),e=function(){if(FH)return CH;FH=1;var t=r_(),e=HP(),n=_P();return CH=function(r){return n(e(r,void 0,t),r+"")}}(),n=e(function(e,n){return null==e?{}:t(e,n)});return MH=n}(),range:function(){if(NH)return OH;NH=1;var t=l_()();return OH=t}(),reduce:IP(),sortBy:function(){if(jH)return KH;jH=1;var t=RP(),e=h_(),n=GP(),r=$H(),i=n(function(n,i){if(null==n)return[];var A=i.length;return A>1&&r(n,i[0],i[1])?i=[]:A>2&&r(i[0],i[1],i[2])&&(i=[i[0]]),e(n,t(i,1),[])});return KH=i}(),uniqueId:function(){if(zH)return VH;zH=1;var t=yP(),e=0;return VH=function(n){var r=++e;return t(n)+r},VH}(),values:XP(),zipObject:function(){if(qH)return XH;qH=1;var t=dU(),e=(YH||(YH=1,WH=function(t,e,n){for(var r=-1,i=t.length,A=e.length,o={};++r<i;){var s=r<A?e[r]:void 0;n(o,t[r],s)}return o}),WH);return XH=function(n,r){return e(n||[],r||[],t)},XH}()}}catch(kE){}ZH||(ZH=window._);var d_=ZH,f_=g_;function g_(){var t={};t._next=t._prev=t,this._sentinel=t}function p_(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function v_(t,e){if("_next"!==t&&"_prev"!==t)return e}g_.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return p_(e),e},g_.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&p_(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},g_.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,v_)),n=n._prev;return"["+t.join(", ")+"]"};var m_=d_,y_=JH.Graph,w_=f_,B_=function(t,e){if(t.nodeCount()<=1)return[];var n=function(t,e){var n=new y_,r=0,i=0;m_.forEach(t.nodes(),function(t){n.setNode(t,{v:t,in:0,out:0})}),m_.forEach(t.edges(),function(t){var A=n.edge(t.v,t.w)||0,o=e(t),s=A+o;n.setEdge(t.v,t.w,s),i=Math.max(i,n.node(t.v).out+=o),r=Math.max(r,n.node(t.w).in+=o)});var A=m_.range(i+r+3).map(function(){return new w_}),o=r+1;return m_.forEach(n.nodes(),function(t){x_(A,o,n.node(t))}),{graph:n,buckets:A,zeroIdx:o}}(t,e||b_),r=function(t,e,n){var r,i=[],A=e[e.length-1],o=e[0];for(;t.nodeCount();){for(;r=o.dequeue();)E_(t,e,n,r);for(;r=A.dequeue();)E_(t,e,n,r);if(t.nodeCount())for(var s=e.length-2;s>0;--s)if(r=e[s].dequeue()){i=i.concat(E_(t,e,n,r,!0));break}}return i}(n.graph,n.buckets,n.zeroIdx);return m_.flatten(m_.map(r,function(e){return t.outEdges(e.v,e.w)}),!0)},b_=m_.constant(1);function E_(t,e,n,r,i){var A=i?[]:void 0;return m_.forEach(t.inEdges(r.v),function(r){var o=t.edge(r),s=t.node(r.v);i&&A.push({v:r.v,w:r.w}),s.out-=o,x_(e,n,s)}),m_.forEach(t.outEdges(r.v),function(r){var i=t.edge(r),A=r.w,o=t.node(A);o.in-=i,x_(e,n,o)}),t.removeNode(r.v),A}function x_(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}var C_=d_,F_=B_,M_={run:function(t){var e="greedy"===t.graph().acyclicer?F_(t,function(t){return function(e){return t.edge(e).weight}}(t)):function(t){var e=[],n={},r={};function i(A){C_.has(r,A)||(r[A]=!0,n[A]=!0,C_.forEach(t.outEdges(A),function(t){C_.has(n,t.w)?e.push(t):i(t.w)}),delete n[A])}return C_.forEach(t.nodes(),i),e}(t);C_.forEach(e,function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,C_.uniqueId("rev"))})},undo:function(t){C_.forEach(t.edges(),function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var r=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,r)}})}};var k_=d_,Q_=JH.Graph,S_={addDummyNode:U_,simplify:function(t){var e=(new Q_).setGraph(t.graph());return k_.forEach(t.nodes(),function(n){e.setNode(n,t.node(n))}),k_.forEach(t.edges(),function(n){var r=e.edge(n.v,n.w)||{weight:0,minlen:1},i=t.edge(n);e.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),e},asNonCompoundGraph:function(t){var e=new Q_({multigraph:t.isMultigraph()}).setGraph(t.graph());return k_.forEach(t.nodes(),function(n){t.children(n).length||e.setNode(n,t.node(n))}),k_.forEach(t.edges(),function(n){e.setEdge(n,t.edge(n))}),e},successorWeights:function(t){var e=k_.map(t.nodes(),function(e){var n={};return k_.forEach(t.outEdges(e),function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight}),n});return k_.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=k_.map(t.nodes(),function(e){var n={};return k_.forEach(t.inEdges(e),function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight}),n});return k_.zipObject(t.nodes(),e)},intersectRect:function(t,e){var n,r,i=t.x,A=t.y,o=e.x-i,s=e.y-A,a=t.width/2,c=t.height/2;if(!o&&!s)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(s)*a>Math.abs(o)*c?(s<0&&(c=-c),n=c*o/s,r=c):(o<0&&(a=-a),n=a,r=a*s/o);return{x:i+n,y:A+r}},buildLayerMatrix:function(t){var e=k_.map(k_.range(T_(t)+1),function(){return[]});return k_.forEach(t.nodes(),function(n){var r=t.node(n),i=r.rank;k_.isUndefined(i)||(e[i][r.order]=n)}),e},normalizeRanks:function(t){var e=k_.min(k_.map(t.nodes(),function(e){return t.node(e).rank}));k_.forEach(t.nodes(),function(n){var r=t.node(n);k_.has(r,"rank")&&(r.rank-=e)})},removeEmptyRanks:function(t){var e=k_.min(k_.map(t.nodes(),function(e){return t.node(e).rank})),n=[];k_.forEach(t.nodes(),function(r){var i=t.node(r).rank-e;n[i]||(n[i]=[]),n[i].push(r)});var r=0,i=t.graph().nodeRankFactor;k_.forEach(n,function(e,n){k_.isUndefined(e)&&n%i!==0?--r:r&&k_.forEach(e,function(e){t.node(e).rank+=r})})},addBorderNode:function(t,e,n,r){var i={width:0,height:0};arguments.length>=4&&(i.rank=n,i.order=r);return U_(t,"border",i,e)},maxRank:T_,partition:function(t,e){var n={lhs:[],rhs:[]};return k_.forEach(t,function(t){e(t)?n.lhs.push(t):n.rhs.push(t)}),n},time:function(t,e){var n=k_.now();try{return e()}finally{console.log(t+" time: "+(k_.now()-n)+"ms")}},notime:function(t,e){return e()}};function U_(t,e,n,r){var i;do{i=k_.uniqueId(r)}while(t.hasNode(i));return n.dummy=e,t.setNode(i,n),i}function T_(t){return k_.max(k_.map(t.nodes(),function(e){var n=t.node(e).rank;if(!k_.isUndefined(n))return n}))}var O_=d_,N_=S_,I_={run:function(t){t.graph().dummyChains=[],O_.forEach(t.edges(),function(e){!function(t,e){var n,r,i,A=e.v,o=t.node(A).rank,s=e.w,a=t.node(s).rank,c=e.name,l=t.edge(e),u=l.labelRank;if(a===o+1)return;for(t.removeEdge(e),i=0,++o;o<a;++i,++o)l.points=[],r={width:0,height:0,edgeLabel:l,edgeObj:e,rank:o},n=N_.addDummyNode(t,"edge",r,"_d"),o===u&&(r.width=l.width,r.height=l.height,r.dummy="edge-label",r.labelpos=l.labelpos),t.setEdge(A,n,{weight:l.weight},c),0===i&&t.graph().dummyChains.push(n),A=n;t.setEdge(A,s,{weight:l.weight},c)}(t,e)})},undo:function(t){O_.forEach(t.graph().dummyChains,function(e){var n,r=t.node(e),i=r.edgeLabel;for(t.setEdge(r.edgeObj,i);r.dummy;)n=t.successors(e)[0],t.removeNode(e),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),e=n,r=t.node(e)})}};var L_=d_,D_={longestPath:function(t){var e={};L_.forEach(t.sources(),function n(r){var i=t.node(r);if(L_.has(e,r))return i.rank;e[r]=!0;var A=L_.min(L_.map(t.outEdges(r),function(e){return n(e.w)-t.edge(e).minlen}));return A!==Number.POSITIVE_INFINITY&&null!=A||(A=0),i.rank=A})},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}};var P_=d_,R_=JH.Graph,H_=D_.slack,__=function(t){var e,n,r=new R_({directed:!1}),i=t.nodes()[0],A=t.nodeCount();r.setNode(i,{});for(;G_(r,t)<A;)e=K_(r,t),n=r.hasNode(e.v)?H_(t,e):-H_(t,e),j_(r,t,n);return r};function G_(t,e){return P_.forEach(t.nodes(),function n(r){P_.forEach(e.nodeEdges(r),function(i){var A=i.v,o=r===A?i.w:A;t.hasNode(o)||H_(e,i)||(t.setNode(o,{}),t.setEdge(r,o,{}),n(o))})}),t.nodeCount()}function K_(t,e){return P_.minBy(e.edges(),function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return H_(e,n)})}function j_(t,e,n){P_.forEach(t.nodes(),function(t){e.node(t).rank+=n})}var V_=d_,z_=__,W_=D_.slack,Y_=D_.longestPath,X_=JH.alg.preorder,q_=JH.alg.postorder,Z_=S_.simplify,J_=$_;function $_(t){t=Z_(t),Y_(t);var e,n=z_(t);for(nG(n),tG(n,t);e=iG(n);)oG(n,t,e,AG(n,t,e))}function tG(t,e){var n=q_(t,t.nodes());n=n.slice(0,n.length-1),V_.forEach(n,function(n){!function(t,e,n){var r=t.node(n),i=r.parent;t.edge(n,i).cutvalue=eG(t,e,n)}(t,e,n)})}function eG(t,e,n){var r=t.node(n).parent,i=!0,A=e.edge(n,r),o=0;return A||(i=!1,A=e.edge(r,n)),o=A.weight,V_.forEach(e.nodeEdges(n),function(A){var s=A.v===n,a=s?A.w:A.v;if(a!==r){var c=s===i,l=e.edge(A).weight;if(o+=c?l:-l,function(t,e,n){return t.hasEdge(e,n)}(t,n,a)){var u=t.edge(n,a).cutvalue;o+=c?-u:u}}}),o}function nG(t,e){arguments.length<2&&(e=t.nodes()[0]),rG(t,{},1,e)}function rG(t,e,n,r,i){var A=n,o=t.node(r);return e[r]=!0,V_.forEach(t.neighbors(r),function(i){V_.has(e,i)||(n=rG(t,e,n,i,r))}),o.low=A,o.lim=n++,i?o.parent=i:delete o.parent,n}function iG(t){return V_.find(t.edges(),function(e){return t.edge(e).cutvalue<0})}function AG(t,e,n){var r=n.v,i=n.w;e.hasEdge(r,i)||(r=n.w,i=n.v);var A=t.node(r),o=t.node(i),s=A,a=!1;A.lim>o.lim&&(s=o,a=!0);var c=V_.filter(e.edges(),function(e){return a===sG(t,t.node(e.v),s)&&a!==sG(t,t.node(e.w),s)});return V_.minBy(c,function(t){return W_(e,t)})}function oG(t,e,n,r){var i=n.v,A=n.w;t.removeEdge(i,A),t.setEdge(r.v,r.w,{}),nG(t),tG(t,e),function(t,e){var n=V_.find(t.nodes(),function(t){return!e.node(t).parent}),r=X_(t,n);r=r.slice(1),V_.forEach(r,function(n){var r=t.node(n).parent,i=e.edge(n,r),A=!1;i||(i=e.edge(r,n),A=!0),e.node(n).rank=e.node(r).rank+(A?i.minlen:-i.minlen)})}(t,e)}function sG(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}$_.initLowLimValues=nG,$_.initCutValues=tG,$_.calcCutValue=eG,$_.leaveEdge=iG,$_.enterEdge=AG,$_.exchangeEdges=oG;var aG=D_.longestPath,cG=__,lG=J_,uG=function(t){switch(t.graph().ranker){case"network-simplex":default:dG(t);break;case"tight-tree":!function(t){aG(t),cG(t)}(t);break;case"longest-path":hG(t)}};var hG=aG;function dG(t){lG(t)}var fG=d_,gG=function(t){var e=function(t){var e={},n=0;function r(i){var A=n;fG.forEach(t.children(i),r),e[i]={low:A,lim:n++}}return fG.forEach(t.children(),r),e}(t);fG.forEach(t.graph().dummyChains,function(n){for(var r=t.node(n),i=r.edgeObj,A=function(t,e,n,r){var i,A,o=[],s=[],a=Math.min(e[n].low,e[r].low),c=Math.max(e[n].lim,e[r].lim);i=n;do{i=t.parent(i),o.push(i)}while(i&&(e[i].low>a||c>e[i].lim));A=i,i=r;for(;(i=t.parent(i))!==A;)s.push(i);return{path:o.concat(s.reverse()),lca:A}}(t,e,i.v,i.w),o=A.path,s=A.lca,a=0,c=o[a],l=!0;n!==i.w;){if(r=t.node(n),l){for(;(c=o[a])!==s&&t.node(c).maxRank<r.rank;)a++;c===s&&(l=!1)}if(!l){for(;a<o.length-1&&t.node(c=o[a+1]).minRank<=r.rank;)a++;c=o[a]}t.setParent(n,c),n=t.successors(n)[0]}})};var pG=d_,vG=S_,mG={run:function(t){var e=vG.addDummyNode(t,"root",{},"_root"),n=function(t){var e={};function n(r,i){var A=t.children(r);A&&A.length&&pG.forEach(A,function(t){n(t,i+1)}),e[r]=i}return pG.forEach(t.children(),function(t){n(t,1)}),e}(t),r=pG.max(pG.values(n))-1,i=2*r+1;t.graph().nestingRoot=e,pG.forEach(t.edges(),function(e){t.edge(e).minlen*=i});var A=function(t){return pG.reduce(t.edges(),function(e,n){return e+t.edge(n).weight},0)}(t)+1;pG.forEach(t.children(),function(o){yG(t,e,i,A,r,n,o)}),t.graph().nodeRankFactor=i},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,pG.forEach(t.edges(),function(e){t.edge(e).nestingEdge&&t.removeEdge(e)})}};function yG(t,e,n,r,i,A,o){var s=t.children(o);if(s.length){var a=vG.addBorderNode(t,"_bt"),c=vG.addBorderNode(t,"_bb"),l=t.node(o);t.setParent(a,o),l.borderTop=a,t.setParent(c,o),l.borderBottom=c,pG.forEach(s,function(s){yG(t,e,n,r,i,A,s);var l=t.node(s),u=l.borderTop?l.borderTop:s,h=l.borderBottom?l.borderBottom:s,d=l.borderTop?r:2*r,f=u!==h?1:i-A[o]+1;t.setEdge(a,u,{weight:d,minlen:f,nestingEdge:!0}),t.setEdge(h,c,{weight:d,minlen:f,nestingEdge:!0})}),t.parent(o)||t.setEdge(e,a,{weight:0,minlen:i+A[o]})}else o!==e&&t.setEdge(e,o,{weight:0,minlen:n})}var wG=d_,BG=S_,bG=function(t){wG.forEach(t.children(),function e(n){var r=t.children(n),i=t.node(n);if(r.length&&wG.forEach(r,e),wG.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var A=i.minRank,o=i.maxRank+1;A<o;++A)EG(t,"borderLeft","_bl",n,i,A),EG(t,"borderRight","_br",n,i,A)}})};function EG(t,e,n,r,i,A){var o={width:0,height:0,rank:A,borderType:e},s=i[e][A-1],a=BG.addDummyNode(t,"border",o,n);i[e][A]=a,t.setParent(a,r),s&&t.setEdge(s,a,{weight:1})}var xG=d_,CG={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||FG(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){xG.forEach(t.nodes(),function(e){kG(t.node(e))}),xG.forEach(t.edges(),function(e){var n=t.edge(e);xG.forEach(n.points,kG),xG.has(n,"y")&&kG(n)})}(t);"lr"!==e&&"rl"!==e||(!function(t){xG.forEach(t.nodes(),function(e){QG(t.node(e))}),xG.forEach(t.edges(),function(e){var n=t.edge(e);xG.forEach(n.points,QG),xG.has(n,"x")&&QG(n)})}(t),FG(t))}};function FG(t){xG.forEach(t.nodes(),function(e){MG(t.node(e))}),xG.forEach(t.edges(),function(e){MG(t.edge(e))})}function MG(t){var e=t.width;t.width=t.height,t.height=e}function kG(t){t.y=-t.y}function QG(t){var e=t.x;t.x=t.y,t.y=e}var SG=d_,UG=function(t){var e={},n=SG.filter(t.nodes(),function(e){return!t.children(e).length}),r=SG.max(SG.map(n,function(e){return t.node(e).rank})),i=SG.map(SG.range(r+1),function(){return[]});function A(n){if(!SG.has(e,n)){e[n]=!0;var r=t.node(n);i[r.rank].push(n),SG.forEach(t.successors(n),A)}}var o=SG.sortBy(n,function(e){return t.node(e).rank});return SG.forEach(o,A),i};var TG=d_,OG=function(t,e){for(var n=0,r=1;r<e.length;++r)n+=NG(t,e[r-1],e[r]);return n};function NG(t,e,n){for(var r=TG.zipObject(n,TG.map(n,function(t,e){return e})),i=TG.flatten(TG.map(e,function(e){return TG.sortBy(TG.map(t.outEdges(e),function(e){return{pos:r[e.w],weight:t.edge(e).weight}}),"pos")}),!0),A=1;A<n.length;)A<<=1;var o=2*A-1;A-=1;var s=TG.map(new Array(o),function(){return 0}),a=0;return TG.forEach(i.forEach(function(t){var e=t.pos+A;s[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=s[e+1]),s[e=e-1>>1]+=t.weight;a+=t.weight*n})),a}var IG=d_,LG=function(t,e){return IG.map(e,function(e){var n=t.inEdges(e);if(n.length){var r=IG.reduce(n,function(e,n){var r=t.edge(n),i=t.node(n.v);return{sum:e.sum+r.weight*i.order,weight:e.weight+r.weight}},{sum:0,weight:0});return{v:e,barycenter:r.sum/r.weight,weight:r.weight}}return{v:e}})};var DG=d_,PG=function(t,e){var n={};return DG.forEach(t,function(t,e){var r=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};DG.isUndefined(t.barycenter)||(r.barycenter=t.barycenter,r.weight=t.weight)}),DG.forEach(e.edges(),function(t){var e=n[t.v],r=n[t.w];DG.isUndefined(e)||DG.isUndefined(r)||(r.indegree++,e.out.push(n[t.w]))}),function(t){var e=[];function n(t){return function(e){e.merged||(DG.isUndefined(e.barycenter)||DG.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&function(t,e){var n=0,r=0;t.weight&&(n+=t.barycenter*t.weight,r+=t.weight);e.weight&&(n+=e.barycenter*e.weight,r+=e.weight);t.vs=e.vs.concat(t.vs),t.barycenter=n/r,t.weight=r,t.i=Math.min(e.i,t.i),e.merged=!0}(t,e)}}function r(e){return function(n){n.in.push(e),0===--n.indegree&&t.push(n)}}for(;t.length;){var i=t.pop();e.push(i),DG.forEach(i.in.reverse(),n(i)),DG.forEach(i.out,r(i))}return DG.map(DG.filter(e,function(t){return!t.merged}),function(t){return DG.pick(t,["vs","i","barycenter","weight"])})}(DG.filter(n,function(t){return!t.indegree}))};var RG=d_,HG=S_;function _G(t,e,n){for(var r;e.length&&(r=RG.last(e)).i<=n;)e.pop(),t.push(r.vs),n++;return n}var GG=d_,KG=LG,jG=PG,VG=function(t,e){var n=HG.partition(t,function(t){return RG.has(t,"barycenter")}),r=n.lhs,i=RG.sortBy(n.rhs,function(t){return-t.i}),A=[],o=0,s=0,a=0;r.sort((c=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:c?e.i-t.i:t.i-e.i})),a=_G(A,i,a),RG.forEach(r,function(t){a+=t.vs.length,A.push(t.vs),o+=t.barycenter*t.weight,s+=t.weight,a=_G(A,i,a)});var c;var l={vs:RG.flatten(A,!0)};s&&(l.barycenter=o/s,l.weight=s);return l},zG=function t(e,n,r,i){var A=e.children(n),o=e.node(n),s=o?o.borderLeft:void 0,a=o?o.borderRight:void 0,c={};s&&(A=GG.filter(A,function(t){return t!==s&&t!==a}));var l=KG(e,A);GG.forEach(l,function(n){if(e.children(n.v).length){var A=t(e,n.v,r,i);c[n.v]=A,GG.has(A,"barycenter")&&(o=n,s=A,GG.isUndefined(o.barycenter)?(o.barycenter=s.barycenter,o.weight=s.weight):(o.barycenter=(o.barycenter*o.weight+s.barycenter*s.weight)/(o.weight+s.weight),o.weight+=s.weight))}var o,s});var u=jG(l,r);!function(t,e){GG.forEach(t,function(t){t.vs=GG.flatten(t.vs.map(function(t){return e[t]?e[t].vs:t}),!0)})}(u,c);var h=VG(u,i);if(s&&(h.vs=GG.flatten([s,h.vs,a],!0),e.predecessors(s).length)){var d=e.node(e.predecessors(s)[0]),f=e.node(e.predecessors(a)[0]);GG.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+d.order+f.order)/(h.weight+2),h.weight+=2}return h};var WG=d_,YG=JH.Graph,XG=function(t,e,n){var r=function(t){var e;for(;t.hasNode(e=WG.uniqueId("_root")););return e}(t),i=new YG({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(e){return t.node(e)});return WG.forEach(t.nodes(),function(A){var o=t.node(A),s=t.parent(A);(o.rank===e||o.minRank<=e&&e<=o.maxRank)&&(i.setNode(A),i.setParent(A,s||r),WG.forEach(t[n](A),function(e){var n=e.v===A?e.w:e.v,r=i.edge(n,A),o=WG.isUndefined(r)?0:r.weight;i.setEdge(n,A,{weight:t.edge(e).weight+o})}),WG.has(o,"minRank")&&i.setNode(A,{borderLeft:o.borderLeft[e],borderRight:o.borderRight[e]}))}),i};var qG=d_,ZG=function(t,e,n){var r,i={};qG.forEach(n,function(n){for(var A,o,s=t.parent(n);s;){if((A=t.parent(s))?(o=i[A],i[A]=s):(o=r,r=s),o&&o!==s)return void e.setEdge(o,s);s=A}})};var JG=d_,$G=UG,tK=OG,eK=zG,nK=XG,rK=ZG,iK=JH.Graph,AK=S_,oK=function(t){var e=AK.maxRank(t),n=sK(t,JG.range(1,e+1),"inEdges"),r=sK(t,JG.range(e-1,-1,-1),"outEdges"),i=$G(t);cK(t,i);for(var A,o=Number.POSITIVE_INFINITY,s=0,a=0;a<4;++s,++a){aK(s%2?n:r,s%4>=2),i=AK.buildLayerMatrix(t);var c=tK(t,i);c<o&&(a=0,A=JG.cloneDeep(i),o=c)}cK(t,A)};function sK(t,e,n){return JG.map(e,function(e){return nK(t,e,n)})}function aK(t,e){var n=new iK;JG.forEach(t,function(t){var r=t.graph().root,i=eK(t,r,n,e);JG.forEach(i.vs,function(e,n){t.node(e).order=n}),rK(t,n,i.vs)})}function cK(t,e){JG.forEach(e,function(e){JG.forEach(e,function(e,n){t.node(e).order=n})})}var lK=d_,uK=JH.Graph,hK=S_,dK=function(t){var e,n=hK.buildLayerMatrix(t),r=lK.merge(function(t,e){var n={};function r(e,r){var i=0,A=0,o=e.length,s=lK.last(r);return lK.forEach(r,function(e,a){var c=function(t,e){if(t.node(e).dummy)return lK.find(t.predecessors(e),function(e){return t.node(e).dummy})}(t,e),l=c?t.node(c).order:o;(c||e===s)&&(lK.forEach(r.slice(A,a+1),function(e){lK.forEach(t.predecessors(e),function(r){var A=t.node(r),o=A.order;!(o<i||l<o)||A.dummy&&t.node(e).dummy||fK(n,r,e)})}),A=a+1,i=l)}),r}return lK.reduce(e,r),n}(t,n),function(t,e){var n={};function r(e,r,i,A,o){var s;lK.forEach(lK.range(r,i),function(r){s=e[r],t.node(s).dummy&&lK.forEach(t.predecessors(s),function(e){var r=t.node(e);r.dummy&&(r.order<A||r.order>o)&&fK(n,e,s)})})}function i(e,n){var i,A=-1,o=0;return lK.forEach(n,function(s,a){if("border"===t.node(s).dummy){var c=t.predecessors(s);c.length&&(i=t.node(c[0]).order,r(n,o,a,A,i),o=a,A=i)}r(n,o,n.length,i,e.length)}),n}return lK.reduce(e,i),n}(t,n)),i={};lK.forEach(["u","d"],function(A){e="u"===A?n:lK.values(n).reverse(),lK.forEach(["l","r"],function(n){"r"===n&&(e=lK.map(e,function(t){return lK.values(t).reverse()}));var o=("u"===A?t.predecessors:t.successors).bind(t),s=function(t,e,n,r){var i={},A={},o={};return lK.forEach(e,function(t){lK.forEach(t,function(t,e){i[t]=t,A[t]=t,o[t]=e})}),lK.forEach(e,function(t){var e=-1;lK.forEach(t,function(t){var s=r(t);if(s.length){s=lK.sortBy(s,function(t){return o[t]});for(var a=(s.length-1)/2,c=Math.floor(a),l=Math.ceil(a);c<=l;++c){var u=s[c];A[t]===t&&e<o[u]&&!gK(n,t,u)&&(A[u]=t,A[t]=i[t]=i[u],e=o[u])}}})}),{root:i,align:A}}(0,e,r,o),a=function(t,e,n,r,i){var A={},o=function(t,e,n,r){var i=new uK,A=t.graph(),o=function(t,e,n){return function(r,i,A){var o,s=r.node(i),a=r.node(A),c=0;if(c+=s.width/2,lK.has(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":o=-s.width/2;break;case"r":o=s.width/2}if(o&&(c+=n?o:-o),o=0,c+=(s.dummy?e:t)/2,c+=(a.dummy?e:t)/2,c+=a.width/2,lK.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":o=a.width/2;break;case"r":o=-a.width/2}return o&&(c+=n?o:-o),o=0,c}}(A.nodesep,A.edgesep,r);return lK.forEach(e,function(e){var r;lK.forEach(e,function(e){var A=n[e];if(i.setNode(A),r){var s=n[r],a=i.edge(s,A);i.setEdge(s,A,Math.max(o(t,e,r),a||0))}r=e})}),i}(t,e,n,i),s=i?"borderLeft":"borderRight";function a(t,e){for(var n=o.nodes(),r=n.pop(),i={};r;)i[r]?t(r):(i[r]=!0,n.push(r),n=n.concat(e(r))),r=n.pop()}function c(t){A[t]=o.inEdges(t).reduce(function(t,e){return Math.max(t,A[e.v]+o.edge(e))},0)}function l(e){var n=o.outEdges(e).reduce(function(t,e){return Math.min(t,A[e.w]-o.edge(e))},Number.POSITIVE_INFINITY),r=t.node(e);n!==Number.POSITIVE_INFINITY&&r.borderType!==s&&(A[e]=Math.max(A[e],n))}return a(c,o.predecessors.bind(o)),a(l,o.successors.bind(o)),lK.forEach(r,function(t){A[t]=A[n[t]]}),A}(t,e,s.root,s.align,"r"===n);"r"===n&&(a=lK.mapValues(a,function(t){return-t})),i[A+n]=a})});var A=function(t,e){return lK.minBy(lK.values(e),function(e){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;return lK.forIn(e,function(e,i){var A=function(t,e){return t.node(e).width}(t,i)/2;n=Math.max(e+A,n),r=Math.min(e-A,r)}),n-r})}(t,i);return function(t,e){var n=lK.values(e),r=lK.min(n),i=lK.max(n);lK.forEach(["u","d"],function(n){lK.forEach(["l","r"],function(A){var o,s=n+A,a=t[s];if(a!==e){var c=lK.values(a);(o="l"===A?r-lK.min(c):i-lK.max(c))&&(t[s]=lK.mapValues(a,function(t){return t+o}))}})})}(i,A),function(t,e){return lK.mapValues(t.ul,function(n,r){if(e)return t[e.toLowerCase()][r];var i=lK.sortBy(lK.map(t,r));return(i[1]+i[2])/2})}(i,t.graph().align)};function fK(t,e,n){if(e>n){var r=e;e=n,n=r}var i=t[e];i||(t[e]=i={}),i[n]=!0}function gK(t,e,n){if(e>n){var r=e;e=n,n=r}return lK.has(t[e],n)}var pK=d_,vK=S_,mK=dK,yK=function(t){t=vK.asNonCompoundGraph(t),function(t){var e=vK.buildLayerMatrix(t),n=t.graph().ranksep,r=0;pK.forEach(e,function(e){var i=pK.max(pK.map(e,function(e){return t.node(e).height}));pK.forEach(e,function(e){t.node(e).y=r+i/2}),r+=i+n})}(t),pK.forEach(mK(t),function(e,n){t.node(n).x=e})};var wK=d_,BK=M_,bK=I_,EK=uG,xK=S_.normalizeRanks,CK=gG,FK=S_.removeEmptyRanks,MK=mG,kK=bG,QK=CG,SK=oK,UK=yK,TK=S_,OK=JH.Graph,NK=function(t,e){var n=e&&e.debugTiming?TK.time:TK.notime;n("layout",function(){var e=n("  buildLayoutGraph",function(){return function(t){var e=new OK({multigraph:!0,compound:!0}),n=jK(t.graph());return e.setGraph(wK.merge({},LK,KK(n,IK),wK.pick(n,DK))),wK.forEach(t.nodes(),function(n){var r=jK(t.node(n));e.setNode(n,wK.defaults(KK(r,PK),RK)),e.setParent(n,t.parent(n))}),wK.forEach(t.edges(),function(n){var r=jK(t.edge(n));e.setEdge(n,wK.merge({},_K,KK(r,HK),wK.pick(r,GK)))}),e}(t)});n("  runLayout",function(){!function(t,e){e("    makeSpaceForEdgeLabels",function(){!function(t){var e=t.graph();e.ranksep/=2,wK.forEach(t.edges(),function(n){var r=t.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)})}(t)}),e("    removeSelfEdges",function(){!function(t){wK.forEach(t.edges(),function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e)}})}(t)}),e("    acyclic",function(){BK.run(t)}),e("    nestingGraph.run",function(){MK.run(t)}),e("    rank",function(){EK(TK.asNonCompoundGraph(t))}),e("    injectEdgeLabelProxies",function(){!function(t){wK.forEach(t.edges(),function(e){var n=t.edge(e);if(n.width&&n.height){var r=t.node(e.v),i={rank:(t.node(e.w).rank-r.rank)/2+r.rank,e:e};TK.addDummyNode(t,"edge-proxy",i,"_ep")}})}(t)}),e("    removeEmptyRanks",function(){FK(t)}),e("    nestingGraph.cleanup",function(){MK.cleanup(t)}),e("    normalizeRanks",function(){xK(t)}),e("    assignRankMinMax",function(){!function(t){var e=0;wK.forEach(t.nodes(),function(n){var r=t.node(n);r.borderTop&&(r.minRank=t.node(r.borderTop).rank,r.maxRank=t.node(r.borderBottom).rank,e=wK.max(e,r.maxRank))}),t.graph().maxRank=e}(t)}),e("    removeEdgeLabelProxies",function(){!function(t){wK.forEach(t.nodes(),function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))})}(t)}),e("    normalize.run",function(){bK.run(t)}),e("    parentDummyChains",function(){CK(t)}),e("    addBorderSegments",function(){kK(t)}),e("    order",function(){SK(t)}),e("    insertSelfEdges",function(){!function(t){var e=TK.buildLayerMatrix(t);wK.forEach(e,function(e){var n=0;wK.forEach(e,function(e,r){var i=t.node(e);i.order=r+n,wK.forEach(i.selfEdges,function(e){TK.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:i.rank,order:r+ ++n,e:e.e,label:e.label},"_se")}),delete i.selfEdges})})}(t)}),e("    adjustCoordinateSystem",function(){QK.adjust(t)}),e("    position",function(){UK(t)}),e("    positionSelfEdges",function(){!function(t){wK.forEach(t.nodes(),function(e){var n=t.node(e);if("selfedge"===n.dummy){var r=t.node(n.e.v),i=r.x+r.width/2,A=r.y,o=n.x-i,s=r.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:i+2*o/3,y:A-s},{x:i+5*o/6,y:A-s},{x:i+o,y:A},{x:i+5*o/6,y:A+s},{x:i+2*o/3,y:A+s}],n.label.x=n.x,n.label.y=n.y}})}(t)}),e("    removeBorderNodes",function(){!function(t){wK.forEach(t.nodes(),function(e){if(t.children(e).length){var n=t.node(e),r=t.node(n.borderTop),i=t.node(n.borderBottom),A=t.node(wK.last(n.borderLeft)),o=t.node(wK.last(n.borderRight));n.width=Math.abs(o.x-A.x),n.height=Math.abs(i.y-r.y),n.x=A.x+n.width/2,n.y=r.y+n.height/2}}),wK.forEach(t.nodes(),function(e){"border"===t.node(e).dummy&&t.removeNode(e)})}(t)}),e("    normalize.undo",function(){bK.undo(t)}),e("    fixupEdgeLabelCoords",function(){!function(t){wK.forEach(t.edges(),function(e){var n=t.edge(e);if(wK.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}})}(t)}),e("    undoCoordinateSystem",function(){QK.undo(t)}),e("    translateGraph",function(){!function(t){var e=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,i=0,A=t.graph(),o=A.marginx||0,s=A.marginy||0;function a(t){var A=t.x,o=t.y,s=t.width,a=t.height;e=Math.min(e,A-s/2),n=Math.max(n,A+s/2),r=Math.min(r,o-a/2),i=Math.max(i,o+a/2)}wK.forEach(t.nodes(),function(e){a(t.node(e))}),wK.forEach(t.edges(),function(e){var n=t.edge(e);wK.has(n,"x")&&a(n)}),e-=o,r-=s,wK.forEach(t.nodes(),function(n){var i=t.node(n);i.x-=e,i.y-=r}),wK.forEach(t.edges(),function(n){var i=t.edge(n);wK.forEach(i.points,function(t){t.x-=e,t.y-=r}),wK.has(i,"x")&&(i.x-=e),wK.has(i,"y")&&(i.y-=r)}),A.width=n-e+o,A.height=i-r+s}(t)}),e("    assignNodeIntersects",function(){!function(t){wK.forEach(t.edges(),function(e){var n,r,i=t.edge(e),A=t.node(e.v),o=t.node(e.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=o,r=A),i.points.unshift(TK.intersectRect(A,n)),i.points.push(TK.intersectRect(o,r))})}(t)}),e("    reversePoints",function(){!function(t){wK.forEach(t.edges(),function(e){var n=t.edge(e);n.reversed&&n.points.reverse()})}(t)}),e("    acyclic.undo",function(){BK.undo(t)})}(e,n)}),n("  updateInputGraph",function(){!function(t,e){wK.forEach(t.nodes(),function(n){var r=t.node(n),i=e.node(n);r&&(r.x=i.x,r.y=i.y,e.children(n).length&&(r.width=i.width,r.height=i.height))}),wK.forEach(t.edges(),function(n){var r=t.edge(n),i=e.edge(n);r.points=i.points,wK.has(i,"x")&&(r.x=i.x,r.y=i.y)}),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,e)})})};var IK=["nodesep","edgesep","ranksep","marginx","marginy"],LK={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},DK=["acyclicer","ranker","rankdir","align"],PK=["width","height"],RK={width:0,height:0},HK=["minlen","weight","width","height","labeloffset"],_K={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},GK=["labelpos"];function KK(t,e){return wK.mapValues(wK.pick(t,e),Number)}function jK(t){var e={};return wK.forEach(t,function(t,n){e[n.toLowerCase()]=t}),e}var VK=d_,zK=S_,WK=JH.Graph,YK={debugOrdering:function(t){var e=zK.buildLayerMatrix(t),n=new WK({compound:!0,multigraph:!0}).setGraph({});return VK.forEach(t.nodes(),function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)}),VK.forEach(t.edges(),function(t){n.setEdge(t.v,t.w,{},t.name)}),VK.forEach(e,function(t,e){var r="layer"+e;n.setNode(r,{rank:"same"}),VK.reduce(t,function(t,e){return n.setEdge(t,e,{style:"invis"}),e})}),n}};var XK={graphlib:JH,layout:NK,debug:YK,util:{time:S_.time,notime:S_.notime},version:"0.8.5"},qK=B(XK);class ZK{constructor(t){this.id="dagre",this.options={},Object.assign(this.options,ZK.defaultOptions,t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,t,Object.assign(Object.assign({},this.options),e))})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,t,Object.assign(Object.assign({},this.options),e))})}genericDagreLayout(t,e,n){return _e(this,void 0,void 0,function*(){const{nodeSize:r}=n,i=new XK.graphlib.Graph;i.setGraph(n),i.setDefaultEdgeLabel(()=>({}));[...e.getAllNodes(),...e.getAllEdges()].some(({id:t})=>oe(t))&&console.error("Dagre layout only support string id, it will convert number to string."),e.getAllNodes().forEach(t=>{const{id:e}=t,n=Object.assign({},t.data);if(void 0!==r){const[e,i]=hF(Vt(r)?r(t):r);Object.assign(n,{width:e,height:i})}i.setNode(e.toString(),n)}),e.getAllEdges().forEach(({id:t,source:e,target:n})=>{i.setEdge(e.toString(),n.toString(),{id:t})}),qK.layout(i);const A={nodes:[],edges:[]};return i.nodes().forEach(n=>{const r=i.node(n);A.nodes.push({id:n,data:r}),t&&e.mergeNodeData(n,r)}),i.edges().forEach(n=>{const r=i.edge(n),{id:o}=r,s=He(r,["id"]),{v:a,w:c}=n;A.edges.push({id:o,source:a,target:c,data:s}),t&&e.mergeEdgeData(o,s)}),A})}}ZK.defaultOptions={};class JK{constructor(t){this.id=t.id||0,this.rx=t.rx,this.ry=t.ry,this.fx=0,this.fy=0,this.mass=t.mass,this.degree=t.degree,this.g=t.g||0}distanceTo(t){const e=this.rx-t.rx,n=this.ry-t.ry;return Math.hypot(e,n)}setPos(t,e){this.rx=t,this.ry=e}resetForce(){this.fx=0,this.fy=0}addForce(t){const e=t.rx-this.rx,n=t.ry-this.ry;let r=Math.hypot(e,n);r=r<1e-4?1e-4:r;const i=this.g*(this.degree+1)*(t.degree+1)/r;this.fx+=i*e/r,this.fy+=i*n/r}in(t){return t.contains(this.rx,this.ry)}add(t){const e=this.mass+t.mass,n=(this.rx*this.mass+t.rx*t.mass)/e,r=(this.ry*this.mass+t.ry*t.mass)/e,i=this.degree+t.degree;return new JK({rx:n,ry:r,mass:e,degree:i})}}class $K{constructor(t){this.xmid=t.xmid,this.ymid=t.ymid,this.length=t.length,this.massCenter=t.massCenter||[0,0],this.mass=t.mass||1}getLength(){return this.length}contains(t,e){const n=this.length/2;return t<=this.xmid+n&&t>=this.xmid-n&&e<=this.ymid+n&&e>=this.ymid-n}NW(){const t=this.xmid-this.length/4,e=this.ymid+this.length/4,n=this.length/2;return new $K({xmid:t,ymid:e,length:n})}NE(){const t=this.xmid+this.length/4,e=this.ymid+this.length/4,n=this.length/2;return new $K({xmid:t,ymid:e,length:n})}SW(){const t=this.xmid-this.length/4,e=this.ymid-this.length/4,n=this.length/2;return new $K({xmid:t,ymid:e,length:n})}SE(){const t=this.xmid+this.length/4,e=this.ymid-this.length/4,n=this.length/2;return new $K({xmid:t,ymid:e,length:n})}}class tj{constructor(t){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=t&&(this.quad=t)}insert(t){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new tj(this.quad.NW()),this.NE=new tj(this.quad.NE()),this.SW=new tj(this.quad.SW()),this.SE=new tj(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t)):this.body=t}_putBody(t){this.quad&&(t.in(this.quad.NW())&&this.NW?this.NW.insert(t):t.in(this.quad.NE())&&this.NE?this.NE.insert(t):t.in(this.quad.SW())&&this.SW?this.SW.insert(t):t.in(this.quad.SE())&&this.SE&&this.SE.insert(t))}_isExternal(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE}updateForce(t){if(null!=this.body&&t!==this.body)if(this._isExternal())t.addForce(this.body);else{(this.quad?this.quad.getLength():0)/this.body.distanceTo(t)<this.theta?t.addForce(this.body):(this.NW&&this.NW.updateForce(t),this.NE&&this.NE.updateForce(t),this.SW&&this.SW.updateForce(t),this.SE&&this.SE.updateForce(t))}}}const ej={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1};class nj{constructor(t={}){this.options=t,this.id="forceAtlas2",this.options=Object.assign(Object.assign({},ej),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,t,e)})}genericForceAtlas2Layout(t,e,n){return _e(this,void 0,void 0,function*(){const r=e.getAllEdges(),i=e.getAllNodes(),A=this.formatOptions(n,i.length),{width:o,height:s,prune:a,maxIteration:c,nodeSize:l,center:u}=A;if(!(null==i?void 0:i.length)||1===i.length)return yF(e,t,u);const h=i.map(t=>uF(t,[o,s])),d=r.filter(t=>{const{source:e,target:n}=t;return e!==n}),f=new fE({nodes:h,edges:d}),g=this.getSizes(f,l);if(this.run(f,e,c,g,t,A),a){for(let t=0;t<d.length;t+=1){const{source:e,target:n}=d[t],r=f.getDegree(e),i=f.getDegree(e);if(r<=1){const t=f.getNode(n);f.mergeNodeData(e,{x:t.data.x,y:t.data.y})}else if(i<=1){const t=f.getNode(e);f.mergeNodeData(n,{x:t.data.x,y:t.data.y})}}const n=Object.assign(Object.assign({},A),{prune:!1,barnesHut:!1});this.run(f,e,100,g,t,n)}return{nodes:h,edges:r}})}getSizes(t,e){const n=t.getAllNodes(),r={};for(let t=0;t<n.length;t+=1){const i=n[t];r[i.id]=gF(e,void 0)(i)}return r}formatOptions(t={},e){const n=Object.assign(Object.assign({},this.options),t),{center:r,width:i,height:A,barnesHut:o,prune:s,maxIteration:a,kr:c,kg:l}=n;return n.width=i||"undefined"==typeof window?i:window.innerWidth,n.height=A||"undefined"==typeof window?A:window.innerHeight,n.center=r||[n.width/2,n.height/2],void 0===o&&e>250&&(n.barnesHut=!0),void 0===s&&e>100&&(n.prune=!0),0!==a||s?0===a&&s&&(n.maxIteration=100,e<=200&&e>100?n.maxIteration=500:e>200&&(n.maxIteration=950)):(n.maxIteration=250,e<=200&&e>100?n.maxIteration=1e3:e>200&&(n.maxIteration=1200)),c||(n.kr=50,e>100&&e<=500?n.kr=20:e>500&&(n.kr=1)),l||(n.kg=20,e>100&&e<=500?n.kg=10:e>500&&(n.kg=1)),n}run(t,e,n,r,i,A){const{kr:o,barnesHut:s,onTick:a}=A,c=t.getAllNodes();let l=0,u=n;const h={},d={},f={};for(let e=0;e<c.length;e+=1){const{data:n,id:r}=c[e];if(h[r]=[0,0],s){const i={id:e,rx:n.x,ry:n.y,mass:1,g:o,degree:t.getDegree(r)};f[r]=new JK(i)}}for(;u>0;)l=this.oneStep(t,{iter:u,preventOverlapIters:50,krPrime:100,sg:l,forces:h,preForces:d,bodies:f,sizes:r},A),u--,null==a||a({nodes:c,edges:e.getAllEdges()});return t}oneStep(t,e,n){const{iter:r,preventOverlapIters:i,krPrime:A,sg:o,preForces:s,bodies:a,sizes:c}=e;let{forces:l}=e;const{preventOverlap:u,barnesHut:h}=n,d=t.getAllNodes();for(let t=0;t<d.length;t+=1){const{id:e}=d[t];s[e]=[...l[e]],l[e]=[0,0]}return l=this.getAttrForces(t,r,i,c,l,n),l=h&&(u&&r>i||!u)?this.getOptRepGraForces(t,l,a,n):this.getRepGraForces(t,r,i,l,A,c,n),this.updatePos(t,l,s,o,n)}getAttrForces(t,e,n,r,i,A){const{preventOverlap:o,dissuadeHubs:s,mode:a,prune:c}=A,l=t.getAllEdges();for(let A=0;A<l.length;A+=1){const{source:u,target:h}=l[A],d=t.getNode(u),f=t.getNode(h),g=t.getDegree(u),p=t.getDegree(h);if(c&&(g<=1||p<=1))continue;const v=[f.data.x-d.data.x,f.data.y-d.data.y];let m=Math.hypot(v[0],v[1]);m=m<1e-4?1e-4:m,v[0]=v[0]/m,v[1]=v[1]/m,o&&e<n&&(m=m-r[u]-r[h]);let y=m,w=y;"linlog"===a&&(y=Math.log(1+m),w=y),s&&(y=m/g,w=m/p),o&&e<n&&m<=0?(y=0,w=0):o&&e<n&&m>0&&(y=m,w=m),i[u][0]+=y*v[0],i[h][0]-=w*v[0],i[u][1]+=y*v[1],i[h][1]-=w*v[1]}return i}getOptRepGraForces(t,e,n,r){const{kg:i,center:A,prune:o}=r,s=t.getAllNodes(),a=s.length;let c=9e10,l=-9e10,u=9e10,h=-9e10;for(let e=0;e<a;e+=1){const{id:r,data:i}=s[e];o&&t.getDegree(r)<=1||(n[r].setPos(i.x,i.y),i.x>=l&&(l=i.x),i.x<=c&&(c=i.x),i.y>=h&&(h=i.y),i.y<=u&&(u=i.y))}const d=Math.max(l-c,h-u),f=new $K({xmid:(l+c)/2,ymid:(h+u)/2,length:d,massCenter:A,mass:a}),g=new tj(f);for(let e=0;e<a;e+=1){const{id:r}=s[e];o&&t.getDegree(r)<=1||n[r].in(f)&&g.insert(n[r])}for(let r=0;r<a;r+=1){const{id:a,data:c}=s[r],l=t.getDegree(a);if(o&&l<=1)continue;n[a].resetForce(),g.updateForce(n[a]),e[a][0]-=n[a].fx,e[a][1]-=n[a].fy;const u=[c.x-A[0],c.y-A[1]];let h=Math.hypot(u[0],u[1]);h=h<1e-4?1e-4:h,u[0]=u[0]/h,u[1]=u[1]/h;const d=i*(l+1);e[a][0]-=d*u[0],e[a][1]-=d*u[1]}return e}getRepGraForces(t,e,n,r,i,A,o){const{preventOverlap:s,kr:a,kg:c,center:l,prune:u}=o,h=t.getAllNodes(),d=h.length;for(let o=0;o<d;o+=1){const f=h[o],g=t.getDegree(f.id);for(let c=o+1;c<d;c+=1){const o=h[c],l=t.getDegree(o.id);if(u&&(g<=1||l<=1))continue;const d=[o.data.x-f.data.x,o.data.y-f.data.y];let p=Math.hypot(d[0],d[1]);p=p<1e-4?1e-4:p,d[0]=d[0]/p,d[1]=d[1]/p,s&&e<n&&(p=p-A[f.id]-A[o.id]);let v=a*(g+1)*(l+1)/p;s&&e<n&&p<0?v=i*(g+1)*(l+1):s&&e<n&&0===p?v=0:s&&e<n&&p>0&&(v=a*(g+1)*(l+1)/p),r[f.id][0]-=v*d[0],r[o.id][0]+=v*d[0],r[f.id][1]-=v*d[1],r[o.id][1]+=v*d[1]}const p=[f.data.x-l[0],f.data.y-l[1]],v=Math.hypot(p[0],p[1]);p[0]=p[0]/v,p[1]=p[1]/v;const m=c*(g+1);r[f.id][0]-=m*p[0],r[f.id][1]-=m*p[1]}return r}updatePos(t,e,n,r,i){const{ks:A,tao:o,prune:s,ksmax:a}=i,c=t.getAllNodes(),l=c.length,u=[],h=[];let d=0,f=0,g=r;for(let r=0;r<l;r+=1){const{id:i}=c[r],A=t.getDegree(i);if(s&&A<=1)continue;const o=[e[i][0]-n[i][0],e[i][1]-n[i][1]],a=Math.hypot(o[0],o[1]),l=[e[i][0]+n[i][0],e[i][1]+n[i][1]],g=Math.hypot(l[0],l[1]);u[r]=a,h[r]=g/2,d+=(A+1)*u[r],f+=(A+1)*h[r]}const p=g;g=o*f/d,0!==p&&(g=g>1.5*p?1.5*p:g);for(let n=0;n<l;n+=1){const{id:r,data:i}=c[n],o=t.getDegree(r);if(s&&o<=1)continue;if(oe(i.fx)&&oe(i.fy))continue;let l=A*g/(1+g*Math.sqrt(u[n])),h=Math.hypot(e[r][0],e[r][1]);h=h<1e-4?1e-4:h;const d=a/h;l=l>d?d:l;const f=l*e[r][0],p=l*e[r][1];t.mergeNodeData(r,{x:i.x+f,y:i.y+p})}return g}}const rj={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"};class ij{constructor(t={}){this.options=t,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},rj),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,t,e)})}stop(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1}tick(t=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let e=0;e<t;e++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);const e={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&e.nodes.forEach(t=>this.lastGraph.mergeNodeData(t.id,{x:t.data.x,y:t.data.y,z:3===this.options.dimensions?t.data.z:void 0})),e}genericFruchtermanLayout(t,e,n){return _e(this,void 0,void 0,function*(){if(this.running)return;const r=this.formatOptions(n),{dimensions:i,width:A,height:o,center:s,clustering:a,nodeClusterBy:c,maxIteration:l,onTick:u}=r,h=e.getAllNodes(),d=e.getAllEdges();if(!(null==h?void 0:h.length)){const t={nodes:[],edges:d};return this.lastResult=t,t}if(1===h.length){t&&e.mergeNodeData(h[0].id,{x:s[0],y:s[1],z:3===i?s[2]:void 0});const n={nodes:[Object.assign(Object.assign({},h[0]),{data:Object.assign(Object.assign({},h[0].data),{x:s[0],y:s[1],z:3===i?s[2]:void 0})})],edges:d};return this.lastResult=n,n}const f=h.map(t=>uF(t,[A,o])),g=new fE({nodes:f,edges:d}),p={};if(a&&f.forEach(t=>{const e=t.data[c];p[e]||(p[e]={name:e,cx:0,cy:0,count:0})}),this.lastLayoutNodes=f,this.lastLayoutEdges=d,this.lastAssign=t,this.lastGraph=g,this.lastOptions=r,this.lastClusterMap=p,"undefined"==typeof window)return;let v=0;return new Promise(n=>{this.timeInterval=window.setInterval(()=>{this.running?(this.runOneStep(g,p,r),t&&f.forEach(({id:t,data:n})=>e.mergeNodeData(t,{x:n.x,y:n.y,z:3===i?n.z:void 0})),null==u||u({nodes:f,edges:d}),v++,v>=l&&(window.clearInterval(this.timeInterval),n({nodes:f,edges:d}))):n({nodes:f,edges:d})},0),this.running=!0})})}formatOptions(t={}){const e=Object.assign(Object.assign({},this.options),t),{clustering:n,nodeClusterBy:r}=e,{center:i,width:A,height:o}=e;return e.width=A||"undefined"==typeof window?A:window.innerWidth,e.height=o||"undefined"==typeof window?o:window.innerHeight,e.center=i||[e.width/2,e.height/2],e.clustering=n&&!!r,e}runOneStep(t,e,n){const{dimensions:r,height:i,width:A,gravity:o,center:s,speed:a,clustering:c,nodeClusterBy:l,clusterGravity:u}=n,h=i*A,d=Math.sqrt(h)/10,f=t.getAllNodes(),g=h/(f.length+1),p=Math.sqrt(g),v={};if(this.applyCalculate(t,v,p,g),c){for(const t in e)e[t].cx=0,e[t].cy=0,e[t].count=0;f.forEach(t=>{const{data:n}=t,r=e[n[l]];oe(n.x)&&(r.cx+=n.x),oe(n.y)&&(r.cy+=n.y),r.count++});for(const t in e)e[t].cx/=e[t].count,e[t].cy/=e[t].count;const t=u||o;f.forEach((n,r)=>{const{id:i,data:A}=n;if(!oe(A.x)||!oe(A.y))return;const o=e[A[l]],s=Math.sqrt((A.x-o.cx)*(A.x-o.cx)+(A.y-o.cy)*(A.y-o.cy)),a=p*t;v[i].x-=a*(A.x-o.cx)/s,v[i].y-=a*(A.y-o.cy)/s})}f.forEach((t,e)=>{const{id:n,data:i}=t;if(!oe(i.x)||!oe(i.y))return;const A=.01*p*o;v[n].x-=A*(i.x-s[0]),v[n].y-=A*(i.y-s[1]),3===r&&(v[n].z-=A*(i.z-s[2]))}),f.forEach((e,n)=>{const{id:i,data:A}=e;if(oe(A.fx)&&oe(A.fy))return A.x=A.fx,A.y=A.fy,void(3===r&&(A.z=A.fz));if(!oe(A.x)||!oe(A.y))return;const o=Math.sqrt(v[i].x*v[i].x+v[i].y*v[i].y+(3===r?v[i].z*v[i].z:0));if(o>0){const e=Math.min(d*(a/800),o);t.mergeNodeData(i,{x:A.x+v[i].x/o*e,y:A.y+v[i].y/o*e,z:3===r?A.z+v[i].z/o*e:void 0})}})}applyCalculate(t,e,n,r){this.calRepulsive(t,e,r),this.calAttractive(t,e,n)}calRepulsive(t,e,n){const r=t.getAllNodes();r.forEach(({data:t,id:i},A)=>{e[i]={x:0,y:0,z:0},r.forEach(({data:r,id:o},s)=>{if(A<=s||!oe(t.x)||!oe(r.x)||!oe(t.y)||!oe(r.y))return;let a=t.x-r.x,c=t.y-r.y,l=3===this.options.dimensions?t.z-r.z:0,u=a*a+c*c+l*l;0===u&&(u=1,a=.01,c=.01,l=.01);const h=n/u,d=a*h,f=c*h,g=l*h;e[i].x+=d,e[i].y+=f,e[o].x-=d,e[o].y-=f,3===this.options.dimensions&&(e[i].z+=g,e[o].z-=g)})})}calAttractive(t,e,n){t.getAllEdges().forEach(r=>{const{source:i,target:A}=r;if(!i||!A||i===A)return;const{data:o}=t.getNode(i),{data:s}=t.getNode(A);if(!(oe(s.x)&&oe(o.x)&&oe(s.y)&&oe(o.y)))return;const a=s.x-o.x,c=s.y-o.y,l=3===this.options.dimensions?s.z-o.z:0,u=Math.sqrt(a*a+c*c+l*l)/n,h=a*u,d=c*u,f=l*u;e[i].x+=h,e[i].y+=d,e[A].x-=h,e[A].y-=d,3===this.options.dimensions&&(e[i].z+=f,e[A].z-=f)})}}const Aj={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300};class oj{constructor(t={}){this.options=t,this.id="grid",this.options=Object.assign(Object.assign({},Aj),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericGridLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,t,e)})}genericGridLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),{begin:i=[0,0],condense:A,preventOverlapPadding:o,preventOverlap:s,rows:a,cols:c,nodeSpacing:l,nodeSize:u,width:h,height:d,position:f}=r;let{sortBy:g}=r;const p=e.getAllNodes(),v=e.getAllEdges(),m=null==p?void 0:p.length;if(!m||1===m)return yF(e,t,i);const y=p.map(t=>uF(t));"id"===g||ne(g)&&void 0!==y[0].data[g]||(g="degree"),"degree"===g?y.sort((t,n)=>e.getDegree(n.id,"both")-e.getDegree(t.id,"both")):"id"===g?y.sort((t,e)=>oe(e.id)&&oe(t.id)?e.id-t.id:`${t.id}`.localeCompare(`${e.id}`)):y.sort((t,e)=>e.data[g]-t.data[g]);const w=h||"undefined"==typeof window?h:window.innerWidth,B=d||"undefined"==typeof window?d:window.innerHeight,b=m,E={rows:a,cols:c};if(null!=a&&null!=c)E.rows=a,E.cols=c;else if(null!=a&&null==c)E.rows=a,E.cols=Math.ceil(b/E.rows);else if(null==a&&null!=c)E.cols=c,E.rows=Math.ceil(b/E.cols);else{const t=Math.sqrt(b*B/w);E.rows=Math.round(t),E.cols=Math.round(w/B*t)}if(E.rows=Math.max(E.rows,1),E.cols=Math.max(E.cols,1),E.cols*E.rows>b){const t=sj(E),e=aj(E);(t-1)*e>=b?sj(E,t-1):(e-1)*t>=b&&aj(E,e-1)}else for(;E.cols*E.rows<b;){const t=sj(E),e=aj(E);(e+1)*t>=b?aj(E,e+1):sj(E,t+1)}let x=A?0:w/E.cols,C=A?0:B/E.rows;if(s||l){const t=dF(10,l),n=fF(30,u,!1);y.forEach(r=>{r.data.x&&r.data.y||(r.data.x=0,r.data.y=0);const i=e.getNode(r.id),[A,s]=hF(n(i)||30),a=void 0!==t?t(r):o,c=A+a,l=s+a;x=Math.max(x,c),C=Math.max(C,l)})}const F={},M={row:0,col:0},k={};for(let t=0;t<y.length;t++){const n=y[t];let r;if(f&&(r=f(e.getNode(n.id))),r&&(void 0!==r.row||void 0!==r.col)){const t={row:r.row,col:r.col};if(void 0===t.col)for(t.col=0;cj(F,t);)t.col++;else if(void 0===t.row)for(t.row=0;cj(F,t);)t.row++;k[n.id]=t,lj(F,t)}hj(n,i,x,C,k,E,M,F)}const Q={nodes:y,edges:v};return t&&y.forEach(t=>{e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y})}),Q})}}const sj=(t,e)=>{let n;const r=t.rows||5,i=t.cols||5;if(null==e)n=Math.min(r,i);else{Math.min(r,i)===t.rows?t.rows=e:t.cols=e}return n},aj=(t,e)=>{let n;const r=t.rows||5,i=t.cols||5;if(null==e)n=Math.max(r,i);else{Math.max(r,i)===t.rows?t.rows=e:t.cols=e}return n},cj=(t,e)=>t[`c-${e.row}-${e.col}`]||!1,lj=(t,e)=>t[`c-${e.row}-${e.col}`]=!0,uj=(t,e)=>{const n=t.cols||5;e.col++,e.col>=n&&(e.col=0,e.row++)},hj=(t,e,n,r,i,A,o,s)=>{let a,c;const l=i[t.id];if(l)a=l.col*n+n/2+e[0],c=l.row*r+r/2+e[1];else{for(;cj(s,o);)uj(A,o);a=o.col*n+n/2+e[0],c=o.row*r+r/2+e[1],lj(s,o),uj(A,o)}t.data.x=a,t.data.y=c},dj={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},fj=(t,e,n,r,i,A)=>{e.forEach((o,s)=>{n[s]={x:0,y:0},e.forEach((e,a)=>{if(s===a)return;if(i[s]!==i[a])return;let c=o.x-e.x,l=o.y-e.y,u=Math.sqrt(c*c+l*l);if(0===u){u=1;const t=s>a?1:-1;c=.01*t,l=.01*t}if(u<A(t[s])/2+A(t[a])/2){const t=r*r/u;n[s].x+=c/u*t,n[s].y+=l/u*t}})})},gj=(t,e,n,r,i,A,o,s)=>{const a=A||o/10;return r&&e.forEach((e,n)=>{const r=t[n].x-t[i].x,A=t[n].y-t[i].y,o=Math.sqrt(r*r+A*A);let s=A/o,a=-r/o;const c=Math.sqrt(e.x*e.x+e.y*e.y);let l=Math.acos((s*e.x+a*e.y)/c);l>Math.PI/2&&(l-=Math.PI/2,s*=-1,a*=-1);const u=Math.cos(l)*c;e.x=s*u,e.y=a*u}),t.forEach((A,o)=>{if(o===i)return;const c=Math.sqrt(e[o].x*e[o].x+e[o].y*e[o].y);if(c>0&&o!==i){const l=Math.min(a*(n/800),c);if(A.x+=e[o].x/c*l,A.y+=e[o].y/c*l,r){let e=A.x-t[i].x,n=A.y-t[i].y;const r=Math.sqrt(e*e+n*n);e=e/r*s[o],n=n/r*s[o],A.x=t[i].x+e,A.y=t[i].y+n}}}),t},pj={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10};class vj{constructor(t={}){this.options=t,this.id="radial",this.options=Object.assign(Object.assign({},pj),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,t,e)})}genericRadialLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),{width:i,height:A,center:o,focusNode:s,unitRadius:a,nodeSize:c,nodeSpacing:l,strictRadial:u,preventOverlap:h,maxPreventOverlapIteration:d,sortBy:f,linkDistance:g=50,sortStrength:p=10,maxIteration:v=1e3}=r,m=e.getAllNodes(),y=e.getAllEdges(),w=i||"undefined"==typeof window?i:window.innerWidth,B=A||"undefined"==typeof window?A:window.innerHeight,b=o||[w/2,B/2];if(!(null==m?void 0:m.length)||1===m.length)return yF(e,t,b);let E=m[0];if(ne(s)){for(let t=0;t<m.length;t++)if(m[t].id===s){E=m[t];break}}else E=s||m[0];const x=wj(m,E.id),C=sF({nodes:m,edges:y}),F=oF(C),M=bj(F,x);Bj(F,x,M+1);const k=F[x];let Q=w-b[0]>b[0]?b[0]:w-b[0],S=B-b[1]>b[1]?b[1]:B-b[1];0===Q&&(Q=w/2),0===S&&(S=B/2);const U=Math.min(Q,S),T=Math.max(...k),O=[],N=a||U/T;k.forEach((t,e)=>{O[e]=t*N});const I=mj(m,F,g,O,N,f,p),L=yj(I),D=((t,e,n)=>{try{const n=WM.mul(WM.pow(e,2),-.5),r=n.mean("row"),i=n.mean("column"),A=n.mean();n.add(A).subRowVector(r).subColumnVector(i);const o=new YM(n),s=WM.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(e=>WM.mul([e],[s]).toJSON()[0].splice(0,t))}catch(t){const r=[];for(let t=0;t<e.length;t++){const t=Math.random()*n,e=Math.random()*n;r.push([t,e])}return r}})(g,I,g);let P,R=D.map(([t,e])=>({x:(isNaN(t)?Math.random()*g:t)-D[x][0],y:(isNaN(e)?Math.random()*g:e)-D[x][1]}));if(this.run(v,R,L,I,O,x),h){P=gF(c,l);const t={nodes:m,nodeSizeFunc:P,positions:R,radii:O,height:B,width:w,strictRadial:Boolean(u),focusIdx:x,iterations:d||200,k:R.length/4.5};R=((t,e)=>{const n=Object.assign(Object.assign({},dj),e),{positions:r,iterations:i,width:A,k:o,speed:s=100,strictRadial:a,focusIdx:c,radii:l=[],nodeSizeFunc:u}=n,h=t.getAllNodes(),d=[],f=A/10;for(let t=0;t<i;t++)r.forEach((t,e)=>{d[e]={x:0,y:0}}),fj(h,r,d,o,l,u),gj(r,d,s,a,c,f,A,l);return r})(e,t)}const H=[];R.forEach((t,e)=>{const n=uF(m[e]);n.data.x=t.x+b[0],n.data.y=t.y+b[1],H.push(n)}),t&&H.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}));return{nodes:H,edges:y}})}run(t,e,n,r,i,A){for(let o=0;o<=t;o++){const s=o/t;this.oneIteration(s,e,i,r,n,A)}}oneIteration(t,e,n,r,i,A){const o=1-t;e.forEach((s,a)=>{const c=aF(s,{x:0,y:0}),l=0===c?0:1/c;if(a===A)return;let u=0,h=0,d=0;e.forEach((t,e)=>{if(a===e)return;const n=aF(s,t),A=0===n?0:1/n,o=r[e][a];d+=i[a][e],u+=i[a][e]*(t.x+o*(s.x-t.x)*A),h+=i[a][e]*(t.y+o*(s.y-t.y)*A)});const f=0===n[a]?0:1/n[a];d*=o,d+=t*f*f,u*=o,u+=t*f*s.x*l,s.x=u/d,h*=o,h+=t*f*s.y*l,s.y=h/d})}}const mj=(t,e,n,r,i,A,o)=>{if(!t)return[];const s=[];if(e){const a={};e.forEach((e,c)=>{const l=[];e.forEach((e,s)=>{var u,h;if(c===s)l.push(0);else if(r[c]===r[s])if("data"===A)l.push(e*(Math.abs(c-s)*o)/(r[c]/i));else if(A){let n,d;if(a[t[c].id])n=a[t[c].id];else{const e=("id"===A?t[c].id:null===(u=t[c].data)||void 0===u?void 0:u[A])||0;n=ne(e)?e.charCodeAt(0):e,a[t[c].id]=n}if(a[t[s].id])d=a[t[s].id];else{const e=("id"===A?t[s].id:null===(h=t[s].data)||void 0===h?void 0:h[A])||0;d=ne(e)?e.charCodeAt(0):e,a[t[s].id]=d}l.push(e*(Math.abs(n-d)*o)/(r[c]/i))}else l.push(e*n/(r[c]/i));else{const t=(n+i)/2;l.push(e*t)}}),s.push(l)})}return s},yj=t=>{const e=t.length,n=t[0].length,r=[];for(let i=0;i<e;i++){const e=[];for(let r=0;r<n;r++)0!==t[i][r]?e.push(1/(t[i][r]*t[i][r])):e.push(0);r.push(e)}return r},wj=(t,e)=>{let n=-1;return t.forEach((t,r)=>{t.id===e&&(n=r)}),Math.max(n,0)},Bj=(t,e,n)=>{const r=t.length;for(let i=0;i<r;i++)if(t[e][i]===1/0){t[e][i]=n,t[i][e]=n;for(let A=0;A<r;A++)t[i][A]!==1/0&&t[e][A]===1/0&&(t[e][A]=n+t[i][A],t[A][e]=n+t[i][A])}for(let n=0;n<r;n++)if(n!==e)for(let i=0;i<r;i++)if(t[n][i]===1/0){let r=Math.abs(t[e][n]-t[e][i]);r=0===r?1:r,t[n][i]=r}},bj=(t,e)=>{let n=0;for(let r=0;r<t[e].length;r++)t[e][r]!==1/0&&(n=t[e][r]>n?t[e][r]:n);return n},Ej={center:[0,0],width:300,height:300};class xj{constructor(t={}){this.options=t,this.id="random",this.options=Object.assign(Object.assign({},Ej),t)}execute(t,e){return _e(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,t,e)})}assign(t,e){return _e(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,t,e)})}genericRandomLayout(t,e,n){return _e(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},this.options),n),{center:i,width:A,height:o}=r,s=e.getAllNodes(),a=A||"undefined"==typeof window?A:window.innerWidth,c=o||"undefined"==typeof window?o:window.innerHeight,l=i||[a/2,c/2],u=[];s&&s.forEach(t=>{u.push({id:t.id,data:{x:.9*(Math.random()-.5)*a+l[0],y:.9*(Math.random()-.5)*c+l[1]}})}),t&&u.forEach(t=>e.mergeNodeData(t.id,{x:t.data.x,y:t.data.y}));return{nodes:u,edges:e.getAllEdges()}})}}
/**
   * @license
   * Copyright 2019 Google LLC
   * SPDX-License-Identifier: Apache-2.0
   */const Cj=Symbol("Comlink.proxy"),Fj=Symbol("Comlink.endpoint"),Mj=Symbol("Comlink.releaseProxy"),kj=Symbol("Comlink.finalizer"),Qj=Symbol("Comlink.thrown"),Sj=t=>"object"==typeof t&&null!==t||"function"==typeof t,Uj=new Map([["proxy",{canHandle:t=>Sj(t)&&t[Cj],serialize(t){const{port1:e,port2:n}=new MessageChannel;return Tj(t,e),[n,[n]]},deserialize:t=>(t.start(),Nj(t))}],["throw",{canHandle:t=>Sj(t)&&Qj in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function Tj(t,e=globalThis,n=["*"]){e.addEventListener("message",function r(i){if(!i||!i.data)return;if(!function(t,e){for(const n of t){if(e===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(e))return!0}return!1}(n,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:A,type:o,path:s}=Object.assign({path:[]},i.data),a=(i.data.argumentList||[]).map(Kj);let c;try{const e=s.slice(0,-1).reduce((t,e)=>t[e],t),n=s.reduce((t,e)=>t[e],t);switch(o){case"GET":c=n;break;case"SET":e[s.slice(-1)[0]]=Kj(i.data.value),c=!0;break;case"APPLY":c=n.apply(e,a);break;case"CONSTRUCT":c=function(t){return Object.assign(t,{[Cj]:!0})}(new n(...a));break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;Tj(t,n),c=function(t,e){return _j.set(t,e),t}(e,[e])}break;case"RELEASE":c=void 0;break;default:return}}catch(t){c={value:t,[Qj]:0}}Promise.resolve(c).catch(t=>({value:t,[Qj]:0})).then(n=>{const[i,s]=Gj(n);e.postMessage(Object.assign(Object.assign({},i),{id:A}),s),"RELEASE"===o&&(e.removeEventListener("message",r),Oj(e),kj in t&&"function"==typeof t[kj]&&t[kj]())}).catch(t=>{const[n,r]=Gj({value:new TypeError("Unserializable return value"),[Qj]:0});e.postMessage(Object.assign(Object.assign({},n),{id:A}),r)})}),e.start&&e.start()}function Oj(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function Nj(t,e){const n=new Map;return t.addEventListener("message",function(t){const{data:e}=t;if(!e||!e.id)return;const r=n.get(e.id);if(r)try{r(e)}finally{n.delete(e.id)}}),Rj(t,n,[],e)}function Ij(t){if(t)throw new Error("Proxy has been released and is not useable")}function Lj(t){return jj(t,new Map,{type:"RELEASE"}).then(()=>{Oj(t)})}const Dj=new WeakMap,Pj="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(Dj.get(t)||0)-1;Dj.set(t,e),0===e&&Lj(t)});function Rj(t,e,n=[],r=function(){}){let i=!1;const A=new Proxy(r,{get(r,o){if(Ij(i),o===Mj)return()=>{!function(t){Pj&&Pj.unregister(t)}(A),Lj(t),e.clear(),i=!0};if("then"===o){if(0===n.length)return{then:()=>A};const r=jj(t,e,{type:"GET",path:n.map(t=>t.toString())}).then(Kj);return r.then.bind(r)}return Rj(t,e,[...n,o])},set(r,A,o){Ij(i);const[s,a]=Gj(o);return jj(t,e,{type:"SET",path:[...n,A].map(t=>t.toString()),value:s},a).then(Kj)},apply(r,A,o){Ij(i);const s=n[n.length-1];if(s===Fj)return jj(t,e,{type:"ENDPOINT"}).then(Kj);if("bind"===s)return Rj(t,e,n.slice(0,-1));const[a,c]=Hj(o);return jj(t,e,{type:"APPLY",path:n.map(t=>t.toString()),argumentList:a},c).then(Kj)},construct(r,A){Ij(i);const[o,s]=Hj(A);return jj(t,e,{type:"CONSTRUCT",path:n.map(t=>t.toString()),argumentList:o},s).then(Kj)}});return function(t,e){const n=(Dj.get(e)||0)+1;Dj.set(e,n),Pj&&Pj.register(t,e,t)}(A,t),A}function Hj(t){const e=t.map(Gj);return[e.map(t=>t[0]),(n=e.map(t=>t[1]),Array.prototype.concat.apply([],n))];var n}const _j=new WeakMap;function Gj(t){for(const[e,n]of Uj)if(n.canHandle(t)){const[r,i]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:t},_j.get(t)||[]]}function Kj(t){switch(t.type){case"HANDLER":return Uj.get(t.name).deserialize(t.value);case"RAW":return t.value}}function jj(t,e,n,r){return new Promise(i=>{const A=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.set(A,i),t.start&&t.start(),t.postMessage(Object.assign({id:A},n),r)})}class Vj extends cE{constructor(t,e,n){super(),this.graph=t,this.layout=e,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=Nj(new Worker(new URL("./worker.js","undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:e&&"SCRIPT"===e.tagName.toUpperCase()&&e.src||new URL("g6.min.js",document.baseURI).href),{type:"module"})),this.running&&(this.running=!1,this.execute())}execute(){var t;return _e(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;const e=this.layout.options,{onTick:n}=e,r=He(e,["onTick"]),i={};Object.keys(r).forEach(t=>{Vt(r[t])||(i[t]=r[t])});const A={layout:{id:this.layout.id,options:i,iterations:null===(t=this.options)||void 0===t?void 0:t.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},o=new Float32Array([0]),[s]=yield this.proxy.calculateLayout(A,[o]);return s})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[Mj]()}isRunning(){return this.running}}class zj extends gE{constructor(){super(...arguments),this.id="fishbone"}getRoot(){const t=this.context.model.getRootsData();if(!(Fe(t)||t.length>2))return t[0]}formatSize(t){const e="function"==typeof t?t:()=>t;return t=>aw(e(t))}doLayout(t,e){const{hGap:n,getRibSep:r,vGap:i,nodeSize:A,height:o}=e,{model:s}=this.context,a=this.formatSize(A);let c=a(t)[0]+r(t);const l=(t,e=0)=>{var r;return e+=n*((t.children||[]).length+1),null===(r=t.children)||void 0===r||r.forEach(t=>{var n;null===(n=s.getNodeLikeDatum(t).children)||void 0===n||n.forEach(t=>{const n=s.getNodeLikeDatum(t);e=l(n,e)})}),e},u=t=>{if(1===t.depth)return c;const e=s.getParentData(t.id,"tree");if(Xj(t)){const r=s.getParentData(e.id,"tree"),A=f(t)-f(r);return u(e)+A*n/i}{const n=(e.children||[]).indexOf(t.id),r=s.getNodeData((e.children||[]).slice(n));return h(e)-r.reduce((t,e)=>t+l(e),0)-a(e)[0]/2}},h=Be(t=>{if(Yj(t))return a(t)[0]/2;const e=s.getParentData(t.id,"tree");if(Xj(t))return u(t)+l(t)+a(t)[0]/2;{const r=f(t)-f(e),A=n/i;return u(t)+r*A}},t=>t.id),d=t=>f(s.getParentData(t,"tree")),f=Be(t=>{if(Yj(t))return o/2;if(Xj(t)){const e=s.getParentData(t.id,"tree"),n=e.children.indexOf(t.id);if(0===n)return d(e.id)+i;const r=s.getNodeLikeDatum(e.children[n-1]);if(Fe(r.children))return f(r)+i;const A=s.getDescendantsData(r.id);return Math.max(...A.map(t=>Xj(t)?d(t.id):f(t)))+i}{if(Fe(t.children))return d(t.id)+i;const e=s.getNodeLikeDatum(t.children.slice(-1)[0]);if(Fe(e.children))return f(e)+i;const n=s.getDescendantsData(t.id).slice(-1)[0];return(Xj(n)?d(n.id):f(n))+i}},t=>t.id);let g=0;const p={nodes:[],edges:[]},v=t=>{var e;null===(e=t.children)||void 0===e||e.forEach(t=>v(s.getNodeLikeDatum(t)));const n=f(t),i=h(t);if(p.nodes.push({id:t.id,x:i,y:n}),Yj(t))return;const A=s.getRelatedEdgesData(t.id,"in")[0],o=[u(t),Xj(t)?n:d(t.id)];p.edges.push({id:Vm(A),controlPoints:[o],relatedNodeId:t.id}),g=Math.max(g,i+r(t)),1===t.depth&&(c=g)};return v(t),p}placeAlterative(t,e){const n=(e.children||[]).filter((t,e)=>e%2!=0);if(0===n.length)return t;const{model:r}=this.context,i=t.nodes.find(t=>t.id===e.id).y,A=t=>{const e=r.getAncestorsData(t,"tree");if(Fe(e))return!1;const i=1===e.length?t:e[e.length-2].id;return n.includes(i)};t.nodes.forEach(t=>{A(t.id)&&(t.y=2*i-t.y)}),t.edges.forEach(t=>{A(t.relatedNodeId)&&(t.controlPoints=t.controlPoints.map(t=>[t[0],2*i-t[1]]))})}rightToLeft(t,e){return t.nodes.forEach(t=>t.x=e.width-t.x),t.edges.forEach(t=>{t.controlPoints=t.controlPoints.map(t=>[e.width-t[0],t[1]])}),t}execute(t,e){return _e(this,void 0,void 0,function*(){const n=Object.assign(Object.assign(Object.assign({},zj.defaultOptions),this.options),e),{direction:r,nodeSize:i}=n,A=this.getRoot();if(!A)return t;const o=this.formatSize(i);n.vGap||(n.vGap=Math.max(...(t.nodes||[]).map(t=>o(t)[1]))),n.hGap||(n.hGap=Math.max(...(t.nodes||[]).map(t=>o(t)[0])));let s=this.doLayout(A,n);this.placeAlterative(s,A),"RL"===r&&(s=this.rightToLeft(s,n));const{model:a}=this.context,c=[],l=[];return s.nodes.forEach(t=>{const{id:e,x:n,y:r}=t,i=a.getNodeLikeDatum(e);c.push(Wj(i,{x:n,y:r}))}),s.edges.forEach(t=>{const{id:e,controlPoints:n}=t,r=a.getEdgeDatum(e);l.push(Wj(r,{controlPoints:n}))}),{nodes:c,edges:l}})}}zj.defaultOptions={direction:"RL",getRibSep:()=>60};const Wj=(t,e)=>Object.assign(Object.assign({},t),{style:Object.assign(Object.assign({},t.style||{}),e)}),Yj=t=>0===t.depth,Xj=t=>(t.depth||(t.depth=0))%2==0;class qj extends gE{constructor(){super(...arguments),this.id="snake"}formatSize(t,e){const n="function"==typeof e?e:()=>e;return t.reduce((t,e)=>{const[r,i]=aw(n(e))||[0,0];return[Math.max(t[0],r),Math.max(t[1],i)]},[0,0])}validate(t){const{nodes:e=[],edges:n=[]}=t,r={},i={},A={};e.forEach(t=>{r[t.id]=0,i[t.id]=0,A[t.id]=[]}),n.forEach(t=>{r[t.target]++,i[t.source]++,A[t.source].push(t.target)});const o=new Set,s=t=>{o.has(t)||(o.add(t),A[t].forEach(s))};if(s(e[0].id),o.size!==e.length)return!1;const a=e.filter(t=>0===r[t.id]),c=e.filter(t=>0===i[t.id]);if(1!==a.length||1!==c.length)return!1;return e.filter(t=>1===r[t.id]&&1===i[t.id]).length===e.length-2}execute(t,e){return _e(this,void 0,void 0,function*(){var n;if(!this.validate(t))return t;const{nodeSize:r,padding:i,sortBy:A,cols:o,colGap:s,rowGap:a,clockwise:c,width:l,height:u}=Object.assign({},qj.defaultOptions,this.options,e),[h,d,f,g]=mm(i),p=this.formatSize(t.nodes||[],r),v=Math.ceil((t.nodes||[]).length/o);let m=s||(l-g-d-o*p[0])/(o-1),y=a||(u-h-f-v*p[1])/(v-1);(y===1/0||y<0)&&(y=0),(m===1/0||m<0)&&(m=0);const w=A?null===(n=t.nodes)||void 0===n?void 0:n.sort(A):function(t){const{nodes:e=[],edges:n=[]}=t,r={},i={};e.forEach(t=>{r[t.id]=0,i[t.id]=[]}),n.forEach(t=>{r[t.target]++,i[t.source].push(t.target)});const A=[],o=[];e.forEach(t=>{0===r[t.id]&&A.push(t.id)});for(;A.length>0;){const t=A.shift(),n=e.find(e=>e.id===t);o.push(n),i[t].forEach(t=>{r[t]--,0===r[t]&&A.push(t)})}return o}(t),B=(w||[]).map((t,e)=>{const n=Math.floor(e/o),r=e%o,i=g+(c?n%2==0?r:o-1-r:n%2==0?o-1-r:r)*(p[0]+m)+p[0]/2,A=h+n*(p[1]+y)+p[1]/2;return{id:t.id,style:{x:i,y:A}}});return{nodes:B}})}}qj.defaultOptions={padding:0,cols:5,clockwise:!0};class Zj extends Ay{}function Jj(t,e=!0,n){const r=document.createElement("div");return r.setAttribute("class",`g6-${t}`),Object.assign(r.style,{position:"absolute",display:"block"}),e&&Object.assign(r.style,{position:"unset",gridArea:"1 / 1 / 2 / 2",inset:"0px",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none"}),n&&Object.assign(r.style,n),r}function $j(t,e="div",n={},r="",i=document.body){const A=document.getElementById(t);A&&A.remove();const o=document.createElement(e);return o.innerHTML=r,o.id=t,Object.assign(o.style,n),i.appendChild(o),o}class tV extends Zj{constructor(t,e){super(t,Object.assign({},tV.defaultOptions,e)),this.$element=Jj("background");this.context.canvas.getContainer().prepend(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return _e(this,void 0,void 0,function*(){e.update.call(this,t),Object.assign(this.$element.style,Te(this.options,["key","type"]))})}destroy(){super.destroy(),this.$element.remove()}}function eV(t,e,n,r,i,A){const o=n-t,s=r-e;let a=i-t,c=A-e,l=a*o+c*s,u=0;l<=0?u=0:(a=o-a,c=s-c,l=a*o+c*s,u=l<=0?0:l*l/(o*o+s*s));const h=a*a+c*c-u;return h<0?0:h}function nV(t,e,n,r){return(t-n)*(t-n)+(e-r)*(e-r)}function rV(t,e,n,r,i){return nV(t,e,n,r)<i*i}function iV(t){const e=Math.min(t.x1,t.x2),n=Math.max(t.x1,t.x2),r=Math.min(t.y1,t.y2),i=Math.max(t.y1,t.y2);return{x:e,y:r,x2:n,y2:i,width:n-e,height:i-r}}tV.defaultOptions={transition:"background 0.5s",backgroundSize:"cover",zIndex:"-1"};class AV{constructor(t,e,n,r){this.x1=t,this.y1=e,this.x2=n,this.y2=r}equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2}draw(t){t.moveTo(this.x1,this.y1),t.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new AV(t.x1,t.y1,t.x2,t.y2)}cuts(t,e){if(this.y1===this.y2)return!1;if(e<this.y1&&e<=this.y2||e>this.y1&&e>=this.y2)return!1;if(t>this.x1&&t>=this.x2)return!1;if(t<this.x1&&t<=this.x2)return!0;return t<=this.x1+(e-this.y1)*(this.x2-this.x1)/(this.y2-this.y1)}distSquare(t,e){return eV(this.x1,this.y1,this.x2,this.y2,t,e)}ptClose(t,e,n){if(this.x1<this.x2){if(t<this.x1-n||t>this.x2+n)return!1}else if(t<this.x2-n||t>this.x1+n)return!1;if(this.y1<this.y2){if(e<this.y1-n||e>this.y2+n)return!1}else if(e<this.y2-n||e>this.y1+n)return!1;return!0}}var oV,sV;!function(t){t[t.POINT=1]="POINT",t[t.PARALLEL=2]="PARALLEL",t[t.COINCIDENT=3]="COINCIDENT",t[t.NONE=4]="NONE"}(oV||(oV={}));class aV{constructor(t,e=0,n=0){this.state=t,this.x=e,this.y=n}}function cV(t,e){const n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),r=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){const e=n/i,A=r/i;return 0<=e&&e<=1&&0<=A&&A<=1?new aV(oV.POINT,t.x1+e*(t.x2-t.x1),t.y1+e*(t.y2-t.y1)):new aV(oV.NONE)}return new aV(0===n||0===r?oV.COINCIDENT:oV.PARALLEL)}function lV(t,e){const n=(e.x2-e.x1)*(t.y1-e.y1)-(e.y2-e.y1)*(t.x1-e.x1),r=(t.x2-t.x1)*(t.y1-e.y1)-(t.y2-t.y1)*(t.x1-e.x1),i=(e.y2-e.y1)*(t.x2-t.x1)-(e.x2-e.x1)*(t.y2-t.y1);if(i){const t=n/i,e=r/i;if(0<=t&&t<=1&&0<=e&&e<=1)return t}return Number.POSITIVE_INFINITY}function uV(t,e,n){const r=new Set;return t.width<=0?(r.add(sV.LEFT),r.add(sV.RIGHT)):e<t.x?r.add(sV.LEFT):e>t.x+t.width&&r.add(sV.RIGHT),t.height<=0?(r.add(sV.TOP),r.add(sV.BOTTOM)):n<t.y?r.add(sV.TOP):n>t.y+t.height&&r.add(sV.BOTTOM),r}function hV(t,e){let n=e.x1,r=e.y1;const i=e.x2,A=e.y2,o=Array.from(uV(t,i,A));if(0===o.length)return!0;let s=uV(t,n,r);for(;0!==s.size;){for(const t of o)if(s.has(t))return!1;if(s.has(sV.RIGHT)||s.has(sV.LEFT)){let e=t.x;s.has(sV.RIGHT)&&(e+=t.width),r+=(e-n)*(A-r)/(i-n),n=e}else{let e=t.y;s.has(sV.BOTTOM)&&(e+=t.height),n+=(e-r)*(i-n)/(A-r),r=e}s=uV(t,n,r)}return!0}function dV(t,e){let n=Number.POSITIVE_INFINITY,r=0;function i(t,i,A,o){let s=lV(e,new AV(t,i,A,o));s=Math.abs(s-.5),s>=0&&s<=1&&(r++,s<n&&(n=s))}return i(t.x,t.y,t.x2,t.y),i(t.x,t.y,t.x,t.y2),r>1?n:(i(t.x,t.y2,t.x2,t.y2),r>1?n:(i(t.x2,t.y,t.x2,t.y2),0===r?-1:n))}function fV(t,e){let n=0;const r=cV(t,new AV(e.x,e.y,e.x2,e.y));n+=r.state===oV.POINT?1:0;const i=cV(t,new AV(e.x,e.y,e.x,e.y2));n+=i.state===oV.POINT?1:0;const A=cV(t,new AV(e.x,e.y2,e.x2,e.y2));n+=A.state===oV.POINT?1:0;const o=cV(t,new AV(e.x2,e.y,e.x2,e.y2));return n+=o.state===oV.POINT?1:0,{top:r,left:i,bottom:A,right:o,count:n}}!function(t){t[t.LEFT=0]="LEFT",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=3]="BOTTOM"}(sV||(sV={}));class gV{constructor(t,e,n,r){this.x=t,this.y=e,this.width=n,this.height=r}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new gV(t.x,t.y,t.width,t.height)}equals(t){return this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height}clone(){return new gV(this.x,this.y,this.width,this.height)}add(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x2,t.x+t.width),i=Math.max(this.y2,t.y+t.height);this.x=e,this.y=n,this.width=r-e,this.height=i-n}addPoint(t){const e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),r=Math.max(this.x2,t.x),i=Math.max(this.y2,t.y);this.x=e,this.y=n,this.width=r-e,this.height=i-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(t){t.rect(this.x,this.y,this.width,this.height)}containsPt(t,e){return t>=this.x&&t<=this.x2&&e>=this.y&&e<=this.y2}get area(){return this.width*this.height}intersects(t){return!(this.area<=0||t.width<=0||t.height<=0)&&(t.x+t.width>this.x&&t.y+t.height>this.y&&t.x<this.x2&&t.y<this.y2)}distSquare(t,e){if(this.containsPt(t,e))return 0;const n=uV(this,t,e);return n.has(sV.TOP)?n.has(sV.LEFT)?nV(t,e,this.x,this.y):n.has(sV.RIGHT)?nV(t,e,this.x2,this.y):(this.y-e)*(this.y-e):n.has(sV.BOTTOM)?n.has(sV.LEFT)?nV(t,e,this.x,this.y2):n.has(sV.RIGHT)?nV(t,e,this.x2,this.y2):(e-this.y2)*(e-this.y2):n.has(sV.LEFT)?(this.x-t)*(this.x-t):n.has(sV.RIGHT)?(t-this.x2)*(t-this.x2):0}}class pV{constructor(t,e,n){this.cx=t,this.cy=e,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return 2*this.radius}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return 2*this.radius}static from(t){return new pV(t.cx,t.cy,t.radius)}containsPt(t,e){return nV(this.cx,this.cy,t,e)<this.radius*this.radius}distSquare(t,e){const n=nV(this.cx,this.cy,t,e);if(n<this.radius*this.radius)return 0;const r=Math.sqrt(n)-this.radius;return r*r}draw(t){t.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,2*Math.PI)}}class vV{constructor(t,e=0,n=0,r=0,i=0,A=10,o=10,s=new Float32Array(Math.max(0,A*o)).fill(0)){this.pixelGroup=t,this.i=e,this.j=n,this.pixelX=r,this.pixelY=i,this.width=A,this.height=o,this.area=s}createSub(t,e){return new vV(this.pixelGroup,t.x,t.y,e.x,e.y,t.width,t.height)}static fromPixelRegion(t,e){return new vV(e,0,0,t.x,t.y,Math.ceil(t.width/e),Math.ceil(t.height/e))}copy(t,e){return new vV(this.pixelGroup,this.scaleX(e.x),this.scaleY(e.y),e.x,e.y,t.width,t.height,t.area)}boundX(t){return t<this.i?this.i:t>=this.width?this.width-1:t}boundY(t){return t<this.j?this.j:t>=this.height?this.height-1:t}scaleX(t){return this.boundX(Math.floor((t-this.pixelX)/this.pixelGroup))}scaleY(t){return this.boundY(Math.floor((t-this.pixelY)/this.pixelGroup))}scale(t){const e=this.scaleX(t.x),n=this.scaleY(t.y),r=this.boundX(Math.ceil((t.x+t.width-this.pixelX)/this.pixelGroup)),i=this.boundY(Math.ceil((t.y+t.height-this.pixelY)/this.pixelGroup));return new gV(e,n,r-e,i-n)}invertScaleX(t){return Math.round(t*this.pixelGroup+this.pixelX)}invertScaleY(t){return Math.round(t*this.pixelGroup+this.pixelY)}addPadding(t,e){const n=Math.ceil(e/this.pixelGroup),r=this.boundX(t.x-n),i=this.boundY(t.y-n),A=this.boundX(t.x2+n),o=this.boundY(t.y2+n);return new gV(r,i,A-r,o-i)}get(t,e){return t<0||e<0||t>=this.width||e>=this.height?Number.NaN:this.area[t+e*this.width]}inc(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]+=n)}set(t,e,n){t<0||e<0||t>=this.width||e>=this.height||(this.area[t+e*this.width]=n)}incArea(t,e){if(t.width<=0||t.height<=0||0===e)return;const n=this.width,r=t.width,i=Math.max(0,t.i),A=Math.max(0,t.j),o=Math.min(t.i+t.width,n),s=Math.min(t.j+t.height,this.height);if(!(s<=0||o<=0||i>=n||s>=this.height))for(let a=A;a<s;a++){const A=(a-t.j)*r,s=a*n;for(let n=i;n<o;n++){const r=t.area[n-t.i+A];0!==r&&(this.area[n+s]+=e*r)}}}fill(t){this.area.fill(t)}fillArea(t,e){const n=t.x+t.y*this.width;for(let r=0;r<t.height;r++){const i=n+r*this.width;this.area.fill(e,i,i+t.width)}}fillHorizontalLine(t,e,n,r){const i=t+e*this.width;this.area.fill(r,i,i+n)}fillVerticalLine(t,e,n,r){const i=t+e*this.width;for(let t=0;t<n;t++)this.area[i+t*this.width]=r}clear(){this.area.fill(0)}toString(){let t="";for(let e=0;e<this.height;e++){const n=e*this.width;for(let e=0;e<this.width;e++){t+=this.area[n+e].toFixed(1).padStart(6),t+=" "}t+="\n"}return t}draw(t,e=!0){if(this.width<=0||this.height<=0)return;t.save(),e&&t.translate(this.pixelX,this.pixelY);const n=this.area.reduce((t,e)=>Math.min(t,e),Number.POSITIVE_INFINITY),r=this.area.reduce((t,e)=>Math.max(t,e),Number.NEGATIVE_INFINITY),i=t=>(t-n)/(r-n);t.scale(this.pixelGroup,this.pixelGroup);for(let e=0;e<this.width;e++)for(let n=0;n<this.height;n++){const r=this.area[e+n*this.width];t.fillStyle=`rgba(0, 0, 0, ${i(r)})`,t.fillRect(e,n,1,1)}t.restore()}drawThreshold(t,e,n=!0){if(!(this.width<=0||this.height<=0)){t.save(),n&&t.translate(this.pixelX,this.pixelY),t.scale(this.pixelGroup,this.pixelGroup);for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++){const i=this.area[n+r*this.width];t.fillStyle=i>e?"black":"white",t.fillRect(n,r,1,1)}t.restore()}}}function mV(t,e){const n=t=>({x:t.x-e,y:t.y-e,width:t.width+2*e,height:t.height+2*e});return Array.isArray(t)?t.map(n):n(t)}function yV(t,e,n){return wV(Object.assign(iV(t),{distSquare:(e,n)=>eV(t.x1,t.y1,t.x2,t.y2,e,n)}),e,n)}function wV(t,e,n){const r=mV(t,n),i=e.scale(r),A=e.createSub(i,r);return function(t,e,n,r){const i=n*n;for(let A=0;A<t.height;A++)for(let o=0;o<t.width;o++){const s=r(e.invertScaleX(t.i+o),e.invertScaleY(t.j+A));if(0!==s){if(s<i){const e=n-Math.sqrt(s);t.set(o,A,e*e)}}else t.set(o,A,i)}}(A,e,n,(e,n)=>t.distSquare(e,n)),A}function BV(t,e){return{x:t,y:e}}function bV(t,e,n,r){if(0===t.length)return[];const i=function(t){if(t.length<2)return t;let e=0,n=0;return t.forEach(t=>{e+=t.cx,n+=t.cy}),e/=t.length,n/=t.length,t.map(t=>{const r=e-t.cx,i=n-t.cy;return[t,r*r+i*i]}).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}(t);return i.map((t,A)=>{const o=i.slice(0,A);return function(t,e,n,r,i){const A=BV(e.cx,e.cy),o=function(t,e,n){let r=Number.POSITIVE_INFINITY;return e.reduce((e,i)=>{const A=nV(t.x,t.y,i.cx,i.cy);if(A>r)return e;const o=new AV(t.x,t.y,i.cx,i.cy),s=function(t,e){return t.reduce((t,n)=>hV(n,e)&&function(t,e){function n(t,n,r,i){let A=lV(e,new AV(t,n,r,i));return A=Math.abs(A-.5),A>=0&&A<=1?1:0}let r=n(t.x,t.y,t.x2,t.y);return r+=n(t.x,t.y,t.x,t.y2),r>1||(r+=n(t.x,t.y2,t.x2,t.y2),r>1||(r+=n(t.x2,t.y,t.x2,t.y2),r>0))}(n,e)?t+1:t,0)}(n,o);return A*(s+1)*(s+1)<r&&(e=i,r=A*(s+1)*(s+1)),e},null)}(A,n,t);if(null==o)return[];const s=function(t,e,n,r){const i=[],A=[];A.push(t);let o=!0;for(let t=0;t<n&&o;t++)for(o=!1;!o&&A.length>0;){const t=A.pop(),n=CV(e,t),s=n?fV(t,n):null;if(!n||!s||2!==s.count){o||i.push(t);continue}let a=r,c=FV(n,a,s,!0),l=xV(c,A)||xV(c,i),u=EV(c,e);for(;!l&&u&&a>=1;)a/=1.5,c=FV(n,a,s,!0),l=xV(c,A)||xV(c,i),u=EV(c,e);if(!c||l||u||(A.push(new AV(t.x1,t.y1,c.x,c.y)),A.push(new AV(c.x,c.y,t.x2,t.y2)),o=!0),o)continue;a=r,c=FV(n,a,s,!1);let h=xV(c,A)||xV(c,i);for(u=EV(c,e);!h&&u&&a>=1;)a/=1.5,c=FV(n,a,s,!1),h=xV(c,A)||xV(c,i),u=EV(c,e);c&&!h&&(A.push(new AV(t.x1,t.y1,c.x,c.y)),A.push(new AV(c.x,c.y,t.x2,t.y2)),o=!0),o||i.push(t)}for(;A.length>0;)i.push(A.pop());return i}(new AV(A.x,A.y,o.cx,o.cy),t,r,i);return function(t,e){const n=[];for(;t.length>0;){const r=t.pop();if(0===t.length){n.push(r);break}const i=t.pop(),A=new AV(r.x1,r.y1,i.x2,i.y2);CV(e,A)?(n.push(r),t.push(i)):t.push(A)}return n}(s,t)}(e,t,o,n,r)}).flat()}function EV(t,e){return e.some(e=>e.containsPt(t.x,t.y))}function xV(t,e){return e.some(e=>!!rV(e.x1,e.y1,t.x,t.y,.001)||!!rV(e.x2,e.y2,t.x,t.y,.001))}function CV(t,e){let n=Number.POSITIVE_INFINITY,r=null;for(const i of t){if(!hV(i,e))continue;const t=dV(i,e);t>=0&&t<n&&(r=i,n=t)}return r}function FV(t,e,n,r){const i=n.top,A=n.left,o=n.bottom,s=n.right;if(r){if(A.state===oV.POINT){if(i.state===oV.POINT)return BV(t.x-e,t.y-e);if(o.state===oV.POINT)return BV(t.x-e,t.y2+e);const n=t.width*t.height;return t.width*(.5*(A.y-t.y+(s.y-t.y)))<.5*n?A.y>s.y?BV(t.x-e,t.y-e):BV(t.x2+e,t.y-e):A.y<s.y?BV(t.x-e,t.y2+e):BV(t.x2+e,t.y2+e)}if(s.state===oV.POINT){if(i.state===oV.POINT)return BV(t.x2+e,t.y-e);if(o.state===oV.POINT)return BV(t.x2+e,t.y2+e)}const n=t.height*t.width;return t.height*(.5*(i.x-t.x+(s.x-t.x)))<.5*n?i.x>o.x?BV(t.x-e,t.y-e):BV(t.x-e,t.y2+e):i.x<o.x?BV(t.x2+e,t.y-e):BV(t.x2+e,t.y2+e)}if(A.state===oV.POINT){if(i.state===oV.POINT)return BV(t.x2+e,t.y2+e);if(o.state===oV.POINT)return BV(t.x2+e,t.y-e);const n=t.height*t.width;return t.width*(.5*(A.y-t.y+(s.y-t.y)))<.5*n?A.y>s.y?BV(t.x2+e,t.y2+e):BV(t.x-e,t.y2+e):A.y<s.y?BV(t.x2+e,t.y-e):BV(t.x-e,t.y-e)}if(s.state===oV.POINT){if(i.state===oV.POINT)return BV(t.x-e,t.y2+e);if(o.state===oV.POINT)return BV(t.x-e,t.y-e)}const a=t.height*t.width;return t.height*(.5*(i.x-t.x+(s.x-t.x)))<.5*a?i.x>o.x?BV(t.x2+e,t.y2+e):BV(t.x2+e,t.y-e):i.x<o.x?BV(t.x-e,t.y2+e):BV(t.x-e,t.y-e)}function MV(t,e,n,r){if(!(t.closed?n<t.length:n<t.length-1))return!1;const i=t.get(e),A=t.get(n+1);for(let o=e+1;o<=n;o++){const e=t.get(o);if(eV(i.x,i.y,A.x,A.y,e.x,e.y)>r)return!1}return!0}function kV(t,e){switch(t){case-2:return(((3-e)*e-3)*e+1)/6;case-1:return((3*e-6)*e*e+4)/6;case 0:return(((-3*e+3)*e+3)*e+1)/6;case 1:return e*e*e/6;default:throw new Error("unknown error")}}class QV{constructor(t=[],e=!0){this.points=t,this.closed=e}get(t){const e=t,n=this.points.length;return t<0?this.closed?this.get(t+n):this.points[0]:t>=n?this.closed?this.get(t-n):this.points[n-1]:this.points[e]}get length(){return this.points.length}toString(t=1/0){const e=this.points;if(0===e.length)return"";const n="function"==typeof t?t:function(t){if(!Number.isFinite(t))return t=>t;if(0===t)return Math.round;const e=Math.pow(10,t);return t=>Math.round(t*e)/e}(t);let r="M";for(const t of e)r+=`${n(t.x)},${n(t.y)} L`;return r=r.slice(0,-1),this.closed&&(r+=" Z"),r}draw(t){const e=this.points;if(0!==e.length){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(const n of e)t.lineTo(n.x,n.y);this.closed&&t.closePath()}}sample(t){return function(t=8){return e=>{let n=t,r=e.length;if(n>1)for(r=Math.floor(e.length/n);r<3&&n>1;)n-=1,r=Math.floor(e.length/n);const i=[];for(let t=0,A=0;A<r;A++,t+=n)i.push(e.get(t));return new QV(i)}}(t)(this)}simplify(t){return function(t=0){return e=>{if(t<0||e.length<3)return e;const n=[];let r=0;const i=t*t;for(;r<e.length;){let t=r+1;for(;MV(e,r,t,i);)t++;n.push(e.get(r)),r=t}return new QV(n)}}(t)(this)}bSplines(t){return function(t=6){function e(t,e,n){let r=0,i=0;for(let A=-2;A<=1;A++){const o=t.get(e+A),s=kV(A,n);r+=s*o.x,i+=s*o.y}return{x:r,y:i}}return n=>{if(n.length<3)return n;const r=[],i=n.closed,A=n.length+3-1+(i?0:2);r.push(e(n,2-(i?0:2),0));for(let o=2-(i?0:2);o<A;o++)for(let i=1;i<=t;i++)r.push(e(n,o,i/t));return new QV(r)}}(t)(this)}apply(t){return t(this)}containsElements(t){const e=function(t){if(0===t.length)return null;const e=t[0],n=new gV(e.x,e.y,0,0);for(const e of t)n.addPoint(e);return n}(this.points);return!!e&&t.every(t=>e.containsPt(t.cx,t.cy)&&this.withinArea(t.cx,t.cy))}withinArea(t,e){if(0===this.length)return!1;let n=0;const r=this.points[0],i=new AV(r.x,r.y,r.x,r.y);for(let r=1;r<this.points.length;r++){const A=this.points[r];i.x1=i.x2,i.y1=i.y2,i.x2=A.x,i.y2=A.y,i.cuts(t,e)&&n++}return i.x1=i.x2,i.y1=i.y2,i.x2=r.x,i.y2=r.y,i.cuts(t,e)&&n++,n%2==1}}class SV{constructor(t=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=t}add(t){this.set.add(`${t.x}x${t.y}`),this.arr[this.count++]=t}contains(t){return this.set.has(`${t.x}x${t.y}`)}isFirst(t){if(0===this.count)return!1;const e=this.arr[0];return null!=e&&e.x===t.x&&e.y===t.y}path(){return new QV(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(t){return this.arr[t]}get length(){return this.count}}function UV(t,e){const n=2*(Math.floor(t.width)+Math.floor(t.height)),r=new SV(n);function i(n,r,i,A){const o=t.get(n,r);return Number.isNaN(o)?Number.NaN:o>e?i+A:i}function A(t,e){let n=0;return n=i(t,e,n,1),n=i(t+1,e,n,2),n=i(t,e+1,n,4),n=i(t+1,e+1,n,8),Number.isNaN(n)?-1:n}let o=1;function s(e,n){let i=e,s=n,a=t.invertScaleX(i),c=t.invertScaleY(s);for(let e=0;e<t.width*t.height;e++){const e={x:a,y:c};if(r.contains(e)){if(r.isFirst(e))return!0}else r.add(e);const n=A(i,s);switch(n){case-1:return!0;case 0:case 3:case 2:case 7:o=2;break;case 12:case 14:case 4:o=3;break;case 6:o=0===o?3:2;break;case 1:case 13:case 5:o=0;break;case 9:o=2===o?0:1;break;case 10:case 8:case 11:o=1;break;default:return console.warn("Marching squares invalid state: "+n),!0}switch(o){case 0:s--,c-=t.pixelGroup;break;case 1:s++,c+=t.pixelGroup;break;case 3:i--,a-=t.pixelGroup;break;case 2:i++,a+=t.pixelGroup;break;default:return console.warn("Marching squares invalid state: "+n),!0}}return!0}for(let n=0;n<t.width;n++)for(let i=0;i<t.height;i++){if(t.get(n,i)<=e)continue;const o=A(n,i);if(!(o<0||15===o)&&s(n,i))return r.path()}return null}const TV={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function OV(t){return null!=t&&"number"==typeof t.radius}function NV(t,e){if(OV(t)!==OV(e))return!1;if(OV(t)){const n=e;return t.cx===n.cx&&t.cy===n.cy&&t.radius===n.radius}const n=e;return t.x===n.x&&t.y===n.y&&t.width===n.width&&t.height===n.height}var IV;!function(t){t[t.MEMBERS=0]="MEMBERS",t[t.NON_MEMBERS=1]="NON_MEMBERS",t[t.EDGES=2]="EDGES"}(IV||(IV={}));let LV=class{constructor(t={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new gV(0,0,0,0),this.potentialArea=new vV(1,0,0,0,0,0,0),this.o=Object.assign({},TV,t)}pushMember(...t){if(0!==t.length){this.dirty.add(IV.MEMBERS);for(const e of t)this.members.push({raw:e,obj:OV(e)?pV.from(e):gV.from(e),area:null})}}removeMember(t){const e=this.members.findIndex(e=>NV(e.raw,t));return!(e<0)&&(this.members.splice(e,1),this.dirty.add(IV.MEMBERS),!0)}removeNonMember(t){const e=this.nonMembers.findIndex(e=>NV(e.raw,t));return!(e<0)&&(this.nonMembers.splice(e,1),this.dirty.add(IV.NON_MEMBERS),!0)}removeEdge(t){const e=this.edges.findIndex(e=>e.obj.equals(t));return!(e<0)&&(this.edges.splice(e,1),this.dirty.add(IV.NON_MEMBERS),!0)}pushNonMember(...t){if(0!==t.length){this.dirty.add(IV.NON_MEMBERS);for(const e of t)this.nonMembers.push({raw:e,obj:OV(e)?pV.from(e):gV.from(e),area:null})}}pushEdge(...t){if(0!==t.length){this.dirty.add(IV.EDGES);for(const e of t)this.edges.push({raw:e,obj:AV.from(e),area:null})}}update(){const t=this.dirty.has(IV.MEMBERS),e=this.dirty.has(IV.NON_MEMBERS);let n=this.dirty.has(IV.EDGES);this.dirty.clear();const r=this.members.map(t=>t.obj);if(this.o.virtualEdges&&(t||e)){const t=this.nonMembers.map(t=>t.obj),e=bV(r,t,this.o.maxRoutingIterations,this.o.morphBuffer),i=new Map(this.virtualEdges.map(t=>[t.obj.toString(),t.area]));this.virtualEdges=e.map(t=>{var e;return{raw:t,obj:t,area:null!==(e=i.get(t.toString()))&&void 0!==e?e:null}}),n=!0}let i=!1;if(t||n){const t=this.virtualEdges.concat(this.edges).map(t=>t.obj),e=function(t,e){if(0===t.length)return new gV(0,0,0,0);const n=gV.from(t[0]);for(const e of t)n.add(e);for(const t of e)n.add(iV(t));return n}(r,t),n=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,A=gV.from(mV(e,n));A.equals(this.activeRegion)||(i=!0,this.activeRegion=A)}if(i){const t=Math.ceil(this.activeRegion.width/this.o.pixelGroup),e=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=vV.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(t=>t.area=null),this.nonMembers.forEach(t=>t.area=null),this.edges.forEach(t=>t.area=null),this.virtualEdges.forEach(t=>t.area=null)):t===this.potentialArea.width&&e===this.potentialArea.height||(this.potentialArea=vV.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}const A=new Map,o=t=>{if(t.area){const e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof gV?"R":"C"}`;A.set(e,t.area)}},s=t=>{if(t.area)return;const e=`${t.obj.width}x${t.obj.height}x${t.obj instanceof gV?"R":"C"}`;if(A.has(e)){const n=A.get(e);return void(t.area=this.potentialArea.copy(n,{x:t.obj.x-this.o.nodeR1,y:t.obj.y-this.o.nodeR1}))}const n=t.obj instanceof gV?function(t,e,n){const r=e.scale(t),i=e.addPadding(r,n),A=e.createSub(i,{x:t.x-n,y:t.y-n}),o=r.x-i.x,s=r.y-i.y,a=i.x2-r.x2,c=i.y2-r.y2,l=i.width-o-a,u=i.height-s-c,h=n*n;A.fillArea({x:o,y:s,width:l+1,height:u+1},h);const d=[0],f=Math.max(s,o,a,c);{const i=e.invertScaleX(r.x+r.width/2);for(let A=1;A<f;A++){const o=e.invertScaleY(r.y-A),s=t.distSquare(i,o);if(!(s<h))break;{const t=n-Math.sqrt(s);d.push(t*t)}}}const g=[],p=Math.max(o,a),v=Math.max(s,a);for(let i=1;i<p;i++){const A=e.invertScaleX(r.x-i),o=[];for(let i=1;i<v;i++){const s=e.invertScaleY(r.y-i),a=t.distSquare(A,s);if(a<h){const t=n-Math.sqrt(a);o.push(t*t)}else o.push(0)}g.push(o)}for(let t=1;t<Math.min(s,d.length);t++){const e=d[t];A.fillHorizontalLine(o,s-t,l+1,e)}for(let t=1;t<Math.min(c,d.length);t++){const e=d[t];A.fillHorizontalLine(o,s+u+t,l+1,e)}for(let t=1;t<Math.min(o,d.length);t++){const e=d[t];A.fillVerticalLine(o-t,s,u+1,e)}for(let t=1;t<Math.min(c,d.length);t++){const e=d[t];A.fillVerticalLine(o+l+t,s,u+1,e)}for(let t=1;t<o;t++){const e=g[t-1],n=o-t;for(let t=1;t<s;t++)A.set(n,s-t,e[t-1]);for(let t=1;t<c;t++)A.set(n,s+u+t,e[t-1])}for(let t=1;t<a;t++){const e=g[t-1],n=o+l+t;for(let t=1;t<s;t++)A.set(n,s-t,e[t-1]);for(let t=1;t<c;t++)A.set(n,s+u+t,e[t-1])}return A}(t.obj,this.potentialArea,this.o.nodeR1):wV(t.obj,this.potentialArea,this.o.nodeR1);t.area=n,A.set(e,n)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(s),this.nonMembers.forEach(t=>{this.activeRegion.intersects(t.obj)?s(t):t.area=null}),this.edges.forEach(t=>{t.area||(t.area=yV(t.obj,this.potentialArea,this.o.edgeR1))}),this.virtualEdges.forEach(t=>{t.area||(t.area=yV(t.obj,this.potentialArea,this.o.edgeR1))})}drawMembers(t){for(const e of this.members)e.obj.draw(t)}drawNonMembers(t){for(const e of this.nonMembers)e.obj.draw(t)}drawEdges(t){for(const e of this.edges)e.obj.draw(t)}drawPotentialArea(t,e=!0){this.potentialArea.draw(t,e)}compute(){if(0===this.members.length)return new QV([]);this.dirty.size>0&&this.update();const{o:t,potentialArea:e}=this,n=this.members.map(t=>t.area),r=this.virtualEdges.concat(this.edges).map(t=>t.area),i=this.nonMembers.filter(t=>null!=t.area).map(t=>t.area),A=this.members.map(t=>t.obj);return function(t,e,n,r,i,A={}){const o=Object.assign({},TV,A);let s=o.threshold,a=o.memberInfluenceFactor,c=o.edgeInfluenceFactor,l=o.nonMemberInfluenceFactor;const u=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),h=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let A=0;A<o.maxMarchingIterations;A++){if(t.clear(),0!==a){const n=a/u;for(const r of e)t.incArea(r,n)}if(0!==c){const e=c/h;for(const r of n)t.incArea(r,e)}if(0!==l){const e=l/u;for(const n of r)t.incArea(n,e)}const d=UV(t,s);if(d&&i(d))return d;if(s*=.95,A<=.5*o.maxMarchingIterations)a*=1.2,c*=1.2;else{if(!(0!==l&&r.length>0))break;l*=.8}}return new QV([])}(e,n,r,i,t=>t.containsElements(A),t)}};class DV extends Zj{constructor(t,e){super(t,xe({},DV.defaultOptions,e)),this.path=null,this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{const{style:t,bubbleSetOptions:e}=this.parseOptions();Me(this.bubbleSetOptions,e)||this.init(),this.bubbleSetOptions=Object.assign({},e);const n=Object.assign(Object.assign({},t),{d:this.getPath()});this.shape?this.shape.update(n):(this.shape=new Ew({style:n}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=t=>{if(!this.shape)return;const e=Vm(t.data);[...this.options.members,...this.options.avoidMembers].includes(e)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(e)}))},this.getPath=t=>{const{graph:e}=this.context,n=this.options.members,r=[...this.members.keys()],i=this.options.avoidMembers,A=[...this.avoidMembers.keys()];if(0===n.length&&0===i.length)return this.members.clear(),this.avoidMembers.clear(),this.path=[],this.path;if(!t&&this.path&&Me(n,r)&&Me(i,A))return this.path;const{enter:o=[],exit:s=[]}=ny(r,n,t=>t),{enter:a=[],exit:c=[]}=ny(A,i,t=>t);if(t){const e=n.includes(t),r=i.includes(t);e&&(s.push(t),o.push(t)),r&&(c.push(t),a.push(t))}const l=(t,n,r)=>{t.forEach(t=>{const i=r?this.members:this.avoidMembers,A=r?"pushMember":"pushNonMember",o=r?"removeMember":"removeNonMember";if(n){let n;"edge"===e.getElementType(t)?([n]=RV(e,t),this.bubbleSets.pushEdge(n)):([n]=PV(e,t),this.bubbleSets[A](n)),i.set(t,n)}else{const n=i.get(t);n&&("edge"===e.getElementType(t)?this.bubbleSets.removeEdge(n):this.bubbleSets[o](n),i.delete(t))}})};l(s,!1,!0),l(o,!0,!0),l(c,!1,!1),l(a,!0,!1);const u=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=bw(u.points.map(Sy)),this.path},this.bindEvents(),this.bubbleSets=new LV(this.options)}bindEvents(){this.context.graph.on(t.GraphEvent.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(t.GraphEvent.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new LV(this.options),this.members.clear(),this.avoidMembers.clear(),this.path=null}parseOptions(){const t=this.options,{type:e,key:n,members:r,avoidMembers:i}=t,A=He(t,["type","key","members","avoidMembers"]),o=Object.keys(A).reduce((t,e)=>(e in TV?t.bubbleSetOptions[e]=A[e]:t.style[e]=A[e],t),{style:{},bubbleSetOptions:{}});return Object.assign({type:e,key:n,members:r,avoidMembers:i},o)}addMember(t){const e=Array.isArray(t)?t:[t];e.some(t=>this.options.avoidMembers.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t))),this.options.members=[...new Set([...this.options.members,...e])],this.drawBubbleSets()}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),this.drawBubbleSets()}updateMember(t){this.options.members=Vt(t)?t(this.options.members):t,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(t){const e=Array.isArray(t)?t:[t];e.some(t=>this.options.members.includes(t))&&(this.options.members=this.options.members.filter(t=>!e.includes(t))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...e])],this.drawBubbleSets()}removeAvoidMember(t){const e=Array.isArray(t)?t:[t];this.options.avoidMembers.some(t=>e.includes(t))&&(this.options.avoidMembers=this.options.avoidMembers.filter(t=>!e.includes(t)),this.drawBubbleSets())}updateAvoidMember(t){this.options.avoidMembers=Array.isArray(t)?t:[t],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(t.GraphEvent.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(t.GraphEvent.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape&&(this.shape.destroy(),this.shape=void 0),super.destroy()}}DV.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:"lightblue",fillOpacity:.2,stroke:"blue",strokeOpacity:.2},TV);const PV=(t,e)=>(Array.isArray(e)?e:[e]).map(e=>{const n=t.getElementRenderBounds(e);return new gV(n.min[0],n.min[1],wm(n),Bm(n))}),RV=(t,e)=>(Array.isArray(e)?e:[e]).map(e=>{const n=t.getEdgeData(e),r=t.getElementPosition(n.source),i=t.getElementPosition(n.target);return AV.from({x1:r[0],y1:r[1],x2:i[0],y2:i[1]})});class HV extends Zj{constructor(t,e){super(t,Object.assign({},HV.defaultOptions,e)),this.targetElement=null,this.onTriggerEvent=t=>{var e;null===(e=t.preventDefault)||void 0===e||e.call(t),this.show(t)},this.onMenuItemClick=t=>{const{onClick:e,trigger:n}=this.options;if(t.target instanceof HTMLElement&&t.target.className.includes("g6-contextmenu-li")){const n=t.target.getAttribute("value");null==e||e(n,t.target,this.targetElement),this.hide()}"click"!==n&&this.hide()},this.initElement(),this.update(e)}initElement(){this.$element=Jj("contextmenu",!1,{zIndex:"99"});const{className:t}=this.options;t&&this.$element.classList.add(t);this.context.canvas.getContainer().appendChild(this.$element),$j("g6-contextmenu-css","style",{},"\n  .g6-contextmenu {\n    font-size: 12px;\n    background-color: rgba(255, 255, 255, 0.96);\n    border-radius: 4px;\n    overflow: hidden;\n    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;\n    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;\n  }\n\n  .g6-contextmenu-ul {\n    max-width: 256px;\n    min-width: 96px;\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .g6-contextmenu-li {\n    padding: 8px 12px;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .g6-contextmenu-li:hover {\n    background-color: #f5f5f5;\n    cursor: pointer;\n  }\n",document.head)}show(t){return _e(this,void 0,void 0,function*(){const{enable:e,offset:n}=this.options;if("function"==typeof e&&!e(t)||!e)return void this.hide();const r=yield this.getDOMContent(t);r instanceof HTMLElement?(this.$element.innerHTML="",this.$element.appendChild(r)):this.$element.innerHTML=r;const i=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${t.client.x-i.left+n[0]}px`,this.$element.style.top=`${t.client.y-i.top+n[1]}px`,this.$element.style.display="block",this.targetElement=t.target})}hide(){this.$element.style.display="none",this.targetElement=null}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(t){return _e(this,void 0,void 0,function*(){const{getContent:e,getItems:n}=this.options;return n?`\n    <ul class="g6-contextmenu-ul">\n      ${(yield n(t)).map(t=>`<li  class="g6-contextmenu-li" value="${t.value}">${t.name}</li>`).join("")}\n    </ul>\n  `:yield e(t)})}bindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.on(`canvas:${e}`,this.onTriggerEvent),t.on(`node:${e}`,this.onTriggerEvent),t.on(`edge:${e}`,this.onTriggerEvent),t.on(`combo:${e}`,this.onTriggerEvent),document.addEventListener("click",this.onMenuItemClick)}unbindEvents(){const{graph:t}=this.context,{trigger:e}=this.options;t.off(`canvas:${e}`,this.onTriggerEvent),t.off(`node:${e}`,this.onTriggerEvent),t.off(`edge:${e}`,this.onTriggerEvent),t.off(`combo:${e}`,this.onTriggerEvent),document.removeEventListener("click",this.onMenuItemClick)}}HV.defaultOptions={trigger:"contextmenu",offset:[4,4],loadingContent:'<div class="g6-contextmenu-loading">Loading...</div>',getContent:()=>"It is a empty context menu.",enable:()=>!0};class _V extends Zj{constructor(t,e){super(t,Object.assign({},_V.defaultOptions,e)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{const{model:t,element:e}=this.context,n=t.getEdgeData();this.divideEdges(this.options.divisions);const{cycles:r,iterRate:i,divRate:A}=this.options;let{lambda:o,divisions:s,iterations:a}=this.options;for(let t=0;t<r;t++){for(let t=0;t<a;t++){const t={};n.forEach(e=>{var n;if(e.source===e.target)return;const r=Vm(e);t[r]=this.getEdgeForces(e,s,o);for(let e=0;e<s+1;e++)(n=this.edgePoints)[r]||(n[r]=[]),this.edgePoints[r][e]=cy(this.edgePoints[r][e],t[r][e])})}o/=2,s*=A,a*=i,this.divideEdges(s)}n.forEach(t=>{const n=Vm(t),r=e.getElement(n);null==r||r.update({d:ub(this.edgePoints[n])})})},this.bindEvents()}get nodeMap(){const t=this.context.model.getNodeData();return Object.fromEntries(t.map(t=>[Vm(t),wy(My(t))]))}divideEdges(t){this.context.model.getEdgeData().forEach(e=>{var n;const r=Vm(e);(n=this.edgePoints)[r]||(n[r]=[]);const i=this.nodeMap[e.source],A=this.nodeMap[e.target];if(1===t)this.edgePoints[r].push(i),this.edgePoints[r].push(hy(cy(i,A),2)),this.edgePoints[r].push(A);else{const e=(0===this.edgePoints[r].length?fy(i,A):YV(this.edgePoints[r]))/(t+1);let n=e;const o=[i];for(let t=1;t<this.edgePoints[r].length;t++){const i=this.edgePoints[r][t-1],A=this.edgePoints[r][t];let s=fy(A,i);for(;s>n;){const t=n/s,r=cy(i,uy(ly(A,i),t));o.push(r),s-=n,n=e}n-=s}o.push(A),this.edgePoints[r]=o}})}getVectorPosition(t){const e=this.nodeMap[t.source],n=this.nodeMap[t.target],[r,i]=ly(n,e);return{source:e,target:n,vx:r,vy:i,length:fy(e,n)}}measureEdgeCompatibility(t,e){const n=this.getVectorPosition(t),r=this.getVectorPosition(e);return GV(n,r)*KV(n,r)*jV(n,r)*WV(n,r)}getEdgeBundles(){const t={},e=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach((r,i)=>{n.forEach((n,A)=>{var o,s;if(A<=i)return;this.measureEdgeCompatibility(r,n)>=e&&(t[o=Vm(r)]||(t[o]=[]),t[Vm(r)].push(n),t[s=Vm(n)]||(t[s]=[]),t[Vm(n)].push(r))})}),t}getSpringForce(t,e){const{pre:n,cur:r,next:i}=t;return uy(ly(cy(n,i),uy(r,2)),e)}getElectrostaticForce(t,e){Fe(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());const n=this.edgeBundles[Vm(e)];let r=[0,0];return null==n||n.forEach(n=>{const i=this.edgePoints[Vm(n)][t],A=this.edgePoints[Vm(e)][t],o=ly(i,A),s=fy(i,A);r=cy(r,uy(o,1/s))}),r}getEdgeForces(t,e,n){const r=this.nodeMap[t.source],i=this.nodeMap[t.target],A=this.options.K/(fy(r,i)*(e+1)),o=[[0,0]],s=Vm(t);for(let r=1;r<e;r++){const e=this.getSpringForce({pre:this.edgePoints[s][r-1],cur:this.edgePoints[s][r],next:this.edgePoints[s][r+1]||[0,0]},A),i=this.getElectrostaticForce(r,t);o.push(uy(cy(e,i),n))}return o.push([0,0]),o}bindEvents(){const{graph:e}=this.context;e.on(t.GraphEvent.AFTER_RENDER,this.onBundle)}unbindEvents(){const{graph:e}=this.context;e.off(t.GraphEvent.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}}_V.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};const GV=(t,e)=>Math.abs(function(t,e){return t.reduce((t,n,r)=>t+n*e[r],0)}([t.vx,t.vy],[e.vx,e.vy])/(t.length*e.length)),KV=(t,e)=>{const n=(t.length+e.length)/2;return 2/(n/Math.min(t.length,e.length)+Math.max(t.length,e.length)/n)},jV=(t,e)=>{const n=(t.length+e.length)/2;return n/(n+fy(hy(cy(t.source,t.target),2),hy(cy(e.source,e.target),2)))},VV=(t,e)=>{if(e.source[0]===e.target[0])return[e.source[0],t[1]];if(e.source[1]===e.target[1])return[t[0],e.source[1]];const n=(e.source[1]-e.target[1])/(e.source[0]-e.target[0]),r=(n*n*e.source[0]+n*(t[1]-e.source[1])+t[0])/(n*n+1);return[r,n*(r-e.source[0])+e.source[1]]},zV=(t,e)=>{const n=VV(e.source,t),r=VV(e.target,t),i=hy(cy(n,r),2),A=hy(cy(t.source,t.target),2);return 0===fy(n,r)?0:Math.max(0,1-2*fy(A,i)/fy(n,r))},WV=(t,e)=>Math.min(zV(t,e),zV(e,t)),YV=t=>{let e=0;for(let n=1;n<t.length;n++)e+=fy(t[n],t[n-1]);return e},XV={fill:"#fff",fillOpacity:1,lineWidth:1,stroke:"#000",strokeOpacity:.8,zIndex:-1/0};class qV extends Zj{constructor(t,e){super(t,Object.assign({},qV.defaultOptions,e)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;const e=Sy(t.canvas);this.renderLens(e),this.renderFocusElements()},this.renderLens=t=>{const e=Object.assign({},XV,this.options.style);this.isLensOn||(this.lens=new Tw({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,Uy(t),{size:2*this.r}),this.lens.update(e)},this.getFilterData=()=>{const{filter:t}=this.options,{model:e}=this.context,n=e.getData();if(!t)return n;const{nodes:r,edges:i,combos:A}=n;return{nodes:r.filter(e=>t(Vm(e),"node")),edges:i.filter(e=>t(Vm(e),"edge")),combos:A.filter(e=>t(Vm(e),"combo"))}},this.getFocusElements=t=>{const{nodes:e,edges:n}=this.getFilterData(),r=e.filter(e=>fy(My(e),t)<this.r),i=r.map(t=>Vm(t));return{nodes:r,edges:n.filter(t=>{const{source:e,target:n}=t,r=i.includes(e),A=i.includes(n);switch(this.options.nodeType){case"both":return r&&A;case"either":return r!==A;case"source":return r&&!A;case"target":return!r&&A;default:return!1}})}},this.renderFocusElements=()=>{const{element:t,graph:e}=this.context;if(!this.isLensOn)return;const n=this.lens.getCenter(),{nodes:r,edges:i}=this.getFocusElements(n),A=new Set,o=n=>{const r=Vm(n);A.add(r);const i=t.getElement(r);if(!i)return;const o=this.shapes.get(r)||i.cloneNode();o.setPosition(i.getPosition()),o.id=i.id,this.shapes.has(r)?Object.entries(i.attributes).forEach(([t,e])=>{o.style[t]!==e&&(o.style[t]=e)}):(this.canvas.appendChild(o),this.shapes.set(r,o));const s=e.getElementType(r),a=this.getElementStyle(s,n);o.update(a)};r.forEach(o),i.forEach(o),this.shapes.forEach((t,e)=>{A.has(e)||(t.destroy(),this.shapes.delete(e))})},this.scaleRByWheel=t=>{var e;this.options.preventDefault&&t.preventDefault();const{clientX:n,clientY:r,deltaX:i,deltaY:A}=t,{graph:o,canvas:s}=this.context,a=o.getCanvasByClient([n,r]),c=null===(e=this.lens)||void 0===e?void 0:e.getCenter();if(!this.isLensOn||fy(a,c)>this.r)return;const{maxR:l,minR:u}=this.options,h=i+A>0?1/.95:.95,d=Math.min(...s.getSize())/2;this.r=Math.max(u||0,Math.min(l||d,this.r*h)),this.renderLens(c),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=t=>{var e;const n=Sy(t.canvas),r=null===(e=this.lens)||void 0===e?void 0:e.getCenter();!this.isLensOn||fy(n,r)>this.r||(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;const e=Sy(t.canvas);this.renderLens(e),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(t,e){const n="node"===t?this.options.nodeStyle:this.options.edgeStyle;return"function"==typeof n?n(e):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:n}=this.context,{trigger:r,scaleRBy:i}=this.options,A=n.getCanvas().getLayer();["click","drag"].includes(r)&&A.addEventListener(t.CommonEvent.CLICK,this.onEdgeFilter),"pointermove"===r?A.addEventListener(t.CommonEvent.POINTER_MOVE,this.onEdgeFilter):"drag"===r&&(A.addEventListener(t.CommonEvent.DRAG_START,this.onDragStart),A.addEventListener(t.CommonEvent.DRAG,this.onDrag),A.addEventListener(t.CommonEvent.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(e=this.graphDom)||void 0===e||e.addEventListener(t.CommonEvent.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var e;const{graph:n}=this.context,{trigger:r,scaleRBy:i}=this.options,A=n.getCanvas().getLayer();["click","drag"].includes(r)&&A.removeEventListener(t.CommonEvent.CLICK,this.onEdgeFilter),"pointermove"===r?A.removeEventListener(t.CommonEvent.POINTER_MOVE,this.onEdgeFilter):"drag"===r&&(A.removeEventListener(t.CommonEvent.DRAG_START,this.onDragStart),A.removeEventListener(t.CommonEvent.DRAG,this.onDrag),A.removeEventListener(t.CommonEvent.DRAG_END,this.onDragEnd)),"wheel"===i&&(null===(e=this.graphDom)||void 0===e||e.removeEventListener(t.CommonEvent.WHEEL,this.scaleRByWheel))}update(t){var e;this.unbindEvents(),super.update(t),this.r=null!==(e=t.r)&&void 0!==e?e:this.r,this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((t,e)=>{t.destroy(),this.shapes.delete(e)}),super.destroy()}}qV.defaultOptions={trigger:"pointermove",r:60,nodeType:"both",filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:"wheel",preventDefault:!0};const ZV={fill:"#ccc",fillOpacity:.1,lineWidth:2,stroke:"#000",strokeOpacity:.8,labelFontSize:12};class JV extends Zj{constructor(t,e){super(t,Object.assign({},JV.defaultOptions,e)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=t=>{if("drag"===this.options.trigger&&this.isLensOn)return;const e=Sy(t.canvas);this.onMagnify(e)},this.onMagnify=t=>{t.some(isNaN)||(this.renderLens(t),this.renderFocusElements())},this.renderLens=t=>{const e=Object.assign({},ZV,this.options.style);this.isLensOn||(this.lens=new Tw({style:e}),this.canvas.appendChild(this.lens)),Object.assign(e,Uy(t),{size:2*this.r,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(e)},this.getDPercent=()=>{const{minD:t,maxD:e}=this.options;return`${Math.round((this.d-t)/(e-t)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;const{graph:t}=this.context,e=this.lens.getCenter(),n=(this.d+1)*this.r,r=new Map,i=new Map;t.getNodeData().forEach(A=>{const o=My(A),s=fy(o,e);if(s>this.r)return;const a=n*s/(this.d*s+this.r),[c,l]=o,[u,h]=e,d=[u+a*((c-u)/s),h+a*((l-h)/s)],f=Vm(A),g=this.getNodeStyle(A),p=Ue(t.getElementRenderStyle(f),Object.keys(g));r.set(f,Object.assign(Object.assign({},Uy(d)),g)),i.set(f,Object.assign(Object.assign({},Uy(o)),p))}),this.updateStyle(r,i)},this.getNodeStyle=t=>{const{nodeStyle:e}=this.options;return"function"==typeof e?e(t):e},this.updateStyle=(t,e)=>{const{graph:n,element:r}=this.context,{enter:i,exit:A,keep:o}=ny(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(t.keys()),t=>t),s=new Set,a=(t,e)=>{const i=r.getElement(t);null==i||i.update(e),n.getRelatedEdgesData(t).forEach(t=>{s.add(Vm(t))})};[...i,...o].forEach(e=>{a(e,t.get(e))}),A.forEach(t=>{a(t,this.prevOriginStyleMap.get(t)),this.prevOriginStyleMap.delete(t)}),s.forEach(t=>{const e=r.getElement(t);null==e||e.update({})}),this.prevMagnifiedStyleMap=t,e.forEach((t,e)=>{this.prevOriginStyleMap.has(e)||this.prevOriginStyleMap.set(e,t)})},this.isWheelValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;const{clientX:e,clientY:n}=t;return!(fy(this.context.graph.getCanvasByClient([e,n]),this.lens.getCenter())>this.r)},this.scaleR=t=>{const{maxR:e,minR:n}=this.options,r=t?1/.95:.95,i=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(n||0,Math.min(e||i,this.r*r))},this.scaleD=t=>{const{maxD:e,minD:n}=this.options,r=t?this.d+.1:this.d-.1;this.d=Math.max(n,Math.min(e,r))},this.scaleRByWheel=t=>{if(!this.isWheelValid(t))return;const{deltaX:e,deltaY:n}=t;this.scaleR(e+n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.scaleDByWheel=t=>{if(!this.isWheelValid(t))return;const{deltaX:e,deltaY:n}=t;this.scaleD(e+n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.isDragValid=t=>{if(this.options.preventDefault&&t.preventDefault(),!this.isLensOn)return!1;return!(fy(Sy(t.canvas),this.lens.getCenter())>this.r)},this.isLensDragging=!1,this.onDragStart=t=>{this.isDragValid(t)&&(this.isLensDragging=!0)},this.onDrag=t=>{if(!this.isLensDragging)return;const e=Sy(t.canvas);this.onMagnify(e)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=t=>{if(!this.isLensDragging)return;const{dx:e,dy:n}=t;this.scaleR(e-n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.scaleDByDrag=t=>{if(!this.isLensDragging)return;const{dx:e,dy:n}=t;this.scaleD(e-n>0);const r=this.lens.getCenter();this.onMagnify(r)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer("transient")}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;const{graph:n}=this.context,{trigger:r,scaleRBy:i,scaleDBy:A}=this.options,o=n.getCanvas().getLayer();if(["click","drag"].includes(r)&&o.addEventListener(t.CommonEvent.CLICK,this.onCreateFisheye),"pointermove"===r&&o.addEventListener(t.CommonEvent.POINTER_MOVE,this.onCreateFisheye),"drag"===r||"drag"===i||"drag"===A){o.addEventListener(t.CommonEvent.DRAG_START,this.onDragStart),o.addEventListener(t.CommonEvent.DRAG_END,this.onDragEnd);const e="drag"===r?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;o.addEventListener(t.CommonEvent.DRAG,e)}if("wheel"===i||"wheel"===A){const n="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(e=this.graphDom)||void 0===e||e.addEventListener(t.CommonEvent.WHEEL,n,{passive:!1})}}unbindEvents(){var e;const{graph:n}=this.context,{trigger:r,scaleRBy:i,scaleDBy:A}=this.options,o=n.getCanvas().getLayer();if(["click","drag"].includes(r)&&o.removeEventListener(t.CommonEvent.CLICK,this.onCreateFisheye),"pointermove"===r&&o.removeEventListener(t.CommonEvent.POINTER_MOVE,this.onCreateFisheye),"drag"===r||"drag"===i||"drag"===A){o.removeEventListener(t.CommonEvent.DRAG_START,this.onDragStart),o.removeEventListener(t.CommonEvent.DRAG_END,this.onDragEnd);const e="drag"===r?this.onDrag:"drag"===i?this.scaleRByDrag:this.scaleDByDrag;o.removeEventListener(t.CommonEvent.DRAG,e)}if("wheel"===i||"wheel"===A){const n="wheel"===i?this.scaleRByWheel:this.scaleDByWheel;null===(e=this.graphDom)||void 0===e||e.removeEventListener(t.CommonEvent.WHEEL,n)}}update(t){var e,n;this.unbindEvents(),super.update(t),this.r=null!==(e=t.r)&&void 0!==e?e:this.r,this.d=null!==(n=t.d)&&void 0!==n?n:this.d,this.bindEvents()}destroy(){var t;this.unbindEvents(),this.isLensOn&&(null===(t=this.lens)||void 0===t||t.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}}JV.defaultOptions={trigger:"pointermove",r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};class $V extends Zj{constructor(t,e){super(t,Object.assign({},$V.defaultOptions,e)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var t,e,n,r;const i=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(i),i?null===(e=(t=this.options).onEnter)||void 0===e||e.call(t):null===(r=(n=this.options).onExit)||void 0===r||r.call(n)},this.shortcut=new zy(t.graph),this.bindEvents(),this.style=document.createElement("style"),document.head.appendChild(this.style),this.style.innerHTML="\n      :not(:root):fullscreen::backdrop {\n        background: transparent;\n      }\n    "}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();const{request:t=[],exit:e=[]}=this.options.trigger;this.shortcut.bind(t,this.request),this.shortcut.bind(e,this.exit);["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.addEventListener(t,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll();["webkitfullscreenchange","mozfullscreenchange","fullscreenchange","MSFullscreenChange"].forEach(t=>{document.removeEventListener(t,this.onFullscreenChange,!1)})}setGraphSize(t=!0){var e,n;let r,i;t?(r=(null===(e=globalThis.screen)||void 0===e?void 0:e.width)||0,i=(null===(n=globalThis.screen)||void 0===n?void 0:n.height)||0,this.graphSize=this.context.graph.getSize()):[r,i]=this.graphSize,this.context.graph.setSize(r,i),this.context.graph.render()}request(){!document.fullscreenElement&&(document.fullscreenEnabled||Reflect.get(document,"webkitFullscreenEnabled")||Reflect.get(document,"mozFullscreenEnabled")||Reflect.get(document,"msFullscreenEnabled"))&&this.$el.requestFullscreen().catch(t=>{em(`Error attempting to enable full-screen: ${t.message} (${t.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(t){this.unbindEvents(),super.update(t),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}}$V.defaultOptions={trigger:{},autoFit:!0};class tz extends Zj{constructor(t,e){super(t,Object.assign({},tz.defaultOptions,e)),this.$element=Jj("grid-line",!0),this.offset=[0,0],this.currentScale=1,this.followZoom=t=>{const{data:{scale:e,origin:n}}=t;if(!e||void 0===n&&void 0===this.context.viewport)return;const r=this.currentScale;this.currentScale=e;const i=e/r,A=uy(n||this.context.graph.getCanvasCenter(),1-i),o=this.baseSize*e,s=cy(yy(uy(this.offset,i),o),A);this.$element.style.backgroundSize=`${o}px ${o}px`,this.$element.style.backgroundPosition=`${s[0]}px ${s[1]}px`,this.offset=yy(s,o)},this.followTranslate=t=>{if(!this.options.follow)return;const{data:{translate:e}}=t;e&&this.updateOffset(e)},this.onTransform=t=>{const e=this.parseFollow(this.options.follow);e.zoom&&this.followZoom(t),e.translate&&this.followTranslate(t)};this.context.canvas.getContainer().prepend(this.$element),this.baseSize=this.options.size,this.updateStyle(),this.bindEvents()}update(t){super.update(t),void 0!==t.size&&(this.baseSize=t.size),this.updateStyle()}bindEvents(){const{graph:e}=this.context;e.on(t.GraphEvent.AFTER_TRANSFORM,this.onTransform)}updateStyle(){const{stroke:t,lineWidth:e,border:n,borderLineWidth:r,borderStroke:i,borderStyle:A}=this.options,o=this.baseSize*this.currentScale;Object.assign(this.$element.style,{border:n?`${r}px ${A} ${i}`:"none",backgroundImage:`linear-gradient(${t} ${e}px, transparent ${e}px), linear-gradient(90deg, ${t} ${e}px, transparent ${e}px)`,backgroundSize:`${o}px ${o}px`,backgroundRepeat:"repeat"})}updateOffset(t){const e=this.baseSize*this.currentScale;this.offset=yy(cy(this.offset,t),e),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}parseFollow(t){var e,n;return fe(t)?{translate:t,zoom:t}:{translate:null!==(e=null==t?void 0:t.translate)&&void 0!==e&&e,zoom:null!==(n=null==t?void 0:t.zoom)&&void 0!==n&&n}}destroy(){this.context.graph.off(t.GraphEvent.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}}function ez(t){const e={Added:new Map,Updated:new Map,Removed:new Map};return t.forEach(t=>{const{type:n,value:r}=t,i=Vm(r);if("NodeAdded"===n||"EdgeAdded"===n||"ComboAdded"===n)e.Added.set(i,t);else if("NodeUpdated"===n||"EdgeUpdated"===n||"ComboUpdated"===n)if(e.Added.has(i))e.Added.set(i,{type:n.replace("Updated","Added"),value:r});else if(e.Updated.has(i)){const{original:t}=e.Updated.get(i);e.Updated.set(i,{type:n,value:r,original:t})}else e.Removed.has(i)||e.Updated.set(i,t);else"NodeRemoved"!==n&&"EdgeRemoved"!==n&&"ComboRemoved"!==n||(e.Added.has(i)?e.Added.delete(i):e.Updated.has(i)?(e.Updated.delete(i),e.Removed.set(i,t)):e.Removed.set(i,t))}),[...Array.from(e.Added.values()),...Array.from(e.Updated.values()),...Array.from(e.Removed.values())]}function nz(t){const{NodeAdded:e=[],NodeUpdated:n=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:A=[],EdgeRemoved:o=[],ComboAdded:s=[],ComboUpdated:a=[],ComboRemoved:c=[]}=ie(t,t=>t.type);return{add:{nodes:e,edges:i,combos:s},update:{nodes:n,edges:A,combos:a},remove:{nodes:r,edges:o,combos:c}}}function rz(t,e){for(const n in t)Yt(t[n])&&!Array.isArray(t[n])&&null!==t[n]?(e[n]||(e[n]={}),rz(t[n],e[n])):void 0===e[n]&&(e[n]=Am(n))}function iz(t,e=!1,n){const r={animation:e,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:A,remove:o}=nz(ez(t));return["nodes","edges","combos"].forEach(t=>{A[t]&&A[t].forEach(e=>{var i,A;const o=Object.assign({},e.value);let s=Object.assign({},e.original);if(n){const t=n.graph.getElementType(Vm(e.original)),r="edge"===t?"stroke":"fill",i=n.element.getElementComputedStyle(t,e.original);s=Object.assign(Object.assign({},e.original),{style:Object.assign({[r]:i[r]},e.original.style)})}rz(o,s),(i=r.current.update)[t]||(i[t]=[]),r.current.update[t].push(o),(A=r.original.update)[t]||(A[t]=[]),r.original.update[t].push(s)}),i[t]&&i[t].forEach(e=>{var n,i;const A=Object.assign({},e.value);(n=r.current.add)[t]||(n[t]=[]),r.current.add[t].push(A),(i=r.original.remove)[t]||(i[t]=[]),r.original.remove[t].push(A)}),o[t]&&o[t].forEach(e=>{var n,i;const A=Object.assign({},e.value);(n=r.current.remove)[t]||(n[t]=[]),r.current.remove[t].push(A),(i=r.original.add)[t]||(i[t]=[]),r.original.add[t].push(A)})}),r}tz.defaultOptions={border:!0,borderLineWidth:1,borderStroke:"#eee",borderStyle:"solid",lineWidth:1,size:20,stroke:"#eee"};class Az extends Zj{constructor(e,n){super(e,Object.assign({},Az.defaultOptions,n)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(t,e=!0)=>{var n,r,i;this.freezed=!0,null===(r=(n=this.options).executeCommand)||void 0===r||r.call(n,t);const A=e?t.original:t.current;this.context.graph.addData(A.add),this.context.graph.updateData(A.update),this.context.graph.removeData(Wm(A.remove,!1)),null===(i=this.context.element)||void 0===i||i.draw({silence:!0,animation:t.animation}),this.freezed=!1},this.addCommand=e=>{var n;if(!this.freezed){if(e.type===t.GraphEvent.AFTER_DRAW){const{dataChanges:t=[],animation:r=!0}=e.data;if(null===(n=this.context.batch)||void 0===n?void 0:n.isBatching){if(!this.batchChanges)return;return this.batchChanges.push(t),void(this.batchAnimation&&(this.batchAnimation=r))}this.batchChanges=[t],this.batchAnimation=r}this.undoStackPush(iz(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(t.HistoryEvent.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=t=>{const{initiate:e}=t.data;if(this.batchAnimation=!1,e)this.batchChanges=[];else{this.undoStack.pop()||(this.batchChanges=null)}},this.emitter=new cE;const{graph:r}=this.context;r.on(t.GraphEvent.AFTER_DRAW,this.addCommand),r.on(t.GraphEvent.BATCH_START,this.initBatchCommand),r.on(t.GraphEvent.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var e,n,r,i;const A=this.undoStack.pop();if(A){this.executeCommand(A);if(!1===(null===(n=(e=this.options).beforeAddCommand)||void 0===n?void 0:n.call(e,A,!1)))return;this.redoStack.push(A),null===(i=(r=this.options).afterAddCommand)||void 0===i||i.call(r,A,!1),this.notify(t.HistoryEvent.UNDO,A)}return this}redo(){const e=this.redoStack.pop();return e&&(this.executeCommand(e,!1),this.undoStackPush(e),this.notify(t.HistoryEvent.REDO,e)),this}undoAndCancel(){const e=this.undoStack.pop();return e&&(this.executeCommand(e,!1),this.redoStack=[],this.notify(t.HistoryEvent.CANCEL,e)),this}undoStackPush(t){var e,n,r,i;const{stackSize:A}=this.options;0!==A&&this.undoStack.length>=A&&this.undoStack.shift();!1!==(null===(n=(e=this.options).beforeAddCommand)||void 0===n?void 0:n.call(e,t,!0))&&(this.undoStack.push(t),null===(i=(r=this.options).afterAddCommand)||void 0===i||i.call(r,t,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(t.HistoryEvent.CLEAR,null)}notify(e,n){this.emitter.emit(e,{cmd:n}),this.emitter.emit(t.HistoryEvent.CHANGE,{cmd:n})}on(t,e){this.emitter.on(t,e)}destroy(){const{graph:e}=this.context;e.off(t.GraphEvent.AFTER_DRAW,this.addCommand),e.off(t.GraphEvent.BATCH_START,this.initBatchCommand),e.off(t.GraphEvent.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}}Az.defaultOptions={stackSize:0};const oz={toXy(t,e){if(!e)return[...t];const n=e[0].slice(1),r=e[1].slice(1);return t.map(t=>[t[n],t[r]])},fromXy(t,e){if(!e)return[...t];const n=e[0].slice(1),r=e[1].slice(1);return t.map(([t,e])=>({[n]:t,[r]:e}))}};let sz=class{constructor(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(const e of t){const t=this.coordToCellNum(e[0]),n=this.coordToCellNum(e[1]);this._cells[t]||(this._cells[t]=[]),this._cells[t][n]||(this._cells[t][n]=[]),this._cells[t][n].push(e)}}cellPoints(t,e){var n;return(null===(n=this._cells[t])||void 0===n?void 0:n[e])||[]}rangePoints(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),r=this.coordToCellNum(t[2]),i=this.coordToCellNum(t[3]),A=[];for(let t=e;t<=r;t++)for(let e=n;e<=i;e++){const n=this.cellPoints(t,e);for(const t of n)A.push(t)}return A}removePoint(t){const e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),r=this._cells[e][n],i=r.findIndex(([e,n])=>e===t[0]&&n===t[1]);return i>-1&&r.splice(i,1),r}trunc(t){return Math.trunc(t)}coordToCellNum(t){return this.trunc(t*this._reverseCellSize)}extendBbox(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}};const az=+(Math.pow(2,27)+1);function cz(t,e,n){const r=t*e,i=az*t,A=i-(i-t),o=t-A,s=az*e,a=s-(s-e),c=e-a,l=o*c-(r-A*a-o*a-A*c);return n?(n[0]=l,n[1]=r,n):[l,r]}function lz(t,e,n){const r=t+e,i=r-t,A=e-i,o=t-(r-i);return n?(n[0]=o+A,n[1]=r,n):[o+A,r]}function uz(t,e){const n=t.length;if(1===n){const n=cz(t[0],e);return n[0]?n:[n[1]]}const r=new Array(2*n),i=[.1,.1],A=[.1,.1];let o=0;cz(t[0],e,i),i[0]&&(r[o++]=i[0]);for(let s=1;s<n;++s){cz(t[s],e,A);lz(i[1],A[0],i),i[0]&&(r[o++]=i[0]);const n=A[1],a=i[1],c=n+a,l=a-(c-n);i[1]=c,l&&(r[o++]=l)}return i[1]&&(r[o++]=i[1]),0===o&&(r[o++]=0),r.length=o,r}function hz(t,e){const n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){const n=t+e,r=n-t,i=t-(n-r)+(e-r);return i?[i,n]:[n]}(t[0],-e[0]);const i=new Array(n+r);let A=0,o=0,s=0;const a=Math.abs;let c,l,u=t[o],h=a(u),d=-e[s],f=a(d);h<f?(l=u,o+=1,o<n&&(u=t[o],h=a(u))):(l=d,s+=1,s<r&&(d=-e[s],f=a(d))),o<n&&h<f||s>=r?(c=u,o+=1,o<n&&(u=t[o],h=a(u))):(c=d,s+=1,s<r&&(d=-e[s],f=a(d)));let g,p,v,m,y,w=c+l,B=w-c,b=l-B,E=b,x=w;for(;o<n&&s<r;)h<f?(c=u,o+=1,o<n&&(u=t[o],h=a(u))):(c=d,s+=1,s<r&&(d=-e[s],f=a(d))),l=E,w=c+l,B=w-c,b=l-B,b&&(i[A++]=b),g=x+w,p=g-x,v=g-p,m=w-p,y=x-v,E=y+m,x=g;for(;o<n;)c=u,l=E,w=c+l,B=w-c,b=l-B,b&&(i[A++]=b),g=x+w,p=g-x,v=g-p,m=w-p,y=x-v,E=y+m,x=g,o+=1,o<n&&(u=t[o]);for(;s<r;)c=d,l=E,w=c+l,B=w-c,b=l-B,b&&(i[A++]=b),g=x+w,p=g-x,v=g-p,m=w-p,y=x-v,E=y+m,x=g,s+=1,s<r&&(d=-e[s]);return E&&(i[A++]=E),x&&(i[A++]=x),A||(i[A++]=0),i.length=A,i}function dz(t,e){const n=0|t.length,r=0|e.length;if(1===n&&1===r)return function(t,e){const n=t+e,r=n-t,i=t-(n-r)+(e-r);return i?[i,n]:[n]}(t[0],e[0]);const i=new Array(n+r);let A=0,o=0,s=0;const a=Math.abs;let c,l,u=t[o],h=a(u),d=e[s],f=a(d);h<f?(l=u,o+=1,o<n&&(u=t[o],h=a(u))):(l=d,s+=1,s<r&&(d=e[s],f=a(d))),o<n&&h<f||s>=r?(c=u,o+=1,o<n&&(u=t[o],h=a(u))):(c=d,s+=1,s<r&&(d=e[s],f=a(d)));let g,p,v,m,y,w=c+l,B=w-c,b=l-B,E=b,x=w;for(;o<n&&s<r;)h<f?(c=u,o+=1,o<n&&(u=t[o],h=a(u))):(c=d,s+=1,s<r&&(d=e[s],f=a(d))),l=E,w=c+l,B=w-c,b=l-B,b&&(i[A++]=b),g=x+w,p=g-x,v=g-p,m=w-p,y=x-v,E=y+m,x=g;for(;o<n;)c=u,l=E,w=c+l,B=w-c,b=l-B,b&&(i[A++]=b),g=x+w,p=g-x,v=g-p,m=w-p,y=x-v,E=y+m,x=g,o+=1,o<n&&(u=t[o]);for(;s<r;)c=d,l=E,w=c+l,B=w-c,b=l-B,b&&(i[A++]=b),g=x+w,p=g-x,v=g-p,m=w-p,y=x-v,E=y+m,x=g,s+=1,s<r&&(d=e[s]);return E&&(i[A++]=E),x&&(i[A++]=x),A||(i[A++]=0),i.length=A,i}function fz(t,e,n,r){return function(n,i,A){const o=t(t(e(i[1],A[0]),e(-A[1],i[0])),t(e(n[1],i[0]),e(-i[1],n[0]))),s=t(e(n[1],A[0]),e(-A[1],n[0])),a=r(o,s);return a[a.length-1]}}function gz(t,e,n,r){return function(i,A,o,s){const a=t(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),A[2]),t(n(t(e(A[1],s[0]),e(-s[1],A[0])),-o[2]),n(t(e(A[1],o[0]),e(-o[1],A[0])),s[2]))),t(n(t(e(A[1],s[0]),e(-s[1],A[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),s[2])))),c=t(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),t(n(t(e(A[1],o[0]),e(-o[1],A[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),o[2])))),l=r(a,c);return l[l.length-1]}}function pz(t,e,n,r){return function(i,A,o,s,a){const c=t(t(t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),o[2]),t(n(t(e(o[1],a[0]),e(-a[1],o[0])),-s[2]),n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]))),A[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),A[2]),t(n(t(e(A[1],a[0]),e(-a[1],A[0])),-s[2]),n(t(e(A[1],s[0]),e(-s[1],A[0])),a[2]))),-o[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),A[2]),t(n(t(e(A[1],a[0]),e(-a[1],A[0])),-o[2]),n(t(e(A[1],o[0]),e(-o[1],A[0])),a[2]))),s[3]))),t(n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),A[2]),t(n(t(e(A[1],s[0]),e(-s[1],A[0])),-o[2]),n(t(e(A[1],o[0]),e(-o[1],A[0])),s[2]))),-a[3]),t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),A[2]),t(n(t(e(A[1],a[0]),e(-a[1],A[0])),-s[2]),n(t(e(A[1],s[0]),e(-s[1],A[0])),a[2]))),i[3]),n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),a[2]))),-A[3])))),t(t(n(t(n(t(e(A[1],a[0]),e(-a[1],A[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),a[2]))),s[3]),t(n(t(n(t(e(A[1],s[0]),e(-s[1],A[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),s[2]))),-a[3]),n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),A[2]),t(n(t(e(A[1],s[0]),e(-s[1],A[0])),-o[2]),n(t(e(A[1],o[0]),e(-o[1],A[0])),s[2]))),i[3]))),t(n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),-A[3]),t(n(t(n(t(e(A[1],s[0]),e(-s[1],A[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),s[2]))),o[3]),n(t(n(t(e(A[1],o[0]),e(-o[1],A[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),o[2]))),-s[3]))))),l=t(t(t(n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),o[2]),t(n(t(e(o[1],a[0]),e(-a[1],o[0])),-s[2]),n(t(e(o[1],s[0]),e(-s[1],o[0])),a[2]))),i[3]),n(t(n(t(e(s[1],a[0]),e(-a[1],s[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-s[2]),n(t(e(i[1],s[0]),e(-s[1],i[0])),a[2]))),-o[3])),t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),a[2]))),s[3]),n(t(n(t(e(o[1],s[0]),e(-s[1],o[0])),i[2]),t(n(t(e(i[1],s[0]),e(-s[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),s[2]))),-a[3]))),t(t(n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),A[2]),t(n(t(e(A[1],a[0]),e(-a[1],A[0])),-o[2]),n(t(e(A[1],o[0]),e(-o[1],A[0])),a[2]))),i[3]),n(t(n(t(e(o[1],a[0]),e(-a[1],o[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-o[2]),n(t(e(i[1],o[0]),e(-o[1],i[0])),a[2]))),-A[3])),t(n(t(n(t(e(A[1],a[0]),e(-a[1],A[0])),i[2]),t(n(t(e(i[1],a[0]),e(-a[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),a[2]))),o[3]),n(t(n(t(e(A[1],o[0]),e(-o[1],A[0])),i[2]),t(n(t(e(i[1],o[0]),e(-o[1],i[0])),-A[2]),n(t(e(i[1],A[0]),e(-A[1],i[0])),o[2]))),-a[3])))),u=r(c,l);return u[u.length-1]}}function vz(t){return(3===t?fz:4===t?gz:pz)(dz,cz,uz,hz)}const mz=vz(3),yz=vz(4),wz=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){const r=(t[1]-n[1])*(e[0]-n[0]),i=(t[0]-n[0])*(e[1]-n[1]),A=r-i;let o;if(r>0){if(i<=0)return A;o=r+i}else{if(!(r<0))return A;if(i>=0)return A;o=-(r+i)}const s=33306690738754716e-32*o;return A>=s||A<=-s?A:mz(t,e,n)},function(t,e,n,r){const i=t[0]-r[0],A=e[0]-r[0],o=n[0]-r[0],s=t[1]-r[1],a=e[1]-r[1],c=n[1]-r[1],l=t[2]-r[2],u=e[2]-r[2],h=n[2]-r[2],d=A*c,f=o*a,g=o*s,p=i*c,v=i*a,m=A*s,y=l*(d-f)+u*(g-p)+h*(v-m),w=7771561172376103e-31*((Math.abs(d)+Math.abs(f))*Math.abs(l)+(Math.abs(g)+Math.abs(p))*Math.abs(u)+(Math.abs(v)+Math.abs(m))*Math.abs(h));return y>w||-y>w?y:yz(t,e,n,r)}];function Bz(t){let e=wz[t.length];return e||(e=wz[t.length]=vz(t.length)),e.apply(void 0,...t)}var bz=function(){for(;wz.length<=5;)wz.push(vz(wz.length));const t=function(t,e,n,r,i,A,o){return function(...e){switch(e.length){case 0:case 1:return 0;case 2:return r(e[0],e[1]);case 3:return i(e[0],e[1],e[2]);case 4:return A(e[0],e[1],e[2],e[3]);case 5:return o(e[0],e[1],e[2],e[3],e[4])}return t(e)}}(void 0,Bz,...wz);for(let e=0;e<=5;++e)t[e]=wz[e];return t}();const Ez=bz[3];function xz(t,e,n,r){const i=bz(t,n,r),A=bz(e,n,r);if(i>0&&A>0||i<0&&A<0)return!1;const o=bz(n,t,e),s=bz(r,t,e);return!(o>0&&s>0||o<0&&s<0)&&(0!==i||0!==A||0!==o||0!==s||function(t,e,n,r){for(let i=0;i<2;++i){const A=t[i],o=e[i],[s,a]=[Math.min(A,o),Math.max(A,o)],c=n[i],l=r[i],[u,h]=[Math.min(c,l),Math.max(c,l)];if(h<s||a<u)return!1}return!0}(t,e,n,r))}function Cz(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function Fz(t,e,n){const r=[e[0]-t[0],e[1]-t[1]],i=[n[0]-t[0],n[1]-t[1]],A=Cz(t,e),o=Cz(t,n);return(r[0]*i[0]+r[1]*i[1])/Math.sqrt(A*o)}function Mz(t,e){for(let n=0;n<e.length-1;n++){const r=[e[n],e[n+1]];if(!(t[0][0]===r[0][0]&&t[0][1]===r[0][1]||t[0][0]===r[1][0]&&t[0][1]===r[1][1])&&xz(t[0],t[1],r[0],r[1]))return!0}return!1}function kz(t){return[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1]),Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]}function Qz(t,e,n){let r,i,A=null,o=Tz,s=Tz;for(let a=0;a<e.length;a++)r=Fz(t[0],t[1],e[a]),i=Fz(t[1],t[0],e[a]),r>o&&i>s&&!Mz([t[0],e[a]],n)&&!Mz([t[1],e[a]],n)&&(o=r,s=i,A=e[a]);return A}function Sz(t,e,n,r,i){let A=!1;for(let o=0;o<t.length-1;o++){const s=[t[o],t[o+1]],a=s[0][0]+","+s[0][1]+","+s[1][0]+","+s[1][1];if(Cz(s[0],s[1])<e||i.has(a))continue;let c,l,u,h=0,d=kz(s);do{d=r.extendBbox(d,h),c=d[2]-d[0],l=d[3]-d[1],u=Qz(s,r.rangePoints(d),t),h++}while(null===u&&(n[0]>c||n[1]>l));c>=n[0]&&l>=n[1]&&i.add(a),null!==u&&(t.splice(o+1,0,u),r.removePoint(u),A=!0)}return A?Sz(t,e,n,r,i):t}function Uz(t,e,n){const r=e||20,i=function(t){const e=[t[0]];let n=t[0];for(let r=1;r<t.length;r++){const i=t[r];n[0]===i[0]&&n[1]===i[1]||e.push(i),n=i}return e}(function(t){return t.sort(function(t,e){return t[0]-e[0]||t[1]-e[1]})}(oz.toXy(t,n)));if(i.length<4){const t=i.concat([i[0]]);return n?oz.fromXy(t,n):t}const A=function(t){let e=1/0,n=1/0,r=-1/0,i=-1/0;for(let A=t.length-1;A>=0;A--)t[A][0]<e&&(e=t[A][0]),t[A][1]<n&&(n=t[A][1]),t[A][0]>r&&(r=t[A][0]),t[A][1]>i&&(i=t[A][1]);return[r-e,i-n]}(i),o=[A[0]*Oz,A[1]*Oz],s=function(t){const e=t.length;if(e<3){const n=new Array(e);for(let t=0;t<e;++t)n[t]=t;return 2===e&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:n}const n=new Array(e);for(let t=0;t<e;++t)n[t]=t;n.sort((e,n)=>t[e][0]-t[n][0]||t[e][1]-t[n][1]);const r=[n[0],n[1]],i=[n[0],n[1]];for(let A=2;A<e;++A){const e=n[A],o=t[e];let s=r.length;for(;s>1&&Ez(t[r[s-2]],t[r[s-1]],o)<=0;)s-=1,r.pop();for(r.push(e),s=i.length;s>1&&Ez(t[i[s-2]],t[i[s-1]],o)>=0;)s-=1,i.pop();i.push(e)}const A=new Array(i.length+r.length-2);let o=0;for(let t=0,e=r.length;t<e;++t)A[o++]=r[t];for(let t=i.length-2;t>0;--t)A[o++]=i[t];return A}(i).reverse().map(t=>i[t]);s.push(s[0]);const a=i.filter(function(t){return s.indexOf(t)<0}),c=Math.ceil(1/(i.length/(A[0]*A[1]))),l=Sz(s,Math.pow(r,2),o,function(t,e){return new sz(t,e)}(a,c),new Set);return n?oz.fromXy(l,n):l}const Tz=Math.cos(90/(180/Math.PI)),Oz=.6;const Nz=(t,e,n)=>{if("sharp"===n)return[["M",t[0]-e,t[1]-e],["L",t[0]+e,t[1]-e],["L",t[0]+e,t[1]+e],["L",t[0]-e,t[1]+e],["Z"]];const r=[e,e,0,0,0];return[["M",t[0],t[1]-e],["A",...r,t[0],t[1]+e],["A",...r,t[0],t[1]-e]]},Iz=(t,e,n)=>{const r=[e,e,0,0,0],i="sharp"===n?cy(t[0],dy(py(ly(t[0],t[1])),e)):t[0],A="sharp"===n?cy(t[1],dy(py(ly(t[1],t[0])),e)):t[1],o=dy(py(my(ly(i,A),!1)),e),s=dy(o,-1),a=cy(i,o),c=cy(A,o),l=cy(A,s),u=cy(i,s);return"sharp"===n?[["M",a[0],a[1]],["L",c[0],c[1]],["L",l[0],l[1]],["L",u[0],u[1]],["Z"]]:[["M",a[0],a[1]],["L",c[0],c[1]],["A",...r,l[0],l[1]],["L",u[0],u[1]],["A",...r,a[0],a[1]]]},Lz=(t,e)=>{const n=Gy(t).map((n,r)=>{const i=(r-2+t.length)%t.length,A=(r-1+t.length)%t.length,o=(r+1)%t.length,s=t[i],a=t[A],c=t[o],l=ly(s,a),u=ly(a,n),h=ly(n,c),d=(t,e)=>vy(t,e,!0)<Math.PI,f=d(l,u),g=d(u,h),p=t=>dy(py(my(t,!1)),e),v=p(u);return[{p:wy(cy(a,f?p(l):v)),concave:f&&a},{p:wy(cy(n,g?p(h):v)),concave:g&&n}]}),r=[e,e,0,0,0],i=n.findIndex((t,e)=>!(n[(e-1+n.length)%n.length][0].concave||n[(e-1+n.length)%n.length][1].concave||t[0].concave||t[0].concave||t[1].concave)),A=n.slice(i).concat(n.slice(0,i));let o=[];return A.flatMap((t,e)=>{const i=[],s=A[n.length-1];return 0===e&&i.push(["M",...s[1].p]),t[0].concave?o.push(t[0].p,t[1].p):i.push(["A",...r,...t[0].p]),t[1].concave?o.unshift(t[1].p):i.push(["L",...t[1].p]),3===o.length&&(i.pop(),i.push(["C",...o.flat()]),o=[]),i})},Dz=(t,e)=>{const n=Gy(t).map((e,n)=>({p:e,v:py(ly(t[(n+1)%t.length],e))}));return n.forEach((r,i)=>{const A=i>0?i-1:t.length-1,o=n[A].v,s=py(cy(o,dy(r.v,vy(o,r.v,!0)<Math.PI?1:-1)));r.p=cy(r.p,dy(s,e))}),bw(n.map(t=>t.p))},Pz=(t,e)=>{const n=t.map((n,r)=>{const i=t[0===r?t.length-1:r-1],A=By(dy(py(my(ly(i,n),!1)),e));return[cy(i,A),cy(n,A)]}),r=n.flat(),i=r.map((t,e)=>{if(e%2==0)return null;return Cy([r[(e-1)%r.length],r[e%r.length]],[r[(e+1)%r.length],r[(e+2)%r.length]],!0)}).filter(Boolean);return i.map((t,e)=>[0===e?"M":"L",t[0],t[1]]).concat([["Z"]])};class Rz extends Zj{constructor(t,e){super(t,Object.assign({},Rz.defaultOptions,e)),this.hullMemberIds=[],this.drawHull=()=>{if(this.shape){const t=!Me(this.optionsCache,this.options);this.shape.update(this.getHullStyle(t))}else this.shape=new Ew({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);this.optionsCache=Object.assign({},this.options)},this.updateHullPath=t=>{this.shape&&this.options.members.includes(Vm(t.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(t=!1)=>{const{graph:e}=this.context,n=this.getMember();if(0===n.length)return"";const r=n.map(t=>e.getNodeData(t)),i=Uz(r.map(My),this.options.concavity).slice(1).reverse(),A=i.flatMap(t=>r.filter(e=>Me(My(e),t)).map(Vm));return Me(A,this.hullMemberIds)&&!t||(this.hullMemberIds=A,this.path=function(t,e,n){if(1===t.length)return Nz(t[0],e,n);if(2===t.length)return Iz(t,e,n);if(3===t.length){const[r,i,A]=Gy(t);if(Ly(r,i,A))return Iz([r,A],e,n)}switch(n){case"smooth":return Dz(t,e);case"sharp":return Pz(t,e);default:return Lz(t,e)}}(i,this.getPadding(),this.options.corner)),this.path},this.bindEvents()}bindEvents(){this.context.graph.on(t.GraphEvent.AFTER_RENDER,this.drawHull),this.context.graph.on(t.GraphEvent.AFTER_ELEMENT_UPDATE,this.updateHullPath)}unbindEvents(){this.context.graph.off(t.GraphEvent.AFTER_RENDER,this.drawHull),this.context.graph.off(t.GraphEvent.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(t){const e=this.options,{members:n,padding:r,corner:i}=e,A=He(e,["members","padding","corner"]);return Object.assign(Object.assign({},A),{d:this.getHullPath(t)})}getPadding(){const{graph:t}=this.context,e=this.hullMemberIds.reduce((e,n)=>{const{halfExtents:r}=t.getElementRenderBounds(n),i=Math.max(r[0],r[1]);return Math.max(e,i)},0);return e+this.options.padding}addMember(t){const e=Array.isArray(t)?t:[t];this.options.members=[...new Set([...this.options.members,...e])],this.shape.update({d:this.getHullPath()})}removeMember(t){const e=Array.isArray(t)?t:[t];this.options.members=this.options.members.filter(t=>!e.includes(t)),e.some(t=>this.hullMemberIds.includes(t))&&this.shape.update({d:this.getHullPath()})}updateMember(t){this.options.members=Vt(t)?t(this.options.members):t,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.unbindEvents(),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}}function Hz(t,e){e(t),t.children&&t.children.forEach(function(t){t&&Hz(t,e)})}function _z(t){Kz(t,!0)}function Gz(t){Kz(t,!1)}function Kz(t,e){var n=e?"visible":"hidden";Hz(t,function(t){t.attr("visibility",n)})}Rz.defaultOptions={members:[],padding:10,corner:"rounded",concavity:1/0,fill:"lightblue",fillOpacity:.2,labelOpacity:1,stroke:"blue",strokeOpacity:.2};var jz=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=t.apply(this,je([],Ke(e),!1))||this;return r.isMutationObserved=!0,r.addEventListener(ia.INSERTED,function(){Gz(r)}),r}return Pe(e,t),e}(Ja);function Vz(t){var e=t.appendChild(new jz({class:"offscreen"}));return Gz(e),e}var zz=function(t){function e(e){void 0===e&&(e={});var n=e.style,r=He(e,["style"]);return t.call(this,Re({style:Re({text:"",fill:"black",fontFamily:"sans-serif",fontSize:16,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",lineWidth:1,textAlign:"start",textBaseline:"middle"},n)},r))||this}return Pe(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Vz(this)),this._offscreen},enumerable:!1,configurable:!0}),e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e}(hc);function Wz(t){return t*Math.PI/180}function Yz(t){return Number((180*t/Math.PI).toPrecision(5))}var Xz=function(){function t(t,e,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===r&&(r=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=t,this.y=e,this.width=n,this.height=r}return Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),t.fromRect=function(e){return new t(e.x,e.y,e.width,e.height)},t.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},t.prototype.isPointIn=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},t}();function qz(t,e){return Vt(t)?t.apply(void 0,je([],Ke(e),!1)):t}var Zz,Jz=function(t,e){var n=function(t){return"".concat(e,"-").concat(t)},r=Object.fromEntries(Object.entries(t).map(function(t){var e=Ke(t,2),r=e[0],i=e[1],A=n(i);return[r,{name:A,class:".".concat(A),id:"#".concat(A),toString:function(){return A}}]}));return Object.assign(r,{prefix:n}),r},$z=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=5),Object.entries(e).forEach(function(i){var A=Ke(i,2),o=A[0],s=A[1],a=t;Object.prototype.hasOwnProperty.call(e,o)&&(s?$t(s)?($t(t[o])||(a[o]={}),n<r?$z(t[o],s,n+1,r):a[o]=e[o]):Wt(s)?(a[o]=[],a[o]=a[o].concat(s)):a[o]=s:a[o]=s)})},tW=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r+=1)$z(t,e[r]);return t},eW=function(t){return void 0!==t&&null!=t&&!Number.isNaN(t)},nW=Be(function(t,e){var n=e.fontSize,r=e.fontFamily,i=e.fontWeight,A=e.fontStyle,o=e.fontVariant;return Zz||(Zz=Na.offscreenCanvasCreator.getOrCreateContext(void 0)),Zz.font=[A,o,i,"".concat(n,"px"),r].join(" "),Zz.measureText(t).width},function(t,e){return[t,Object.values(e||rW(t)).join()].join("")},4096),rW=function(t){var e=t.style.fontFamily||"sans-serif",n=t.style.fontWeight||"normal",r=t.style.fontStyle||"normal",i=t.style.fontVariant,A=t.style.fontSize;return{fontSize:A="object"==typeof A?A.value:A,fontFamily:e,fontWeight:n,fontStyle:r,fontVariant:i}};function iW(t){return"text"===t.nodeName?t:"g"===t.nodeName&&1===t.children.length&&"text"===t.children[0].nodeName?t.children[0]:null}function AW(t,e){var n=iW(t);n&&n.attr(e)}function oW(t,e,n){void 0===n&&(n="..."),AW(t,{wordWrap:!0,wordWrapWidth:e,maxLines:1,textOverflow:n})}function sW(t){var e=t.nativeEvent,n=t.touches,r=t.clientX,i=t.clientY;if(e)return[e.clientX,e.clientY];if(n){var A=n[0];return[A.clientX,A.clientY]}return"number"==typeof r&&"number"==typeof i?[r,i]:[0,0]}function aW(t){return"function"==typeof t?t():ne(t)||oe(t)?new zz({style:{text:String(t)}}):t}function cW(t,e,n,r,i){return void 0===r&&(r=!0),void 0===i&&(i=function(t){t.node().removeChildren()}),t?n(e):(r&&i(e),null)}function lW(t,e,n,r,i){return void 0===r&&(r=!0),void 0===i&&(i=!1),!!(r&&t===e||i&&t===n)||t>e&&t<n}function uW(t,e){return"number"==typeof t&&"number"==typeof e?function(t,e){return function(n){return t*(1-n)+e*n}}(t,e):Array.isArray(t)&&Array.isArray(e)?function(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0;return function(i){var A=new Array(r),o=new Array(n),s=0;for(s=0;s<r;++s)A[s]=uW(t[s],e[s]);for(;s<n;++s)o[s]=e[s];for(s=0;s<r;++s)o[s]=A[s](i);return o}}(t,e):"object"==typeof t&&"object"==typeof e?function(t,e){void 0===t&&(t={}),void 0===e&&(e={});var n={},r={};return Object.entries(e).forEach(function(e){var i=Ke(e,2),A=i[0],o=i[1];A in t?n[A]=uW(t[A],o):r[A]=o}),function(t){return Object.entries(n).forEach(function(e){var n=Ke(e,2),i=n[0],A=n[1];return r[i]=A(t)}),r}}(t,e):function(e){return t}}function hW(t,e){return[t[0]*e,t[1]*e]}function dW(t,e){return[t[0]+e[0],t[1]+e[1]]}function fW(t,e){return[t[0]-e[0],t[1]-e[1]]}function gW(t,e){return[Math.min(t[0],e[0]),Math.min(t[1],e[1])]}function pW(t,e){return[Math.max(t[0],e[0]),Math.max(t[1],e[1])]}function vW(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function mW(t){if(0===t[0]&&0===t[1])return[0,0];var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2));return[t[0]/e,t[1]/e]}function yW(t,e){return+t.toPrecision(e)}function wW(t,e){var n={},r=Array.isArray(e)?e:[e];for(var i in t)r.includes(i)||(n[i]=t[i]);return n}function BW(t,e,n){void 0===n&&(n=[[0,0],[1,1]]);for(var r=[],i=0,A=t.length;i<A;i+=2)r.push([t[i],t[i+1]]);var o,s,a,c=function(t,e,n,r){var i,A,o,s,a,c,l=[],u=!!r,h=[1/0,1/0],d=[-1/0,-1/0];if(u){h=(i=Ke(r,2))[0],d=i[1];for(var f=0,g=t.length;f<g;f+=1)h=gW(h,v=t[f]),d=pW(d,v)}f=0;for(var p=t.length;f<p;f+=1){var v=t[f];if(0===f)c=v;else if(f===p-1)a=v,l.push(c),l.push(a);else{A=t[f-1];var m=[0,0];m=hW(m=fW(o=t[f+1],A),e);var y=vW(v,A),w=vW(v,o),B=y+w;0!==B&&(y/=B,w/=B);var b=hW(m,-y),E=hW(m,w);a=dW(v,b),s=gW(s=dW(v,E),pW(o,v)),s=pW(s,gW(o,v)),a=gW(a=dW(v,b=hW(b=fW(s,v),-y/w)),pW(A,v)),s=dW(v,E=hW(E=fW(v,a=pW(a,gW(A,v))),w/y)),u&&(a=gW(a=pW(a,h),d),s=gW(s=pW(s,h),d)),l.push(c),l.push(a),c=s}}return l}(r,.4,0,n),l=r.length,u=[];for(i=0;i<l-1;i+=1)o=c[2*i],s=c[2*i+1],a=r[i+1],u.push(["C",o[0],o[1],s[0],s[1],a[0],a[1]]);return u}var bW=["$el","cx","cy","d","dx","dy","fill","fillOpacity","filter","fontFamily","fontSize","fontStyle","fontVariant","fontWeight","height","img","increasedLineWidthForHitTesting","innerHTML","isBillboard","billboardRotation","isSizeAttenuation","isClosed","isOverflowing","leading","letterSpacing","lineDash","lineHeight","lineWidth","markerEnd","markerEndOffset","markerMid","markerStart","markerStartOffset","maxLines","metrics","miterLimit","offsetX","offsetY","opacity","path","points","r","radius","rx","ry","shadowColor","src","stroke","strokeOpacity","text","textAlign","textBaseline","textDecorationColor","textDecorationLine","textDecorationStyle","textOverflow","textPath","textPathSide","textPathStartOffset","transform","transformOrigin","visibility","width","wordWrap","wordWrapWidth","x","x1","x2","y","y1","y2","z1","z2","zIndex"];function EW(t){return bW.includes(t)}function xW(t){var e={};for(var n in t)EW(n)&&(e[n]=t[n]);return e}function CW(t,e,n){var r=t.getBBox(),i=r.width,A=r.height,o=e/Math.max(i,A);return t.style.transform="scale(".concat(o,")"),o}var FW=function(){function t(t,n,r,i,A,o,s){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===A&&(A=[null,null,null,null,null]),void 0===o&&(o=[]),void 0===s&&(s=[]),e.add(this),this._elements=Array.from(t),this._data=n,this._parent=r,this._document=i,this._enter=A[0],this._update=A[1],this._exit=A[2],this._merge=A[3],this._split=A[4],this._transitions=o,this._facetElements=s}var e,n,r;return t.prototype.selectAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(e,null,this._elements[0],this._document)},t.prototype.selectFacetAll=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t):t;return new n(this._elements,null,this._parent,this._document,void 0,void 0,e)},t.prototype.select=function(t){var e="string"==typeof t?this._parent.querySelectorAll(t)[0]||null:t;return new n([e],null,e,this._document)},t.prototype.append=function(t){var e=this,r="function"==typeof t?t:function(){return e.createElement(t)},i=[];if(null!==this._data){for(var A=0;A<this._data.length;A++){var o=this._data[A],s=Ke(Array.isArray(o)?o:[o,null],2),a=s[0],c=s[1];(u=r(a,A)).__data__=a,null!==c&&(u.__fromElements__=c),this._parent.appendChild(u),i.push(u)}return new n(i,null,this._parent,this._document)}for(A=0;A<this._elements.length;A++){var l=this._elements[A],u=r(a=l.__data__,A);l.appendChild(u),i.push(u)}return new n(i,null,i[0],this._document)},t.prototype.maybeAppend=function(t,n){var i=Ve(this,e,"m",r).call(this,"#"===t[0]?t:"#".concat(t),n);return i.attr("id",t),i},t.prototype.maybeAppendByClassName=function(t,n){var i=t.toString(),A=Ve(this,e,"m",r).call(this,"."===i[0]?i:".".concat(i),n);return A.attr("className",i),A},t.prototype.maybeAppendByName=function(t,n){var i=Ve(this,e,"m",r).call(this,'[name="'.concat(t,'"]'),n);return i.attr("name",t),i},t.prototype.data=function(t,e,r){var i,A;void 0===e&&(e=function(t){return t}),void 0===r&&(r=function(){return null});for(var o,s,a,c=[],l=[],u=new Set(this._elements),h=[],d=new Set,f=new Map(this._elements.map(function(t,n){return[e(t.__data__,n),t]})),g=new Map(this._facetElements.map(function(t,n){return[e(t.__data__,n),t]})),p=(o=this._elements,s=function(t){return r(t.__data__)},a=new Map,o.forEach(function(t){var e=s(t);a.has(e)||a.set(e,[]),a.get(e).push(t)}),a),v=0;v<t.length;v++){var m=t[v],y=e(m,v),w=r(m,v);if(f.has(y))(x=f.get(y)).__data__=m,x.__facet__=!1,l.push(x),u.delete(x),f.delete(y);else if(g.has(y)){(x=g.get(y)).__data__=m,x.__facet__=!0,l.push(x),g.delete(y)}else if(p.has(y)){var B=p.get(y);h.push([m,B]);try{for(var b=(i=void 0,Ge(B)),E=b.next();!E.done;E=b.next()){var x=E.value;u.delete(x)}}catch(t){i={error:t}}finally{try{E&&!E.done&&(A=b.return)&&A.call(b)}finally{if(i)throw i.error}}p.delete(y)}else if(f.has(w)){(x=f.get(w)).__toData__?x.__toData__.push(m):x.__toData__=[m],d.add(x),u.delete(x)}else c.push(m)}var C=[new n([],c,this._parent,this._document),new n(l,null,this._parent,this._document),new n(u,null,this._parent,this._document),new n([],h,this._parent,this._document),new n(d,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,C)},t.prototype.merge=function(t){var e=je(je([],Ke(this._elements),!1),Ke(t._elements),!1),r=je(je([],Ke(this._transitions),!1),Ke(t._transitions),!1);return new n(e,null,this._parent,this._document,void 0,r)},t.prototype.createElement=function(t){if(this._document)return this._document.createElement(t,{});var e=n.registry[t];return e?new e:function(t){throw new Error(t)}("Unknown node type: ".concat(t))},t.prototype.join=function(t,e,n,r,i){void 0===t&&(t=function(t){return t}),void 0===e&&(e=function(t){return t}),void 0===n&&(n=function(t){return t.remove()}),void 0===r&&(r=function(t){return t}),void 0===i&&(i=function(t){return t.remove()});var A=t(this._enter),o=e(this._update),s=n(this._exit),a=r(this._merge),c=i(this._split);return o.merge(A).merge(s).merge(a).merge(c)},t.prototype.remove=function(){for(var t=function(t){var n=e._elements[t],r=e._transitions[t];r?r.then(function(){return n.remove()}):n.remove()},e=this,r=0;r<this._elements.length;r++)t(r);return new n([],null,this._parent,this._document,void 0,this._transitions)},t.prototype.each=function(t){for(var e=0;e<this._elements.length;e++){var n=this._elements[e],r=n.__data__;t.call(n,r,e)}return this},t.prototype.attr=function(t,e){var n="function"!=typeof e?function(){return e}:e;return this.each(function(r,i){void 0!==e&&(this[t]=n.call(this,r,i))})},t.prototype.style=function(t,e,n){void 0===n&&(n=!0);var r="function"==typeof e&&n?e:function(){return e};return this.each(function(n,i){void 0!==e&&(this.style[t]=r.call(this,n,i))})},t.prototype.styles=function(t,e){return void 0===t&&(t={}),void 0===e&&(e=!0),this.each(function(n,r){var i=this;Object.entries(t).forEach(function(t){var A=Ke(t,2),o=A[0],s=A[1],a="function"==typeof s&&e?s:function(){return s};void 0!==s&&i.attr(o,a.call(i,n,r))})})},t.prototype.update=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each(function(e,r){t&&this.update&&this.update(n.call(this,e,r))})},t.prototype.maybeUpdate=function(t,e){void 0===e&&(e=!0);var n="function"==typeof t&&e?t:function(){return t};return this.each(function(e,r){t&&this.update&&this.update(n.call(this,e,r))})},t.prototype.transition=function(t){this._transitions;var e=new Array(this._elements.length);return this.each(function(n,r){e[r]=t.call(this,n,r)}),this._transitions=function(t){if(!Wt(t))return[];for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n]);return e}(e),this},t.prototype.on=function(t,e){return this.each(function(){this.addEventListener(t,e)}),this},t.prototype.call=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.call.apply(t,je([this._parent,this],Ke(e),!1)),this},t.prototype.node=function(){return this._elements[0]},t.prototype.nodes=function(){return this._elements},t.prototype.transitions=function(){return this._transitions.filter(function(t){return!!t})},t.prototype.parent=function(){return this._parent},n=t,e=new WeakSet,r=function(t,e){var r=this._elements[0],i=r.querySelector(t);if(i)return new n([i],null,this._parent,this._document);var A="string"==typeof e?this.createElement(e):e();return r.appendChild(A),new n([A],null,this._parent,this._document)},t.registry={g:Ja,rect:lc,circle:Ya,path:Ac,text:zz,ellipse:Za,image:ec,line:rc,polygon:sc,polyline:cc,html:tc},t}();function MW(t){return new FW([t],null,t,t.ownerDocument)}function kW(t){if(oe(t))return[t,t,t,t];if(Wt(t)){var e=t.length;if(1===e)return[t[0],t[0],t[0],t[0]];if(2===e)return[t[0],t[1],t[0],t[1]];if(3===e)return[t[0],t[1],t[2],t[1]];if(4===e)return t}return[0,0,0,0]}function QW(t){var e=t.getLocalBounds(),n=Ke([e.min,e.max],2),r=Ke(n[0],2),i=r[0],A=r[1],o=Ke(n[1],2),s=o[0],a=o[1];return{x:i,y:A,width:s-i,height:a-A,left:i,bottom:a,top:A,right:s}}function SW(t,e){var n=Ke(t,2),r=n[0],i=n[1],A=Ke(e,2),o=A[0],s=A[1];return r!==o&&i===s}function UW(t){return t.toString().charAt(0).toUpperCase()+t.toString().slice(1)}function TW(t,e,n){var r;void 0===n&&(n=!0);var i=e||(null===(r=t.match(/^([a-z][a-z0-9]+)/))||void 0===r?void 0:r[0])||"",A=t.replace(new RegExp("^(".concat(i,")")),"");return n?function(t){return t.toString().charAt(0).toLowerCase()+t.toString().slice(1)}(A):A}var OW=function(t,e){if(!(null==t?void 0:t.startsWith(e)))return!1;var n=t[e.length];return n>="A"&&n<="Z"};function NW(t,e,n){void 0===n&&(n=!1);var r={};return Object.entries(t).forEach(function(t){var i=Ke(t,2),A=i[0],o=i[1];if("className"===A||"class"===A);else if(OW(A,"show")&&OW(TW(A,"show"),e)!==n)A===function(t,e){return"".concat(e).concat(UW(t))}(e,"show")?r[A]=o:r[A.replace(new RegExp(UW(e)),"")]=o;else if(!OW(A,"show")&&OW(A,e)!==n){var s=TW(A,e);"filter"===s&&"function"==typeof o||(r[s]=o)}}),r}function IW(t,e){return Object.entries(t).reduce(function(t,n){var r=Ke(n,2),i=r[0],A=r[1];return i.startsWith("show")?t["show".concat(e).concat(i.slice(4))]=A:t["".concat(e).concat(UW(i))]=A,t},{})}function LW(t,e){void 0===e&&(e=["x","y","class","className"]);var n=["transform","transformOrigin","anchor","visibility","pointerEvents","zIndex","cursor","clipPath","clipPathTargets","offsetPath","offsetPathTargets","offsetDistance","draggable","droppable"],r={},i={};return Object.entries(t).forEach(function(t){var A=Ke(t,2),o=A[0],s=A[1];e.includes(o)||(-1!==n.indexOf(o)?i[o]=s:r[o]=s)}),[r,i]}function DW(t,e){var n={YYYY:t.getFullYear(),MM:t.getMonth()+1,DD:t.getDate(),HH:t.getHours(),mm:t.getMinutes(),ss:t.getSeconds()},r=e;return Object.keys(n).forEach(function(t){var e=n[t];r=r.replace(t,"YYYY"===t?"".concat(e):"".concat(e).padStart(2,"0"))}),r}function PW(t,e){if(e)try{var n=e.replace(/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,function(e,n,r){return"translate(".concat(function(t,e,n){var r=t.getBBox(),i=r.width,A=r.height,o=Ke([e,n].map(function(t,e){var n;return t.includes("%")?parseFloat((null===(n=t.match(/[+-]?([0-9]*[.])?[0-9]+/))||void 0===n?void 0:n[0])||"0")/100*(0===e?i:A):t}),2);return[o[0],o[1]]}(t,n,r),")")});t.attr("transform",n)}catch(t){}}var RW=function(t,e){null!=e?t.replaceChildren?Array.isArray(e)?t.replaceChildren.apply(t,je([],Ke(e),!1)):t.replaceChildren(e):(t.innerHTML="",Array.isArray(e)?e.forEach(function(e){return t.appendChild(e)}):t.appendChild(e)):t.innerHTML=""};function HW(t){return/\S+-\S+/g.test(t)?t.split("-").map(function(t){return t[0]}):t.length>2?[t[0]]:t.split("")}function _W(){Kz(this,"hidden"!==this.attributes.visibility)}var GW=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this,tW({},{style:n},e))||this;return r.initialized=!1,r._defaultOptions=n,r}return Pe(e,t),Object.defineProperty(e.prototype,"offscreenGroup",{get:function(){return this._offscreen||(this._offscreen=Vz(this)),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultOptions",{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),e.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},e.prototype.disconnectedCallback=function(){var t;null===(t=this._offscreen)||void 0===t||t.destroy()},e.prototype.attributeChangedCallback=function(t){"visibility"===t&&_W.call(this)},e.prototype.update=function(t,e){var n;return this.attr(tW({},this.attributes,t||{})),null===(n=this.render)||void 0===n?void 0:n.call(this,this.attributes,this,e)},e.prototype.clear=function(){this.removeChildren()},e.prototype.bindEvents=function(t,e){},e.prototype.getSubShapeStyle=function(t){return t.x,t.y,t.transform,t.transformOrigin,t.class,t.className,t.zIndex,He(t,["x","y","transform","transformOrigin","class","className","zIndex"])},e}(qa),KW=function(t,e,n){return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"]]},jW=KW,VW=function(t,e,n){return[["M",t,e+n],["L",t,e-n]]},zW=function(t,e,n){return[["M",t-n,e],["L",t+n,e]]},WW=zW;var YW=function(t,e,n){return[["M",t-n,e-n],["L",t+n,e],["L",t-n,e+n],["Z"]]};function XW(t){var e=function(t){var e="default";if(Yt(t)&&t instanceof Image)e="image";else if(Vt(t))e="symbol";else if(ne(t)){var n=new RegExp("data:(image|text)");e=t.match(n)?"base64":/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(t)?"url":"symbol"}return e}(t);return["base64","url","image"].includes(e)?"image":t&&"symbol"===e?"path":null}var qW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),e.prototype.render=function(t,n){var r=t.x,i=void 0===r?0:r,A=t.y,o=void 0===A?0:A,s=this.getSubShapeStyle(t),a=s.symbol,c=s.size,l=void 0===c?16:c,u=He(s,["symbol","size"]),h=XW(a);cW(!!h,MW(n),function(t){t.maybeAppendByClassName("marker",h).attr("className","marker ".concat(h,"-marker")).call(function(t){if("image"===h){var n=2*l;t.styles({img:a,width:n,height:n,x:i-l,y:o-l})}else{n=l/2;var r=Vt(a)?a:e.getSymbol(a);t.styles(Re({d:null==r?void 0:r(i,o,n)},u))}})})},e.MARKER_SYMBOL_MAP=new Map,e.registerSymbol=function(t,n){e.MARKER_SYMBOL_MAP.set(t,n)},e.getSymbol=function(t){return e.MARKER_SYMBOL_MAP.get(t)},e.getSymbols=function(){return Array.from(e.MARKER_SYMBOL_MAP.keys())},e}(GW);function ZW(t,...e){return e.reduce((t,e)=>n=>t(e(n)),t)}function JW(t,e){return e-t?n=>(n-t)/(e-t):t=>.5}qW.registerSymbol("cross",function(t,e,n){return[["M",t-n,e-n],["L",t+n,e+n],["M",t+n,e-n],["L",t-n,e+n]]}),qW.registerSymbol("hyphen",function(t,e,n){return[["M",t-n,e],["L",t+n,e]]}),qW.registerSymbol("line",VW),qW.registerSymbol("plus",function(t,e,n){return[["M",t-n,e],["L",t+n,e],["M",t,e-n],["L",t,e+n]]}),qW.registerSymbol("tick",function(t,e,n){return[["M",t-n/2,e-n],["L",t+n/2,e-n],["M",t,e-n],["L",t,e+n],["M",t-n/2,e+n],["L",t+n/2,e+n]]}),qW.registerSymbol("circle",KW),qW.registerSymbol("point",jW),qW.registerSymbol("bowtie",function(t,e,n){var r=n-1.5;return[["M",t-n,e-r],["L",t+n,e+r],["L",t+n,e-r],["L",t-n,e+r],["Z"]]}),qW.registerSymbol("hexagon",function(t,e,n){var r=n/2*Math.sqrt(3);return[["M",t,e-n],["L",t+r,e-n/2],["L",t+r,e+n/2],["L",t,e+n],["L",t-r,e+n/2],["L",t-r,e-n/2],["Z"]]}),qW.registerSymbol("square",function(t,e,n){return[["M",t-n,e-n],["L",t+n,e-n],["L",t+n,e+n],["L",t-n,e+n],["Z"]]}),qW.registerSymbol("diamond",function(t,e,n){return[["M",t-n,e],["L",t,e-n],["L",t+n,e],["L",t,e+n],["Z"]]}),qW.registerSymbol("triangle",function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e+r],["L",t,e-r],["L",t+n,e+r],["Z"]]}),qW.registerSymbol("triangle-down",function(t,e,n){var r=n*Math.sin(1/3*Math.PI);return[["M",t-n,e-r],["L",t+n,e-r],["L",t,e+r],["Z"]]}),qW.registerSymbol("line",VW),qW.registerSymbol("dot",zW),qW.registerSymbol("dash",WW),qW.registerSymbol("smooth",function(t,e,n){return[["M",t-n,e],["A",n/2,n/2,0,1,1,t,e],["A",n/2,n/2,0,1,0,t+n,e]]}),qW.registerSymbol("hv",function(t,e,n){return[["M",t-n-1,e-2.5],["L",t,e-2.5],["L",t,e+2.5],["L",t+n+1,e+2.5]]}),qW.registerSymbol("vh",function(t,e,n){return[["M",t-n-1,e+2.5],["L",t,e+2.5],["L",t,e-2.5],["L",t+n+1,e-2.5]]}),qW.registerSymbol("hvh",function(t,e,n){return[["M",t-(n+1),e+2.5],["L",t-n/2,e+2.5],["L",t-n/2,e-2.5],["L",t+n/2,e-2.5],["L",t+n/2,e+2.5],["L",t+n+1,e+2.5]]}),qW.registerSymbol("vhv",function(t,e){return[["M",t-5,e+2.5],["L",t-5,e],["L",t,e],["L",t,e-3],["L",t,e+3],["L",t+6.5,e+3]]}),qW.registerSymbol("focus",function(t,e,n){var r=.2*n,i=.7*n;return[["M",t-n,e],["A",n,n,0,1,0,t+n,e],["A",n,n,0,1,0,t-n,e],["Z"],["M",t-i,e],["L",t-r,e],["M",t+r,e],["L",t+i,e],["M",t,e-i],["L",t,e-r],["M",t,e+r],["L",t,e+i]]});const $W=Math.sqrt(50),tY=Math.sqrt(10),eY=Math.sqrt(2);function nY(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),A=r/10**i;return i>=0?(A>=$W?10:A>=tY?5:A>=eY?2:1)*10**i:-(10**-i)/(A>=$W?10:A>=tY?5:A>=eY?2:1)}const rY=(t,e,n=5)=>{const r=[t,e];let i,A=0,o=r.length-1,s=r[A],a=r[o];return a<s&&([s,a]=[a,s],[A,o]=[o,A]),i=nY(s,a,n),i>0?(s=Math.floor(s/i)*i,a=Math.ceil(a/i)*i,i=nY(s,a,n)):i<0&&(s=Math.ceil(s*i)/i,a=Math.floor(a*i)/i,i=nY(s,a,n)),i>0?(r[A]=Math.floor(s/i)*i,r[o]=Math.ceil(a/i)*i):i<0&&(r[A]=Math.ceil(s*i)/i,r[o]=Math.floor(a*i)/i),r};function iY(t){return!(pe(t)||(e=t,null===e)||Number.isNaN(t));var e}var AY={exports:{}},oY={exports:{}},sY=function(t){return!(!t||"string"==typeof t)&&(t instanceof Array||Array.isArray(t)||t.length>=0&&(t.splice instanceof Function||Object.getOwnPropertyDescriptor(t,t.length-1)&&"String"!==t.constructor.name))},aY=Array.prototype.concat,cY=Array.prototype.slice,lY=oY.exports=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];sY(i)?e=aY.call(e,cY.call(i)):e.push(i)}return e};lY.wrap=function(t){return function(){return t(lY(arguments))}};var uY=oY.exports,hY={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},dY=uY,fY=Object.hasOwnProperty,gY=Object.create(null);for(var pY in hY)fY.call(hY,pY)&&(gY[hY[pY]]=pY);var vY=AY.exports={to:{},get:{}};function mY(t,e,n){return Math.min(Math.max(e,t),n)}function yY(t){var e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}vY.get=function(t){var e,n;switch(t.substring(0,3).toLowerCase()){case"hsl":e=vY.get.hsl(t),n="hsl";break;case"hwb":e=vY.get.hwb(t),n="hwb";break;default:e=vY.get.rgb(t),n="rgb"}return e?{model:n,value:e}:null},vY.get.rgb=function(t){if(!t)return null;var e,n,r,i=[0,0,0,1];if(e=t.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=e[2],e=e[1],n=0;n<3;n++){var A=2*n;i[n]=parseInt(e.slice(A,A+2),16)}r&&(i[3]=parseInt(r,16)/255)}else if(e=t.match(/^#([a-f0-9]{3,4})$/i)){for(r=(e=e[1])[3],n=0;n<3;n++)i[n]=parseInt(e[n]+e[n],16);r&&(i[3]=parseInt(r+r,16)/255)}else if(e=t.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)i[n]=parseInt(e[n+1],0);e[4]&&(e[5]?i[3]=.01*parseFloat(e[4]):i[3]=parseFloat(e[4]))}else{if(!(e=t.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(e=t.match(/^(\w+)$/))?"transparent"===e[1]?[0,0,0,0]:fY.call(hY,e[1])?((i=hY[e[1]])[3]=1,i):null:null;for(n=0;n<3;n++)i[n]=Math.round(2.55*parseFloat(e[n+1]));e[4]&&(e[5]?i[3]=.01*parseFloat(e[4]):i[3]=parseFloat(e[4]))}for(n=0;n<3;n++)i[n]=mY(i[n],0,255);return i[3]=mY(i[3],0,1),i},vY.get.hsl=function(t){if(!t)return null;var e=t.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,mY(parseFloat(e[2]),0,100),mY(parseFloat(e[3]),0,100),mY(isNaN(n)?1:n,0,1)]}return null},vY.get.hwb=function(t){if(!t)return null;var e=t.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(e){var n=parseFloat(e[4]);return[(parseFloat(e[1])%360+360)%360,mY(parseFloat(e[2]),0,100),mY(parseFloat(e[3]),0,100),mY(isNaN(n)?1:n,0,1)]}return null},vY.to.hex=function(){var t=dY(arguments);return"#"+yY(t[0])+yY(t[1])+yY(t[2])+(t[3]<1?yY(Math.round(255*t[3])):"")},vY.to.rgb=function(){var t=dY(arguments);return t.length<4||1===t[3]?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"},vY.to.rgb.percent=function(){var t=dY(arguments),e=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),r=Math.round(t[2]/255*100);return t.length<4||1===t[3]?"rgb("+e+"%, "+n+"%, "+r+"%)":"rgba("+e+"%, "+n+"%, "+r+"%, "+t[3]+")"},vY.to.hsl=function(){var t=dY(arguments);return t.length<4||1===t[3]?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"},vY.to.hwb=function(){var t=dY(arguments),e="";return t.length>=4&&1!==t[3]&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"},vY.to.keyword=function(t){return gY[t.slice(0,3)]};var wY=B(AY.exports);function BY(t,e,n){let r=n;return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function bY(t){const e=wY.get(t);if(!e)return null;const{model:n,value:r}=e;return"rgb"===n?r:"hsl"===n?function(t){const e=t[0]/360,n=t[1]/100,r=t[2]/100,i=t[3];if(0===n)return[255*r,255*r,255*r,i];const A=r<.5?r*(1+n):r+n-r*n,o=2*r-A;return[255*BY(o,A,e+1/3),255*BY(o,A,e),255*BY(o,A,e-1/3),i]}(r):null}const EY=(t,e)=>n=>t*(1-n)+e*n,xY=(t,e)=>"number"==typeof t&&"number"==typeof e?EY(t,e):"string"==typeof t&&"string"==typeof e?((t,e)=>{const n=bY(t),r=bY(e);return null===n||null===r?n?()=>t:()=>e:t=>{const e=new Array(4);for(let i=0;i<4;i+=1){const A=n[i],o=r[i];e[i]=A*(1-t)+o*t}const[i,A,o,s]=e;return`rgba(${Math.round(i)}, ${Math.round(A)}, ${Math.round(o)}, ${s})`}})(t,e):()=>t,CY=(t,e)=>{const n=EY(t,e);return t=>Math.round(n(t))};function FY({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):n}function MY(t){return"object"==typeof t?t.valueOf():t}class kY extends Map{constructor(t){if(super(),this.map=new Map,this.initKey=MY,null!==t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(FY({map:this.map,initKey:this.initKey},t))}has(t){return super.has(FY({map:this.map,initKey:this.initKey},t))}set(t,e){return super.set(function({map:t,initKey:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}({map:this.map,initKey:this.initKey},t),e)}delete(t){return super.delete(function({map:t,initKey:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}({map:this.map,initKey:this.initKey},t))}}class QY{constructor(t){this.options=xe({},this.getDefaultOptions()),this.update(t)}getOptions(){return this.options}update(t={}){this.options=xe({},this.options,t),this.rescale(t)}rescale(t){}}const SY=Symbol("defaultUnknown");function UY(t,e,n){for(let r=0;r<e.length;r+=1)t.has(e[r])||t.set(n(e[r]),r)}function TY(t){const{value:e,from:n,to:r,mapper:i,notFoundReturn:A}=t;let o=i.get(e);if(void 0===o){if(A!==SY)return A;o=n.push(e)-1,i.set(e,o)}return r[o%r.length]}function OY(t){return t instanceof Date?t=>`${t}`:"object"==typeof t?t=>JSON.stringify(t):t=>t}class NY extends QY{getDefaultOptions(){return{domain:[],range:[],unknown:SY}}constructor(t){super(t)}map(t){return 0===this.domainIndexMap.size&&UY(this.domainIndexMap,this.getDomain(),this.domainKey),TY({value:this.domainKey(t),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(t){return 0===this.rangeIndexMap.size&&UY(this.rangeIndexMap,this.getRange(),this.rangeKey),TY({value:this.rangeKey(t),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(t){const[e]=this.options.domain,[n]=this.options.range;if(this.domainKey=OY(e),this.rangeKey=OY(n),!this.rangeIndexMap)return this.rangeIndexMap=new Map,void(this.domainIndexMap=new Map);t&&!t.range||this.rangeIndexMap.clear(),(!t||t.domain||t.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new NY(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;const{domain:t,compare:e}=this.options;return this.sortedDomain=e?[...t].sort(e):t,this.sortedDomain}}function IY(t){return Math.round(1e12*t)/1e12}function LY(t){const{domain:e,range:n,paddingOuter:r,paddingInner:i,flex:A,round:o,align:s}=t,a=e.length,c=function(t,e){const n=e-t.length;return n>0?[...t,...new Array(n).fill(1)]:n<0?t.slice(0,e):t}(A,a),[l,u]=n,h=u-l,d=h/(2/a*r+1-1/a*i),f=d*i/a,g=d-a*f,p=function(t){const e=Math.min(...t);return t.map(t=>t/e)}(c),v=g/p.reduce((t,e)=>t+e),m=new kY(e.map((t,e)=>{const n=p[e]*v;return[t,o?Math.floor(n):n]})),y=new kY(e.map((t,e)=>{const n=p[e]*v+f;return[t,o?Math.floor(n):n]})),w=Array.from(y.values()).reduce((t,e)=>t+e),B=l+(h-(w-w/a*i))*s;let b=o?Math.round(B):B;const E=new Array(a);for(let t=0;t<a;t+=1){E[t]=IY(b);const n=e[t];b+=y.get(n)}return{valueBandWidth:m,valueStep:y,adjustedRange:E}}class DY extends NY{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:SY,flex:[]}}constructor(t){super(t)}clone(){return new DY(this.options)}getStep(t){return void 0===this.valueStep?1:"number"==typeof this.valueStep?this.valueStep:void 0===t?Array.from(this.valueStep.values())[0]:this.valueStep.get(t)}getBandWidth(t){return void 0===this.valueBandWidth?1:"number"==typeof this.valueBandWidth?this.valueBandWidth:void 0===t?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(t)}getRange(){return this.adjustedRange}getPaddingInner(){const{padding:t,paddingInner:e}=this.options;return t>0?t:e}getPaddingOuter(){const{padding:t,paddingOuter:e}=this.options;return t>0?t:e}rescale(){super.rescale();const{align:t,domain:e,range:n,round:r,flex:i}=this.options,{adjustedRange:A,valueBandWidth:o,valueStep:s}=function(t){var e;const{domain:n}=t,r=n.length;if(0===r)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(null===(e=t.flex)||void 0===e?void 0:e.length)return LY(t);const{range:i,paddingOuter:A,paddingInner:o,round:s,align:a}=t;let c,l,u=i[0];const h=i[1]-u,d=2*A,f=r-o;c=h/Math.max(1,d+f),s&&(c=Math.floor(c)),u+=(h-c*(r-o))*a,l=c*(1-o),s&&(u=Math.round(u),l=Math.round(l));const g=new Array(r).fill(0).map((t,e)=>u+e*c);return{valueStep:c,valueBandWidth:l,adjustedRange:g}}({align:t,range:n,round:r,flex:i,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:e});this.valueStep=s,this.valueBandWidth=o,this.adjustedRange=A}}const PY=(t,e,n)=>{let r,i,A=t,o=e;if(A===o&&n>0)return[A];let s=nY(A,o,n);if(0===s||!Number.isFinite(s))return[];if(s>0){A=Math.ceil(A/s),o=Math.floor(o/s),i=new Array(r=Math.ceil(o-A+1));for(let t=0;t<r;t+=1)i[t]=(A+t)*s}else{s=-s,A=Math.ceil(A*s),o=Math.floor(o*s),i=new Array(r=Math.ceil(o-A+1));for(let t=0;t<r;t+=1)i[t]=(A+t)/s}return i},RY=(t,e,n)=>{const[r,i]=t,[A,o]=e;let s,a;return r<i?(s=JW(r,i),a=n(A,o)):(s=JW(i,r),a=n(o,A)),ZW(a,s)},HY=(t,e,n)=>{const r=Math.min(t.length,e.length)-1,i=new Array(r),A=new Array(r),o=t[0]>t[r],s=o?[...t].reverse():t,a=o?[...e].reverse():e;for(let t=0;t<r;t+=1)i[t]=JW(s[t],s[t+1]),A[t]=n(a[t],a[t+1]);return e=>{const n=function(t,e,n,r){let i=n,A=r||t.length;const o=t=>t;for(;i<A;){const n=Math.floor((i+A)/2);o(t[n])>e?A=n:i=n+1}return i}(t,e,1,r)-1,o=i[n];return ZW(A[n],o)(e)}},_Y=(t,e,n,r)=>(Math.min(t.length,e.length)>2?HY:RY)(t,e,r?CY:n);class GY extends QY{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:EY,tickCount:5}}map(t){return iY(t)?this.output(t):this.options.unknown}invert(t){return iY(t)?this.input(t):this.options.unknown}nice(){if(!this.options.nice)return;const[t,e,n,...r]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(t,e,n,...r)}getTicks(){const{tickMethod:t}=this.options,[e,n,r,...i]=this.getTickMethodOptions();return t(e,n,r,...i)}getTickMethodOptions(){const{domain:t,tickCount:e}=this.options;return[t[0],t[t.length-1],e]}chooseNice(){return rY}rescale(){this.nice();const[t,e]=this.chooseTransforms();this.composeOutput(t,this.chooseClamp(t)),this.composeInput(t,e,this.chooseClamp(e))}chooseClamp(t){const{clamp:e,range:n}=this.options,r=this.options.domain.map(t),i=Math.min(r.length,n.length);return e?function(t,e){const n=e<t?e:t,r=t>e?t:e;return t=>Math.min(Math.max(n,t),r)}(r[0],r[i-1]):Le}composeOutput(t,e){const{domain:n,range:r,round:i,interpolate:A}=this.options,o=_Y(n.map(t),r,A,i);this.output=ZW(o,e,t)}composeInput(t,e,n){const{domain:r,range:i}=this.options,A=_Y(i,r.map(t),EY);this.input=ZW(e,n,A)}}class KY extends GY{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:xY,tickMethod:PY,tickCount:5}}chooseTransforms(){return[Le,Le]}clone(){return new KY(this.options)}}var jY=function(t){function e(e){var n=this,r=e.style,i=He(e,["style"]);return(n=t.call(this,xe({},{type:"column"},Re({style:r},i)))||this).columnsGroup=new Ja({name:"columns"}),n.appendChild(n.columnsGroup),n.render(),n}return Pe(e,t),e.prototype.render=function(){var t=this.attributes,e=t.columns,n=t.x,r=t.y;this.columnsGroup.style.transform="translate(".concat(n,", ").concat(r,")"),MW(this.columnsGroup).selectAll(".column").data(e.flat()).join(function(t){return t.append("rect").attr("className","column").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.attr(t)})},function(t){return t.remove()})},e.prototype.update=function(t){this.attr(tW({},this.attributes,t)),this.render()},e.prototype.clear=function(){this.removeChildren()},e}(Wa),VY=function(t){function e(e){var n=this,r=e.style,i=He(e,["style"]);return(n=t.call(this,xe({},{type:"lines"},Re({style:r},i)))||this).linesGroup=n.appendChild(new Ja),n.areasGroup=n.appendChild(new Ja),n.render(),n}return Pe(e,t),e.prototype.render=function(){var t=this.attributes,e=t.lines,n=t.areas,r=t.x,i=t.y;this.style.transform="translate(".concat(r,", ").concat(i,")"),e&&this.renderLines(e),n&&this.renderAreas(n)},e.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},e.prototype.update=function(t){this.attr(tW({},this.attributes,t)),this.render()},e.prototype.renderLines=function(t){MW(this.linesGroup).selectAll(".line").data(t).join(function(t){return t.append("path").attr("className","line").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.attr(t)})},function(t){return t.remove()})},e.prototype.renderAreas=function(t){MW(this.linesGroup).selectAll(".area").data(t).join(function(t){return t.append("path").attr("className","area").each(function(t){this.attr(t)})},function(t){return t.each(function(t){this.style(t)})},function(t){return t.remove()})},e}(Wa);function zY(t,e){void 0===e&&(e=!1);var n=e?t.length-1:0,r=t.map(function(t,e){return je([e===n?"M":"L"],Ke(t),!1)});return e?r.reverse():r}function WY(t,e){if(void 0===e&&(e=!1),t.length<=2)return zY(t);for(var n=[],r=t.length,i=0;i<r;i+=1){var A=e?t[r-i-1]:t[i];Me(A,n.slice(-2))||n.push.apply(n,je([],Ke(A),!1))}var o=BW(n);return e?o.unshift(je(["M"],Ke(t[r-1]),!1)):o.unshift(je(["M"],Ke(t[0]),!1)),o}function YY(t,e,n){var r=me(t);return r.push(["L",e,n],["L",0,n],["Z"]),r}function XY(t){return 0===t.length?[0,0]:[ee(ce(t,function(t){return ee(t)||0})),te(ae(t,function(t){return te(t)||0}))]}function qY(t){for(var e=me(t),n=e[0].length,r=Ke([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],A=r[1],o=0;o<e.length;o+=1)for(var s=e[o],a=0;a<n;a+=1)s[a]>=0?(s[a]+=i[a],i[a]=s[a]):(s[a]+=A[a],A[a]=s[a]);return e}var ZY=function(t){function e(e){return t.call(this,e,{type:"line",x:0,y:0,width:200,height:20,isStack:!1,color:["#83daad","#edbf45","#d2cef9","#e290b3","#6f63f4"],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:"#fff",scale:1,spacing:0})||this}return Pe(e,t),Object.defineProperty(e.prototype,"rawData",{get:function(){var t=this.attributes.data;if(!t||0===(null==t?void 0:t.length))return[[]];var e=me(t);return oe(e[0])?[e]:e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.isStack?qY(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scales",{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseline",{get:function(){var t=this.scales.y,e=Ke(t.getOptions().domain||[0,0],2),n=e[0],r=e[1];return r<0?t.map(r):t.map(n<0?0:n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"containerShape",{get:function(){var t=this.attributes;return{width:t.width,height:t.height}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"linesStyle",{get:function(){var t=this,e=this.attributes,n=e.type,r=e.isStack,i=e.smooth;if("line"!==n)throw new Error("linesStyle can only be used in line type");var A=NW(this.attributes,"area"),o=NW(this.attributes,"line"),s=this.containerShape.width,a=this.data;if(0===a[0].length)return{lines:[],areas:[]};var c=this.scales,l=function(t,e){var n,r=e.x,i=e.y,A=Ke(i.getOptions().range||[0,0],2),o=A[0],s=A[1];return s>o&&(n=Ke([o,s],2),s=n[0],o=n[1]),t.map(function(t){return t.map(function(t,e){return[r.map(e),Ae(i.map(t),s,o)]})})}(a,{x:c.x,y:c.y}),u=[];if(A){var h=this.baseline;u=r?i?function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var A=t[i],o=WY(A),s=void 0;if(0===i)s=YY(o,e,n);else{var a=WY(t[i-1],!0),c=A[0];a[0][0]="L",s=je(je(je([],Ke(o),!1),Ke(a),!1),[je(["M"],Ke(c),!1),["Z"]],!1)}r.push(s)}return r}(l,s,h):function(t,e,n){for(var r=[],i=t.length-1;i>=0;i-=1){var A=zY(t[i]),o=void 0;if(0===i)o=YY(A,e,n);else{var s=zY(t[i-1],!0);s[0][0]="L",o=je(je(je([],Ke(A),!1),Ke(s),!1),[["Z"]],!1)}r.push(o)}return r}(l,s,h):function(t,e,n,r){return t.map(function(t){return YY(e?WY(t):zY(t),n,r)})}(l,i,s,h)}return{lines:l.map(function(e,n){return Re({stroke:t.getColor(n),d:i?WY(e):zY(e)},o)}),areas:u.map(function(e,n){return Re({d:e,fill:t.getColor(n)},A)})}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnsStyle",{get:function(){var t=this,e=NW(this.attributes,"column"),n=this.attributes,r=n.isStack,i=n.type,A=n.scale;if("column"!==i)throw new Error("columnsStyle can only be used in column type");var o=this.containerShape.height,s=this.rawData;if(!s)return{columns:[]};r&&(s=qY(s));var a=this.createScales(s),c=a.x,l=a.y,u=Ke(XY(s),2),h=u[0],d=u[1],f=new KY({domain:[0,d-(h>0?0:h)],range:[0,o*A]}),g=c.getBandWidth(),p=this.rawData;return{columns:s.map(function(n,i){return n.map(function(n,A){var o=g/s.length;return Re(Re({fill:t.getColor(i)},e),r?{x:c.map(A),y:l.map(n),width:g,height:f.map(p[i][A])}:{x:c.map(A)+o*i,y:n>=0?l.map(n):l.map(0),width:o,height:f.map(Math.abs(n))})})})}},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){var n,r,i;(n=e,r=".container",i="rect",n.querySelector(r)?MW(n).select(r):MW(n).append(i)).attr("className","container").node();var A=t.type,o=t.x,s=t.y,a="spark".concat(A),c=Re({x:o,y:s},"line"===A?this.linesStyle:this.columnsStyle);MW(e).selectAll(".spark").data([A]).join(function(t){return t.append(function(t){return"line"===t?new VY({className:a,style:c}):new jY({className:a,style:c})}).attr("className","spark ".concat(a))},function(t){return t.update(c)},function(t){return t.remove()})},e.prototype.getColor=function(t){var e=this.attributes.color;return Wt(e)?e[t%e.length]:Vt(e)?e.call(null,t):e},e.prototype.createScales=function(t){var e,n,r=this.attributes,i=r.type,A=r.scale,o=r.range,s=void 0===o?[]:o,a=r.spacing,c=this.containerShape,l=c.width,u=c.height,h=Ke(XY(t),2),d=h[0],f=h[1],g=new KY({domain:[null!==(e=s[0])&&void 0!==e?e:d,null!==(n=s[1])&&void 0!==n?n:f],range:[u,u*(1-A)]});return"line"===i?{type:i,x:new KY({domain:[0,t[0].length-1],range:[0,l]}),y:g}:{type:i,x:new DY({domain:t[0].map(function(t,e){return e}),range:[0,l],paddingInner:a,paddingOuter:a/2,align:.5}),y:g}},e.tag="sparkline",e}(GW);function JY(t){if(!t)return{enter:!1,update:!1,exit:!1};var e=["enter","update","exit"],n=Object.fromEntries(Object.entries(t).filter(function(t){var n=Ke(t,1)[0];return!e.includes(n)}));return Object.fromEntries(e.map(function(e){return function(t){return"boolean"!=typeof t&&"enter"in t&&"update"in t&&"exit"in t}(t)?!1===t[e]?[e,!1]:[e,Re(Re({},t[e]),n)]:[e,n]}))}function $Y(t,e){t?t.finished.then(e):e()}function tX(t,e){"update"in t?t.update(e):t.attr(e)}function eX(t,e,n){return 0===e.length?null:n?t.animate(e,n):(tX(t,{style:e.slice(-1)[0]}),null)}function nX(t,e,n){var r={},i={};return Object.entries(e).forEach(function(e){var n=Ke(e,2),A=n[0],o=n[1];if(!zt(o)){var s=t.style[A]||t.parsedStyle[A]||0;s!==o&&(r[A]=s,i[A]=o)}}),n?eX(t,[r,i],Re({fill:"both"},n)):(tX(t,i),null)}function rX(t,e){return t.style.opacity||(t.style.opacity=1),nX(t,{opacity:0},e)}var iX={fill:"#fff",lineWidth:1,radius:2,size:10,stroke:"#bfbfbf",strokeOpacity:1,zIndex:0},AX={fill:"#000",fillOpacity:.45,fontSize:12,textAlign:"center",textBaseline:"middle",zIndex:1},oX={x:0,y:0,orientation:"horizontal",showLabel:!0,type:"start"},sX=Jz({foreground:"foreground",handle:"handle",selection:"selection",sparkline:"sparkline",sparklineGroup:"sparkline-group",track:"track",brushArea:"brush-area"},"slider"),aX=Jz({labelGroup:"label-group",label:"label",iconGroup:"icon-group",icon:"icon",iconRect:"icon-rect",iconLine:"icon-line"},"handle"),cX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),e.prototype.render=function(t,e){var n=t.x,r=t.y,i=t.size,A=void 0===i?10:i,o=t.radius,s=void 0===o?A/4:o,a=t.orientation,c=t.classNamePrefix,l=He(t,["x","y","size","radius","orientation","classNamePrefix"]),u=A,h=2.4*u,d=c?"".concat(aX.iconRect.name," ").concat(c,"handle-icon-rect"):aX.iconRect.name,f=function(t){return c?"".concat(aX.iconLine,"-").concat(t," ").concat(c,"handle-icon-line"):"".concat(aX.iconLine,"-").concat(t)},g=MW(e).maybeAppendByClassName(aX.iconRect,"rect").attr("className",d).styles(Re(Re({},l),{width:u,height:h,radius:s,x:n-u/2,y:r-h/2,transformOrigin:"center"})),p=n+1/3*u-u/2,v=n+2/3*u-u/2,m=r+1/4*h-h/2,y=r+3/4*h-h/2;g.maybeAppendByClassName("".concat(aX.iconLine,"-1"),"line").attr("className",f(1)).styles(Re({x1:p,x2:p,y1:m,y2:y},l)),g.maybeAppendByClassName("".concat(aX.iconLine,"-2"),"line").attr("className",f(2)).styles(Re({x1:v,x2:v,y1:m,y2:y},l)),"vertical"===a&&(g.node().style.transform="rotate(90)")},e}(GW),lX=function(t){function e(e){return t.call(this,e,oX)||this}return Pe(e,t),e.prototype.renderLabel=function(t){var e=this,n=this.attributes,r=n.x,i=n.y,A=n.showLabel,o=NW(this.attributes,"label"),s=o.x,a=void 0===s?0:s,c=o.y,l=void 0===c?0:c,u=o.transform,h=o.transformOrigin,d=Ke(LW(He(o,["x","y","transform","transformOrigin"]),[]),2),f=d[0],g=d[1],p=MW(t).maybeAppendByClassName(aX.labelGroup,"g").styles(g),v=Re(Re({},AX),f),m=v.text,y=He(v,["text"]);cW(!!A,p,function(t){e.label=t.maybeAppendByClassName(aX.label,"text").styles(Re(Re({},y),{x:r+a,y:i+l,transform:u,transformOrigin:h,text:"".concat(m)})),e.label.on("mousedown",function(t){t.stopPropagation()}),e.label.on("touchstart",function(t){t.stopPropagation()})})},e.prototype.renderIcon=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.orientation,A=e.type,o=e.classNamePrefix,s=Re(Re({x:n,y:r,orientation:i,classNamePrefix:o},iX),NW(this.attributes,"icon")),a=this.attributes.iconShape,c=void 0===a?function(){return new cX({style:s})}:a;MW(t).maybeAppendByClassName(aX.iconGroup,"g").selectAll(aX.icon.class).data([c]).join(function(t){return t.append("string"==typeof c?c:function(){return c(A)}).attr("className",aX.icon.name)},function(t){return t.update(s)},function(t){return t.remove()})},e.prototype.render=function(t,e){this.renderIcon(e),this.renderLabel(e)},e}(GW),uX=function(t){function e(e){var n=t.call(this,e,Re(Re(Re({x:0,y:0,animate:{duration:100,fill:"both"},brushable:!0,formatter:function(t){return t.toString()},handleSpacing:2,orientation:"horizontal",padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:"#5B8FF9",selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:"#416180",trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:"range",selectionType:"select",handleIconOffset:0},IW(oX,"handle")),IW(iX,"handleIcon")),IW(AX,"handleLabel")))||this;return n.range=[0,1],n.onDragStart=function(t){return function(e){e.stopPropagation(),n.target=t,n.prevPos=n.getOrientVal(sW(e));var r=n.availableSpace,i=r.x,A=r.y,o=n.getBBox(),s=o.x,a=o.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([i,A])-n.getOrientVal([+s,+a])),n.selectionWidth=0,document.addEventListener("pointermove",n.onDragging),document.addEventListener("pointerup",n.onDragEnd)}},n.onDragging=function(t){var e=n.attributes,r=e.slidable,i=e.brushable,A=e.type;t.stopPropagation();var o=n.getOrientVal(sW(t)),s=o-n.prevPos;if(s){var a=n.getRatio(s);switch(n.target){case"start":r&&n.setValuesOffset(a);break;case"end":r&&n.setValuesOffset(0,a);break;case"selection":r&&n.setValuesOffset(a,a);break;case"track":if(!i)return;n.selectionWidth+=a,"range"===A?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0)}n.prevPos=o}},n.onDragEnd=function(){document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointermove",n.onDragging),document.removeEventListener("pointerup",n.onDragEnd),n.target="",n.updateHandlesPosition(!1)},n.onValueChange=function(t){var e=n.attributes,r=e.onChange,i=e.type,A="range"===i?t:t[1],o="range"===i?n.getValues():n.getValues()[1],s=new Xs("valuechange",{detail:{oldValue:A,value:o}});n.dispatchEvent(s),null==r||r(o)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target="",n}return Pe(e,t),Object.defineProperty(e.prototype,"values",{get:function(){return this.attributes.values},set:function(t){this.attributes.values=this.clampValues(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sparklineStyle",{get:function(){if("horizontal"!==this.attributes.orientation)return null;var t=NW(this.attributes,"sparkline");return Re(Re({zIndex:0},this.availableSpace),t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t=this.attributes,e=t.trackLength,n=t.trackSize,r=Ke(this.getOrientVal([[e,n],[n,e]]),2);return{width:r[0],height:r[1]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes;t.x,t.y;var e=Ke(kW(t.padding),4),n=e[0],r=e[1],i=e[2],A=e[3],o=this.shape;return{x:A,y:n,width:o.width-(A+r),height:o.height-(n+i)}},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this.values},e.prototype.setValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1),this.attributes.values=t;var n=!1!==e&&this.attributes.animate;this.updateSelectionArea(n),this.updateHandlesPosition(n)},e.prototype.updateSelectionArea=function(t){var e=this.calcSelectionArea();this.foregroundGroup.selectAll(sX.selection.class).each(function(n,r){nX(this,e[r],t)})},e.prototype.updateHandlesPosition=function(t){this.attributes.showHandle&&(this.startHandle&&nX(this.startHandle,this.getHandleStyle("start"),t),this.endHandle&&nX(this.endHandle,this.getHandleStyle("end"),t))},e.prototype.innerSetValues=function(t,e){void 0===t&&(t=[0,0]),void 0===e&&(e=!1);var n=this.values,r=this.clampValues(t);this.attributes.values=r,this.setValues(r),e&&this.onValueChange(n)},e.prototype.renderTrack=function(t){var e=this.attributes,n=e.x,r=e.y,i=NW(this.attributes,"track");this.trackShape=MW(t).maybeAppendByClassName(sX.track,"rect").styles(Re(Re({x:n,y:r},this.shape),i))},e.prototype.renderBrushArea=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.brushable;this.brushArea=MW(t).maybeAppendByClassName(sX.brushArea,"rect").styles(Re({x:n,y:r,fill:"transparent",cursor:i?"crosshair":"default"},this.shape))},e.prototype.renderSparkline=function(t){var e=this,n=this.attributes,r=n.x,i=n.y;cW("horizontal"===n.orientation,MW(t).maybeAppendByClassName(sX.sparklineGroup,"g"),function(t){var n=Re(Re({},e.sparklineStyle),{x:r,y:i});t.maybeAppendByClassName(sX.sparkline,function(){return new ZY({style:n})}).update(n)})},e.prototype.renderHandles=function(){var t,e=this,n=this.attributes,r=n.showHandle,i=n.type,A=r?"range"===i?["start","end"]:["end"]:[],o=this;null===(t=this.foregroundGroup)||void 0===t||t.selectAll(sX.handle.class).data(A.map(function(t){return{type:t}}),function(t){return t.type}).join(function(t){return t.append(function(t){var n=t.type;return new lX({style:e.getHandleStyle(n)})}).each(function(t){var e=t.type;this.attr("class","".concat(sX.handle.name," ").concat(e,"-handle"));var n="".concat(e,"Handle");o[n]=this,this.addEventListener("pointerdown",o.onDragStart(e))})},function(t){return t.each(function(t){var e=t.type;this.update(o.getHandleStyle(e))})},function(t){return t.each(function(t){var e=t.type,n="".concat(e,"Handle");o[n]=void 0}).remove()})},e.prototype.renderSelection=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.type,A=e.selectionType;this.foregroundGroup=MW(t).maybeAppendByClassName(sX.foreground,"g");var o=NW(this.attributes,"selection"),s=function(t){return t.style("visibility",function(t){return t.show?"visible":"hidden"}).style("cursor",function(t){return"select"===A?"grab":"invert"===A?"crosshair":"default"}).styles(Re(Re({},o),{transform:"translate(".concat(n,", ").concat(r,")")}))},a=this;this.foregroundGroup.selectAll(sX.selection.class).data("value"===i?[]:this.calcSelectionArea().map(function(t,e){return{style:Re({},t),index:e,show:"select"===A?1===e:1!==e}}),function(t){return t.index}).join(function(t){return t.append("rect").attr("className",sX.selection.name).call(s).each(function(t,e){var n=this;1===e?(a.selectionShape=MW(this),this.on("pointerdown",function(t){n.attr("cursor","grabbing"),a.onDragStart("selection")(t)}),a.dispatchCustomEvent(this,"pointerenter","selectionMouseenter"),a.dispatchCustomEvent(this,"pointerleave","selectionMouseleave"),a.dispatchCustomEvent(this,"click","selectionClick"),this.addEventListener("pointerdown",function(){n.attr("cursor","grabbing")}),this.addEventListener("pointerup",function(){n.attr("cursor","pointer")}),this.addEventListener("pointerover",function(){n.attr("cursor","pointer")})):this.on("pointerdown",a.onDragStart("track"))})},function(t){return t.call(s)},function(t){return t.remove()}),this.updateSelectionArea(!1),this.renderHandles()},e.prototype.render=function(t,e){this.renderTrack(e),this.renderSparkline(e),this.renderBrushArea(e),this.renderSelection(e)},e.prototype.clampValues=function(t,e){var n;void 0===e&&(e=4);var r=Ke(this.range,2),i=r[0],A=r[1],o=Ke(this.getValues().map(function(t){return yW(t,e)}),2),s=o[0],a=o[1],c=Ke(((Array.isArray(t)?t:[s,null!=t?t:a])||[s,a]).map(function(t){return yW(t,e)}),2),l=c[0],u=c[1];if("value"===this.attributes.type)return[0,Ae(u,i,A)];l>u&&(l=(n=Ke([u,l],2))[0],u=n[1]);var h=u-l;return h>A-i?[i,A]:l<i?s===i&&a===u?[i,u]:[i,h+i]:u>A?a===A&&s===l?[l,A]:[A-h,A]:[l,u]},e.prototype.calcSelectionArea=function(t){var e=Ke(this.clampValues(t),2),n=e[0],r=e[1],i=this.availableSpace,A=i.x,o=i.y,s=i.width,a=i.height;return this.getOrientVal([[{y:o,height:a,x:A,width:n*s},{y:o,height:a,x:n*s+A,width:(r-n)*s},{y:o,height:a,x:r*s,width:(1-r)*s}],[{x:A,width:s,y:o,height:n*a},{x:A,width:s,y:n*a+o,height:(r-n)*a},{x:A,width:s,y:r*a,height:(1-r)*a}]])},e.prototype.calcHandlePosition=function(t){var e=this.attributes.handleIconOffset,n=this.availableSpace,r=n.x,i=n.y,A=n.width,o=n.height,s=Ke(this.clampValues(),2),a=s[0],c=s[1],l="start"===t?-e:e,u=("start"===t?a:c)*this.getOrientVal([A,o])+l;return{x:r+this.getOrientVal([u,A/2]),y:i+this.getOrientVal([o/2,u])}},e.prototype.inferTextStyle=function(t){return"horizontal"===this.attributes.orientation?{}:"start"===t?{transformOrigin:"left center",transform:"rotate(90)",textAlign:"start"}:"end"===t?{transformOrigin:"right center",transform:"rotate(90)",textAlign:"end"}:{}},e.prototype.calcHandleText=function(t){var e,n=this.attributes,r=n.type,i=n.orientation,A=n.formatter,o=n.autoFitLabel,s=NW(this.attributes,"handle"),a=NW(s,"label"),c=s.spacing,l=this.getHandleSize(),u=this.clampValues(),h=A("start"===t?u[0]:u[1]),d=new zz({style:Re(Re(Re({},a),this.inferTextStyle(t)),{text:h})}),f=d.getBBox(),g=f.width,p=f.height;if(d.destroy(),!o){if("value"===r)return{text:h,x:0,y:-p-c};var v=c+l+("horizontal"===i?g/2:0);return(e={text:h})["horizontal"===i?"x":"y"]="start"===t?-v:v,e}var m=0,y=0,w=this.availableSpace,B=w.width,b=w.height,E=this.calcSelectionArea()[1],x=E.x,C=E.y,F=E.width,M=E.height,k=c+l;if("horizontal"===i){var Q=k+g/2;if("start"===t)m=x-k-g>0?-Q:Q;else m=B-x-F-k>g?Q:-Q}else{var S=p+k;y="start"===t?C-l>p?-S:k:b-(C+M)-l>p?S:-k}return{x:m,y:y,text:h}},e.prototype.getHandleLabelStyle=function(t){var e=NW(this.attributes,"handleLabel");return Re(Re(Re({},e),this.calcHandleText(t)),this.inferTextStyle(t))},e.prototype.getHandleIconStyle=function(){var t=this.attributes.handleIconShape,e=NW(this.attributes,"handleIcon"),n=this.getOrientVal(["ew-resize","ns-resize"]),r=this.getHandleSize();return Re({cursor:n,shape:t,size:r},e)},e.prototype.getHandleStyle=function(t){var e=this.attributes,n=e.x,r=e.y,i=e.showLabel,A=e.showLabelOnInteraction,o=e.orientation,s=this.calcHandlePosition(t),a=s.x,c=s.y,l=this.calcHandleText(t),u=i;return!i&&A&&(u=!!this.target),Re(Re(Re({},IW(this.getHandleIconStyle(),"icon")),IW(Re(Re({},this.getHandleLabelStyle(t)),l),"label")),{transform:"translate(".concat(a+n,", ").concat(c+r,")"),orientation:o,showLabel:u,type:t,zIndex:3})},e.prototype.getHandleSize=function(){var t=this.attributes,e=t.handleIconSize,n=t.width,r=t.height;return e||Math.floor((this.getOrientVal([+r,+n])+4)/2.4)},e.prototype.getOrientVal=function(t){var e=Ke(t,2),n=e[0],r=e[1];return"horizontal"===this.attributes.orientation?n:r},e.prototype.setValuesOffset=function(t,e){void 0===e&&(e=0);var n=this.attributes.type,r=Ke(this.getValues(),2),i=[r[0]+("range"===n?t:0),r[1]+e].sort();this.innerSetValues(i,!0)},e.prototype.getRatio=function(t){var e=this.availableSpace,n=e.width,r=e.height;return t/this.getOrientVal([n,r])},e.prototype.dispatchCustomEvent=function(t,e,n){var r=this;t.on(e,function(t){t.stopPropagation(),r.dispatchEvent(new Xs(n,{detail:t}))})},e.prototype.bindEvents=function(){this.addEventListener("wheel",this.onScroll);var t=this.brushArea;this.dispatchCustomEvent(t,"click","trackClick"),this.dispatchCustomEvent(t,"pointerenter","trackMouseenter"),this.dispatchCustomEvent(t,"pointerleave","trackMouseleave"),t.on("pointerdown",this.onDragStart("track"))},e.prototype.onScroll=function(t){if(this.attributes.scrollable){var e=t.deltaX,n=t.deltaY||e,r=this.getRatio(n);this.setValuesOffset(r,r)}},e.tag="slider",e}(GW),hX="grid-group",dX="main-group",fX="line-group",gX="tick-group",pX="label-group",vX="title-group",mX="grid",yX="line",wX="line-first",BX="line-second",bX="tick",EX="tick-item",xX="label",CX="label-item",FX="title",MX={data:[],animate:{enter:!1,update:{duration:100,easing:"ease-in-out-sine",fill:"both"},exit:{duration:100,fill:"both"}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:"black",crossPadding:10,titleFill:"black",titleFontSize:12,titlePosition:"lb",titleSpacing:0,titleTextAlign:"center",titleTextBaseline:"middle",lineArrow:function(){return new Ac({style:{d:[["M",10,10],["L",-10,0],["L",10,-10],["L",0,0],["L",10,10],["Z"]],fill:"black",transformOrigin:"center"}})},labelAlign:"parallel",labelDirection:"positive",labelFontSize:12,labelSpacing:0,gridConnect:"line",gridControlAngles:[],gridDirection:"positive",gridLength:0,gridType:"segment",lineArrowOffset:15,lineArrowSize:10,tickDirection:"positive",tickLength:5,tickLineWidth:1,tickStroke:"black",labelOverlap:[]};xe({},MX,{style:{type:"arc"}}),xe({},MX,{style:{}});var kX=Jz({mainGroup:dX,gridGroup:hX,grid:mX,lineGroup:fX,line:yX,tickGroup:gX,tick:bX,tickItem:EX,labelGroup:pX,label:xX,labelItem:CX,titleGroup:vX,title:FX,lineFirst:wX,lineSecond:BX},"axis"),QX=Jz({lineGroup:"line-group",line:"line",regionGroup:"region-group",region:"region"},"grid");function SX(t){return t.reduce(function(t,e,n){return t.push(je([0===n?"M":"L"],Ke(e),!1)),t},[])}function UX(t,e,n){return"surround"===e.type?function(t,e,n){var r=e.connect,i=void 0===r?"line":r,A=e.center;if("line"===i)return SX(t);if(!A)return[];var o=vW(t[0],A),s=n?0:1;return t.reduce(function(t,e,n){return 0===n?t.push(je(["M"],Ke(e),!1)):t.push(je(["A",o,o,0,0,s],Ke(e),!1)),t},[])}(t,e,n):SX(t)}function TX(t,e,n){var r=n.type,i=n.connect,A=n.center,o=n.closed?[["Z"]]:[],s=Ke([UX(t,n),UX(e.slice().reverse(),n,!0)],2),a=s[0],c=s[1],l=Ke([t[0],e.slice(-1)[0]],2),u=l[0],h=l[1],d=function(t,e){return[a,t,c,e,o].flat()};if("line"===i||"surround"===r)return d([je(["L"],Ke(h),!1)],[je(["L"],Ke(u),!1)]);if(!A)throw new Error("Arc grid need to specified center");var f=Ke([vW(h,A),vW(u,A)],2),g=f[0],p=f[1];return d([je(["A",g,g,0,0,1],Ke(h),!1),je(["L"],Ke(h),!1)],[je(["A",p,p,0,0,0],Ke(u),!1),je(["L"],Ke(u),!1)])}var OX=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),e.prototype.render=function(t,e){t.type,t.center,t.areaFill,t.closed;var n=He(t,["type","center","areaFill","closed"]),r=function(t){var e=t.data,n=void 0===e?[]:e;return t.closed?n.map(function(t){var e=t.points,n=Ke(e,1)[0];return Re(Re({},t),{points:je(je([],Ke(e),!1),[n],!1)})}):n}(t),i=MW(e).maybeAppendByClassName(QX.lineGroup,"g"),A=MW(e).maybeAppendByClassName(QX.regionGroup,"g"),o=function(t,e,n,r){var i=n.animate,A=n.isBillboard,o=e.map(function(t,e){return{id:t.id||"grid-line-".concat(e),d:UX(t.points,n)}});return t.selectAll(QX.line.class).data(o,function(t){return t.id}).join(function(t){return t.append("path").each(function(t,e){var n=qz(xW(Re({d:t.d},r)),[t,e,o]);this.attr(Re({class:QX.line.name,stroke:"#D9D9D9",lineWidth:1,lineDash:[4,4],isBillboard:A},n))})},function(t){return t.transition(function(t,e){return nX(this,qz(xW(Re({d:t.d},r)),[t,e,o]),i.update)})},function(t){return t.transition(function(){var t=this,e=rX(this,i.exit);return $Y(e,function(){return t.remove()}),e})}).transitions()}(i,r,t,n),s=function(t,e,n){var r=n.animate,i=n.connect,A=n.areaFill;if(e.length<2||!A||!i)return[];for(var o=Array.isArray(A)?A:[A,"transparent"],s=function(t){return o[t%o.length]},a=[],c=0;c<e.length-1;c++){var l=Ke([e[c].points,e[c+1].points],2),u=TX(l[0],l[1],n);a.push({d:u,fill:s(c)})}return t.selectAll(QX.region.class).data(a,function(t,e){return e}).join(function(t){return t.append("path").each(function(t,e){var n=qz(t,[t,e,a]);this.attr(n)}).attr("className",QX.region.name)},function(t){return t.transition(function(t,e){return nX(this,qz(t,[t,e,a]),r.update)})},function(t){return t.transition(function(){var t=this,e=rX(this,r.exit);return $Y(e,function(){return t.remove()}),e})}).transitions()}(A,r,t);return je(je([],Ke(o),!1),Ke(s),!1)},e}(GW);function NX(t,e){return Object.fromEntries(Object.entries(t).map(function(t){var n=Ke(t,2);return[n[0],qz(n[1],e)]}))}function IX(t,e){return e&&Vt(e)?t.filter(e):t}function LX(t,e){var n=e.startAngle;return(e.endAngle-n)*t+n}function DX(t,e){if("linear"===e.type){var n=Ke(e.startPos,2),r=n[0],i=n[1],A=Ke(e.endPos,2),o=Ke([A[0]-r,A[1]-i],2);return mW([o[0],o[1]])}var s=Wz(LX(t,e));return[-Math.sin(s),Math.cos(s)]}function PX(t,e,n){return function(t,e){return e?[t[1],-t[0]]:[-t[1],t[0]]}(DX(t,n),"positive"!==e)}function RX(t,e){return PX(t,e.labelDirection,e)}function HX(t,e,n){return n?"".concat(t," ").concat(n,"axis-").concat(e):t}function _X(t,e,n,r){return r&&t.attr("className",HX(e.name,n,r)),t}function GX(t,e){return"linear"===e.type?function(t,e){var n=Ke(e.startPos,2),r=n[0],i=n[1],A=Ke(e.endPos,2),o=Ke([A[0]-r,A[1]-i],2);return[r+o[0]*t,i+o[1]*t]}(t,e):function(t,e){var n=e.radius,r=Ke(e.center,2),i=r[0],A=r[1],o=Wz(LX(t,e));return[i+n*Math.cos(o),A+n*Math.sin(o)]}(t,e)}function KX(t){return 0===DX(0,t)[1]}function jX(t){return 0===DX(0,t)[0]}function VX(t,e){return e-t===360}function zX(t,e,n,r,i){var A=e-t,o=Ke([i,i],2),s=o[0],a=o[1],c=Ke([Wz(t),Wz(e)],2),l=c[0],u=c[1],h=function(t){return[n+i*Math.cos(t),r+i*Math.sin(t)]},d=Ke(h(l),2),f=d[0],g=d[1],p=Ke(h(u),2),v=p[0],m=p[1];if(VX(t,e)){var y=Ke(h((u+l)/2),2);return[["M",f,g],["A",s,a,0,1,0,y[0],y[1]],["A",s,a,0,1,0,v,m]]}var w=A>180?1:0,B=t>e?0:1;return"M".concat(f,",").concat(g,",A").concat(s,",").concat(a,",0,").concat(w,",").concat(B,",").concat(v,",").concat(m)}function WX(t,e,n,r){var i=e.startAngle,A=e.endAngle,o=e.center,s=e.radius,a=e.classNamePrefix;return t.selectAll(kX.line.class).data([{d:zX.apply(void 0,je(je([i,A],Ke(o),!1),[s],!1))}],function(t,e){return e}).join(function(t){var n=t.append("path").attr("className",kX.line.name).styles(e).styles({d:function(t){return t.d}});return _X(n,kX.line,yX,a),n},function(t){return t.transition(function(){var t=this,e=function(t,e,n,r){if(!r)return t.attr("__keyframe_data__",n),null;var i=r.duration,A=void 0===i?0:i,o=uW(e,n),s=Math.ceil(+A/16),a=new Array(s).fill(0).map(function(t,e,n){return{__keyframe_data__:o(e/(n.length-1))}});return t.animate(a,Re({fill:"both"},r))}(this,function(t){var e=t.attributes,n=e.startAngle,r=e.endAngle,i=e.center,A=e.radius;return je(je([n,r],Ke(i),!1),[A],!1)}(this),je(je([i,A],Ke(o),!1),[s],!1),r.update);if(e){var n=function(){var e=ke(t.attributes,"__keyframe_data__");t.style.d=zX.apply(void 0,je([],Ke(e),!1))};e.onframe=n,e.onfinish=n}return e}).styles(e)},function(t){return t.remove()}).styles(n).transitions()}function YX(t){var e=Ke(t,2),n=Ke(e[0],2),r=n[0],i=n[1],A=Ke(e[1],2);return{x1:r,y1:i,x2:A[0],y2:A[1]}}function XX(t,e,n,r){var i=e.showTrunc,A=e.startPos,o=e.endPos,s=e.truncRange,a=e.lineExtension,c=e.classNamePrefix,l=Ke([A,o],2),u=Ke(l[0],2),h=u[0],d=u[1],f=Ke(l[1],2),g=f[0],p=f[1],v=Ke(a?function(t,e,n){void 0===n&&(n=[0,0]);var r=Ke([t,e,n],3),i=Ke(r[0],2),A=i[0],o=i[1],s=Ke(r[1],2),a=s[0],c=s[1],l=Ke(r[2],2),u=l[0],h=l[1],d=Ke([a-A,c-o],2),f=d[0],g=d[1],p=Math.sqrt(Math.pow(f,2)+Math.pow(g,2)),v=Ke([-u/p,h/p],2),m=v[0],y=v[1];return[m*f,m*g,y*f,y*g]}(A,o,a):new Array(4).fill(0),4),m=v[0],y=v[1],w=v[2],B=v[3],b=function(e){return t.selectAll(kX.line.class).data(e,function(t,e){return e}).join(function(t){var e=t.append("line").styles(n).transition(function(t){return nX(this,YX(t.line),!1)});return e.attr("className",function(t){if(!c)return"".concat(kX.line.name," ").concat(t.className);var e=HX(kX.line.name,yX,c);if(t.className===kX.lineFirst.name){var n=HX(kX.lineFirst.name,wX,c);return"".concat(e," ").concat(n)}if(t.className===kX.lineSecond.name){n=HX(kX.lineSecond.name,BX,c);return"".concat(e," ").concat(n)}return e}),e},function(t){return t.styles(n).transition(function(t){return nX(this,YX(t.line),r.update)})},function(t){return t.remove()}).transitions()};if(!i||!s)return b([{line:[[h+m,d+y],[g+w,p+B]],className:kX.line.name}]);var E=Ke(s,2),x=E[0],C=E[1],F=g-h,M=p-d,k=Ke([h+F*x,d+M*x],2),Q=k[0],S=k[1],U=Ke([h+F*C,d+M*C],2),T=U[0],O=U[1],N=b([{line:[[h+m,d+y],[Q,S]],className:kX.lineFirst.name},{line:[[T,O],[g+w,p+B]],className:kX.lineSecond.name}]);return function(t,e){e.truncRange,e.truncShape,e.lineExtension}(0,e),N}function qX(t,e,n){var r,i=e.type,A=NW(e,"line");return r="linear"===i?XX(t,e,wW(A,"arrow"),n):WX(t,e,wW(A,"arrow"),n),function(t,e,n,r){var i,A=n.showArrow,o=n.showTrunc,s=n.lineArrow,a=n.lineArrowOffset,c=n.lineArrowSize;if(i="arc"===e?t.select(kX.line.class):o?t.select(kX.lineSecond.class):t.select(kX.line.class),!A||!s||"arc"===n.type&&VX(n.startAngle,n.endAngle)){var l=i.node();l&&(l.style.markerEnd=void 0)}else{var u=aW(s);u.attr(r),CW(u,c),i.style("markerEnd",u).style("markerEndOffset",-a)}}(t,i,e,A),r}function ZX(t){var e=t.type,n=t.gridCenter;return"linear"===e?n:n||t.center}function JX(t,e){var n=e.gridLength;return t.map(function(t,r){var i=t.value,A=Ke(GX(i,e),2),o=A[0],s=A[1],a=Ke(hW(function(t,e){return PX(t,e.gridDirection,e)}(i,e),n),2);return{id:r,points:[[o,s],[o+a[0],s+a[1]]]}})}function $X(t,e,n,r){var i=n.classNamePrefix,A=NW(n,"grid"),o=A.type,s=A.areaFill,a=ZX(n),c=IX(e,n.gridFilter),l="segment"===o?JX(c,n):function(t,e){var n=e.gridControlAngles,r=ZX(e);if(!r)throw new Error("grid center is not provide");if(t.length<2)throw new Error("Invalid grid data");if(!n||0===n.length)throw new Error("Invalid gridControlAngles");var i=Ke(r,2),A=i[0],o=i[1];return t.map(function(t,r){var i=Ke(GX(t.value,e),2),s=i[0],a=i[1],c=Ke([s-A,a-o],2),l=c[0],u=c[1],h=[];return n.forEach(function(t){var e=Wz(t),n=Ke([Math.cos(e),Math.sin(e)],2),r=n[0],i=n[1],s=l*r-u*i+A,a=l*i+u*r+o;h.push([s,a])}),{points:h,id:r}})}(c,n),u=Re(Re({},A),{center:a,areaFill:Vt(s)?c.map(function(t,e){return qz(s,[t,e,c])}):s,animate:r,data:l});return t.selectAll(kX.grid.class).data([1]).join(function(t){var e=t.append(function(){return new OX({style:u})}).attr("className",kX.grid.name);return _X(e,kX.grid,mX,i),e},function(t){return t.transition(function(){return this.update(u)})},function(t){return t.remove()}).transitions()}var tq=function(){function t(t,e,n,r){this.set(t,e,n,r)}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.defined("x2")&&this.defined("x1")?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.defined("y2")&&this.defined("y1")?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),t.prototype.rotatedPoints=function(t,e,n){var r=this,i=r.x1,A=r.y1,o=r.x2,s=r.y2,a=Math.cos(t),c=Math.sin(t),l=e-e*a+n*c,u=n-e*c-n*a;return[[a*i-c*s+l,c*i+a*s+u],[a*o-c*s+l,c*o+a*s+u],[a*i-c*A+l,c*i+a*A+u],[a*o-c*A+l,c*o+a*A+u]]},t.prototype.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},t.prototype.defined=function(t){return this[t]!==Number.MAX_VALUE&&this[t]!==-Number.MAX_VALUE},t}();function eq(t,e){var n=t.getEulerAngles()||0;t.setEulerAngles(0);var r=t.getBounds(),i=Ke(r.min,2),A=i[0],o=i[1],s=Ke(r.max,2),a=s[0],c=s[1],l=t.getBBox(),u=l.width,h=l.height,d=0,f=0,g=A,p=o,v=iW(t);if(v){h-=1.5;var m=v.style.textAlign,y=v.style.textBaseline;"center"===m?g=(A+a)/2:"right"!==m&&"end"!==m||(g=a),"middle"===y?p=(o+c)/2:"bottom"===y&&(p=c)}var w=Ke(kW(e),4),B=w[0],b=void 0===B?0:B,E=w[1],x=void 0===E?0:E,C=w[2],F=void 0===C?b:C,M=w[3],k=new tq((d+=A)-(void 0===M?x:M),(f+=o)-b,d+u+x,f+h+F);return t.setEulerAngles(n),k.rotatedPoints(Wz(n),g,p)}function nq(t,e){return e[0]<=Math.max(t[0][0],t[1][0])&&e[0]<=Math.min(t[0][0],t[1][0])&&e[1]<=Math.max(t[0][1],t[1][1])&&e[1]<=Math.min(t[0][1],t[1][1])}function rq(t,e,n){var r=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return 0===r?0:r<0?2:1}function iq(t,e){var n=rq(t[0],t[1],e[0]),r=rq(t[0],t[1],e[1]),i=rq(e[0],e[1],t[0]),A=rq(e[0],e[1],t[1]);return n!==r&&i!==A||(!(0!==n||!nq(t,e[0]))||(!(0!==r||!nq(t,e[1]))||(!(0!==i||!nq(e,t[0]))||!(0!==A||!nq(e,t[1])))))}function Aq(t,e){return e.every(function(e){return function(t,e){var n=t.length;if(n<3)return!1;var r=[e,[9999,e[1]]],i=0,A=0;do{var o=[t[A],t[(A+1)%n]];if(iq(o,r)){if(0===rq(o[0],e,o[1]))return nq(o,e);i++}A=(A+1)%n}while(0!==A);return!!(1&i)}(t,e)})}function oq(t,e){return[[t[0],t[1],t[2],t[3]],[t[2],t[3],t[4],t[5]],[t[4],t[5],t[6],t[7]],[t[6],t[7],t[0],t[1]]].some(function(t){return function(t,e){var n=Ke(t,4),r=n[0],i=n[1],A=n[2],o=n[3],s=Ke(e,4),a=s[0],c=s[1],l=A-r,u=o-i,h=s[2]-a,d=s[3]-c,f=l*d-h*u;if(0===f)return!1;var g=f>0,p=r-a,v=i-c,m=l*v-u*p;if(m<0===g)return!1;var y=h*v-d*p;return y<0!==g&&m>f!==g&&y>f!==g}(e,t)})}function sq(t,e,n){var r,i,A=e.crossPadding,o=new Set,s=null,a=function(t,e){var n=t.type,r=t.labelDirection,i=t.crossSize;if(!i)return!1;if("arc"===n){var A=t.center,o=t.radius,s=Ke(A,2),a=s[0],c=s[1],l="negative"===r?0:i,u=-o-l,h=o+l,d=Ke(kW(e),4),f=d[0],g=d[1],p=d[2],v=d[3];return new tq(a+u-v,c+u-f,a+h+g,c+h+p)}var m=Ke(t.startPos,2),y=m[0],w=m[1],B=Ke(t.endPos,2),b=B[0],E=B[1],x=Ke(jX(t)?[-e,0,e,0]:[0,e,0,-e],4),C=x[0],F=x[1],M=x[2],k=x[3],Q=hW(RX(0,t),i),S=new tq(y,w,b,E);return S.x1+=k,S.y1+=C,S.x2+=F+Q[0],S.y2+=M+Q[1],S}(e,A),c=function(t){return!a||function(t,e,n){var r=t.x1,i=t.x2,A=t.y1,o=t.y2;return Aq([[r,A],[i,A],[i,o],[r,o]],eq(e,n))}(a,t)},l=function(t,e){return!t||!t.firstChild||!function(t,e,n){var r,i,A=eq(t,n).flat(1),o=eq(e,n).flat(1),s=[[A[0],A[1],A[2],A[3]],[A[0],A[1],A[4],A[5]],[A[4],A[5],A[6],A[7]],[A[2],A[3],A[6],A[7]]];try{for(var a=Ge(s),c=a.next();!c.done;c=a.next())if(oq(o,c.value))return!0}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return!1}(t.firstChild,e.firstChild,kW(n))};try{for(var u=Ge(t),h=u.next();!h.done;h=u.next()){var d=h.value;c(d)?!s||l(s,d)?s=d:(o.add(s),o.add(d)):o.add(d)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return Array.from(o)}function aq(t,e){return void 0===e&&(e={}),zt(t)?0:"number"==typeof t?t:Math.floor(nW(t,e))}var cq=function(t,e){var n=e.seq,r=void 0===n?2:n;return t.filter(function(t,e){return!(e%r)||(Gz(t),!1)})},lq=function(t){return t.filter(eW)};var uq=new Map([["hide",function(t,e,n,r){var i=t.length,A=e.keepHeader,o=e.keepTail;if(!(i<=1||2===i&&A&&o)){var s,a,c=cq,l=function(t){return t.forEach(r.show),t},u=2,h=t.slice(),d=t.slice(),f=Math.min.apply(Math,je([1],Ke(t.map(function(t){return t.getBBox().width})),!1));if("linear"===n.type&&(KX(n)||jX(n))){var g=QW(t[0]).left,p=QW(t[i-1]).right,v=Math.abs(p-g)||1;u=Math.max(Math.floor(i*f/v),u)}for(A&&(s=h.splice(0,1)[0]),o&&(a=h.splice(-1,1)[0],h.reverse()),l(h);u<t.length&&sq(lq(a?je(je([a],Ke(d),!1),[s],!1):je([s],Ke(d),!1)),n,null==e?void 0:e.margin).length;){if(a&&!s&&u%2==0)h.splice(0,1).forEach(r.hide);else if(a&&s){h.splice(0,1).forEach(r.hide)}d=c(l(h),{seq:u}),u++}}}],["rotate",function(t,e,n,r){var i,A,o=e.optionalAngles,s=void 0===o?[0,45,90]:o,a=e.margin,c=e.recoverWhenFailed,l=void 0===c||c,u=t.map(function(t){return t.getLocalEulerAngles()}),h=function(){return sq(t,n,a).length<1},d=function(e){return t.forEach(function(t,n){var i=Array.isArray(e)?e[n]:e;r.rotate(t,+i)})};try{for(var f=Ge(s),g=f.next();!g.done;g=f.next()){if(d(g.value),h())return}}catch(t){i={error:t}}finally{try{g&&!g.done&&(A=f.return)&&A.call(f)}finally{if(i)throw i.error}}l&&d(u)}],["ellipsis",function(t,e,n,r){if(!(t.length<=0)){var i=e.suffix,A=void 0===i?"...":i,o=e.minLength,s=e.maxLength,a=void 0===s?1/0:s,c=e.step,l=void 0===c?" ":c,u=e.margin,h=void 0===u?[0,0,0,0]:u,d=rW(r.getTextShape(t[0])),f=aq(l,d),g=o?aq(o,d):f,p=aq(a,d);(zt(p)||p===1/0)&&(p=Math.max.apply(null,t.map(function(t){return t.getBBox().width})));var v=t.slice(),m=Ke(h,4);m[0],m[1],m[2],m[3];for(var y=function(e){if(v.forEach(function(t){r.ellipsis(r.getTextShape(t),e,A)}),(v=sq(t,n,h)).length<1)return{value:void 0}},w=p;w>g+f;w-=f){var B=y(w);if("object"==typeof B)return B.value}}}],["wrap",function(t,e,n,r,i){var A,o=e.maxLines,s=void 0===o?3:o,a=e.recoverWhenFailed,c=void 0===a||a,l=e.margin,u=void 0===l?[0,0,0,0]:l,h=qz(null!==(A=e.wordWrapWidth)&&void 0!==A?A:50,[i]),d=t.map(function(t){return t.attr("maxLines")||1}),f=Math.min.apply(Math,je([],Ke(d),!1)),g=function(){return sq(t,n,u).length<1},p=function(t){var e=t.type,n=t.labelDirection;return"linear"===e&&KX(t)?"negative"===n?"bottom":"top":"middle"}(n),v=function(e){return t.forEach(function(t,n){var i=Array.isArray(e)?e[n]:e;r.wrap(t,h,i,p)})};if(!(f>s)){if("linear"===n.type&&KX(n)){if(v(s),g())return}else for(var m=f;m<=s;m++)if(v(m),g())return;c&&v(d)}}]]);function hq(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.reduce(function(t,e){return t*function(t){return"positive"===t?-1:1}(e)},1)}function dq(t){for(var e=t;e<0;)e+=360;return Math.round(e%360)}function fq(t,e){var n=Ke(t,2),r=n[0],i=n[1],A=Ke(e,2),o=A[0],s=A[1],a=Ke([r*o+i*s,r*s-i*o],2),c=a[0],l=a[1];return Math.atan2(l,c)}function gq(t,e,n){var r,i=n.labelAlign;if(null===(r=e.style.transform)||void 0===r?void 0:r.includes("rotate"))return e.getLocalEulerAngles();var A=RX(t.value,n),o=DX(t.value,n);return"horizontal"===i?0:function(t){var e=(t+360)%180;return lW(e,-90,90)||(e+=180),e}(Yz("perpendicular"===i?fq([1,0],A):fq([o[0]<0?-1:1,0],o)))}function pq(t,e,n){var r=n.type,i=n.labelAlign,A=RX(t,n),o=dq(e),s=dq(Yz(fq([1,0],A))),a="center",c="middle";return"linear"===r?[90,270].includes(s)&&0===o?(a="center",c=1===A[1]?"top":"bottom"):s%180||![90,270].includes(o)?0===s?(lW(o,0,90,!1,!0)||lW(o,0,90)||lW(o,270,360))&&(a="start"):90===s?lW(o,0,90,!1,!0)?a="start":(lW(o,90,180)||lW(o,270,360))&&(a="end"):270===s?lW(o,0,90,!1,!0)?a="end":(lW(o,90,180)||lW(o,270,360))&&(a="start"):180===s&&(90===o?a="start":(lW(o,0,90)||lW(o,270,360))&&(a="end")):a="center":"parallel"===i?c=lW(s,0,180,!0)?"top":"bottom":"horizontal"===i?lW(s,90,270,!1)?a="end":(lW(s,270,360,!1)||lW(s,0,90))&&(a="start"):"perpendicular"===i&&(a=lW(s,90,270)?"end":"start"),{textAlign:a,textBaseline:c}}function vq(t,e,n){var r=n.showTick,i=n.tickLength,A=n.tickDirection,o=n.labelDirection,s=n.labelSpacing,a=e.indexOf(t),c=qz(s,[t,a,e]),l=Ke([RX(t.value,n),hq(o,A)],2),u=Ke(dW(hW(l[0],c+(1===l[1]?qz(r?i:0,[t,a,e]):0)),GX(t.value,n)),2);return{x:u[0],y:u[1]}}function mq(t,e,n,r){var i=r.labelRender,A=(ke(r,"endPos.0",400)-ke(r,"startPos.0",0))/n.length,o=Vt(i)?qz(i,[t,e,n,RX(t.value,r)]):t.label||"",s=function(t){var e=(new DOMParser).parseFromString(t,"text/html").body.firstElementChild;if(console.log(null==e?void 0:e.getClientRects(),11),!e)return 0;var n=e.getAttribute("style")||"",r=Object.fromEntries(n.split(";").map(function(t){return t.trim()}).filter(function(t){return t.includes(":")}).map(function(t){var e=Ke(t.split(":").map(function(t){return t.trim()}),2),n=e[0],r=e[1];return[n.toLowerCase(),r]})),i=function(t){if(!t)return 0;var e=t.match(/([\d.]+)px/);return e?parseFloat(e[1]):0};if(r.height)return i(r.height);var A,o=i(r["font-size"])||16,s=r["line-height"];A=s&&"normal"!==s?s.endsWith("px")?i(s):/^[\d.]+$/.test(s)?parseFloat(s)*o:o:1.2*o;var a=i(r["padding-top"]),c=i(r["padding-bottom"]);r.padding&&(1===(l=r.padding.split(/\s+/).map(i)).length||2===l.length?(a=l[0],c=l[0]):(3===l.length||4===l.length)&&(a=l[0],c=l[2]));var l,u=i(r["border-top-width"]),h=i(r["border-bottom-width"]);if(r.border){var d=r.border.match(/([\d.]+)px/);d&&(u=parseFloat(d[1]),h=parseFloat(d[1]))}return r["border-width"]&&(1===(l=r["border-width"].split(/\s+/).map(i)).length||2===l.length?(u=l[0],h=l[0]):(3===l.length||4===l.length)&&(u=l[0],h=l[2])),A+a+c+u+h}(o)||30;return function(){return e={width:A,height:s},"function"==typeof(t=o)?t():ne(t)||oe(t)?new tc({style:Re(Re({pointerEvents:"auto"},e),{innerHTML:t})}):t;var t,e}}var yq={html:["fill"],text:[]};function wq(t,e){["text","html"].includes(t.nodeName)&&t.attr(wW(e,yq[t.nodeName]))}function Bq(t,e){!function(t,e,n,r){var i=e.labelOverlap,A=void 0===i?[]:i;A.length&&A.forEach(function(i){var A=i.type,o=uq.get(A);(function(t,e,n){return!(e.labelOverlap.length<1)&&("hide"===n?!function(t){for(var e=t;e;){if("offscreen"===e.className)return!0;e=e.parent}return!1}(t[0]):"rotate"===n?!t.some(function(t){var e;return!!(null===(e=t.attr("transform"))||void 0===e?void 0:e.includes("rotate"))}):"ellipsis"!==n&&"wrap"!==n||t.filter(function(t){return t.querySelector("text")}).length>=1)})(t,e,A)&&(null==o||o(t,i,e,r,n))})}(this.node().childNodes,t,e,{hide:Gz,show:_z,rotate:function(e,n){!function(t,e,n){e.setLocalEulerAngles(t);var r=pq(e.__data__.value,t,n),i=e.querySelector(kX.labelItem.class);i&&wq(i,r)}(+n,e,t)},ellipsis:function(t,e,n){t&&oW(t,e||1/0,n)},wrap:function(t,e,n){var r,i;t&&(void 0===(r=n)&&(r=2),void 0===i&&(i="top"),AW(t,{wordWrap:!0,wordWrapWidth:e,maxLines:r,textBaseline:i}))},getTextShape:function(t){return t.querySelector(kX.labelItem.class)}})}function bq(t,e,n,r,i){var A=n.indexOf(e),o=i.labelRender,s=i.classNamePrefix,a=MW(t).append(o?mq(e,A,n,i):function(t,e,n,r){var i=r.labelFormatter;return Vt(i)?function(){return aW(qz(i,[t,e,n,RX(t.value,r)]))}:function(){return aW(t.label||"")}}(e,A,n,i)).attr("className",kX.labelItem.name).node();_X(MW(a),kX.labelItem,CX,s);var c=Ke(LW(NX(r,[e,A,n])),2),l=c[0],u=c[1],h=u.transform,d=He(u,["transform"]);PW(a,h);var f=gq(e,a,i);if(a.getLocalEulerAngles()||a.setLocalEulerAngles(f),wq(a,Re(Re({},pq(e.value,f,i)),l)),"html"===a.nodeName){var g=a.getBBox(),p=a.style.x||0;a.attr("x",p-g.width/2)}return t.attr(d),a}function Eq(t,e,n,r,i){var A,o,s,a=n.classNamePrefix,c=IX(e,n.labelFilter),l=NW(n,"label"),u=t.selectAll(kX.label.class).data(c,function(t,e){return e}).join(function(t){var r=t.append("g").attr("className",kX.label.name).transition(function(t){bq(this,t,e,l,n);var r=vq(t,e,n),i=r.x,A=r.y;return this.style.transform="translate(".concat(i,", ").concat(A,")"),null});return _X(r,kX.label,xX,a),r},function(t){return t.transition(function(t){var i=function(t,e,n,r){if(void 0===r&&(r="destroy"),function(t,e){return"text"===t.nodeName&&"text"===e.nodeName&&t.attributes.text===e.attributes.text}(t,e))return t.remove(),[null];var i=function(){"destroy"===r?t.destroy():"hide"===r&&Gz(t),e.isVisible()&&_z(e)};if(!n)return i(),[null];var A=n.duration,o=void 0===A?0:A,s=n.delay,a=void 0===s?0:s,c=Math.ceil(+o/2),l=+o/4,u=Ke(t.getGeometryBounds().center,2),h=u[0],d=u[1],f=Ke(e.getGeometryBounds().center,2),g=Ke([(h+f[0])/2-h,(d+f[1])/2-d],2),p=g[0],v=g[1],m=t.style.opacity,y=void 0===m?1:m,w=e.style.opacity,B=void 0===w?1:w,b=t.style.transform||"",E=e.style.transform||"",x=t.animate([{opacity:y,transform:"translate(0, 0) ".concat(b)},{opacity:0,transform:"translate(".concat(p,", ").concat(v,") ").concat(b)}],Re(Re({fill:"both"},n),{duration:a+c+l})),C=e.animate([{opacity:0,transform:"translate(".concat(-p,", ").concat(-v,") ").concat(E),offset:.01},{opacity:B,transform:"translate(0, 0) ".concat(E)}],Re(Re({fill:"both"},n),{duration:c+l,delay:a+c-l}));return $Y(C,i),[x,C]}(this.querySelector(kX.labelItem.class),bq(this,t,e,l,n),r.update),A=vq(t,e,n),o=A.x,s=A.y,a=nX(this,{transform:"translate(".concat(o,", ").concat(s,")")},r.update);return je(je([],Ke(i),!1),[a],!1)})},function(t){return A=t,t.transition(function(){var t=this,e=rX(this.childNodes[0],r.exit);return $Y(e,function(){return MW(t).remove()}),e}),A}).transitions();return s=function(){Bq.call(t,n,i)},0===(o=u).length?s():Promise.all(o.map(function(t){return null==t?void 0:t.finished})).then(s),u}function xq(t,e){return PX(t,e.tickDirection,e)}function Cq(t,e,n,r,i){var A=Ke(function(t,e){var n=Ke(t,2);return[[0,0],[n[0]*e,n[1]*e]]}(r,qz(i.tickLength,[t,e,n])),2),o=Ke(A[0],2),s=o[0],a=o[1],c=Ke(A[1],2);return{x1:s,x2:c[0],y1:a,y2:c[1]}}function Fq(t,e,n,r,i,A){var o=function(t,e,n,r,i){var A=i.tickFormatter,o=i.classNamePrefix,s=xq(e.value,i),a="line";Vt(A)&&(a=function(){return qz(A,[e,n,r,s])});var c=t.append(a).attr("className",kX.tickItem.name);return _X(c,kX.tickItem,EX,o),c}(MW(this),t,e,n,r);!function(t,e,n,r,i,A,o){var s=xq(t.value,A),a=Cq(t,e,n,s,A),c=a.x1,l=a.x2,u=a.y1,h=a.y2,d=Ke(LW(NX(o,[t,e,n,s])),2),f=d[0],g=d[1];"line"===r.node().nodeName&&r.styles(Re({x1:c,x2:l,y1:u,y2:h},f)),i.attr(g),r.styles(f)}(t,e,n,o,this,r,i);var s=Ke(GX(t.value,r),2),a=s[0],c=s[1];return nX(this,{transform:"translate(".concat(a,", ").concat(c,")")},A)}function Mq(t,e,n,r,i){var A=Ke(LW(NW(r,"title")),2),o=A[0],s=A[1],a=s.transform,c=s.transformOrigin,l=He(s,["transform","transformOrigin"]);e.styles(l);var u=a||function(t,e,n){var r=2*t.getGeometryBounds().halfExtents[1];if("vertical"===e){if("left"===n)return"rotate(-90) translate(0, ".concat(r/2,")");if("right"===n)return"rotate(-90) translate(0, -".concat(r/2,")")}return""}(t.node(),o.direction,o.position);t.styles(Re(Re({},o),{transformOrigin:c})),PW(t.node(),u);var h=function(t,e,n){var r=n.titlePosition,i=void 0===r?"lb":r,A=n.titleSpacing,o=HW(i),s=t.node().getLocalBounds(),a=Ke(s.min,2),c=a[0],l=a[1],u=Ke(s.halfExtents,2),h=u[0],d=u[1],f=Ke(e.node().getLocalBounds().halfExtents,2),g=f[0],p=f[1],v=Ke([c+h,l+d],2),m=v[0],y=v[1],w=Ke(kW(A),4),B=w[0],b=w[1],E=w[2],x=w[3];if(["start","end"].includes(i)&&"linear"===n.type){var C=n.startPos,F=n.endPos,M=Ke("start"===i?[C,F]:[F,C],2),k=M[0],Q=M[1],S=Ke(hW(mW([-Q[0]+k[0],-Q[1]+k[1]]),B),2),U=S[0],T=S[1];return{x:k[0]+U,y:k[1]+T}}return o.includes("t")&&(y-=d+p+B),o.includes("r")&&(m+=h+g+b),o.includes("l")&&(m-=h+g+x),o.includes("b")&&(y+=d+p+E),{x:m,y:y}}(MW(n._offscreen||n.querySelector(kX.mainGroup.class)),e,r),d=h.x,f=h.y;return nX(e.node(),{transform:"translate(".concat(d,", ").concat(f,")")},i)}function kq(t,e,n,r){var i=t.showLine,A=t.showTick,o=t.showLabel,s=t.classNamePrefix,a=e.maybeAppendByClassName(kX.lineGroup,"g");_X(a,kX.lineGroup,fX,s);var c=cW(i,a,function(e){return qX(e,t,r)})||[],l=e.maybeAppendByClassName(kX.tickGroup,"g");_X(l,kX.tickGroup,gX,s);var u=cW(A,l,function(e){return function(t,e,n,r){var i=n.classNamePrefix,A=IX(e,n.tickFilter),o=NW(n,"tick");return t.selectAll(kX.tick.class).data(A,function(t){return t.id||t.label}).join(function(t){var e=t.append("g").attr("className",kX.tick.name).transition(function(t,e){return Fq.call(this,t,e,A,n,o,!1)});return _X(e,kX.tick,bX,i),e},function(t){return t.transition(function(t,e){return this.removeChildren(),Fq.call(this,t,e,A,n,o,r.update)})},function(t){return t.transition(function(){var t=this,e=rX(this.childNodes[0],r.exit);return $Y(e,function(){return t.remove()}),e})}).transitions()}(e,n,t,r)})||[],h=e.maybeAppendByClassName(kX.labelGroup,"g");_X(h,kX.labelGroup,pX,s);var d=cW(o,h,function(i){return Eq(i,n,t,r,e.node())})||[];return je(je(je([],Ke(c),!1),Ke(u),!1),Ke(d),!1).filter(function(t){return!!t})}var Qq=function(t){function e(e){return t.call(this,e,MX)||this}return Pe(e,t),e.prototype.render=function(t,e,n){var r=this,i=t.titleText,A=t.data,o=t.animate,s=t.showTitle,a=t.showGrid,c=t.dataThreshold,l=t.truncRange,u=t.classNamePrefix,h=e.className||"axis";u?e.attr("className","".concat(h," ").concat(u,"axis")):e.className||e.attr("className","axis");var d=function(t,e){if(t.length<=e)return t;for(var n=Math.floor(t.length/e),r=[],i=0;i<t.length;i+=n)r.push(t[i]);return r}(A,c).filter(function(t){var e=t.value;return!(l&&e>l[0]&&e<l[1])}),f=JY(void 0===n?o:n),g=MW(e).maybeAppendByClassName(kX.gridGroup,"g");_X(g,kX.gridGroup,hX,u);var p=cW(a,g,function(e){return $X(e,d,t,f)})||[],v=MW(e).maybeAppendByClassName(kX.mainGroup,"g");_X(v,kX.mainGroup,dX,u),i&&(!this.initialized&&f.enter||this.initialized&&f.update)&&kq(t,MW(this.offscreenGroup),d,JY(!1));var m=kq(t,MW(v.node()),d,f),y=MW(e).maybeAppendByClassName(kX.titleGroup,"g");_X(y,kX.titleGroup,vX,u);var w=cW(s,y,function(e){return function(t,e,n,r){var i=n.titleText,A=n.classNamePrefix;return t.selectAll(kX.title.class).data([{title:i}].filter(function(t){return!!t.title}),function(t,e){return t.title}).join(function(o){var s=o.append(function(){return aW(i)}).attr("className",kX.title.name).transition(function(){return Mq(MW(this),t,e,n,r.enter)});return _X(s,kX.title,FX,A),s},function(i){return i.transition(function(){return Mq(MW(this),t,e,n,r.update)})},function(t){return t.remove()}).transitions()}(e,r,t,f)})||[];return je(je(je([],Ke(p),!1),Ke(m),!1),Ke(w),!1).flat().filter(function(t){return!!t})},e}(GW);function Sq(t,e,n){return n?"".concat(t," ").concat(n,"legend-").concat(e):t}function Uq(t,e,n){return void 0===t&&(t="horizontal"),"horizontal"===t?e:n}qW.registerSymbol("hiddenHandle",function(t,e,n){var r=1.4*n;return[["M",t-n,e-r],["L",t+n,e-r],["L",t+n,e+r],["L",t-n,e+r],["Z"]]}),qW.registerSymbol("verticalHandle",function(t,e,n){var r=1.4*n,i=n/2,A=n/6,o=t+.4*r;return[["M",t,e],["L",o,e+i],["L",t+r,e+i],["L",t+r,e-i],["L",o,e-i],["Z"],["M",o,e+A],["L",t+r-2,e+A],["M",o,e-A],["L",t+r-2,e-A]]}),qW.registerSymbol("horizontalHandle",function(t,e,n){var r=1.4*n,i=n/2,A=n/6,o=e+.4*r;return[["M",t,e],["L",t-i,o],["L",t-i,e+r],["L",t+i,e+r],["L",t+i,o],["Z"],["M",t-A,o],["L",t-A,e+r-2],["M",t+A,o],["L",t+A,e+r-2]]});var Tq="title",Oq="item",Nq="marker",Iq="label",Lq="value",Dq="focus-icon",Pq="background",Rq="handle-marker",Hq="handle-label",_q="prev-btn",Gq="next-btn",Kq="page-info",jq=Jz({markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label"},"handle"),Vq={showLabel:!0,formatter:function(t){return t.toString()},markerSize:25,markerStroke:"#c5c5c5",markerFill:"#fff",markerLineWidth:1,labelFontSize:12,labelFill:"#c5c5c5",labelText:"",orientation:"vertical",spacing:0};!function(t){function e(e){return t.call(this,e,Vq)||this}Pe(e,t),e.prototype.render=function(t,e){var n=MW(e).maybeAppendByClassName(jq.markerGroup,"g");this.renderMarker(n);var r=MW(e).maybeAppendByClassName(jq.labelGroup,"g");this.renderLabel(r)},e.prototype.renderMarker=function(t){var e=this,n=this.attributes,r=n.orientation,i=n.classNamePrefix,A=n.markerSymbol,o=void 0===A?Uq(r,"horizontalHandle","verticalHandle"):A;cW(!!o,t,function(t){var n=NW(e.attributes,"marker"),r=Re({symbol:o},n),A=Sq(jq.marker.name,Rq,i);if(e.marker=t.maybeAppendByClassName(jq.marker,function(){return new qW({style:r,className:A})}).update(r),i){var s=e.marker.node().querySelector(".marker");if(s){var a=Sq((s.getAttribute("class")||"").split(" ")[0],Rq,i);s.setAttribute("class",a)}}})},e.prototype.renderLabel=function(t){var e=this,n=this.attributes,r=n.showLabel,i=n.orientation,A=n.spacing,o=void 0===A?0:A,s=n.formatter,a=n.classNamePrefix;cW(r,t,function(t){var n,r=NW(e.attributes,"label"),A=r.text,c=He(r,["text"]),l=(null===(n=t.select(jq.marker.class))||void 0===n?void 0:n.node().getBBox())||{},u=l.width,h=void 0===u?0:u,d=l.height,f=Ke(Uq(i,[0,(void 0===d?0:d)+o,"center","top"],[h+o,0,"start","middle"]),4),g=f[0],p=f[1],v=f[2],m=f[3],y=Sq(jq.label.name,Hq,a);t.maybeAppendByClassName(jq.label,"text").attr("className",y).styles(Re(Re({},c),{x:g,y:p,text:s(A).toString(),textAlign:v,textBaseline:m}))})}}(GW);var zq={showTitle:!0,padding:0,orientation:"horizontal",backgroundFill:"transparent",titleText:"",titleSpacing:4,titlePosition:"top-left",titleFill:"#2C3542",titleFontWeight:"bold",titleFontFamily:"sans-serif",titleFontSize:12},Wq=tW({},zq,{});tW({},zq,IW(Vq,"handle"),{color:["#d0e3fa","#acc7f6","#8daaf2","#6d8eea","#4d73cd","#325bb1","#5a3e75","#8c3c79","#e23455","#e7655b"],indicatorBackgroundFill:"#262626",indicatorLabelFill:"white",indicatorLabelFontSize:12,indicatorVisibility:"hidden",labelAlign:"value",labelDirection:"positive",labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:"",type:"continuous"});var Yq=Jz({title:"title",html:"html",titleGroup:"title-group",items:"items",itemsGroup:"items-group",contentGroup:"content-group",ribbonGroup:"ribbon-group",ribbon:"ribbon",handlesGroup:"handles-group",handle:"handle",startHandle:"start-handle",endHandle:"end-handle",labelGroup:"label-group",label:"label",indicator:"indicator"},"legend"),Xq=Jz({text:"text"},"title");function qq(t,e){var n=Object.entries(e).reduce(function(e,n){var r=Ke(n,2),i=r[0],A=r[1];return t.node().attr(i)||(e[i]=A),e},{});t.styles(n)}var Zq,Jq=function(t){function e(e){return t.call(this,e,{text:"",width:0,height:0,fill:"#4a505a",fontWeight:"bold",fontSize:12,fontFamily:"sans-serif",inset:0,spacing:0,position:"top-left"})||this}return Pe(e,t),e.prototype.getAvailableSpace=function(){var t=this.attributes,e=t.width,n=t.height,r=t.position,i=t.spacing,A=t.inset,o=this.querySelector(Xq.text.class);if(!o)return new Xz(0,0,+e,+n);var s=o.getBBox(),a=s.width,c=s.height,l=Ke(kW(i),4),u=l[0],h=l[1],d=l[2],f=l[3],g=Ke([0,0,+e,+n],4),p=g[0],v=g[1],m=g[2],y=g[3],w=HW(r);if(w.includes("i"))return new Xz(p,v,m,y);w.forEach(function(t,r){var i,A,o,s;"t"===t&&(i=Ke(0===r?[c+d,+n-c-d]:[0,+n],2),v=i[0],y=i[1]),"r"===t&&(A=Ke([+e-a-f],1),m=A[0]),"b"===t&&(o=Ke([+n-c-u],1),y=o[0]),"l"===t&&(s=Ke(0===r?[a+h,+e-a-h]:[0,+e],2),p=s[0],m=s[1])});var B=Ke(kW(A),4),b=B[0],E=B[1],x=B[2],C=B[3],F=Ke([C+E,b+x],2),M=F[0],k=F[1];return new Xz(p+C,v+b,m-M,y-k)},e.prototype.getBBox=function(){return this.title?this.title.getBBox():new Xz(0,0,0,0)},e.prototype.render=function(t,e){var n=this;t.width,t.height,t.position,t.spacing;var r=t.classNamePrefix,i=He(t,["width","height","position","spacing","classNamePrefix"]),A=Ke(LW(i),1)[0],o=function(t){var e,n,r,i,A=t,o=A.width,s=A.height,a=A.position,c=Ke([+o/2,+s/2],2),l=Ke([+c[0],+c[1],"center","middle"],4),u=l[0],h=l[1],d=l[2],f=l[3],g=HW(a);return g.includes("l")&&(u=(e=Ke([0,"start"],2))[0],d=e[1]),g.includes("r")&&(u=(n=Ke([+o,"end"],2))[0],d=n[1]),g.includes("t")&&(h=(r=Ke([0,"top"],2))[0],f=r[1]),g.includes("b")&&(h=(i=Ke([+s,"bottom"],2))[0],f=i[1]),{x:u,y:h,textAlign:d,textBaseline:f}}(t),s=o.x,a=o.y,c=o.textAlign,l=o.textBaseline;cW(!!i.text,MW(e),function(t){var e=Sq(Xq.text.name,Tq,r);n.title=t.maybeAppendByClassName(Xq.text,"text").attr("className",e).styles(A).call(qq,{x:s,y:a,textAlign:c,textBaseline:l}).node()})},e}(GW),$q=Jz({prevBtnGroup:"prev-btn-group",prevBtn:"prev-btn",nextBtnGroup:"next-btn-group",nextBtn:"next-btn",pageInfoGroup:"page-info-group",pageInfo:"page-info",playWindow:"play-window",contentGroup:"content-group",controller:"controller",clipPath:"clip-path"},"navigator"),tZ=function(t){function e(e){var n=t.call(this,e,{x:0,y:0,animate:{easing:"linear",duration:200,fill:"both"},buttonCursor:"pointer",buttonFill:"black",buttonD:YW(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(t,e){return"".concat(t,"/").concat(e)},defaultPage:0,loop:!1,orientation:"horizontal",pageNumFill:"black",pageNumFontSize:12,pageNumTextAlign:"start",pageNumTextBaseline:"middle"})||this;return n.playState="idle",n.contentGroup=n.appendChild(new Ja({class:$q.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new Ja({class:$q.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return Pe(e,t),Object.defineProperty(e.prototype,"defaultPage",{get:function(){var t=this.attributes.defaultPage;return Ae(t,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controllerShape",{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageShape",{get:function(){var t=Ke(function(t){var e;return(null===(e=t[0])||void 0===e?void 0:e.map(function(e,n){return t.map(function(t){return t[n]})}))||[]}(this.pageViews.map(function(t){var e=t.getBBox();return[e.width,e.height]})).map(function(t){return Math.max.apply(Math,je([],Ke(t),!1))}),2),e=t[0],n=t[1],r=this.attributes,i=r.pageWidth,A=void 0===i?e:i,o=r.pageHeight;return{pageWidth:A,pageHeight:void 0===o?n:o}},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(e.prototype,"totalPages",{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currPage",{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e=t.prototype.getBBox.call(this),n=e.x,r=e.y,i=this.controllerShape,A=this.pageShape,o=A.pageWidth,s=A.pageHeight;return new Xz(n,r,o+i.width,s)},e.prototype.goTo=function(t){var e=this,n=this.attributes.animate,r=this,i=r.currPage,A=r.playState,o=r.playWindow,s=r.pageViews;if("idle"!==A||t<0||s.length<=0||t>=s.length)return null;s[i].setLocalPosition(0,0),this.prepareFollowingPage(t);var a=Ke(this.getFollowingPageDiff(t),2),c=a[0],l=a[1];this.playState="running";var u=eX(o,[{transform:"translate(0, 0)"},{transform:"translate(".concat(-c,", ").concat(-l,")")}],n);return $Y(u,function(){e.innerCurrPage=t,e.playState="idle",e.setVisiblePages([t]),e.updatePageInfo()}),u},e.prototype.prev=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n<=0)return null;var r=t?(n-1+e)%e:Ae(n-1,0,e);return this.goTo(r)},e.prototype.next=function(){var t=this.attributes.loop,e=this.pageViews.length,n=this.currPage;if(!t&&n>=e-1)return null;var r=t?(n+1)%e:Ae(n+1,0,e);return this.goTo(r)},e.prototype.renderClipPath=function(t){var e=this.pageShape,n=e.pageWidth,r=e.pageHeight;n&&r?(this.clipPath=t.maybeAppendByClassName($q.clipPath,"rect").styles({width:n,height:r}),this.contentGroup.attr("clipPath",this.clipPath.node())):this.contentGroup.style.clipPath=void 0},e.prototype.setVisiblePages=function(t){this.playWindow.children.forEach(function(e,n){t.includes(n)?_z(e):Gz(e)})},e.prototype.adjustControllerLayout=function(){var t=this,e=t.prevBtnGroup,n=t.nextBtnGroup,r=t.pageInfoGroup,i=this.attributes,A=i.orientation,o=i.controllerPadding,s=r.getBBox(),a=s.width;s.height;var c=Ke("horizontal"===A?[-180,0]:[-90,90],2),l=c[0],u=c[1];e.setLocalEulerAngles(l),n.setLocalEulerAngles(u);var h=e.getBBox(),d=h.width,f=h.height,g=n.getBBox(),p=g.width,v=g.height,m=Math.max(d,a,p),y="horizontal"===A?{offset:[[0,0],[d/2+o,0],[d+a+2*o,0]],textAlign:"start"}:{offset:[[m/2,-f-o],[m/2,0],[m/2,v+o]],textAlign:"center"},w=Ke(y.offset,3),B=Ke(w[0],2),b=B[0],E=B[1],x=Ke(w[1],2),C=x[0],F=x[1],M=Ke(w[2],2),k=M[0],Q=M[1],S=y.textAlign,U=r.querySelector("text");U&&(U.style.textAlign=S),e.setLocalPosition(b,E),r.setLocalPosition(C,F),n.setLocalPosition(k,Q)},e.prototype.updatePageInfo=function(){var t,e=this,n=e.currPage,r=e.pageViews,i=e.attributes.formatter;r.length<2||(null===(t=this.pageInfoGroup.querySelector($q.pageInfo.class))||void 0===t||t.attr("text",i(n+1,r.length)),this.adjustControllerLayout())},e.prototype.getFollowingPageDiff=function(t){var e=this.currPage;if(e===t)return[0,0];var n=this.attributes.orientation,r=this.pageShape,i=r.pageWidth,A=r.pageHeight,o=t<e?-1:1;return"horizontal"===n?[o*i,0]:[0,o*A]},e.prototype.prepareFollowingPage=function(t){var e=this.currPage,n=this.pageViews;if(this.setVisiblePages([t,e]),t!==e){var r=Ke(this.getFollowingPageDiff(t),2),i=r[0],A=r[1];n[t].setLocalPosition(i,A)}},e.prototype.renderController=function(t){var e=this,n=this.attributes,r=n.controllerSpacing,i=n.classNamePrefix,A=void 0===i?"":i,o=this.pageShape,s=o.pageWidth,a=o.pageHeight,c=this.pageViews.length>=2,l=t.maybeAppendByClassName($q.controller,"g");if(Kz(l.node(),c),c){var u=NW(this.attributes,"button"),h=NW(this.attributes,"pageNum"),d=Ke(LW(u),2),f=d[0],g=d[1],p=f.size,v=He(f,["size"]),m=!l.select($q.prevBtnGroup.class).node(),y=l.maybeAppendByClassName($q.prevBtnGroup,"g").styles(g);this.prevBtnGroup=y.node();var w=y.maybeAppendByClassName($q.prevBtn,"path");if(A){var B=Sq($q.prevBtn.name,_q,A);w.node().setAttribute("class",B)}var b=l.maybeAppendByClassName($q.nextBtnGroup,"g").styles(g);this.nextBtnGroup=b.node();var E=b.maybeAppendByClassName($q.nextBtn,"path");if(A){var x=Sq($q.nextBtn.name,Gq,A);E.node().setAttribute("class",x)}[w,E].forEach(function(t){t.styles(Re(Re({},v),{transformOrigin:"center"})),CW(t.node(),p)});var C=l.maybeAppendByClassName($q.pageInfoGroup,"g");this.pageInfoGroup=C.node();var F=C.maybeAppendByClassName($q.pageInfo,"text");if(F.styles(h),A){var M=Sq($q.pageInfo.name,Kq,A);F.node().setAttribute("class",M)}this.updatePageInfo(),l.node().setLocalPosition(s+r,a/2),m&&(this.prevBtnGroup.addEventListener("click",function(){e.prev()}),this.nextBtnGroup.addEventListener("click",function(){e.next()}))}},e.prototype.render=function(t,e){var n=t.x,r=void 0===n?0:n,i=t.y,A=void 0===i?0:i;this.attr("transform","translate(".concat(r,", ").concat(A,")"));var o=MW(e);this.renderClipPath(o),this.renderController(o),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},e.prototype.bindEvents=function(){var t=this,e=ye(function(){return t.render(t.attributes,t)},50);this.playWindow.addEventListener(ia.INSERTED,e),this.playWindow.addEventListener(ia.REMOVED,e)},e}(GW),eZ="component-poptip",nZ="component-poptip-arrow",rZ="component-poptip-text",iZ=((Zq={})[".".concat(eZ)]={visibility:"visible",position:"absolute","background-color":"rgba(0, 0, 0)","box-shadow":"0px 0px 10px #aeaeae","border-radius":"3px",color:"#fff",opacity:.8,"font-size":"12px",padding:"4px 6px",display:"flex","justify-content":"center","align-items":"center","z-index":8,transition:"visibility 50ms"},Zq[".".concat(rZ)]={"text-align":"center"},Zq[".".concat(eZ,"[data-position='top']")]={transform:"translate(-50%, -100%)"},Zq[".".concat(eZ,"[data-position='left']")]={transform:"translate(-100%, -50%)"},Zq[".".concat(eZ,"[data-position='right']")]={transform:"translate(0, -50%)"},Zq[".".concat(eZ,"[data-position='bottom']")]={transform:"translate(-50%, 0)"},Zq[".".concat(eZ,"[data-position='top-left']")]={transform:"translate(0,-100%)"},Zq[".".concat(eZ,"[data-position='top-right']")]={transform:"translate(-100%,-100%)"},Zq[".".concat(eZ,"[data-position='left-top']")]={transform:"translate(-100%, 0)"},Zq[".".concat(eZ,"[data-position='left-bottom']")]={transform:"translate(-100%, -100%)"},Zq[".".concat(eZ,"[data-position='right-top']")]={transform:"translate(0, 0)"},Zq[".".concat(eZ,"[data-position='right-bottom']")]={transform:"translate(0, -100%)"},Zq[".".concat(eZ,"[data-position='bottom-left']")]={transform:"translate(0, 0)"},Zq[".".concat(eZ,"[data-position='bottom-right']")]={transform:"translate(-100%, 0)"},Zq[".".concat(nZ)]={width:"4px",height:"4px",transform:"rotate(45deg)","background-color":"rgba(0, 0, 0)",position:"absolute","z-index":-1},Zq[".".concat(eZ,"[data-position='top']")]={transform:"translate(-50%, calc(-100% - 5px))"},Zq["[data-position='top'] .".concat(nZ)]={bottom:"-2px"},Zq[".".concat(eZ,"[data-position='left']")]={transform:"translate(calc(-100% - 5px), -50%)"},Zq["[data-position='left'] .".concat(nZ)]={right:"-2px"},Zq[".".concat(eZ,"[data-position='right']")]={transform:"translate(5px, -50%)"},Zq["[data-position='right'] .".concat(nZ)]={left:"-2px"},Zq[".".concat(eZ,"[data-position='bottom']")]={transform:"translate(-50%, 5px)"},Zq["[data-position='bottom'] .".concat(nZ)]={top:"-2px"},Zq[".".concat(eZ,"[data-position='top-left']")]={transform:"translate(0, calc(-100% - 5px))"},Zq["[data-position='top-left'] .".concat(nZ)]={left:"10px",bottom:"-2px"},Zq[".".concat(eZ,"[data-position='top-right']")]={transform:"translate(-100%, calc(-100% - 5px))"},Zq["[data-position='top-right'] .".concat(nZ)]={right:"10px",bottom:"-2px"},Zq[".".concat(eZ,"[data-position='left-top']")]={transform:"translate(calc(-100% - 5px), 0)"},Zq["[data-position='left-top'] .".concat(nZ)]={right:"-2px",top:"8px"},Zq[".".concat(eZ,"[data-position='left-bottom']")]={transform:"translate(calc(-100% - 5px), -100%)"},Zq["[data-position='left-bottom'] .".concat(nZ)]={right:"-2px",bottom:"8px"},Zq[".".concat(eZ,"[data-position='right-top']")]={transform:"translate(5px, 0)"},Zq["[data-position='right-top'] .".concat(nZ)]={left:"-2px",top:"8px"},Zq[".".concat(eZ,"[data-position='right-bottom']")]={transform:"translate(5px, -100%)"},Zq["[data-position='right-bottom'] .".concat(nZ)]={left:"-2px",bottom:"8px"},Zq[".".concat(eZ,"[data-position='bottom-left']")]={transform:"translate(0, 5px)"},Zq["[data-position='bottom-left'] .".concat(nZ)]={top:"-2px",left:"8px"},Zq[".".concat(eZ,"[data-position='bottom-right']")]={transform:"translate(-100%, 5px)"},Zq["[data-position='bottom-right'] .".concat(nZ)]={top:"-2px",right:"8px"},Zq);function AZ(t){var e=t&&document.getElementById(t);return e||((e=document.createElement("div")).setAttribute("id",t),document.body.appendChild(e)),e}var oZ=function(t){function e(n){var r=t.call(this,xe({style:{id:"component-poptip"}},e.defaultOptions,n))||this;return r.visibility="visible",r.map=new Map,r.domStyles="",r.initShape(),r.render(r.attributes,r),r}return Pe(e,t),Object.defineProperty(e.prototype,"visible",{get:function(){return"visible"===this.visibility},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.visibility=this.style.visibility,this.updatePoptipElement()},e.prototype.update=function(t){this.attr(xe({},this.style,t)),this.render(this.attributes,this)},e.prototype.bind=function(t,e){var n=this;if(t){var r=this.style.text,i=function(i){var A=t,o=n.style,s=r;if(e){var a="function"==typeof e?e.call(null,i):e,c=a.html,l=a.target,u=He(a,["html","target"]);o=function(t,e,n){return e&&ve(t,e),n&&ve(t,n),t}({},n.style,u),(l||!1===l)&&(A=l),"string"==typeof c&&(s=c)}var h=o.position,d=o.arrowPointAtCenter,f=o.follow,g=o.offset;if(A){var p=i,v=Ke(function(t,e,n,r,i,A){if(void 0===i&&(i=!1),void 0===A&&(A=!1),A)return[t,e];var o=n.getBoundingClientRect(),s=o.x,a=o.y,c=o.width,l=o.height;switch(r){case"top":return i?[s+c/2,a]:[t,a];case"left":return i?[s,a+l/2]:[s,e];case"bottom":return i?[s+c/2,a+l]:[t,a+l];case"right":return i?[s+c,a+l/2]:[s+c,e];case"top-right":case"right-top":return[s+c,a];case"left-bottom":case"bottom-left":return[s,a+l];case"right-bottom":case"bottom-right":return[s+c,a+l];default:return[s,a]}}(p.clientX,p.clientY,A,h,d,f),2),m=v[0],y=v[1];n.showTip(m,y,{text:s,position:h,offset:g})}else n.hideTip()},A=function(){n.hideTip()};t.addEventListener("mousemove",i),t.addEventListener("mouseleave",A),this.map.set(t,[i,A])}},e.prototype.unbind=function(t){if(this.map.has(t)){var e=Ke(this.map.get(t)||[],2),n=e[0],r=e[1];n&&t.removeEventListener("mousemove",n),r&&t.removeEventListener("mouseleave",r),this.map.delete(t)}},e.prototype.clear=function(){this.container.innerHTML=""},e.prototype.destroy=function(){var e,n=this;je([],Ke(this.map.keys()),!1).forEach(function(t){return n.unbind(t)}),null===(e=this.container)||void 0===e||e.remove(),t.prototype.destroy.call(this)},e.prototype.showTip=function(t,e,n){var r=ke(n,"text");if((!r||"string"==typeof r)&&(this.applyStyles(),t&&e&&n)){var i=n.offset,A=n.position;if(A&&this.container.setAttribute("data-position",A),this.setOffsetPosition(t,e,i),"string"==typeof r){var o=this.container.querySelector(".".concat(rZ));o&&(o.innerHTML=r)}this.visibility="visible",this.container.style.visibility="visible"}},e.prototype.hideTip=function(){this.visibility="hidden",this.container.style.visibility="hidden"},e.prototype.getContainer=function(){return this.container},e.prototype.getClassName=function(){var t=this.style.containerClassName;return"".concat(eZ).concat(t?" ".concat(t):"")},e.prototype.initShape=function(){var t=this,e=this.style.id;this.container=function(t){var e,n,r=(e=AZ,function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return n||(n=e.apply(void 0,t)),n})(t);return r}(e),this.container.className=this.getClassName(),this.container.addEventListener("mousemove",function(){return t.showTip()}),this.container.addEventListener("mouseleave",function(){return t.hideTip()})},e.prototype.updatePoptipElement=function(){var t=this.container;this.clear();var e=this.style,n=e.id,r=e.template,i=e.text;this.container.setAttribute("id",n),this.container.className=this.getClassName();var A,o='<span class="'.concat(nZ,'"></span>');t.innerHTML=o,ne(r)?t.innerHTML+=r:r&&((A=r)instanceof Element||A instanceof Document)&&t.appendChild(r),i&&(t.getElementsByClassName(rZ)[0].textContent=i),this.applyStyles(),this.container.style.visibility=this.visibility},e.prototype.applyStyles=function(){var t=tW({},iZ,this.style.domStyles),e=Object.entries(t).reduce(function(t,e){var n=Ke(e,2),r=n[0],i=n[1],A=Object.entries(i).reduce(function(t,e){var n=Ke(e,2),r=n[0],i=n[1];return"".concat(t).concat(r,": ").concat(i,";")},"");return"".concat(t).concat(r,"{").concat(A,"}")},"");if(this.domStyles!==e){this.domStyles=e;var n=this.container.querySelector("style");n&&this.container.removeChild(n),(n=document.createElement("style")).innerHTML=e,this.container.appendChild(n)}},e.prototype.setOffsetPosition=function(t,e,n){void 0===n&&(n=this.style.offset);var r=Ke(n,2),i=r[0],A=void 0===i?0:i,o=r[1],s=void 0===o?0:o;this.container.style.left="".concat(t+A,"px"),this.container.style.top="".concat(e+s,"px")},e.tag="poptip",e.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:"hidden",text:"",position:"top",follow:!1,offset:[0,0],domStyles:iZ,template:'<div class="'.concat(rZ,'"></div>')}},e}(GW),sZ=Jz({layout:"flex",markerGroup:"marker-group",marker:"marker",labelGroup:"label-group",label:"label",valueGroup:"value-group",focusGroup:"focus-group",focus:"focus",value:"value",backgroundGroup:"background-group",background:"background"},"legend-category-item"),aZ={offset:[0,20],domStyles:{".component-poptip":{opacity:"1",padding:"8px 12px",background:"#fff",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"},".component-poptip-arrow":{display:"none"},".component-poptip-text":{color:"#000",lineHeight:"20px"}}};var cZ=function(t){function e(e,n){var r=t.call(this,e,{span:[1,1],marker:function(){return new Ya({style:{r:6}})},markerSize:10,labelFill:"#646464",valueFill:"#646464",labelFontSize:12,valueFontSize:12,labelTextBaseline:"middle",valueTextBaseline:"middle"})||this;return r.keyFields={},r.keyFields=n||{},r}return Pe(e,t),Object.defineProperty(e.prototype,"showValue",{get:function(){var t=this.attributes.valueText;return!!t&&("string"==typeof t||"number"==typeof t?""!==t:"function"==typeof t||""!==t.attr("text"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"actualSpace",{get:function(){var t=this.labelGroup,e=this.valueGroup,n=this.attributes,r=n.markerSize,i=n.focus,A=n.focusMarkerSize,o=t.node().getBBox(),s=o.width,a=o.height,c=e.node().getBBox(),l=c.width,u=c.height;return{markerWidth:r,labelWidth:s,valueWidth:l,focusWidth:i?null!=A?A:12:0,height:Math.max(r,a,u)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){var t=this.attributes.span;if(!t)return[1,1];var e=Ke(kW(t),2),n=e[0],r=e[1],i=this.showValue?r:0,A=n+i;return[n/A,i/A]},enumerable:!1,configurable:!0}),e.prototype.setAttribute=function(e,n){t.prototype.setAttribute.call(this,e,n)},Object.defineProperty(e.prototype,"shape",{get:function(){var t,e=this.attributes,n=e.markerSize,r=e.width,i=this.actualSpace,A=i.markerWidth,o=i.focusWidth,s=i.height,a=this.actualSpace,c=a.labelWidth,l=a.valueWidth,u=Ke(this.spacing,3),h=u[0],d=u[1],f=u[2];if(r){var g=r-n-h-d-o-f,p=Ke(this.span,2);c=(t=Ke([p[0]*g,p[1]*g],2))[0],l=t[1]}return{width:A+c+l+h+d+o+f,height:s,markerWidth:A,labelWidth:c,valueWidth:l,focusWidth:o}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spacing",{get:function(){var t=this.attributes,e=t.spacing,n=t.focus;if(!e)return[0,0,0];var r=Ke(kW(e),3),i=r[0],A=r[1],o=r[2];return[i,this.showValue?A:0,n?o:0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layout",{get:function(){var t=this.shape,e=t.markerWidth,n=t.labelWidth,r=t.valueWidth,i=t.focusWidth,A=t.width,o=t.height,s=Ke(this.spacing,3),a=s[0],c=s[1];return{height:o,width:A,markerWidth:e,labelWidth:n,valueWidth:r,focusWidth:i,position:[e/2,e+a,e+n+a+c,e+n+r+a+c+s[2]+i/2]}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleSize",{get:function(){var t=function(t){var e=t.querySelector(sZ.marker.class);return e?e.style:{}}(this.markerGroup.node()),e=this.attributes,n=e.markerSize,r=e.markerStrokeWidth,i=void 0===r?t.strokeWidth:r,A=e.markerLineWidth,o=void 0===A?t.lineWidth:A,s=e.markerStroke,a=void 0===s?t.stroke:s,c=+(i||o||(a?1:0))*Math.sqrt(2),l=this.markerGroup.node().getBBox(),u=l.width,h=l.height;return(1-c/Math.max(u,h))*n},enumerable:!1,configurable:!0}),e.prototype.renderMarker=function(t){var e=this,n=this.attributes,r=n.marker,i=n.classNamePrefix,A=NW(this.attributes,"marker");this.markerGroup=t.maybeAppendByClassName(sZ.markerGroup,"g").style("zIndex",0),cW(!!r,this.markerGroup,function(){var t,n=e.markerGroup.node(),o=null===(t=n.childNodes)||void 0===t?void 0:t[0],s=Sq(sZ.marker.name,Nq,i),a="string"==typeof r?new qW({style:{symbol:r},className:s}):r();if(o)if(a.nodeName===o.nodeName)o instanceof qW?o.update(Re(Re({},A),{symbol:r})):(!function(t,e){var n,r,i=e.attributes;try{for(var A=Ge(Object.entries(i)),o=A.next();!o.done;o=A.next()){var s=Ke(o.value,2),a=s[0],c=s[1];"id"!==a&&"className"!==a&&t.attr(a,c)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=A.return)&&r.call(A)}finally{if(n)throw n.error}}}(o,a),MW(o).styles(A));else{if(o.remove(),!(a instanceof qW)){var c=Sq(sZ.marker.name,Nq,i);a.className=c}MW(a).styles(A),n.appendChild(a)}else{if(!(a instanceof qW)){var l=Sq(sZ.marker.name,Nq,i);a.className=l,MW(a).styles(A)}n.appendChild(a)}e.markerGroup.node().scale(1/e.markerGroup.node().getScale()[0]);var u=CW(e.markerGroup.node(),e.scaleSize);e.markerGroup.node().style._transform="scale(".concat(u,")")})},e.prototype.renderLabel=function(t){var e=NW(this.attributes,"label"),n=e.text,r=He(e,["text"]),i=this.attributes.classNamePrefix;this.labelGroup=t.maybeAppendByClassName(sZ.labelGroup,"g").style("zIndex",0);var A=Sq(sZ.label.name,Iq,i),o=this.labelGroup.maybeAppendByClassName(sZ.label,function(){return aW(n)});o.node().setAttribute("class",A),o.styles(r)},e.prototype.renderValue=function(t){var e=this,n=NW(this.attributes,"value"),r=n.text,i=He(n,["text"]),A=this.attributes.classNamePrefix;this.valueGroup=t.maybeAppendByClassName(sZ.valueGroup,"g").style("zIndex",0),cW(this.showValue,this.valueGroup,function(){var t=Sq(sZ.value.name,Lq,A),n=e.valueGroup.maybeAppendByClassName(sZ.value,function(){return aW(r)});n.node().setAttribute("class",t),n.styles(i)})},e.prototype.createPoptip=function(){var t=this.attributes.poptip||{};t.render;var e=He(t,["render"]),n=new oZ({style:tW(aZ,e)});return this.poptipGroup=n,n},e.prototype.bindPoptip=function(t){var e=this,n=this.attributes.poptip;n&&(this.poptipGroup||this.createPoptip()).bind(t,function(){var t=e.attributes,r=t.labelText,i=t.valueText,A=t.markerFill,o="string"==typeof r?r:null==r?void 0:r.attr("text"),s="string"==typeof i?i:null==i?void 0:i.attr("text");if("function"==typeof n.render)return{html:n.render(Re(Re({},e.keyFields),{label:o,value:s,color:A}))};var a="";return"string"!=typeof o&&"number"!=typeof o||(a+='<div class="component-poptip-label">'.concat(o,"</div>")),"string"!=typeof s&&"number"!=typeof s||(a+='<div class="component-poptip-value">'.concat(s,"</div>")),{html:a}})},e.prototype.renderFocus=function(t){var e=this,n=this.attributes,r=n.focus,i=n.focusMarkerSize,A=n.classNamePrefix,o={x:0,y:0,size:i,opacity:.6,symbol:"focus",stroke:"#aaaaaa",lineWidth:1};pe(r)||(this.focusGroup=t.maybeAppendByClassName(sZ.focusGroup,"g").style("zIndex",0),cW(r,this.focusGroup,function(){var n=Sq(sZ.focus.name,Dq,A),r=new qW({style:Re(Re({},o),{symbol:"focus"}),className:n}),i=new Ya({style:{r:o.size/2,fill:"transparent"}}),s=e.focusGroup.node();s.appendChild(i),s.appendChild(r),r.update({opacity:0}),t.node().addEventListener("pointerenter",function(){r.update({opacity:1})}),t.node().addEventListener("pointerleave",function(){r.update({opacity:0})})}))},e.prototype.renderPoptip=function(t){var e=this;this.attributes.poptip&&[t.maybeAppendByClassName(sZ.value,"g").node(),t.maybeAppendByClassName(sZ.label,"g").node()].forEach(function(t){t&&e.bindPoptip(t)})},e.prototype.renderBackground=function(t){var e=this.shape,n=e.width,r=e.height,i=NW(this.attributes,"background");this.background=t.maybeAppendByClassName(sZ.backgroundGroup,"g").style("zIndex",-1);var A=this.background.maybeAppendByClassName(sZ.background,"rect");A.styles(Re({width:n,height:r},i));var o=this.attributes.classNamePrefix,s=void 0===o?"":o;if(s){var a=Sq(sZ.background.name,Pq,s);A.node().setAttribute("class",a)}},e.prototype.adjustLayout=function(){var t=this.layout,e=t.labelWidth,n=t.valueWidth,r=t.height,i=Ke(t.position,4),A=i[0],o=i[1],s=i[2],a=i[3],c=r/2;this.markerGroup.styles({transform:"translate(".concat(A,", ").concat(c,")").concat(this.markerGroup.node().style._transform)}),this.labelGroup.styles({transform:"translate(".concat(o,", ").concat(c,")")}),this.focusGroup&&this.focusGroup.styles({transform:"translate(".concat(a,", ").concat(c,")")}),oW(this.labelGroup.select(sZ.label.class).node(),Math.ceil(e)),this.showValue&&(this.valueGroup.styles({transform:"translate(".concat(s,", ").concat(c,")")}),oW(this.valueGroup.select(sZ.value.class).node(),Math.ceil(n)))},e.prototype.render=function(t,e){var n=MW(e),r=t.x,i=void 0===r?0:r,A=t.y,o=void 0===A?0:A;n.styles({transform:"translate(".concat(i,", ").concat(o,")")}),this.renderMarker(n),this.renderLabel(n),this.renderValue(n),this.renderBackground(n),this.renderPoptip(n),this.renderFocus(n),this.adjustLayout()},e}(GW),lZ=Jz({page:"item-page",navigator:"navigator",item:"item"},"items"),uZ=function(t,e,n){return void 0===n&&(n=!0),t?e(t):n},hZ=function(t){function e(e){var n=t.call(this,e,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:"flex",orientation:"horizontal",click:Ie,mouseenter:Ie,mouseleave:Ie})||this;return n.navigatorShape=[0,0],n}return Pe(e,t),Object.defineProperty(e.prototype,"pageViews",{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){var t=this.attributes,e=t.gridRow,n=t.gridCol,r=t.data;if(!e&&!n)throw new Error("gridRow and gridCol can not be set null at the same time");return e&&n?[e,n]:e?[e,r.length]:[r.length,n]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderData",{get:function(){var t=this.attributes,e=t.data,n=t.layout,r=t.poptip,i=t.focus,A=t.focusMarkerSize,o=t.classNamePrefix,s=NW(this.attributes,"item"),a=e.map(function(t,a){var c=t.id,l=void 0===c?a:c,u=t.label,h=t.value;return{id:"".concat(l),index:a,style:Re({layout:n,labelText:u,valueText:h,poptip:r,focus:i,focusMarkerSize:A,classNamePrefix:o},Object.fromEntries(Object.entries(s).map(function(n){var r=Ke(n,2);return[r[0],qz(r[1],[t,a,e])]})))}});return a},enumerable:!1,configurable:!0}),e.prototype.getGridLayout=function(){var t=this,e=this.attributes,n=e.orientation,r=e.width,i=e.rowPadding,A=e.colPadding,o=Ke(this.navigatorShape,1)[0],s=Ke(this.grid,2),a=s[0],c=s[1],l=c*a,u=0;return this.pageViews.children.map(function(e,s){var h,d,f=Math.floor(s/l),g=s%l,p=t.ifHorizontal(c,a),v=[Math.floor(g/p),g%p];"vertical"===n&&v.reverse();var m=Ke(v,2),y=m[0],w=m[1],B=(r-o-(c-1)*A)/c,b=e.getBBox().height,E=Ke([0,0],2),x=E[0],C=E[1];return"horizontal"===n?(x=(h=Ke([u,y*(b+i)],2))[0],C=h[1],u=w===c-1?0:u+B+A):(x=(d=Ke([w*(B+A),u],2))[0],C=d[1],u=y===a-1?0:u+b+i),{page:f,index:s,row:y,col:w,pageIndex:g,width:B,height:b,x:x,y:C}})},e.prototype.getFlexLayout=function(){var t=this.attributes,e=t.width,n=t.height,r=t.rowPadding,i=t.colPadding,A=Ke(this.navigatorShape,1)[0],o=Ke(this.grid,2),s=o[0],a=o[1],c=Ke([e-A,n],2),l=c[0],u=c[1],h=Ke([0,0,0,0,0,0,0,0],8),d=h[0],f=h[1],g=h[2],p=h[3],v=h[4],m=h[5],y=h[6],w=h[7];return this.pageViews.children.map(function(t,e){var n,A,o,c,h=t.getBBox(),B=h.width,b=h.height,E=0===y?0:i,x=y+E+B;return x<=l&&uZ(v,function(t){return t<a})?(n=Ke([y+E,w,x],3),d=n[0],f=n[1],y=n[2],{width:B,height:b,x:d,y:f,page:g,index:e,pageIndex:p++,row:m,col:v++}):(A=Ke([m+1,0,0,w+b+r],4),m=A[0],v=A[1],y=A[2],(w=A[3])+b<=u&&uZ(m,function(t){return t<s})?(o=Ke([y,w,B],3),d=o[0],f=o[1],y=o[2],{width:B,height:b,x:d,y:f,page:g,index:e,pageIndex:p++,row:m,col:v++}):(c=Ke([0,0,B,0,g+1,0,0,0],8),d=c[0],f=c[1],y=c[2],w=c[3],g=c[4],p=c[5],m=c[6],v=c[7],{width:B,height:b,x:d,y:f,page:g,index:e,pageIndex:p++,row:m,col:v++}))})},Object.defineProperty(e.prototype,"itemsLayout",{get:function(){this.navigatorShape=[0,0];var t="grid"===this.attributes.layout?this.getGridLayout:this.getFlexLayout,e=t.call(this);return e.slice(-1)[0].page>0?(this.navigatorShape=[55,0],t.call(this)):e},enumerable:!1,configurable:!0}),e.prototype.ifHorizontal=function(t,e){return Uq(this.attributes.orientation,t,e)},e.prototype.flattenPage=function(t){t.querySelectorAll(lZ.item.class).forEach(function(e){t.appendChild(e)}),t.querySelectorAll(lZ.page.class).forEach(function(e){t.removeChild(e).destroy()})},e.prototype.renderItems=function(t){var e=this.attributes,n=e.click,r=e.mouseenter,i=e.mouseleave,A=e.classNamePrefix;this.flattenPage(t);var o=this.dispatchCustomEvent.bind(this),s=Sq(lZ.item.name,Oq,A);MW(t).selectAll(lZ.item.class).data(this.renderData,function(t){return t.id}).join(function(t){return t.append(function(t){var e=t.style,n=He(t,["style"]);return new cZ({style:e},n)}).attr("className",s).on("click",function(){null==n||n(this),o("itemClick",{item:this})}).on("pointerenter",function(){null==r||r(this),o("itemMouseenter",{item:this})}).on("pointerleave",function(){null==i||i(this),o("itemMouseleave",{item:this})})},function(t){return t.each(function(t){var e=t.style;this.update(e)})},function(t){return t.remove()})},e.prototype.relayoutNavigator=function(){var t,e=this.attributes,n=e.layout,r=e.width,i=(null===(t=this.pageViews.children[0])||void 0===t?void 0:t.getBBox().height)||0,A=Ke(this.navigatorShape,2),o=A[0],s=A[1];this.navigator.update("grid"===n?{pageWidth:r-o,pageHeight:i-s}:{})},e.prototype.adjustLayout=function(){var t,e,n=this,r=Object.entries((t=this.itemsLayout,e="page",t.reduce(function(t,n){return(t[n[e]]=t[n[e]]||[]).push(n),t},{}))).map(function(t){var e=Ke(t,2);return{page:e[0],layouts:e[1]}}),i=je([],Ke(this.navigator.getContainer().children),!1);r.forEach(function(t){var e=t.layouts,r=n.pageViews.appendChild(new Ja({className:lZ.page.name}));e.forEach(function(t){var e=t.x,n=t.y,A=t.index,o=t.width,s=t.height,a=i[A];r.appendChild(a),Qe(a,"__layout__",t),a.update({x:e,y:n,width:o,height:s})})}),this.relayoutNavigator()},e.prototype.renderNavigator=function(t){var e=this.attributes,n=e.orientation,r=e.classNamePrefix,i=NW(this.attributes,"nav"),A=tW({orientation:n,classNamePrefix:r},i),o=this;return t.selectAll(lZ.navigator.class).data(["nav"]).join(function(t){return t.append(function(){return new tZ({style:A})}).attr("className",lZ.navigator.name).each(function(){o.navigator=this})},function(t){return t.each(function(){this.update(A)})},function(t){return t.remove()}),this.navigator},e.prototype.getBBox=function(){return this.navigator.getBBox()},e.prototype.render=function(t,e){var n=this.attributes.data;if(n&&0!==n.length){var r=this.renderNavigator(MW(e));this.renderItems(r.getContainer()),this.adjustLayout()}},e.prototype.dispatchCustomEvent=function(t,e){var n=new Xs(t,{detail:e});this.dispatchEvent(n)},e}(GW),dZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),e.prototype.update=function(t){this.attr(t)},e}(tc),fZ=function(t){function e(e){return t.call(this,e,Wq)||this}return Pe(e,t),e.prototype.renderTitle=function(t,e,n){var r=this.attributes,i=r.showTitle,A=r.titleText,o=r.classNamePrefix,s=Ke(LW(NW(this.attributes,"title")),2),a=s[0],c=s[1];this.titleGroup=t.maybeAppendByClassName(Yq.titleGroup,"g").styles(c);var l=Re(Re({width:e,height:n},a),{text:i?A:"",classNamePrefix:o});this.title=this.titleGroup.maybeAppendByClassName(Yq.title,function(){return new Jq({style:l})}).update(l)},e.prototype.renderCustom=function(t){var e=this.attributes.data,n={innerHTML:this.attributes.render(e),pointerEvents:"auto"};t.maybeAppendByClassName(Yq.html,function(){return new dZ({className:Yq.html.name,style:n})}).update(n)},e.prototype.renderItems=function(t,e){var n=e.x,r=e.y,i=e.width,A=e.height,o=Ke(LW(NW(this.attributes,"title",!0)),2),s=o[0],a=o[1],c=Re(Re({},s),{width:i,height:A,x:0,y:0});this.itemsGroup=t.maybeAppendByClassName(Yq.itemsGroup,"g").styles(Re(Re({},a),{transform:"translate(".concat(n,", ").concat(r,")")}));var l=this;this.itemsGroup.selectAll(Yq.items.class).data(["items"]).join(function(t){return t.append(function(){return new hZ({style:c})}).attr("className",Yq.items.name).each(function(){l.items=MW(this)})},function(t){return t.update(c)},function(t){return t.remove()})},e.prototype.adjustLayout=function(){if(this.attributes.showTitle){var t=this.title.node().getAvailableSpace(),e=t.x,n=t.y;this.itemsGroup.node().style.transform="translate(".concat(e,", ").concat(n,")")}},Object.defineProperty(e.prototype,"availableSpace",{get:function(){var t=this.attributes,e=t.showTitle,n=t.width,r=t.height;return e?this.title.node().getAvailableSpace():new Xz(0,0,n,r)},enumerable:!1,configurable:!0}),e.prototype.getBBox=function(){var e,n,r=null===(e=this.title)||void 0===e?void 0:e.node(),i=null===(n=this.items)||void 0===n?void 0:n.node();return r&&i?function(t,e){var n=t.attributes,r=n.position,i=n.spacing,A=n.inset,o=n.text,s=t.getBBox(),a=e.getBBox(),c=HW(r),l=Ke(kW(o?i:0),4),u=l[0],h=l[1],d=l[2],f=l[3],g=Ke(kW(A),4),p=g[0],v=g[1],m=g[2],y=g[3],w=Ke([f+h,u+d],2),B=w[0],b=w[1],E=Ke([y+v,p+m],2),x=E[0],C=E[1];if("l"===c[0])return new Xz(s.x,s.y,a.width+s.width+B+x,Math.max(a.height+C,s.height));if("t"===c[0])return new Xz(s.x,s.y,Math.max(a.width+x,s.width),a.height+s.height+b+C);var F=Ke([e.attributes.width||a.width,e.attributes.height||a.height],2),M=F[0],k=F[1];return new Xz(a.x,a.y,M+s.width+B+x,k+s.height+b+C)}(r,i):t.prototype.getBBox.call(this)},e.prototype.render=function(t,e){var n=this.attributes,r=n.width,i=n.height,A=n.x,o=void 0===A?0:A,s=n.y,a=void 0===s?0:s,c=n.classNamePrefix,l=n.render,u=MW(e),h=e.className||"legend-category";c?e.attr("className","".concat(h," ").concat(c,"legend")):e.className||e.attr("className","legend-category"),e.style.transform="translate(".concat(o,", ").concat(a,")"),l?this.renderCustom(u):(this.renderTitle(u,r,i),this.renderItems(u,this.availableSpace),this.adjustLayout())},e}(GW),gZ={backgroundFill:"#262626",backgroundLineCap:"round",backgroundLineWidth:1,backgroundStroke:"#333",backgroundZIndex:-1,formatter:function(t){return t.toString()},labelFill:"#fff",labelFontSize:12,labelTextBaseline:"middle",padding:[2,4],position:"right",radius:0,zIndex:999},pZ=Jz({background:"background",labelGroup:"label-group",label:"label"},"indicator"),vZ=function(t){function e(e){var n=t.call(this,e,gZ)||this;return n.point=[0,0],n.group=n.appendChild(new Ja({})),n.isMutationObserved=!0,n}return Pe(e,t),e.prototype.renderBackground=function(){if(this.label){var t=this.attributes,e=t.position,n=Ke(kW(t.padding),4),r=n[0],i=n[1],A=n[2],o=n[3],s=this.label.node().getLocalBounds(),a=s.min,c=s.max,l=new Xz(a[0]-o,a[1]-r,c[0]+i-a[0]+o,c[1]+A-a[1]+r),u=this.getPath(e,l),h=NW(this.attributes,"background");this.background=MW(this.group).maybeAppendByClassName(pZ.background,"path").styles(Re(Re({},h),{d:u})),this.group.appendChild(this.label.node())}},e.prototype.renderLabel=function(){var t=this.attributes,e=t.formatter,n=t.labelText,r=Ke(LW(NW(this.attributes,"label")),2),i=r[0],A=r[1];i.text;var o=He(i,["text"]);(this.label=MW(this.group).maybeAppendByClassName(pZ.labelGroup,"g").styles(A),n)&&this.label.maybeAppendByClassName(pZ.label,function(){return aW(e(n))}).style("text",e(n).toString()).selectAll("text").styles(o)},e.prototype.adjustLayout=function(){var t=Ke(this.point,2),e=t[0],n=t[1],r=this.attributes,i=r.x,A=r.y;this.group.attr("transform","translate(".concat(i-e,", ").concat(A-n,")"))},e.prototype.getPath=function(t,e){var n=this.attributes.radius,r=e.x,i=e.y,A=e.width,o=e.height,s=[["M",r+n,i],["L",r+A-n,i],["A",n,n,0,0,1,r+A,i+n],["L",r+A,i+o-n],["A",n,n,0,0,1,r+A-n,i+o],["L",r+n,i+o],["A",n,n,0,0,1,r,i+o-n],["L",r,i+n],["A",n,n,0,0,1,r+n,i],["Z"]],a={top:4,right:6,bottom:0,left:2}[t],c=this.createCorner([s[a].slice(-2),s[a+1].slice(-2)]);return s.splice.apply(s,je([a+1,1],Ke(c),!1)),s[0][0]="M",s},e.prototype.createCorner=function(t,e){void 0===e&&(e=10);var n=SW.apply(void 0,je([],Ke(t),!1)),r=Ke(t,2),i=Ke(r[0],2),A=i[0],o=i[1],s=Ke(r[1],2),a=s[0],c=s[1],l=Ke(n?[a-A,[A,a]]:[c-o,[o,c]],2),u=l[0],h=Ke(l[1],2),d=h[0],f=h[1],g=u/2,p=e*(u/Math.abs(u)),v=p/2,m=p*Math.sqrt(3)/2*.8,y=Ke([d,d+g-v,d+g,d+g+v,f],5),w=y[0],B=y[1],b=y[2],E=y[3],x=y[4];return n?(this.point=[b,o-m],[["L",w,o],["L",B,o],["L",b,o-m],["L",E,o],["L",x,o]]):(this.point=[A+m,b],[["L",A,w],["L",A,B],["L",A+m,b],["L",A,E],["L",A,x]])},e.prototype.applyVisibility=function(){"hidden"===this.attributes.visibility?Gz(this):_z(this)},e.prototype.bindEvents=function(){this.label.on(ia.BOUNDS_CHANGED,this.renderBackground)},e.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},e}(GW);function mZ(t){return void 0===t&&(t=""),{CONTAINER:"".concat(t,"tooltip"),TITLE:"".concat(t,"tooltip-title"),LIST:"".concat(t,"tooltip-list"),LIST_ITEM:"".concat(t,"tooltip-list-item"),NAME:"".concat(t,"tooltip-list-item-name"),MARKER:"".concat(t,"tooltip-list-item-marker"),NAME_LABEL:"".concat(t,"tooltip-list-item-name-label"),VALUE:"".concat(t,"tooltip-list-item-value"),CROSSHAIR_X:"".concat(t,"tooltip-crosshair-x"),CROSSHAIR_Y:"".concat(t,"tooltip-crosshair-y")}}var yZ={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"};function wZ(t){var e;void 0===t&&(t="");var n=mZ(t);return(e={})[".".concat(n.CONTAINER)]={position:"absolute",visibility:"visible","z-index":8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)","background-color":"rgba(255, 255, 255, 0.96)","box-shadow":"0 6px 12px 0 rgba(0, 0, 0, 0.12)","border-radius":"4px",color:"rgba(0, 0, 0, 0.65)","font-size":"12px","line-height":"20px",padding:"12px","min-width":"120px","max-width":"360px","font-family":"Roboto-Regular"},e[".".concat(n.TITLE)]={color:"rgba(0, 0, 0, 0.45)"},e[".".concat(n.LIST)]={margin:"0px","list-style-type":"none",padding:"0px"},e[".".concat(n.LIST_ITEM)]={"list-style-type":"none",display:"flex","line-height":"2em","align-items":"center","justify-content":"space-between","white-space":"nowrap"},e[".".concat(n.MARKER)]={width:"8px",height:"8px","border-radius":"50%",display:"inline-block","margin-right":"4px"},e[".".concat(n.NAME)]={display:"flex","align-items":"center","max-width":"216px"},e[".".concat(n.NAME_LABEL)]=Re({flex:1},yZ),e[".".concat(n.VALUE)]=Re({display:"inline-block",float:"right",flex:1,"text-align":"right","min-width":"28px","margin-left":"30px",color:"rgba(0, 0, 0, 0.85)"},yZ),e[".".concat(n.CROSSHAIR_X)]={position:"absolute",width:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e[".".concat(n.CROSSHAIR_Y)]={position:"absolute",height:"1px","background-color":"rgba(0, 0, 0, 0.25)"},e}var BZ=function(t){function e(e){var n,r,i=this,A=null===(r=null===(n=e.style)||void 0===n?void 0:n.template)||void 0===r?void 0:r.prefixCls,o=mZ(A);return(i=t.call(this,e,{data:[],x:0,y:0,visibility:"visible",title:"",position:"bottom-right",offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:"",container:'<div class="'.concat(o.CONTAINER,'"></div>'),title:'<div class="'.concat(o.TITLE,'"></div>'),item:'<li class="'.concat(o.LIST_ITEM,'" data-index={index}>\n        <span class="').concat(o.NAME,'">\n          <span class="').concat(o.MARKER,'" style="background:{color}"></span>\n          <span class="').concat(o.NAME_LABEL,'" title="{name}">{name}</span>\n        </span>\n        <span class="').concat(o.VALUE,'" title="{value}">{value}</span>\n      </li>')},style:wZ(A)})||this).timestamp=-1,i.prevCustomContentKey=i.attributes.contentKey,i.initShape(),i.render(i.attributes,i),i}return Pe(e,t),Object.defineProperty(e.prototype,"HTMLTooltipElement",{get:function(){return this.element},enumerable:!1,configurable:!0}),e.prototype.getContainer=function(){return this.element},Object.defineProperty(e.prototype,"elementSize",{get:function(){return{width:this.element.offsetWidth,height:this.element.offsetHeight}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"HTMLTooltipItemsElements",{get:function(){var t=this.attributes,e=t.data,n=t.template;return e.map(function(t,e){var r=t.name,i=void 0===r?"":r,A=t.color,o=void 0===A?"black":A,s=t.index,a=He(t,["name","color","index"]),c=Re({name:i,color:o,index:null!=s?s:e},a);return Tn(function(t,e){return t&&e?t.replace(/\\?\{([^{}]+)\}/g,function(t,n){return"\\"===t.charAt(0)?t.slice(1):void 0===e[n]?"":e[n]}):t}(n.item,c))})},enumerable:!1,configurable:!0}),e.prototype.render=function(t,e){this.renderHTMLTooltipElement(),this.updatePosition()},e.prototype.destroy=function(){var e;null===(e=this.element)||void 0===e||e.remove(),t.prototype.destroy.call(this)},e.prototype.show=function(t,e){var n=this;if(void 0!==t&&void 0!==e){var r=function(){n.attributes.x=null!=t?t:n.attributes.x,n.attributes.y=null!=e?e:n.attributes.y,n.updatePosition()};"hidden"===this.element.style.visibility?this.closeTransition(r):r()}this.element.style.visibility="visible"},e.prototype.hide=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.attributes.enterable&&this.isCursorEntered(t,e)||(this.element.style.visibility="hidden")},e.prototype.initShape=function(){var t=this.attributes.template;this.element=Tn(t.container),this.id&&this.element.setAttribute("id",this.id)},e.prototype.renderCustomContent=function(){if(void 0===this.prevCustomContentKey||this.prevCustomContentKey!==this.attributes.contentKey){this.prevCustomContentKey=this.attributes.contentKey;var t=this.attributes.content;t&&("string"==typeof t?this.element.innerHTML=t:RW(this.element,t))}},e.prototype.renderHTMLTooltipElement=function(){var t,e,n=this.attributes,r=n.template,i=n.title,A=n.enterable,o=n.style,s=n.content,a=mZ(r.prefixCls),c=this.element;if(this.element.style.pointerEvents=A?"auto":"none",s)this.renderCustomContent();else{i?(c.innerHTML=r.title,c.getElementsByClassName(a.TITLE)[0].innerHTML=i):null===(e=null===(t=c.getElementsByClassName(a.TITLE))||void 0===t?void 0:t[0])||void 0===e||e.remove();var l=this.HTMLTooltipItemsElements,u=document.createElement("ul");u.className=a.LIST,RW(u,l);var h=this.element.querySelector(".".concat(a.LIST));h?h.replaceWith(u):c.appendChild(u)}!function(t,e){Object.entries(e).forEach(function(e){var n=Ke(e,2),r=n[0],i=n[1];je([t],Ke(t.querySelectorAll(r)),!1).filter(function(t){return t.matches(r)}).forEach(function(t){t&&(t.style.cssText+=Object.entries(i).reduce(function(t,e){return"".concat(t).concat(e.join(":"),";")},""))})})}(c,o)},e.prototype.getRelativeOffsetFromCursor=function(t){var e=this.attributes,n=e.position,r=e.offset,i=(t||n).split("-"),A={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},o=this.elementSize,s=o.width,a=o.height,c=[-s/2,-a/2];return i.forEach(function(t){var e=Ke(c,2),n=e[0],i=e[1],o=Ke(A[t],2),l=o[0],u=o[1];c=[n+(s/2+r[0])*l,i+(a/2+r[1])*u]}),c},e.prototype.setOffsetPosition=function(t){var e=Ke(t,2),n=e[0],r=e[1],i=this.attributes,A=i.x,o=void 0===A?0:A,s=i.y,a=void 0===s?0:s,c=i.container,l=c.x,u=c.y;this.element.style.left="".concat(+o+l+n,"px"),this.element.style.top="".concat(+a+u+r,"px")},e.prototype.updatePosition=function(){var t=this.attributes.showDelay,e=void 0===t?60:t,n=Date.now();this.timestamp>0&&n-this.timestamp<e||(this.timestamp=n,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},e.prototype.autoPosition=function(t){var e=Ke(t,2),n=e[0],r=e[1],i=this.attributes,A=i.x,o=i.y,s=i.bounding,a=i.position;if(!s)return[n,r];var c=this.element,l=c.offsetWidth,u=c.offsetHeight,h=Ke([+A+n,+o+r],2),d=h[0],f=h[1],g={left:"right",right:"left",top:"bottom",bottom:"top"},p=s.x,v=s.y,m={left:d<p,right:d+l>p+s.width,top:f<v,bottom:f+u>v+s.height},y=[];a.split("-").forEach(function(t){m[t]?y.push(g[t]):y.push(t)});var w=y.join("-");return this.getRelativeOffsetFromCursor(w)},e.prototype.isCursorEntered=function(t,e){if(this.element){var n=this.element.getBoundingClientRect(),r=n.x,i=n.y,A=n.width,o=n.height;return new Xz(r,i,A,o).isPointIn(t,e)}return!1},e.prototype.closeTransition=function(t){var e=this,n=this.element.style.transition;this.element.style.transition="none",t(),setTimeout(function(){e.element.style.transition=n},10)},e.tag="tooltip",e}(GW),bZ=function(t){function e(n){var r=t.call(this,tW({},e.defaultOptions,n))||this;return r.hoverColor="#f5f5f5",r.selectedColor="#e6f7ff",r.background=r.appendChild(new lc({})),r.label=r.background.appendChild(new Ja({})),r}return Pe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return kW(this.style.padding)},enumerable:!1,configurable:!0}),e.prototype.renderLabel=function(){var t=this.style,e=t.label,n=t.value,r=NW(this.attributes,"label");MW(this.label).maybeAppend(".label",function(){return aW(e)}).attr("className","label").styles(r),this.label.attr("__data__",n)},e.prototype.renderBackground=function(){var t=this.label.getBBox(),e=Ke(this.padding,4),n=e[0],r=e[1],i=e[2],A=e[3],o=t.width,s=t.height,a=o+A+r,c=s+n+i,l=NW(this.attributes,"background"),u=this.style,h=u.width,d=void 0===h?0:h,f=u.height,g=void 0===f?0:f,p=u.selected;this.background.attr(Re(Re({},l),{width:Math.max(a,d),height:Math.max(c,g),fill:p?this.selectedColor:"#fff"})),this.label.attr({transform:"translate(".concat(A,", ").concat((c-s)/2,")")})},e.prototype.render=function(){this.renderLabel(),this.renderBackground()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("pointerenter",function(){t.style.selected||t.background.attr("fill",t.hoverColor)}),this.addEventListener("pointerleave",function(){t.style.selected||t.background.attr("fill",t.style.backgroundFill)});var e=this;this.addEventListener("click",function(){var n=t.style,r=n.label,i=n.value,A=n.onClick;null==A||A(i,{label:r,value:i},e)})},e.defaultOptions={style:{value:"",label:"",cursor:"pointer"}},e}(GW),EZ=function(t){function e(n){var r,i,A=t.call(this,tW({},e.defaultOptions,n))||this;A.currentValue=null===(r=e.defaultOptions.style)||void 0===r?void 0:r.defaultValue,A.isPointerInSelect=!1,A.select=A.appendChild(new lc({className:"select",style:{cursor:"pointer",width:0,height:0}})),A.dropdown=A.appendChild(new lc({className:"dropdown"}));var o=A.style.defaultValue;return o&&(null===(i=A.style.options)||void 0===i?void 0:i.some(function(t){return t.value===o}))&&(A.currentValue=o),A}return Pe(e,t),e.prototype.setValue=function(t){this.currentValue=t,this.render()},e.prototype.getValue=function(){return this.currentValue},Object.defineProperty(e.prototype,"dropdownPadding",{get:function(){return kW(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),e.prototype.renderSelect=function(){var t,e=this,n=this.style,r=n.x,i=n.y,A=n.width,o=n.height,s=n.bordered,a=n.showDropdownIcon,c=NW(this.attributes,"select"),l=NW(this.attributes,"placeholder");this.select.attr(Re(Re({x:r,y:i,width:A,height:o},c),{fill:"#fff",strokeWidth:s?1:0}));var u=this.dropdownPadding;a&&MW(this.select).maybeAppend(".dropdown-icon","path").style("d","M-5,-3.5 L0,3.5 L5,-3.5").style("transform","translate(".concat(r+A-10-u[1]-u[3],", ").concat(i+o/2,")")).style("lineWidth",1).style("stroke",this.select.style.stroke);var h=null===(t=this.style.options)||void 0===t?void 0:t.find(function(t){return t.value===e.currentValue}),d=Re({x:r+u[3]},l);MW(this.select).selectAll(".placeholder").data(h?[]:[1]).join(function(t){return t.append("text").attr("className","placeholder").styles(d).style("y",function(){var t=this.getBBox();return i+(o-t.height)/2})},function(t){return t.styles(d)},function(t){return t.remove()});var f=NW(this.attributes,"optionLabel"),g=Re({x:r+u[3]},f);MW(this.select).selectAll(".value").data(h?[h]:[]).join(function(t){return t.append(function(t){return aW(t.label)}).attr("className","value").styles(g).style("y",function(){var t=this.getBBox();return i+(o-t.height)/2})},function(t){return t.styles(g)},function(t){return t.remove()})},e.prototype.renderDropdown=function(){var t,e,n=this,r=this.style,i=r.x,A=r.y,o=r.width,s=r.height,a=r.options,c=r.onSelect,l=r.open,u=NW(this.attributes,"dropdown"),h=NW(this.attributes,"option"),d=this.dropdownPadding;MW(this.dropdown).maybeAppend(".dropdown-container","g").attr("className","dropdown-container").selectAll(".dropdown-item").data(a,function(t){return t.value}).join(function(t){return t.append(function(t){return new bZ({className:"dropdown-item",style:Re(Re(Re({},t),h),{width:o-d[1]-d[3],selected:t.value===n.currentValue,onClick:function(t,e,r){n.setValue(t),null==c||c(t,e,r),n.dispatchEvent(new Xs("change",{detail:{value:t,option:e,item:r}})),Gz(n.dropdown)}})})}).each(function(t,e){var n,r=(null===(n=this.parentNode)||void 0===n?void 0:n.children).reduce(function(t,n,r){return r<e&&(t+=n.getBBox().height),t},0);this.attr("transform","translate(".concat(d[3],", ").concat(d[0]+r,")"))})},function(t){return t.update(function(t){return{selected:t.value===n.currentValue}})},function(t){return t.remove()});var f=null===(e=null===(t=this.dropdown.getElementsByClassName("dropdown-container"))||void 0===t?void 0:t[0])||void 0===e?void 0:e.getBBox(),g=u.spacing;this.dropdown.attr(Re({transform:"translate(".concat(i,", ").concat(A+s+g,")"),width:f.width+d[1]+d[3],height:f.height+d[0]+d[2]},u)),!l&&Gz(this.dropdown)},e.prototype.render=function(){this.renderSelect(),this.renderDropdown()},e.prototype.bindEvents=function(){var t=this;this.addEventListener("click",function(t){t.stopPropagation()}),this.select.addEventListener("click",function(){"visible"===t.dropdown.style.visibility?Gz(t.dropdown):_z(t.dropdown)}),this.addEventListener("pointerenter",function(){t.isPointerInSelect=!0}),this.addEventListener("pointerleave",function(){t.isPointerInSelect=!1}),null===document||void 0===document||document.addEventListener("click",function(){t.isPointerInSelect||Gz(t.dropdown)})},e.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:"",selectRadius:8,selectStroke:"#d9d9d9",showDropdownIcon:!0,placeholderText:"",placeholderFontSize:12,placeholderTextBaseline:"top",placeholderFill:"#c2c2c2",dropdownFill:"#fff",dropdownStroke:"#d9d9d9",dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:"rgba(0, 0, 0, 0.08)",dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:"top",optionBackgroundFill:"#fff",optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:"top"}},e}(GW),xZ=function(t){function e(n){var r=t.call(this,tW({},{style:{backgroundOpacity:e.backgroundOpacities.default}},e.defaultOptions,n))||this;return r.showBackground=!0,r.background=r.appendChild(new lc({})),r.icon=r.appendChild(new Ja({})),r}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"BaseIcon"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"padding",{get:function(){return kW(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconSize",{get:function(){var t=this.attributes.size,e=Ke(this.padding,4),n=e[0],r=e[1],i=e[2],A=e[3];return Math.max(t-Math.max(A+r,n+i),2*this.lineWidth+1)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,r=t.size,i=r/2,A=NW(this.attributes,"background");this.background.attr(Re({x:e-i,y:n-i,width:r,height:r},A))},e.prototype.showIndicator=function(){if(this.label){var t=this.attributes.size,e=this.background.getBBox(),n=e.x,r=e.y;this.indicator.update({x:n+t/2,y:r-5,labelText:this.label,visibility:"visible"})}},e.prototype.hideIndicator=function(){this.indicator.update({visibility:"hidden"})},e.prototype.connectedCallback=function(){var e;t.prototype.connectedCallback.call(this);var n=this.attributes.size,r=this.background.getBBox(),i=r.x,A=r.y,o=null===(e=this.ownerDocument)||void 0===e?void 0:e.defaultView;o&&(this.indicator=o.appendChild(new vZ({style:{x:i+n/2,y:A-n/2,visibility:"hidden",position:"top",radius:3,zIndex:100}})))},e.prototype.disconnectedCallback=function(){this.indicator.destroy()},e.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},e.prototype.bindEvents=function(){var t=this,n=this.attributes.onClick;if(this.addEventListener("click",function(){null==n||n(t)}),this.showBackground){var r=function(){return t.background.attr({opacity:e.backgroundOpacities.default})};this.addEventListener("pointerenter",function(){t.background.attr({opacity:e.backgroundOpacities.hover}),t.showIndicator()}),this.addEventListener("pointerleave",function(){r(),t.hideIndicator()}),this.addEventListener("pointerdown",function(){t.background.attr({opacity:e.backgroundOpacities.active})}),this.addEventListener("pointerup",function(){r()})}},e.tag="IconBase",e.defaultOptions={style:{x:0,y:0,size:10,color:"#565758",backgroundRadius:4,backgroundFill:"#e2e2e2"}},e.backgroundOpacities={default:0,hover:.8,active:1},e}(GW),CZ=function(t,e){return void 0===e&&(e="#565758"),new Ac({style:{fill:e,d:"M ".concat(t,",").concat(t," L -").concat(t,",0 L ").concat(t,",-").concat(t," Z"),transformOrigin:"center"}})},FZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),e.prototype.arcPath=function(t,e,n){var r=Ke([n,n],2),i=r[0],A=r[1],o=function(r){return[t+n*Math.cos(r),e+n*Math.sin(r)]},s=Ke(o(-5/4*Math.PI),2),a=s[0],c=s[1],l=Ke(o(1/4*Math.PI),2),u=l[0],h=l[1];return"M".concat(a,",").concat(c,",A").concat(i,",").concat(A,",0,1,1,").concat(u,",").concat(h)},Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=this.lineWidth,o=A+.5;MW(this.icon).maybeAppend(".reset","path").styles({stroke:r,lineWidth:A,d:this.arcPath(e,n,i/2-A),markerStart:CZ(o,r)})},e}(xZ),MZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=i/2,o=i/2/Math.pow(3,.5),s=[[e,n],[e,n-o],[e-A,n],[e,n+o],[e,n],[e+A,n-o],[e+A,n+o],[e,n]];MW(this.icon).maybeAppend(".backward","polygon").styles({points:s,fill:r})},e}(xZ),kZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=i/2,o=i/2/Math.pow(3,.5),s=[[e,n],[e,n-o],[e+A,n],[e,n+o],[e,n],[e-A,n-o],[e-A,n+o],[e,n]];MW(this.icon).maybeAppend(".forward","polygon").styles({points:s,fill:r})},e}(xZ),QZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=i/3*Math.pow(3,.5)*.8,o=[[e+A,n],[e-A/2,n-i/2*.8],[e-A/2,n+i/2*.8],[e+A,n]];MW(this.icon).maybeAppend(".play","polygon").styles({points:o,fill:r})},e}(xZ),SZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=i/3,o=[[e-A,n-i/2],[e-A,n+i/2],[e-A/2,n+i/2],[e-A/2,n-i/2],[e-A,n-i/2],[e+A/2,n-i/2],[e+A/2,n+i/2],[e+A,n+i/2],[e+A,n-i/2]];MW(this.icon).maybeAppend(".pause","polygon").styles({points:o,fill:r})},e}(xZ),UZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=this.lineWidth,o=A;MW(this.icon).maybeAppend(".left-line","line").styles({x1:e-i/2,y1:n-i/2,x2:e-i/2,y2:n+i/2,stroke:r,lineWidth:A}),MW(this.icon).maybeAppend(".right-line","line").styles({x1:e+i/2,y1:n-i/2,x2:e+i/2,y2:n+i/2,stroke:r,lineWidth:A}),MW(this.icon).maybeAppend(".left-arrow","line").styles({x1:e,y1:n,x2:e-i/2+2*o,y2:n,stroke:r,lineWidth:A,markerEnd:CZ(2*A,r)}),MW(this.icon).maybeAppend(".right-arrow","line").styles({x1:e,y1:n,x2:e+i/2-2*o,y2:n,stroke:r,lineWidth:A,markerEnd:CZ(2*A,r)})},e}(xZ),TZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=this.lineWidth;MW(this.icon).maybeAppend(".line","line").styles({x1:e,y1:n-i/2,x2:e,y2:n+i/2,stroke:r,lineWidth:A});var o=A;MW(this.icon).maybeAppend(".left-arrow","line").styles({x1:e-i/2-2*o,y1:n,x2:e-2*o,y2:n,stroke:r,lineWidth:A,markerEnd:CZ(2*A,r)}),MW(this.icon).maybeAppend(".right-arrow","line").styles({x1:e+i/2+2*o,y1:n,x2:e+2*o,y2:n,stroke:r,lineWidth:A,markerEnd:CZ(2*A,r)})},e}(xZ),OZ=function(t){return[[-t/2,-t/2],[-t/2,t/2],[t/2,t/2]]},NZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=this.lineWidth,o=(i-2*A-A)/4,s=(i-2*A-A)/2,a=Ke([e-i/2+A,n+i/2-2*A],2),c=a[0],l=a[1];MW(this.icon).maybeAppend(".coordinate","polyline").styles({points:OZ(i).map(function(t){var r=Ke(t,2),i=r[0],A=r[1];return[i+e,A+n]}),stroke:r,lineWidth:A}),MW(this.icon).maybeAppend(".line","polyline").styles({points:[[c,l],[c+o,l-s],[c+2*o,l],[c+4*o,l-2*s]],stroke:r,lineWidth:A})},e}(xZ),IZ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Pe(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.data,e=this.attributes,n=e.x,r=e.y,i=e.color,A=this.iconSize,o=this.lineWidth,s=o,a=(A-s)/t.length,c=(A-2*s)/4,l=Ke([n-A/2+2*s,r+A/2-s],2),u=l[0],h=l[1];MW(this.icon).maybeAppend(".coordinate","polyline").styles({points:OZ(A).map(function(t){var e=Ke(t,2),i=e[0],A=e[1];return[i+n,A+r]}),stroke:i,lineWidth:o}),MW(this.icon).maybeAppend(".bars","g").selectAll(".column").data(this.data.map(function(t,e){return{value:t,index:e}})).join(function(t){return t.append("line").attr("className","column").style("x1",function(t){var e=t.index;return u+a*e}).style("y1",h).style("x2",function(t){var e=t.index;return u+a*e}).style("y2",function(t){var e=t.value;return h-c*e}).styles({y1:h,stroke:i,lineWidth:o})})},e}(xZ),LZ=function(t){function e(e){var n=t.call(this,tW({},{style:{color:"#d8d9d9"}},e))||this;return n.showBackground=!1,n}return Pe(e,t),e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.color,i=this.iconSize,A=this.lineWidth;MW(this.icon).maybeAppend(".split","line").styles({x1:e,y1:n-i/2,x2:e,y2:n+i/2,stroke:r,lineWidth:A})},e}(xZ),DZ=function(t){function e(){var e=t.apply(this,je([],Ke(arguments),!1))||this;return e.showBackground=!1,e}return Pe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return kW(0)},enumerable:!1,configurable:!0}),e.prototype.renderIcon=function(){var t=this.iconSize,e=this.attributes,n=e.x,r=e.y,i=e.speed,A=void 0===i?1:i,o=Te(this.attributes,["x","y","transform","transformOrigin","width","height","size","color","speed"]),s=Ae(t,20,1/0),a=Re(Re({},o),{x:n-s/2,y:r-10,width:s,height:20,defaultValue:A,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:t/5,placeholderFontSize:t/2,optionPadding:0,optionLabelFontSize:t/2,optionBackgroundRadius:1,options:[{label:"1x",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}]});MW(this.icon).maybeAppend(".speed",function(){return new EZ({style:a})}).attr("className","speed").each(function(){this.update(a)})},e.tag="SpeedSelect",e}(xZ),PZ=function(t){function e(e){var n=t.call(this,e)||this;return n.icon=n.appendChild(new Ja({})),n.currentType=n.attributes.type,n}return Pe(e,t),e.prototype.getType=function(){return this.currentType},e.prototype.render=function(){var t=this,e=this.attributes;e.onChange;var n=He(e,["onChange"]);MW(this.icon).selectAll(".icon").data([this.currentType]).join(function(e){return e.append(function(e){var n,r=null===(n=t.toggles.find(function(t){return Ke(t,1)[0]===e}))||void 0===n?void 0:n[1];if(!r)throw new Error("Invalid type: ".concat(e));return new r({})}).attr("className","icon").styles(n,!1).update({})},function(t){return t.styles({restStyles:n}).update({})},function(t){return t.remove()})},e.prototype.bindEvents=function(){var t=this,e=this.attributes.onChange;this.addEventListener("click",function(n){n.preventDefault(),n.stopPropagation();var r=(t.toggles.findIndex(function(e){return Ke(e,1)[0]===t.currentType})+1)%t.toggles.length,i=t.toggles[r][0];null==e||e(t.currentType),t.currentType=i,t.render()})},e.tag="ToggleIcon",e}(GW),RZ=function(t){function e(e){var n=t.call(this,tW({},{style:{type:"play"}},e))||this;return n.toggles=[["play",QZ],["pause",SZ]],n}return Pe(e,t),e}(PZ),HZ=function(t){function e(e){var n=t.call(this,tW({},{style:{type:"range"}},e))||this;return n.toggles=[["range",UZ],["value",TZ]],n}return Pe(e,t),e}(PZ),_Z=function(t){function e(e){var n=t.call(this,tW({},{style:{type:"column"}},e))||this;return n.toggles=[["line",NZ],["column",IZ]],n}return Pe(e,t),e}(PZ),GZ={reset:FZ,speed:DZ,backward:MZ,playPause:RZ,forward:kZ,selectionType:HZ,chartType:_Z,split:LZ},KZ=function(t){function e(n){var r=t.call(this,tW({},e.defaultOptions,n))||this;return r.background=r.appendChild(new lc({})),r.functions=r.appendChild(new Ja({})),r}return Pe(e,t),Object.defineProperty(e.prototype,"padding",{get:function(){return kW(this.attributes.padding)},enumerable:!1,configurable:!0}),e.prototype.renderBackground=function(){var t=this.style,e=t.x,n=t.y,r=t.width,i=t.height,A=NW(this.attributes,"background");this.background.attr(Re({x:e,y:n,width:r,height:i},A))},e.prototype.renderFunctions=function(){var t,e=this,n=this.attributes,r=n.functions,i=n.iconSize,A=n.iconSpacing,o=n.x,s=n.y,a=n.width,c=n.height,l=n.align,u=Ke(this.padding,4),h=u[1],d=u[3],f=r.reduce(function(t,e){return t.length&&e.length?t.concat.apply(t,je(["split"],Ke(e),!1)):t.concat.apply(t,je([],Ke(e),!1))},[]),g=f.length*(i+A)-A,p={left:d+i/2,center:(a-g)/2+i/2,right:a-g-d-h+i/2}[l]||0;null===(t=this.speedSelect)||void 0===t||t.destroy(),this.functions.removeChildren(),f.forEach(function(t,n){var r,a=GZ[t],l={x:o+n*(i+A)+p,y:s+c/2,size:i};if(a===DZ?(l.speed=e.attributes.speed,l.onSelect=function(n){return e.handleFunctionChange(t,{value:n})}):[RZ,HZ,_Z].includes(a)?(l.onChange=function(n){return e.handleFunctionChange(t,{value:n})},a===RZ&&(l.type="play"===e.attributes.state?"pause":"play"),a===HZ&&(l.type="range"===e.attributes.selectionType?"value":"range"),a===_Z&&(l.type="line"===e.attributes.chartType?"column":"line")):l.onClick=function(){return e.handleFunctionChange(t,{value:t})},a===DZ){var u=null===(r=e.ownerDocument)||void 0===r?void 0:r.defaultView;u&&(e.speedSelect=new a({style:Re(Re({},l),{zIndex:100})}),u.appendChild(e.speedSelect))}else e.functions.appendChild(new a({style:l}))})},e.prototype.disconnectedCallback=function(){var e;t.prototype.disconnectedCallback.call(this),null===(e=this.speedSelect)||void 0===e||e.destroy()},e.prototype.render=function(){this.renderBackground(),this.renderFunctions()},e.prototype.handleFunctionChange=function(t,e){var n=this.attributes.onChange;null==n||n(t,e)},e.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:"center",iconSize:25,iconSpacing:0,speed:1,state:"pause",chartType:"line",selectionType:"range",backgroundFill:"#fbfdff",backgroundStroke:"#ebedf0",functions:[["reset","speed"],["backward","playPause","forward"],["selectionType","chartType"]]}},e}(GW),jZ=function(t){function e(n){var r=t.call(this,tW({},e.defaultOptions,n))||this;return r.bindEvents(),r}return Pe(e,t),e.prototype.bindEvents=function(){var t=this;this.addEventListener("mouseenter",function(){t.attr("lineWidth",Math.ceil(+(t.style.r||0)/2))}),this.addEventListener("mouseleave",function(){t.attr("lineWidth",0)})},e.defaultOptions={style:{r:5,fill:"#3f7cf7",lineWidth:0,stroke:"#3f7cf7",strokeOpacity:.5,cursor:"pointer"}},e}(Ya),VZ=function(t){function e(n){return t.call(this,tW({},e.defaultOptions,n))||this}return Pe(e,t),e.prototype.renderBackground=function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,A=NW(this.attributes,"background");MW(this).maybeAppend("background","rect").attr("className","background").styles(Re({x:e-r/2,y:n-i/2,width:r,height:i},A))},e.prototype.renderIcon=function(){var t=this.attributes,e=t.x,n=t.y,r=t.iconSize,i=NW(this.attributes,"icon"),A=r/2;MW(this).maybeAppend("icon-left-line","line").attr("className","icon-left-line").styles(Re({x1:e-1,y1:n-A,x2:e-1,y2:n+A},i)),MW(this).maybeAppend("icon-right-line","line").attr("className","icon-right-line").styles(Re({x1:e+1,y1:n-A,x2:e+1,y2:n+A},i))},e.prototype.renderBorder=function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,A=t.type,o=NW(this.attributes,"border"),s="start"===A?+r/2:-r/2;MW(this).maybeAppend("border","line").attr("className","border").styles(Re({x1:s+e,y1:n-i/2,x2:s+e,y2:n+i/2},o))},e.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},e.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:"start",backgroundFill:"#fff",backgroundFillOpacity:.5,iconStroke:"#9a9a9a",iconLineWidth:1,borderStroke:"#e8e8e8",borderLineWidth:1}},e}(GW);function zZ(t,e){return"number"==typeof t?WZ(t):function(t,e){var n=new Date(t);switch(e){case"half-hour":case"hour":case"four-hour":return[0,6,12,18].includes(n.getHours())&&0===n.getMinutes()?DW(n,"HH:mm\nYYYY-MM-DD"):DW(n,"HH:mm");case"half-day":return n.getHours()<12?"AM\n".concat(DW(n,"YYYY-MM-DD")):"PM";case"day":return[1,10,20].includes(n.getDate())?DW(n,"DD\nYYYY-MM"):DW(n,"DD");case"week":return n.getDate()<=7?DW(n,"DD\nYYYY-MM"):DW(n,"DD");case"month":return[0,6].includes(n.getMonth())?DW(n,"MM\nYYYY"):DW(n,"MM");case"season":return[0].includes(n.getMonth())?DW(n,"MM\nYYYY"):DW(n,"MM");case"year":return DW(n,"YYYY");default:return DW(n,"YYYY-MM-DD HH:mm")}}(t,e)}function WZ(t){var e=String(Math.floor(t/3600)).padStart(2,"0"),n=String(Math.floor(t%3600/60)).padStart(2,"0"),r=String(Math.floor(t%60)).padStart(2,"0");return t<3600?"".concat(n,":").concat(r):"".concat(e,":").concat(n,":").concat(r)}var YZ=function(t){function e(n){var r=t.call(this,tW({},e.defaultOptions,n))||this;r.axis=r.appendChild(new Qq({style:{type:"linear",startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new uX({style:{onChange:function(t){r.handleSliderChange(t)}}})),r.controller=r.appendChild(new KZ({})),r.states={},r.handleSliderChange=function(t){var e,n=(e=r.states.values,Array.isArray(e)?je([],Ke(e),!1):e);r.setBySliderValues(t),r.dispatchOnChange(n)};var i=r.attributes,A=i.selectionType,o=i.chartType,s=i.speed,a=i.state,c=i.playMode,l=i.values;return r.states={chartType:o,playMode:c,selectionType:A,speed:s,state:a},r.setByTimebarValues(l),r}return Pe(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.attributes.data.sort(function(t,e){return t.time<e.time?-1:t.time>e.time?1:0})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){var t=this.attributes,e=t.x,n=t.y,r=t.width,i=t.height,A=t.type,o=t.controllerHeight,s=Ae(+i-o,0,+i),a=new Xz(e,n+ +i-o,+r,o),c=0,l="time"===A?10:s;return{axisBBox:"chart"===A?new Xz(e,n+s-(c=35),+r,c):new Xz,controllerBBox:a,timelineBBox:new Xz(e,n+("time"===A?s:s-l),+r,l-c)}},enumerable:!1,configurable:!0}),e.prototype.setBySliderValues=function(t){var e,n,r=this.data,i=Ke(Array.isArray(t)?t:[0,t],2),A=i[0],o=i[1],s=r.length,a=r[Math.floor(A*s)],c=r[Math.ceil(o*s)-(Array.isArray(t)?0:1)];this.states.values=[null!==(e=null==a?void 0:a.time)&&void 0!==e?e:r[0].time,null!==(n=null==c?void 0:c.time)&&void 0!==n?n:1/0]},e.prototype.setByTimebarValues=function(t){var e,n,r,i=this.data,A=Ke(Array.isArray(t)?t:[void 0,t],2),o=A[0],s=A[1],a=i.find(function(t){return t.time===o}),c=i.find(function(t){return t.time===s});this.states.values=[null!==(e=null==a?void 0:a.time)&&void 0!==e?e:null===(n=i[0])||void 0===n?void 0:n.time,null!==(r=null==c?void 0:c.time)&&void 0!==r?r:1/0]},e.prototype.setByIndex=function(t){var e,n,r,i,A=this.data,o=Ke(t,2),s=o[0],a=o[1];this.states.values=[null!==(n=null===(e=A[s])||void 0===e?void 0:e.time)&&void 0!==n?n:A[0].time,null!==(i=null===(r=this.data[a])||void 0===r?void 0:r.time)&&void 0!==i?i:1/0]},Object.defineProperty(e.prototype,"sliderValues",{get:function(){var t,e=this.states,n=e.values,r=e.selectionType,i=Ke(Array.isArray(n)?n:[void 0,n],2),A=i[0],o=i[1],s=this.data,a=s.length,c="value"===r;return[(t=s.findIndex(function(t){return t.time===A}),c?0:t>-1?t/a:0),function(){if(o===1/0)return 1;var t=s.findIndex(function(t){return t.time===o});return t>-1?t/a:c?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){var t=this.states,e=t.values,n=t.selectionType,r=Ke(Array.isArray(e)?e:[this.data[0].time,e],2),i=r[0],A=r[1];return"value"===n?A:[i,A]},enumerable:!1,configurable:!0}),e.prototype.getDatumByRatio=function(t){var e=this.data,n=e.length;return e[Math.floor(t*(n-1))]},Object.defineProperty(e.prototype,"chartHandleIconShape",{get:function(){var t=this.states.selectionType,e=this.space.timelineBBox.height;return"range"===t?function(t){return new VZ({style:{type:t,height:e,iconSize:e/6}})}:function(){return new rc({style:{x1:0,y1:-e/2,x2:0,y2:e/2,lineWidth:2,stroke:"#c8c8c8"}})}},enumerable:!1,configurable:!0}),e.prototype.getChartStyle=function(t){var e=this,n=t.x,r=t.y,i=t.width,A=t.height,o=this.states,s=o.selectionType,a=o.chartType,c=this.data,l=this.attributes,u=l.type,h=l.labelFormatter,d=NW(this.attributes,"chart");d.type;var f=He(d,["type"]),g="range"===s;if("time"===u)return Re({handleIconShape:function(){return new jZ({})},selectionFill:"#2e7ff8",selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:g?-15:0,autoFitLabel:g,handleSpacing:g?-15:0,trackFill:"#edeeef",trackLength:i,trackOpacity:.5,trackRadius:A/2,trackSize:A/2,type:s,values:this.sliderValues,formatter:function(t){if(h)return h(t);var n=e.getDatumByRatio(t).time;return"number"==typeof n?WZ(n):DW(n,"YYYY-MM-DD HH:mm:ss")},transform:"translate(".concat(n,", ").concat(r,")"),zIndex:1},f);var p="range"===s?5:0,v=c.map(function(t){return t.value});return Re({handleIconOffset:p,handleIconShape:this.chartHandleIconShape,selectionFill:"#fff",selectionFillOpacity:.5,selectionType:"invert",sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:"#d4e5fd",sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:v,sparklineType:a,sparklineScale:.8,trackLength:i,trackSize:A,type:s,values:this.sliderValues,transform:"translate(".concat(n,", ").concat(r,")"),zIndex:1},f)},e.prototype.renderChart=function(t){void 0===t&&(t=this.space.timelineBBox),this.timeline.update(this.getChartStyle(t))},e.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},e.prototype.getAxisStyle=function(t){var e=this.data,n=this.attributes,r=n.interval,i=n.labelFormatter,A=NW(this.attributes,"axis"),o=t.x,s=t.y,a=t.width,c=je(je([],Ke(e),!1),[{time:0}],!1).map(function(t,e,n){var r=t.time;return{label:"".concat(r),value:e/(n.length-1),time:r}}),l=Re({startPos:[o,s],endPos:[o+a,s],data:c,labelFilter:function(t,e){return e<c.length-1},labelFormatter:function(t){var e=t.time;return i?i(e):zZ(e,r)}},A);return l},e.prototype.renderAxis=function(t){void 0===t&&(t=this.space.axisBBox),"chart"===this.attributes.type&&this.axis.update(this.getAxisStyle(t))},e.prototype.renderController=function(t){void 0===t&&(t=this.space.controllerBBox);var e=this.attributes.type,n=this.states,r=n.state,i=n.speed,A=n.selectionType,o=n.chartType,s=NW(this.attributes,"controller"),a=this,c=Re(Re(Re({},t),{iconSize:20,speed:i,state:r,selectionType:A,chartType:o,onChange:function(t,e){var n=e.value;switch(t){case"reset":a.internalReset();break;case"speed":a.handleSpeedChange(n);break;case"backward":a.internalBackward();break;case"playPause":"play"===n?a.internalPlay():a.internalPause();break;case"forward":a.internalForward();break;case"selectionType":a.handleSelectionTypeChange(n);break;case"chartType":a.handleChartTypeChange(n)}}}),s);"time"===e&&(c.functions=[["reset","speed"],["backward","playPause","forward"],["selectionType"]]),this.controller.update(c)},e.prototype.dispatchOnChange=function(t){var e=this.data,n=this.attributes.onChange,r=this.states,i=r.values,A=r.selectionType,o=Ke(i,2),s=o[0],a=o[1],c=a===1/0?e.at(-1).time:a;t&&function(t,e){if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t[0]===e[0]){if(t[1]===e[1])return!0;if(t[1]===1/0||e[1]===1/0)return!0}return!1}return!Array.isArray(e)&&t===e}(t,"range"===A?[s,c]:c)||null==n||n("range"===A?[s,c]:c)},e.prototype.internalReset=function(t){var e,n,r=this.states.selectionType;this.internalPause(),this.setBySliderValues("range"===r?[0,1]:[0,0]),this.renderController(),this.updateSelection(),t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onReset)||void 0===n||n.call(e),this.dispatchOnChange())},e.prototype.reset=function(){this.internalReset()},e.prototype.moveSelection=function(t,e){var n=this.data,r=n.length,i=this.states,A=i.values,o=i.selectionType,s=i.playMode,a=Ke(A,2),c=a[0],l=a[1],u=n.findIndex(function(t){return t.time===c}),h=n.findIndex(function(t){return t.time===l});-1===h&&(h=r);var d,f="backward"===t?-1:1;"range"===o?"acc"===s?(d=[u,h+f],-1===f&&u===h&&(d=[u,r])):d=[u+f,h+f]:d=[u,h+f];var g=function(t){var e=Ke(t.sort(function(t,e){return t-e}),2),n=e[0],i=e[1],A=function(t){return Ae(t,0,r)};return i>r?"value"===o?[0,0]:"acc"===s?[A(n),A(n)]:[0,A(i-n)]:n<0?"acc"===s?[0,A(i)]:[A(n+r-i),r]:[A(n),A(i)]}(d);return this.setByIndex(g),this.updateSelection(),g},e.prototype.internalBackward=function(t){var e,n,r=this.moveSelection("backward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onBackward)||void 0===n||n.call(e),this.dispatchOnChange()),r},e.prototype.backward=function(){this.internalBackward()},e.prototype.internalPlay=function(t){var e,n,r=this,i=this.data,A=this.attributes.loop,o=this.states.speed,s=void 0===o?1:o;this.playInterval=window.setInterval(function(){r.internalForward()[1]!==i.length||A||(r.internalPause(),r.renderController())},1e3/s),this.states.state="play",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPlay)||void 0===n||n.call(e))},e.prototype.play=function(){this.internalPlay()},e.prototype.internalPause=function(t){var e,n;clearInterval(this.playInterval),this.states.state="pause",!t&&(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onPause)||void 0===n||n.call(e))},e.prototype.pause=function(){this.internalPause()},e.prototype.internalForward=function(t){var e,n,r=this.moveSelection("forward",t);return t||(null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onForward)||void 0===n||n.call(e),this.dispatchOnChange()),r},e.prototype.forward=function(){this.internalForward()},e.prototype.handleSpeedChange=function(t){var e,n;this.states.speed=t,"play"===this.states.state&&(this.internalPause(!0),this.internalPlay(!0)),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSpeedChange)||void 0===n||n.call(e,t)},e.prototype.handleSelectionTypeChange=function(t){var e,n;this.states.selectionType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onSelectionTypeChange)||void 0===n||n.call(e,t)},e.prototype.handleChartTypeChange=function(t){var e,n;this.states.chartType=t,this.renderChart(),null===(n=null===(e=this.attributes)||void 0===e?void 0:e.onChartTypeChange)||void 0===n||n.call(e,t)},e.prototype.render=function(){var t=this.space,e=t.axisBBox,n=t.controllerBBox,r=t.timelineBBox;this.renderController(n),this.renderAxis(e),this.renderChart(r),"play"===this.states.state&&this.internalPlay()},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.internalPause(!0)},e.defaultOptions={style:{x:0,y:0,axisLabelFill:"#6e6e6e",axisLabelTextAlign:"left",axisLabelTextBaseline:"top",axisLabelTransform:"translate(5, -12)",axisLineLineWidth:1,axisLineStroke:"#cacdd1",axisTickLength:15,axisTickLineWidth:1,axisTickStroke:"#cacdd1",chartShowLabel:!1,chartType:"line",controllerAlign:"center",controllerHeight:40,data:[],interval:"day",loop:!1,playMode:"acc",selectionType:"range",type:"time"}},e}(GW);function XZ(t){const{width:e,height:n,renderer:r}=t,i=function(t){var e;const{container:n,className:r,graphCanvas:i}=t;if(n)return"string"==typeof n?document.getElementById(n):n;const A=Jj(r,!1),{width:o,height:s,containerStyle:a}=t,[c,l]=function(t){const{width:e,height:n,placement:r,graphCanvas:i}=t,[A,o]=i.getSize(),[s,a]=Fy(r);return[s*(A-e),a*(o-n)]}(t);return Object.assign(A.style,Object.assign({position:"absolute",left:c+"px",top:l+"px",width:o+"px",height:s+"px"},a)),null===(e=i.getContainer())||void 0===e||e.appendChild(A),A}(t);return[i,new Mc({width:e,height:n,container:i,renderer:r||new HB})]}class qZ extends Zj{constructor(e,n){super(e,Object.assign({},qZ.defaultOptions,n)),this.typePrefix="__data__",this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{const{graph:e}=this.context;e.on(t.GraphEvent.AFTER_DRAW,this.createElement)},this.changeState=(t,e)=>{const{graph:n}=this.context,{typePrefix:r}=this,i=ke(t,[r,"id"]),A=ke(t,[r,"style","labelText"]),[o]=i.split("__"),s=this.fieldMap[o].get(A)||[];n.setElementState(Object.fromEntries(null==s?void 0:s.map(t=>[t,e])))},this.click=t=>{if("hover"===this.options.trigger)return;const e=ke(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?(this.selectedItems=this.selectedItems.filter(t=>t!==e),this.changeState(t,[])):(this.selectedItems.push(e),this.changeState(t,"selected"))},this.mouseleave=t=>{"click"!==this.options.trigger&&(this.selectedItems=[],this.changeState(t,[]))},this.mouseenter=t=>{if("click"===this.options.trigger)return;const e=ke(t,[this.typePrefix,"id"]);this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter(t=>t!==e):(this.selectedItems.push(e),this.changeState(t,"active"))},this.setFieldMap=(t,e,n)=>{if(!t)return;const r=this.fieldMap[n];if(r)if(r.has(t)){const n=r.get(t);n&&(n.push(e),r.set(t,n))}else r.set(t,[e])},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(t,e)=>{if(!t)return[];const{model:n,element:r}=this.context,{nodes:i,edges:A,combos:o}=n.getData(),s={},a=e=>Vt(t)?t(e):t,c={node:"circle",edge:"line",combo:"rect"},l={circle:"circle",ellipse:"circle",image:"bowtie",rect:"square",star:"cross",triangle:"triangle",diamond:"diamond",cubic:"dot",line:"hyphen",polyline:"hyphen",quadratic:"hv","cubic-horizontal":"hyphen","cubic-vertical":"line"},u=(t,e)=>{t.forEach(t=>{const{id:n}=t,i=ke(t,["data",a(t)]),A=(null==r?void 0:r.getElementType(e,t))||"circle",o=((t,e)=>null==r?void 0:r.getElementComputedStyle(t,e))(e,t),u=("edge"===e?null==o?void 0:o.stroke:null==o?void 0:o.fill)||"#1783ff";n&&i&&i.replace(/\s+/g,"")&&(this.setFieldMap(i,n,e),s[i]||(s[i]={id:`${e}__${n}`,label:i,marker:l[A]||c[e],elementType:e,lineWidth:1,stroke:u,fill:u}))})};switch(e){case"node":u(i,"node");break;case"edge":u(A,"edge");break;case"combo":u(o,"combo");break;default:return[]}return Object.values(s)},this.createElement=()=>{if(this.draw)return void this.updateElement();const t=this.options,{width:e,height:n,nodeField:r,edgeField:i,comboField:A,trigger:o,position:s,container:a,containerStyle:c,className:l}=t,u=He(t,["width","height","nodeField","edgeField","comboField","trigger","position","container","containerStyle","className"]),h=this.getMarkerData(r,"node"),d=this.getMarkerData(i,"edge"),f=this.getMarkerData(A,"combo"),g=[...h,...f,...d],p=Object.assign({width:e,height:n,data:g,itemMarkerLineWidth:({lineWidth:t})=>t,itemMarker:({marker:t})=>t,itemMarkerStroke:({stroke:t})=>t,itemMarkerFill:({fill:t})=>t,gridCol:h.length},u,this.getEvents()),v=new fZ({className:"legend",style:p});this.category=v;this.upsertCanvas().appendChild(v),this.draw=!0},this.bindEvents()}update(t){super.update(t),this.clear(),this.createElement()}clear(){var t,e;null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.container)||void 0===e||e.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5,itemLabelOpacity:({id:t})=>!this.selectedItems.length||this.selectedItems.includes(t)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;const t=this.context.canvas,[e,n]=t.getSize(),{width:r=e,height:i=n,position:A,container:o,containerStyle:s,className:a}=this.options,[c,l]=XZ({width:r,height:i,graphCanvas:t,container:o,containerStyle:s,placement:A,className:"legend"});return this.container=c,a&&c.classList.add(a),this.canvas=l,this.canvas}destroy(){this.clear(),this.context.graph.off(t.GraphEvent.AFTER_DRAW,this.createElement),super.destroy()}}qZ.defaultOptions={position:"bottom",trigger:"hover",orientation:"horizontal",layout:"flex",itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};class ZZ extends Zj{constructor(t,e){super(t,Object.assign({},ZZ.defaultOptions,e)),this.onDraw=t=>{var e;(null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.render)||this.onRender()},this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=t=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(t.pointerId),this.mask.addEventListener("pointermove",this.onMaskDrag),this.mask.addEventListener("pointerup",this.onMaskDragEnd),this.mask.addEventListener("pointercancel",this.onMaskDragEnd))},this.onMaskDrag=t=>{if(!this.mask||!this.isMaskDragging)return;const{size:[e,n]}=this.options,{movementX:r,movementY:i}=t,{left:A,top:o,width:s,height:a}=this.mask.style,[,,c,l]=this.maskBBox;let u=parseInt(A)+r,h=parseInt(o)+i,d=parseInt(s),f=parseInt(a);u<0&&(u=0),h<0&&(h=0),u+d>e&&(u=$Z(e-d,0)),h+f>n&&(h=$Z(n-f,0)),d<c&&(r>0?(u=$Z(u-r,0),d=JZ(d+r,e)):r<0&&(d=JZ(d-r,e))),f<l&&(i>0?(h=$Z(h-i,0),f=JZ(f+i,n)):i<0&&(f=JZ(f-i,n))),Object.assign(this.mask.style,{left:u+"px",top:h+"px",width:d+"px",height:f+"px"});const g=parseInt(A)-u,p=parseInt(o)-h;if(0===g&&0===p)return;const v=this.context.canvas.getCamera().getZoom()/this.canvas.getCamera().getZoom();this.context.graph.translateBy([g*v,p*v],!1)},this.onMaskDragEnd=t=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(t.pointerId),this.mask.removeEventListener("pointermove",this.onMaskDrag),this.mask.removeEventListener("pointerup",this.onMaskDragEnd),this.mask.removeEventListener("pointercancel",this.onMaskDragEnd))},this.onTransform=Oe(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(t){this.unbindEvents(),super.update(t),"delay"in t&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=ye(()=>{this.renderMinimap(),this.renderMask()},this.options.delay)}bindEvents(){const{graph:e}=this.context;e.on(t.GraphEvent.AFTER_DRAW,this.onDraw),e.on(t.GraphEvent.AFTER_RENDER,this.onRender),e.on(t.GraphEvent.AFTER_ANIMATE,this.onRender),e.on(t.GraphEvent.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){const{graph:e}=this.context;e.off(t.GraphEvent.AFTER_DRAW,this.onDraw),e.off(t.GraphEvent.AFTER_RENDER,this.onRender),e.off(t.GraphEvent.AFTER_ANIMATE,this.onRender),e.off(t.GraphEvent.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){const t=this.getElements(),e=this.initCanvas();this.setShapes(e,t)}getElements(){const{filter:t}=this.options,{model:e,element:n}=this.context,r=e.getData(),i={nodes:r.nodes.filter(t=>null==n?void 0:n.getElement(Vm(t))),edges:r.edges.filter(t=>{const e=null==n?void 0:n.getElement(Vm(t));return e&&qb(e)}),combos:r.combos.filter(t=>null==n?void 0:n.getElement(Vm(t)))};if(!t)return i;const{nodes:A,edges:o,combos:s}=i;return{nodes:A.filter(e=>t(Vm(e),"node")),edges:o.filter(e=>t(Vm(e),"edge")),combos:s.filter(e=>t(Vm(e),"combo"))}}setShapes(t,e){const{nodes:n,edges:r,combos:i}=e,{shape:A}=this.options,{element:o}=this.context,s=(e,n)=>{const r=Vm(e),i=null==o?void 0:o.getElement(r);if(!i)return;const s=i.getShape("key");let a;if("string"==typeof A){const t=A;a=i.getShape(t).cloneNode()}else{const t=A(r,n,i);a=t===i?t.cloneNode(!0):t}a.setPosition(s.getPosition()),i.style.zIndex&&(a.style.zIndex=i.style.zIndex),a.id=i.id,t.appendChild(a)};t.removeChildren(),r.forEach(t=>s(t,"edge")),i.forEach(t=>s(t,"combo")),n.forEach(t=>s(t,"node"))}initCanvas(){const{renderer:t,size:[e,n]}=this.options;if(this.canvas){const{width:r,height:i}=this.canvas.getConfig();e===r&&n===i||this.canvas.resize(e,n),t&&this.canvas.setRenderer(t)}else{const{className:r,position:i,container:A,containerStyle:o}=this.options,[s,a]=XZ({renderer:t,width:e,height:n,placement:i,className:"minimap",container:A,containerStyle:o,graphCanvas:this.context.canvas});r&&s.classList.add(r),this.container=s,this.canvas=a}return this.setCamera(),this.canvas}createLandmark(t,e,n){const r=`${t.join(",")}-${e.join(",")}-${n}`;if(this.landmarkMap.has(r))return this.landmarkMap.get(r);const i=this.canvas.getCamera().createLandmark(r,{position:t,focalPoint:e,zoom:n});return this.landmarkMap.set(r,i),i}setCamera(){var t;const{canvas:e}=this.context,n=null===(t=this.canvas)||void 0===t?void 0:t.getCamera();if(!n)return;const{size:[r,i],padding:A}=this.options,[o,s,a,c]=mm(A),{min:l,max:u,center:h}=e.getBounds("elements"),d=(r-c-s)/(u[0]-l[0]),f=(i-o-a)/(u[1]-l[1]),g=Math.min(d,f),p=this.createLandmark(h,h,g);n.gotoLandmark(p,0)}get maskBBox(){const{canvas:t}=this.context,e=t.getSize(),n=t.getCanvasByViewport([0,0]),r=t.getCanvasByViewport(e),i=this.canvas.canvas2Viewport(Uy(n)),A=this.canvas.canvas2Viewport(Uy(r)),o=A.x-i.x,s=A.y-i.y;return[i.x,i.y,o,s]}calculateMaskBBox(){const{size:[t,e]}=this.options;let[n,r,i,A]=this.maskBBox;return n<0&&(i=JZ(i+n,t),n=0),r<0&&(A=JZ(A+r,e),r=0),n+i>t&&(i=$Z(t-n,0)),r+A>e&&(A=$Z(e-r,0)),[JZ(n,t),JZ(r,e),$Z(i,0),$Z(A,0)]}renderMask(){const{maskStyle:t}=this.options;this.mask||(this.mask=document.createElement("div"),this.mask.addEventListener("pointerdown",this.onMaskDragStart),this.mask.draggable=!0,this.mask.addEventListener("dragstart",t=>t.preventDefault&&t.preventDefault())),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},t),{cursor:"move",position:"absolute",pointerEvents:"auto"})),this.updateMask()}updateMask(){if(!this.mask)return;const[t,e,n,r]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:e+"px",left:t+"px",width:n+"px",height:r+"px"})}destroy(){var t,e,n;this.unbindEvents(),null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.mask)||void 0===e||e.remove(),null===(n=this.container)||void 0===n||n.remove(),super.destroy()}}ZZ.defaultOptions={size:[240,160],shape:"key",padding:10,position:"right-bottom",maskStyle:{border:"1px solid #ddd",background:"rgba(0, 0, 0, 0.1)"},containerStyle:{border:"1px solid #ddd",background:"#fff"},delay:128};const JZ=(t,e)=>Math.min(t,e),$Z=(t,e)=>Math.max(t,e),tJ={x1:0,y1:0,x2:0,y2:0,visibility:"hidden"};class eJ extends Zj{constructor(t,e){super(t,Object.assign({},eJ.defaultOptions,e)),this.initSnapline=()=>{const t=this.context.canvas.getLayer("transient");this.horizontalLine||(this.horizontalLine=t.appendChild(new rc({style:Object.assign(Object.assign({},tJ),this.options.horizontalLineStyle)}))),this.verticalLine||(this.verticalLine=t.appendChild(new rc({style:Object.assign(Object.assign({},tJ),this.options.verticalLineStyle)})))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(t,e,n)=>_e(this,void 0,void 0,function*(){const{verticalX:r,horizontalY:i}=n,{tolerance:A}=this.options,{min:[o,s],max:[a,c],center:[l,u]}=e;let h=0,d=0;null!==r&&(nJ(a,r)<A&&(h=r-a),nJ(o,r)<A&&(h=r-o),nJ(l,r)<A&&(h=r-l),0!==h&&(this.isVerticalSticking=!0)),null!==i&&(nJ(c,i)<A&&(d=i-c),nJ(s,i)<A&&(d=i-s),nJ(u,i)<A&&(d=i-u),0!==d&&(this.isHorizontalSticking=!0)),0===h&&0===d||(yield this.context.graph.translateElementBy({[t]:[h,d]},!1))}),this.enableSnap=t=>{const{target:e}=t,n=.5;if(this.isHorizontalSticking||this.isVerticalSticking){const[r,i]=this.getDelta(t);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(r)<=n&&Math.abs(i)<=n)return this.context.graph.translateElementBy({[e.id]:[-r,-i]},!1),!1;if(this.isHorizontalSticking&&Math.abs(i)<=n)return this.context.graph.translateElementBy({[e.id]:[0,-i]},!1),!1;if(this.isVerticalSticking&&Math.abs(r)<=n)return this.context.graph.translateElementBy({[e.id]:[-r,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(t,e)=>{const{tolerance:n,shape:r}=this.options,{min:[i,A],max:[o,s],center:[a,c]}=e;let l=null,u=null,h=null,d=null,f=null,g=null;return this.getNodes().some(e=>{if(Me(t.id,e.id))return!1;const p=rJ(e,r).getRenderBounds(),{min:[v,m],max:[y,w],center:[B,b]}=p;return null===l&&(nJ(B,a)<n?l=B:nJ(v,i)<n||nJ(v,o)<n?l=v:(nJ(y,o)<n||nJ(y,i)<n)&&(l=y),null!==l&&(u=Math.min(m,A),h=Math.max(w,s))),null===d&&(nJ(b,c)<n?d=b:nJ(m,A)<n||nJ(m,s)<n?d=m:(nJ(w,s)<n||nJ(w,A)<n)&&(d=w),null!==d&&(f=Math.min(v,i),g=Math.max(y,o))),null!==l&&null!==d}),{verticalX:l,verticalMinY:u,verticalMaxY:h,horizontalY:d,horizontalMinX:f,horizontalMaxX:g}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=t=>_e(this,void 0,void 0,function*(){const{target:e}=t;if(this.options.autoSnap){if(!this.enableSnap(t))return}const n=rJ(e,this.options.shape).getRenderBounds(),r=this.calcSnaplineMetadata(e,n);this.hideSnapline(),null===r.verticalX&&null===r.horizontalY||this.updateSnapline(r),this.options.autoSnap&&(yield this.autoSnapToLine(e.id,n,r))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){var t;const{filter:e}=this.options,n=((null===(t=this.context.element)||void 0===t?void 0:t.getNodes())||[]).filter(t=>{var e;return qb(t)&&(null===(e=this.context.viewport)||void 0===e?void 0:e.isInViewport(t.getRenderBounds()))});return e?n.filter(t=>e(t)):n}hideSnapline(){this.horizontalLine.style.visibility="hidden",this.verticalLine.style.visibility="hidden"}getLineWidth(t){const{lineWidth:e}=this.options[`${t}LineStyle`];return+(e||tJ.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(t){const{verticalX:e,verticalMinY:n,verticalMaxY:r,horizontalY:i,horizontalMinX:A,horizontalMaxX:o}=t,[s,a]=this.context.canvas.getSize(),{offset:c}=this.options;null!==i?Object.assign(this.horizontalLine.style,{x1:c===1/0?0:A-c,y1:i,x2:c===1/0?s:o+c,y2:i,visibility:"visible",lineWidth:this.getLineWidth("horizontal")}):this.horizontalLine.style.visibility="hidden",null!==e?Object.assign(this.verticalLine.style,{x1:e,y1:c===1/0?0:n-c,x2:e,y2:c===1/0?a:r+c,visibility:"visible",lineWidth:this.getLineWidth("vertical")}):this.verticalLine.style.visibility="hidden"}getDelta(t){const e=this.context.graph.getZoom();return hy([t.dx,t.dy],e)}bindEvents(){return _e(this,void 0,void 0,function*(){const{graph:e}=this.context;e.on(t.NodeEvent.DRAG_START,this.onDragStart),e.on(t.NodeEvent.DRAG,this.onDrag),e.on(t.NodeEvent.DRAG_END,this.onDragEnd)})}unbindEvents(){const{graph:e}=this.context;e.off(t.NodeEvent.DRAG_START,this.onDragStart),e.off(t.NodeEvent.DRAG,this.onDrag),e.off(t.NodeEvent.DRAG_END,this.onDragEnd)}destroyElements(){var t,e;null===(t=this.horizontalLine)||void 0===t||t.destroy(),null===(e=this.verticalLine)||void 0===e||e.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}}eJ.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:"key",verticalLineStyle:{stroke:"#1783FF"},horizontalLineStyle:{stroke:"#1783FF"},filter:()=>!0};const nJ=(t,e)=>Math.abs(t-e),rJ=(t,e)=>"function"==typeof e?e(t):t.getShape(e),iJ=["timestamp","time","date","datetime"];class AJ extends Zj{get padding(){return mm(this.options.padding)}constructor(t,e){super(t,Object.assign({},AJ.defaultOptions,e)),this.backup(),this.upsertTimebar()}play(){var t;null===(t=this.timebar)||void 0===t||t.play()}pause(){var t;null===(t=this.timebar)||void 0===t||t.pause()}forward(){var t;null===(t=this.timebar)||void 0===t||t.forward()}backward(){var t;null===(t=this.timebar)||void 0===t||t.backward()}reset(){var t;null===(t=this.timebar)||void 0===t||t.reset()}update(t){super.update(t),this.backup(),this.upsertTimebar()}backup(){this.originalData=oJ(this.context.graph.getData())}upsertTimebar(){const{canvas:t}=this.context,e=this.options,{onChange:n,timebarType:r,data:i,x:A,y:o,width:s,height:a,mode:c}=e,l=He(e,["onChange","timebarType","data","x","y","width","height","mode"]),u=t.getSize(),[h]=this.padding;this.upsertCanvas().ready.then(()=>{var t;const e=Object.assign(Object.assign({x:u[0]/2-s/2,y:h,onChange:t=>{const e=(Wt(t)?t:[t,t]).map(t=>function(t){return t instanceof Date}(t)?t.getTime():t);"modify"===this.options.mode?this.filterElements(e):this.hiddenElements(e),null==n||n(e)}},l),{data:i.map(t=>oe(t)?{time:t,value:0}:t),width:s,height:a,type:r});this.timebar?this.timebar.update(e):(this.timebar=new YZ({style:e}),null===(t=this.canvas)||void 0===t||t.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;const{className:t,height:e,position:n}=this.options,r=this.context.canvas,[i]=r.getSize(),[A,,o]=this.padding,[s,a]=XZ({width:i,height:e+A+o,graphCanvas:r,className:"timebar",placement:n});return this.container=s,t&&s.classList.add(t),this.canvas=a,this.canvas}filterElements(t){return _e(this,void 0,void 0,function*(){var e;if(!this.originalData)return;const{elementTypes:n,getTime:r}=this.options,{graph:i,element:A}=this.context,o=oJ(this.originalData);n.forEach(e=>{const n=`${e}s`;o[n]=(this.originalData[n]||[]).filter(e=>{const n=r(e);return!!sJ(n,t)})});const s=[...o.nodes,...o.combos].map(t=>Vm(t));o.edges=o.edges.filter(t=>{const e=t.source,n=t.target;return s.includes(e)&&s.includes(n)}),i.setData(o),yield null===(e=A.draw({animation:!1,silence:!0}))||void 0===e?void 0:e.finished})}hiddenElements(t){const{graph:e}=this.context,{elementTypes:n,getTime:r}=this.options,i=[],A=[];n.forEach(e=>{var n;const o=`${e}s`;((null===(n=this.originalData)||void 0===n?void 0:n[o])||[]).forEach(e=>{const n=Vm(e),o=r(e);sJ(o,t)?A.push(n):i.push(n)})}),e.hideElement(i,!1),e.showElement(A,!1)}destroy(){var t,e,n;const{graph:r}=this.context;this.originalData&&r.setData(Object.assign({},this.originalData)),null===(t=this.timebar)||void 0===t||t.destroy(),null===(e=this.canvas)||void 0===e||e.destroy(),null===(n=this.container)||void 0===n||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}}AJ.defaultOptions={position:"bottom",enable:!0,timebarType:"time",className:"g6-timebar",width:450,height:60,zIndex:3,elementTypes:["node"],padding:10,mode:"modify",getTime:t=>aJ(t,iJ,void 0),loop:!1};const oJ=t=>{const{nodes:e=[],edges:n=[],combos:r=[]}=t;return{nodes:[...e],edges:[...n],combos:[...r]}},sJ=(t,e)=>{if(oe(e))return t===e;const[n,r]=e;return t>=n&&t<=r},aJ=(t,e,n)=>{var r;for(let n=0;n<e.length;n++){const i=e[n],A=null===(r=t.data)||void 0===r?void 0:r[i];if(A)return A}return n},cJ={fill:"#1D2129",wordWrap:!0,maxLines:1,textOverflow:"ellipsis",textBaseline:"top",textAlign:"start",x:0},lJ=Object.assign(Object.assign({},cJ),{fillOpacity:.9,fontSize:16,fontWeight:"bold"}),uJ=Object.assign(Object.assign({},cJ),{fillOpacity:.65,fontSize:12,fontWeight:"normal"}),hJ={align:"left",spacing:8,size:44,padding:[16,24,0,24]},dJ="title",fJ="subtitle";class gJ extends Zj{get padding(){return mm(this.options.padding)}constructor(t,e){super(t,Object.assign({},hJ,e)),this.onRender=()=>{const t=this.updateCanvas();this.renderTitle(t)},this.bindEvents()}bindEvents(){const{graph:e}=this.context;e.on(t.GraphEvent.AFTER_RENDER,this.onRender),e.on(t.GraphEvent.AFTER_ANIMATE,this.onRender)}unbindEvents(){const{graph:e}=this.context;e.off(t.GraphEvent.AFTER_RENDER,this.onRender),e.off(t.GraphEvent.AFTER_ANIMATE,this.onRender)}destroy(){var t,e;this.unbindEvents(),null===(t=this.canvas)||void 0===t||t.destroy(),null===(e=this.container)||void 0===e||e.remove(),super.destroy()}updateCanvas(){const{size:t,className:e,align:n}=this.options,[r]=this.context.canvas.getSize(),[i=0,,A=0]=this.padding,o=t+i+A;if(this.canvas){const{width:t,height:e}=this.canvas.getConfig();r===t&&o===e||this.canvas.resize(r,o)}else{const t={left:"left-top",center:"top",right:"right-top"},[i,A]=XZ({width:r,height:o,placement:t[n]||t.left,className:"title-canvas",graphCanvas:this.context.canvas});e&&i.classList.add(e),this.container=i,this.canvas=A}return this.canvas}renderTitle(t){const e=new pJ({options:this.options,ctx:this.context});t.removeChildren(),e.getTitle().forEach(e=>{e&&t.appendChild(e)})}}class pJ{get padding(){return mm(this.options.padding)}constructor(t){const{options:e,ctx:n}=t;this.options=e,this.context=n}getTitle(){const t=this.options,e=dJ,n=t[e],r=fJ,i=t[r],{spacing:A=44,padding:o,align:s}=t,a=He(t,[e+"",r+"","spacing","padding","align"]),c=n,l=i,u=Aw(a,dJ),h=Aw(a,fJ),[d]=this.context.graph.getSize(),[f=0,g=0,,p=0]=this.padding,v=d,m=v-p-g;let y=null,w=p,B="left";switch(s){case"left":default:w=p,B="left";break;case"center":w=v/2,B="center";break;case"right":w=v-g,B="right"}const b=new mw({className:dJ,style:Object.assign(Object.assign(Object.assign(Object.assign({},lJ),{wordWrapWidth:m-5,x:w,y:f,textAlign:B}),u),{text:c})}),E=b.getBBox();return l&&(y=new mw({className:"subTitle",style:Object.assign(Object.assign(Object.assign(Object.assign({},uJ),{wordWrapWidth:m-5,x:w,y:E.height+A+f,textAlign:B}),h),{text:l})})),[b,y]}}class vJ extends Zj{constructor(t,e){super(t,Object.assign({},vJ.defaultOptions,e)),this.$element=Jj("toolbar",!1),this.onToolbarItemClick=t=>{const{onClick:e}=this.options;if(t.target instanceof Element&&t.target.className.includes("g6-toolbar-item")){const n=t.target.getAttribute("value");null==e||e(n,t.target)}};const n=this.context.canvas.getContainer();this.$element.style.display="flex",n.appendChild(this.$element),$j("g6-toolbar-css","style",{},"\n  .g6-toolbar {\n    position: absolute;\n    z-index: 100;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    border-radius: 4px;\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);\n    opacity: 0.65;\n  }\n  .g6-toolbar .g6-toolbar-item {\n    display: inline-block;\n    width: 16px;\n    height: 16px;\n    padding: 4px;\n    cursor: pointer;\n    box-sizing: content-box;\n  }\n\n  .g6-toolbar .g6-toolbar-item:hover {\n    background-color: #f0f0f0;\n  }\n\n  .g6-toolbar .g6-toolbar-item svg {\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n  }\n",document.head),$j("g6-toolbar-svgicon","div",{display:"none"},'\n  <svg>\n    <symbol id="zoom-in" viewBox="64 64 896 896">\n      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="zoom-out" viewBox="64 64 896 896">\n      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>\n    </symbol>\n    <symbol id="edit" viewBox="64 64 896 896">\n      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>\n    </symbol>\n    <symbol id="delete" viewBox="64 64 896 896">\n      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>\n    </symbol>\n    <symbol id="redo" viewBox="64 64 896 896">\n      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>\n    </symbol>\n    <symbol id="undo" viewBox="64 64 896 896">\n      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>\n    </symbol>\n    <symbol id="export" viewBox="64 64 896 896">\n      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>\n    </symbol>\n    <symbol id="auto-fit" viewBox="64 64 896 896">\n      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>\n      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>\n    </symbol>\n    <symbol id="reset" viewBox="64 64 896 896">\n      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>\n    </symbol>\n    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>\n    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">\n      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>\n  </svg>\n'),this.$element.addEventListener("click",this.onToolbarItemClick),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return _e(this,void 0,void 0,function*(){e.update.call(this,t);const{className:n,position:r,style:i}=this.options;this.$element.className=`g6-toolbar ${n||""}`,Object.assign(this.$element.style,i,function(t){const e={top:"unset",right:"unset",bottom:"unset",left:"unset"};return t.split("-").forEach(t=>{e[t]="8px"}),e.flexDirection=t.startsWith("top")||t.startsWith("bottom")?"row":"column",e}(r)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener("click",this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return _e(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(t=>{var e;return`\n          <div class="g6-toolbar-item" value="${t.value}" title="${null!==(e=t.title)&&void 0!==e?e:""}">\n            <svg aria-hidden="true" focusable="false">\n              <use xlink:href="#${t.id}"></use>\n            </svg>\n          </div>`}).join("")})}}vJ.defaultOptions={position:"top-left"};class mJ extends Zj{constructor(t,e){super(t,Object.assign({},mJ.defaultOptions,e)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(t,e)=>{const{enable:n}=this.options;return"function"==typeof n?n(t,e):n},this.onClick=t=>{const{target:{id:e}}=t;this.currentTarget===e?this.hide(t):this.show(t)},this.onPointerMove=t=>{const{target:e}=t;this.currentTarget&&e.id!==this.currentTarget&&this.show(t)},this.onPointerLeave=t=>{this.hide(t)},this.onCanvasMove=t=>{this.hide(t)},this.onPointerOver=t=>{this.show(t)},this.showById=t=>_e(this,void 0,void 0,function*(){const e={target:{id:t}};yield this.show(e)}),this.getElementData=(t,e)=>{const{model:n}=this.context;switch(e){case"node":return n.getNodeData([t]);case"edge":return n.getEdgeData([t]);case"combo":return n.getComboData([t]);default:return[]}},this.show=t=>_e(this,void 0,void 0,function*(){var e,n;const{client:r,target:{id:i}}=t;if(Jb(t.target))return;const A=this.context.graph.getElementType(i),{getContent:o,title:s}=this.options,a=this.getElementData(i,A);if(!this.tooltipElement)return;if(!this.isEnable(t,a))return void this.hide(t);let c,l,u={};if(o){if(u.content=yield o(t,a),!u.content)return}else{const t=this.context.graph.getElementRenderStyle(i),e="node"===A?t.fill:t.stroke;u={title:s||A,data:a.map(t=>({name:"ID",value:t.id||`${t.source} -> ${t.target}`,color:e}))}}if(this.currentTarget=i,r)c=r.x,l=r.y;else{const t=ke(a,"0.style",{x:0,y:0});c=t.x,l=t.y}null===(n=(e=this.options).onOpenChange)||void 0===n||n.call(e,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:c,y:l,style:{".tooltip":{visibility:"visible"}}}),u))}),this.hide=t=>{var e,n,r,i,A;if(!t)return null===(n=(e=this.options).onOpenChange)||void 0===n||n.call(e,!1),null===(r=this.tooltipElement)||void 0===r||r.hide(),void(this.currentTarget=null);if(!this.tooltipElement)return;if(!this.currentTarget)return;const{client:{x:o,y:s}}=t;null===(A=(i=this.options).onOpenChange)||void 0===A||A.call(i,!1),this.tooltipElement.hide(o,s),this.currentTarget=null},this.initTooltip=()=>{var t;const e=new BZ({className:"tooltip",style:this.tooltipStyleProps});return null===(t=this.container)||void 0===t||t.appendChild(e.HTMLTooltipElement),e},this.render(),this.bindEvents()}getEvents(){return"click"===this.options.trigger?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerover":this.onPointerOver,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerover":this.onPointerOver,"edge:pointermove":this.onPointerMove,"combo:pointerover":this.onPointerOver,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(t){var e;this.unbindEvents(),super.update(t),this.tooltipElement&&(null===(e=this.container)||void 0===e||e.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){const{canvas:t}=this.context,e=t.getContainer();e&&(this.container=e,this.tooltipElement=this.initTooltip())}unbindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.off(n,e[n])})}bindEvents(){const{graph:t}=this.context,e=this.getEvents();Object.keys(e).forEach(n=>{t.on(n,e[n])})}get tooltipStyleProps(){const{canvas:t}=this.context,{center:e}=t.getBounds(),n=t.getContainer(),{top:r,left:i}=n.getBoundingClientRect(),{style:A,position:o,enterable:s,container:a={x:-i,y:-r},title:c,offset:l}=this.options,[u,h]=e,[d,f]=t.getSize();return{x:u,y:h,container:a,title:c,bounding:{x:0,y:0,width:d,height:f},position:o,enterable:s,offset:l,style:A}}destroy(){var t;this.unbindEvents(),this.tooltipElement&&(null===(t=this.container)||void 0===t||t.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}}let yJ;function wJ(t,e){yJ||(yJ=document.createElement("canvas")),yJ.width=t,yJ.height=e;return yJ.getContext("2d").clearRect(0,0,t,e),yJ}mJ.defaultOptions={trigger:"hover",position:"top-right",enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:"hidden"}}};class BJ extends Zj{constructor(t,e){super(t,Object.assign({},BJ.defaultOptions,e)),this.$element=Jj("watermark");this.context.canvas.getContainer().appendChild(this.$element),this.update(e)}update(t){const e=Object.create(null,{update:{get:()=>super.update}});return _e(this,void 0,void 0,function*(){e.update.call(this,t);const n=this.options,{width:r,height:i,text:A,imageURL:o}=n,s=He(n,["width","height","text","imageURL"]);Object.keys(s).forEach(e=>{e.startsWith("background")&&(this.$element.style[e]=t[e])});const a=o?yield function(t,e,n,r){return _e(this,void 0,void 0,function*(){const i=wJ(t,e),A=i.getContext("2d"),{rotate:o,opacity:s}=r;o&&A.rotate(o),s&&(A.globalAlpha=s);const a=new Image;return a.crossOrigin="anonymous",a.src=n,new Promise(n=>{a.onload=function(){const r=t>a.width?(t-a.width)/2:0,o=e>a.height?(e-a.height)/2:0;A.drawImage(a,0,0,a.width,a.height,r,o,t-2*r,e-2*o),n(i.toDataURL())}})})}(r,i,o,s):yield function(t,e,n,r){return _e(this,void 0,void 0,function*(){const i=wJ(t,e),A=i.getContext("2d"),{rotate:o,opacity:s,textFill:a,textFontSize:c,textFontFamily:l,textFontVariant:u,textFontWeight:h,textAlign:d,textBaseline:f}=r;return A.textAlign=d,A.textBaseline=f,A.translate(t/2,e/2),A.font=`${c}px ${l} ${u} ${h}`,o&&A.rotate(o),s&&(A.globalAlpha=s),a&&(A.fillStyle=a,A.fillText(`${n}`,0,0)),i.toDataURL()})}(r,i,A,s);this.$element.style.backgroundImage=`url(${a})`})}destroy(){super.destroy(),this.$element.remove()}}BJ.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:"",textFill:"#000",textFontSize:16,textAlign:"center",textBaseline:"middle",backgroundRepeat:"repeat"};const bJ=["#7E92B5","#F4664A","#FFBE3A"],EJ={type:"group",color:["#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]},xJ={type:"group",color:["#99ADD1","#1783FF","#00C9C9","#F08F56","#D580FF","#7863FF","#DB9D0D","#60C42D","#FF80CA","#2491B3","#17C76F"]};function CJ(t){const{bgColor:e,textColor:n,nodeColor:r,nodeColorDisabled:i,nodeStroke:A,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:s=.25,nodeOpacityDisabled:a=.06,nodeIconOpacityInactive:c=.85,nodeOpacityInactive:l=.25,nodeBadgePalette:u=bJ,nodePaletteOptions:h=EJ,edgeColor:d,edgeColorDisabled:f,edgePaletteOptions:g=xJ,comboColor:p,comboColorDisabled:v,comboStroke:m,comboStrokeDisabled:y,edgeColorInactive:w}=t;return{background:e,node:{palette:h,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:"#fff",badgeFontSize:8,badgePadding:[0,4],badgePalette:u,fill:r,fillOpacity:1,halo:!1,iconFill:"#fff",iconOpacity:1,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:n,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:A,portStrokeOpacity:.65,size:32,stroke:A,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:s,labelFontSize:12,labelFontWeight:"bold",lineWidth:4,stroke:A},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:"bold",lineWidth:4,stroke:A,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:l,donutOpacity:l,fillOpacity:l,iconOpacity:c,labelFill:n,labelFillOpacity:l,strokeOpacity:l},disabled:{badgeBackgroundOpacity:.25,donutOpacity:a,fill:i,fillOpacity:a,iconFill:i,iconOpacity:.25,labelFill:n,labelFillOpacity:.25,strokeOpacity:a}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"node-expand",collapse:"node-collapse",update:[{fields:["x","y","fill","stroke"]}],translate:[{fields:["x","y"]}]}},edge:{palette:g,style:{badgeBackgroundFill:d,badgeFill:"#fff",badgeFontSize:8,badgeOffsetX:10,badgeBackgroundOpacity:1,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:"center",labelTextBaseline:"middle",lineWidth:1,stroke:d,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:"bold",lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:"bold",lineWidth:3},inactive:{stroke:w,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:f,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:"fade",exit:"fade",expand:"path-in",collapse:"path-out",show:"fade",hide:"fade",update:[{fields:["sourceNode","targetNode"]},{fields:["stroke"],shape:"key"}],translate:[{fields:["sourceNode","targetNode"]}]}},combo:{style:{collapsedMarkerFill:e,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:p,halo:!1,haloLineWidth:12,haloStroke:m,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:e,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:m},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:v,fillOpacity:.25,labelOpacity:.25,stroke:y,strokeOpacity:.25}},animation:{enter:"fade",exit:"fade",show:"fade",hide:"fade",expand:"combo-expand",collapse:"combo-collapse",update:[{fields:["x","y"]},{fields:["fill","stroke","lineWidth"],shape:"key"}],translate:[{fields:["x","y"]}]}}}}const FJ=CJ({bgColor:"#000000",comboColor:"#fdfdfd",comboColorDisabled:"#d0e4ff",comboStroke:"#99add1",comboStrokeDisabled:"#969696",edgeColor:"#637088",edgeColorDisabled:"#637088",edgeColorInactive:"#D0E4FF",edgePaletteOptions:{type:"group",color:["#637088","#0F55A6","#008383","#9C5D38","#8B53A6","#4E40A6","#8F6608","#3E801D","#A65383","#175E75","#0F8248"]},nodeColor:"#1783ff",nodeColorDisabled:"#D0E4FF",nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:"#d0e4ff",textColor:"#ffffff"}),MJ=CJ({bgColor:"#ffffff",comboColor:"#99ADD1",comboColorDisabled:"#f0f0f0",comboStroke:"#99add1",comboStrokeDisabled:"#d9d9d9",edgeColor:"#99add1",edgeColorDisabled:"#d9d9d9",edgeColorInactive:"#1B324F",nodeColor:"#1783ff",nodeColorDisabled:"#1B324F",nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:"#000000",textColor:"#000000"});class kJ extends Ay{beforeDraw(t,e){return t}afterLayout(t,e){}}function QJ(t,e,n,r,i){const A=Vm(r),o=`${n}s`,s=i?r:t.add[o].get(A)||t.update[o].get(A)||t.remove[o].get(A)||r;Object.entries(t).forEach(([t,n])=>{e===t?n[o].set(A,s):n[o].delete(A)})}function SJ(t,e){return Object.keys(t).every(n=>t[n]===e[n])}const UJ=(t,e,n,r)=>{const i=`${n}s`,A=Vm(r);t.add[i].has(A)||t.update[i].has(A)||t[e][i].set(Vm(r),r)};const TJ=new WeakMap;const OJ=(t,e,n=2)=>{if("object"!=typeof t||"object"!=typeof e)return t===e;const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const i of r){const r=t[i],A=e[i];if(n>1&&"object"==typeof r&&"object"==typeof A){if(!OJ(r,A,n-1))return!1}else if(r!==A)return!1}return!0};function NJ(t,e,n){Zv[t][e]&&em(`The extension ${e} of ${t} has been registered before, and will be overridden.`),Object.assign(Zv[t],{[e]:n})}
/*!
   * @antv/g-plugin-dragndrop
   * @description A G plugin for Drag n Drop implemented with PointerEvents
   * @version 2.1.1
   * @date 12/24/2025, 11:56:44 AM
   * @author AntVis
   * @docs https://g.antv.antgroup.com/
   */var IJ=function(){function t(e){s(this,t),this.dragndropPluginOptions=e}return c(t,[{key:"apply",value:function(e){var n=this,r=e.renderingService,i=e.renderingContext.root.ownerDocument,A=i.defaultView,o=function(t){var e=t.target,r=e===i,o=r&&n.dragndropPluginOptions.isDocumentDraggable?i:e.closest&&e.closest("[draggable=true]");if(o){var s=!1,a=t.timeStamp,c=[t.clientX,t.clientY],l=null,u=[t.clientX,t.clientY],h=function(){var t=cr(sr().mark(function t(A){var h,d,f,g,p,v;return sr().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=2;break}if(h=A.timeStamp-a,d=mn([A.clientX,A.clientY],c),!(h<=n.dragndropPluginOptions.dragstartTimeThreshold||d<=n.dragndropPluginOptions.dragstartDistanceThreshold)){t.next=1;break}return t.abrupt("return");case 1:A.type="dragstart",o.dispatchEvent(A),s=!0;case 2:if(A.type="drag",A.dx=A.clientX-u[0],A.dy=A.clientY-u[1],o.dispatchEvent(A),u=[A.clientX,A.clientY],r){t.next=4;break}return f="pointer"===n.dragndropPluginOptions.overlap?[A.canvasX,A.canvasY]:e.getBounds().center,t.next=3,i.elementsFromPoint(f[0],f[1]);case 3:g=t.sent,p=g[g.indexOf(e)+1],v=(null==p?void 0:p.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?i:null),l!==v&&(l&&(A.type="dragleave",A.target=l,l.dispatchEvent(A)),v&&(A.type="dragenter",A.target=v,v.dispatchEvent(A)),(l=v)&&(A.type="dragover",A.target=l,l.dispatchEvent(A)));case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();A.addEventListener("pointermove",h);var d=function(t){if(s){t.detail={preventClick:!0};var e=t.clone();l&&(e.type="drop",e.target=l,l.dispatchEvent(e)),e.type="dragend",o.dispatchEvent(e),s=!1}A.removeEventListener("pointermove",h)};e.addEventListener("pointerup",d,{once:!0}),e.addEventListener("pointerupoutside",d,{once:!0})}};r.hooks.init.tap(t.tag,function(){A.addEventListener("pointerdown",o)}),r.hooks.destroy.tap(t.tag,function(){A.removeEventListener("pointerdown",o)})}}])}();IJ.tag="Dragndrop";var LJ=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return s(this,e),(t=p(this,e)).name="dragndrop",t.options=n,t}return m(e,t),c(e,[{key:"init",value:function(){this.addRenderingPlugin(new IJ(o({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)}}])}(fr);const DJ=["main"],PJ=["background","main","label","transient"];class RJ{getConfig(){return this.config}getLayer(t="main"){return this.extends.layers[t]||this.getLayers().main}getLayers(){return this.extends.layers}getRenderer(t){return this.extends.renderers[t]}getCamera(t="main"){return this.getLayer(t).getCamera()}getRoot(t="main"){return this.getLayer(t).getRoot()}getContextService(t="main"){return this.getLayer(t).getContextService()}setCursor(t){this.config.cursor=t,this.getLayer().setCursor(t)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(t){this.config={enableMultiLayer:!0},Object.assign(this.config,t);const e=this.config,{renderer:n,background:r,cursor:i,enableMultiLayer:A}=e,o=He(e,["renderer","background","cursor","enableMultiLayer"]),s=A?PJ:DJ,a=HJ(n,s),c=Object.fromEntries(s.map(t=>[t,new Mc(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:A,renderer:a[t],background:A?"background"===t?r:void 0:r}))]));_J(c),this.extends={config:this.config,renderer:n,renderers:a,layers:c}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,t])=>t.ready))}resize(t,e){Object.assign(this.extends.config,{width:t,height:e}),Object.values(this.getLayers()).forEach(n=>{const r=n.getCamera(),i=r.getPosition(),A=r.getFocalPoint();n.resize(t,e),r.setPosition(i),r.setFocalPoint(A)})}getBounds(t){return Fm(Object.values(this.getLayers()).map(e=>t?e.getRoot().childNodes.find(e=>e.classList.includes(t)):e.getRoot()).filter(t=>(null==t?void 0:t.childNodes.length)>0).map(t=>t.getBounds()))}getContainer(){const t=this.extends.config.container;return"string"==typeof t?document.getElementById(t):t}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(t,e){var n;const r=(null===(n=t.style)||void 0===n?void 0:n.$layer)||"main";return this.getLayer(r).appendChild(t,e)}setRenderer(t){if(t===this.extends.renderer)return;const e=HJ(t,this.config.enableMultiLayer?PJ:DJ);this.extends.renderers=e,Object.entries(e).forEach(([t,e])=>this.getLayer(t).setRenderer(e)),_J(this.getLayers())}getCanvasByViewport(t){return Sy(this.getLayer().viewport2Canvas(Uy(t)))}getViewportByCanvas(t){return Sy(this.getLayer().canvas2Viewport(Uy(t)))}getViewportByClient(t){return Sy(this.getLayer().client2Viewport(Uy(t)))}getClientByViewport(t){return Sy(this.getLayer().viewport2Client(Uy(t)))}getClientByCanvas(t){return this.getClientByViewport(this.getViewportByCanvas(t))}getCanvasByClient(t){const e=this.getLayer(),n=e.client2Viewport(Uy(t));return Sy(e.viewport2Canvas(n))}toDataURL(){return _e(this,arguments,void 0,function*(t={}){const e=globalThis.devicePixelRatio||1,{mode:n="viewport"}=t,r=He(t,["mode"]);let[i,A,o,s]=[0,0,0,0];if("viewport"===n)[o,s]=this.getSize();else if("overall"===n){const t=this.getBounds(),e=bm(t);[i,A]=t.min,[o,s]=e}const a=Tn('<div id="virtual-image"></div>'),c=new Mc({width:o,height:s,renderer:new HB,devicePixelRatio:e,container:a,background:this.extends.config.background});yield c.ready,c.appendChild(this.getLayer("background").getRoot().cloneNode(!0)),c.appendChild(this.getRoot().cloneNode(!0));const l=this.getLayer("label").getRoot().cloneNode(!0),u=c.viewport2Canvas({x:0,y:0}),h=this.getCanvasByViewport([0,0]);l.translate([h[0]-u.x,h[1]-u.y]),l.scale(1/this.getCamera().getZoom()),c.appendChild(l),c.appendChild(this.getLayer("transient").getRoot().cloneNode(!0));const d=this.getCamera(),f=c.getCamera();if("viewport"===n)f.setZoom(d.getZoom()),f.setPosition(d.getPosition()),f.setFocalPoint(d.getFocalPoint());else if("overall"===n){const[t,e,n]=f.getPosition(),[r,o,s]=f.getFocalPoint();f.setPosition([t+i,e+A,n]),f.setFocalPoint([r+i,o+A,s])}const g=c.getContextService();return new Promise(t=>{c.addEventListener(Bc.RERENDER,()=>_e(this,void 0,void 0,function*(){yield new Promise(t=>setTimeout(t,300));const e=yield g.toDataURL(r);t(e)}))})})}destroy(){Object.values(this.getLayers()).forEach(t=>{t.getCamera().cancelLandmarkAnimation(),t.destroy()})}}function HJ(t,e){return Object.fromEntries(e.map(e=>{const n=(null==t?void 0:t(e))||new HB;return n instanceof HB&&n.setConfig({enableDirtyRectangleRendering:!1}),"main"===e?n.registerPlugin(new LJ({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin("dom-interaction")),[e,n]}))}function _J(t){Object.entries(t).forEach(([t,e])=>{const n=e.getContextService().getDomElement();(null==n?void 0:n.style)&&(n.style.gridArea="1 / 1 / 2 / 2",n.style.outline="none",n.tabIndex=1,"main"!==t&&(n.style.pointerEvents="none")),(null==n?void 0:n.parentElement)&&(n.parentElement.style.display="grid",n.parentElement.style.isolation="isolate")})}const GJ=t=>t?parseInt(t):0;function KJ(t){if(!t)return[0,0];let e=640,n=480;const[r,i]=function(t){const e=getComputedStyle(t),n=t.clientWidth||GJ(e.width),r=t.clientHeight||GJ(e.height);return[n-(GJ(e.paddingLeft)+GJ(e.paddingRight)),r-(GJ(e.paddingTop)+GJ(e.paddingBottom))]}(t);e=r||e,n=i||n;return[Math.max(oe(e)?e:1,1),Math.max(oe(n)?n:1,1)]}class jJ{constructor(t){this.type=t}}class VJ extends jJ{constructor(t,e){super(t),this.data=e}}class zJ extends jJ{constructor(t,e,n,r){super(t),this.animationType=e,this.animation=n,this.data=r}}class WJ extends jJ{constructor(t,e,n){super(t),this.elementType=e,this.data=n}}class YJ extends jJ{constructor(t,e){super(t),this.data=e}}function XJ(t,e){t.emit(e.type,e)}function qJ(t){var e;return(null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0}const ZJ="cachedStyle",JJ=t=>`__${t}__`;function $J(t,e){return ke(t,[ZJ,JJ(e)])}class t${constructor(t){this.tasks=[],this.animations=new Set,this.context=t}getTasks(){const t=[...this.tasks];return this.tasks=[],t}add(t,e){this.tasks.push([t,e])}animate(t,e,n){var r,i,A;null===(r=null==e?void 0:e.before)||void 0===r||r.call(e);const o=this.getTasks().map(([e,r])=>{var i,A,o;const{element:s,elementType:a,stage:c}=e,l=sm(this.context.options,a,c,t);null===(i=null==r?void 0:r.before)||void 0===i||i.call(r);const u=l.length?cm(s,this.inferStyle(e,n),l):null;return u?(null===(A=null==r?void 0:r.beforeAnimate)||void 0===A||A.call(r,u),u.finished.then(()=>{var t,e;null===(t=null==r?void 0:r.afterAnimate)||void 0===t||t.call(r,u),null===(e=null==r?void 0:r.after)||void 0===e||e.call(r),this.animations.delete(u)})):null===(o=null==r?void 0:r.after)||void 0===o||o.call(r),u}).filter(Boolean);o.forEach(t=>this.animations.add(t));const s=rm(o);return s?(null===(i=null==e?void 0:e.beforeAnimate)||void 0===i||i.call(e,s),s.finished.then(()=>{var t,n;null===(t=null==e?void 0:e.afterAnimate)||void 0===t||t.call(e,s),null===(n=null==e?void 0:e.after)||void 0===n||n.call(e),this.release()})):null===(A=null==e?void 0:e.after)||void 0===A||A.call(e),s}inferStyle(t,e){var n,r;const{element:i,elementType:A,stage:o,originalStyle:s,updatedStyle:a={}}=t;t.modifiedStyle||(t.modifiedStyle=Object.assign(Object.assign({},s),a));const{modifiedStyle:c}=t,l={},u={};if("enter"===o)Object.assign(l,{opacity:0});else if("exit"===o)Object.assign(u,{opacity:0});else if("show"===o)Object.assign(l,{opacity:0}),Object.assign(u,{opacity:null!==(n=$J(i,"opacity"))&&void 0!==n?n:Am("opacity")});else if("hide"===o)Object.assign(l,{opacity:null!==(r=$J(i,"opacity"))&&void 0!==r?r:Am("opacity")}),Object.assign(u,{opacity:0});else if("collapse"===o){const{collapse:t}=e||{},{target:n,descendants:r,position:o}=t;if("node"===A){if(r.includes(i.id)){const[t,e,n]=o;Object.assign(u,{x:t,y:e,z:n})}}else if("combo"===A){if(i.id===n||r.includes(i.id)){const[t,e]=o;Object.assign(u,{x:t,y:e,childrenNode:s.childrenNode})}}else"edge"===A&&Object.assign(u,{sourceNode:c.sourceNode,targetNode:c.targetNode})}else if("expand"===o){const{expand:t}=e||{},{target:n,descendants:r,position:o}=t;if("node"===A){if(i.id===n||r.includes(i.id)){const[t,e,n]=o;Object.assign(l,{x:t,y:e,z:n})}}else if("combo"===A){if(i.id===n||r.includes(i.id)){const[t,e,n]=o;Object.assign(l,{x:t,y:e,z:n,childrenNode:c.childrenNode})}}else"edge"===A&&Object.assign(l,{sourceNode:c.sourceNode,targetNode:c.targetNode})}return[Object.keys(l).length>0?Object.assign({},s,l):s,Object.keys(u).length>0?Object.assign({},c,u):c]}stop(){this.animations.forEach(t=>t.cancel())}clear(){this.tasks=[]}release(){var t,e;const{canvas:n}=this.context,r=null===(e=null===(t=n.document)||void 0===t?void 0:t.timeline)||void 0===e?void 0:e.animationsWithPromises;r&&(n.document.timeline.animationsWithPromises=r.filter(t=>"finished"!==t.playState))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}}class e${constructor(t){this.batchCount=0,this.context=t}emit(t){const{graph:e}=this.context;e.emit(t.type,t)}startBatch(e=!0){this.batchCount++,1===this.batchCount&&this.emit(new VJ(t.GraphEvent.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,0===this.batchCount&&this.emit(new VJ(t.GraphEvent.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}}class n$ extends iy{constructor(e){super(e),this.currentTarget=null,this.currentTargetType=null,this.category="behavior",this.forwardCanvasEvents=e=>{const{target:n}=e,r=function(t){if(!t)return null;if(t instanceof gc)return{type:"canvas",element:t};let e=t;for(;e;){if(Db(e))return{type:"node",element:e};if(Pb(e))return{type:"edge",element:e};if(Rb(e))return{type:"combo",element:e};e=e.parentElement}return null}(n);if(!r)return;const{graph:i,canvas:A}=this.context,{type:o,element:s}=r;if("destroyed"in s&&(Jb(s)||s.destroyed))return;const{type:a,detail:c,button:l}=e,u=Object.assign(Object.assign({},e),{target:s,targetType:o,originalTarget:n});a===t.CommonEvent.POINTER_MOVE&&(this.currentTarget!==s&&(this.currentTarget&&i.emit(`${this.currentTargetType}:${t.CommonEvent.POINTER_LEAVE}`,Object.assign(Object.assign({},u),{type:t.CommonEvent.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),s&&(Object.assign(u,{type:t.CommonEvent.POINTER_ENTER}),i.emit(`${o}:${t.CommonEvent.POINTER_ENTER}`,u))),this.currentTarget=s,this.currentTargetType=o),a===t.CommonEvent.CLICK&&2===l||(i.emit(`${o}:${a}`,u),i.emit(a,u)),a===t.CommonEvent.CLICK&&2===c&&(Object.assign(u,{type:t.CommonEvent.DBLCLICK}),i.emit(`${o}:${t.CommonEvent.DBLCLICK}`,u),i.emit(t.CommonEvent.DBLCLICK,u)),a===t.CommonEvent.POINTER_DOWN&&2===l&&(Object.assign(u,{type:t.CommonEvent.CONTEXT_MENU,preventDefault:()=>{var e;null===(e=A.getContainer())||void 0===e||e.addEventListener(t.CommonEvent.CONTEXT_MENU,t=>t.preventDefault(),{once:!0})}}),i.emit(`${o}:${t.CommonEvent.CONTEXT_MENU}`,u),i.emit(t.CommonEvent.CONTEXT_MENU,u))},this.forwardContainerEvents=t=>{this.context.graph.emit(t.type,t)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(t){this.setExtensions(t)}forwardEvents(){const e=this.context.canvas.getContainer();e&&[t.ContainerEvent.KEY_DOWN,t.ContainerEvent.KEY_UP].forEach(t=>{e.addEventListener(t,this.forwardContainerEvents)});const n=this.context.canvas.document;n&&[t.CommonEvent.CLICK,t.CommonEvent.DBLCLICK,t.CommonEvent.POINTER_OVER,t.CommonEvent.POINTER_LEAVE,t.CommonEvent.POINTER_ENTER,t.CommonEvent.POINTER_MOVE,t.CommonEvent.POINTER_OUT,t.CommonEvent.POINTER_DOWN,t.CommonEvent.POINTER_UP,t.CommonEvent.CONTEXT_MENU,t.CommonEvent.DRAG_START,t.CommonEvent.DRAG,t.CommonEvent.DRAG_END,t.CommonEvent.DRAG_ENTER,t.CommonEvent.DRAG_OVER,t.CommonEvent.DRAG_LEAVE,t.CommonEvent.DROP,t.CommonEvent.WHEEL].forEach(t=>{n.addEventListener(t,this.forwardCanvasEvents)})}destroy(){const e=this.context.canvas.getContainer();e&&[t.ContainerEvent.KEY_DOWN,t.ContainerEvent.KEY_UP].forEach(t=>{e.removeEventListener(t,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}}function r$(t){const{id:e=Vm(t),style:n,data:r}=t,i=He(t,["id","style","data"]),A=Object.assign(Object.assign({},t),{style:Object.assign({},n),data:Object.assign({},r)});return function(t){return"source"in t&&"target"in t}(t)?Object.assign({id:e,data:A},i):{id:e,data:A}}function i$(t){return t.data}class A${constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new fE}pushChange(t){if(this.isTraceless)return;const{type:e}=t;if(e===Rv.NodeUpdated||e===Rv.EdgeUpdated||e===Rv.ComboUpdated){const{value:n,original:r}=t;this.changes.push({value:eE(n),original:eE(r),type:e})}else this.changes.push({value:eE(t.value),type:e})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(t){this.batchCount++,this.model.batch(t),this.batchCount--}isBatching(){return this.batchCount>0}silence(t){this.isTraceless=!0,t(),this.isTraceless=!1}isCombo(t){return this.comboIds.has(t)||this.latestRemovedComboIds.has(t)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(t){return this.model.getAllNodes().reduce((e,n)=>{const r=i$(n);return this.isCombo(Vm(r))||(void 0===t||t.includes(Vm(r)))&&e.push(r),e},[])}getEdgeDatum(t){return i$(this.model.getEdge(t))}getEdgeData(t){return this.model.getAllEdges().reduce((e,n)=>{const r=i$(n);return(void 0===t||t.includes(Vm(r)))&&e.push(r),e},[])}getComboData(t){return this.model.getAllNodes().reduce((e,n)=>{const r=i$(n);return this.isCombo(Vm(r))?((void 0===t||t.includes(Vm(r)))&&e.push(r),e):e},[])}getRootsData(t=Xv){return this.model.getRoots(t).map(i$)}getAncestorsData(t,e){const{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getAncestors(t,e).map(i$):[]}getDescendantsData(t){const e=this.getElementDataById(t),n=[];return Zy(e,t=>{t!==e&&n.push(t)},t=>this.getChildrenData(Vm(t)),"TB"),n}getParentData(t,e){const{model:n}=this;if(!e)return void em("The hierarchy structure key is not specified");if(!n.hasNode(t)||!n.hasTreeStructure(e))return;const r=n.getParent(t,e);return r?i$(r):void 0}getChildrenData(t){const e="node"===this.getElementType(t)?Xv:Yv,{model:n}=this;return n.hasNode(t)&&n.hasTreeStructure(e)?n.getChildren(t,e).map(i$):[]}getElementsDataByType(t){return"node"===t?this.getNodeData():"edge"===t?this.getEdgeData():"combo"===t?this.getComboData():[]}getElementDataById(t){return"edge"===this.getElementType(t)?this.getEdgeDatum(t):this.getNodeLikeDatum(t)}getNodeLikeDatum(t){return i$(this.model.getNode(t))}getNodeLikeData(t){return this.model.getAllNodes().reduce((e,n)=>{const r=i$(n);return t?t.includes(Vm(r))&&e.push(r):e.push(r),e},[])}getElementDataByState(t,e){return this.getElementsDataByType(t).filter(t=>{var n;return null===(n=t.states)||void 0===n?void 0:n.includes(e)})}getElementState(t){var e;return(null===(e=this.getElementDataById(t))||void 0===e?void 0:e.states)||[]}hasNode(t){return this.model.hasNode(t)&&!this.isCombo(t)}hasEdge(t){return this.model.hasEdge(t)}hasCombo(t){return this.model.hasNode(t)&&this.isCombo(t)}getRelatedEdgesData(t,e="both"){return this.model.getRelatedEdges(t,e).map(i$)}getNeighborNodesData(t){return this.model.getNeighbors(t).map(i$)}setData(t){const{nodes:e=[],edges:n=[],combos:r=[]}=t,{nodes:i,edges:A,combos:o}=this.getData(),s=ny(i,e,t=>Vm(t),nE),a=ny(A,n,t=>Vm(t),nE),c=ny(o,r,t=>Vm(t),nE);this.batch(()=>{const t={nodes:s.enter,edges:a.enter,combos:c.enter};this.addData(t),this.computeZIndex(t,"add",!0);const e={nodes:s.update,edges:a.update,combos:c.update};this.updateData(e),this.computeZIndex(e,"update",!0);const n={nodes:s.exit.map(Vm),edges:a.exit.map(Vm),combos:c.exit.map(Vm)};this.removeData(n)})}addData(t){const{nodes:e,edges:n,combos:r}=t;this.batch(()=>{this.addComboData(r),this.addNodeData(e),this.addEdgeData(n)}),this.computeZIndex(t,"add")}addNodeData(t=[]){t.length&&(this.model.addNodes(t.map(t=>(this.pushChange({value:t,type:Rv.NodeAdded}),r$(t)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({nodes:t},"add"))}addEdgeData(t=[]){t.length&&(this.model.addEdges(t.map(t=>(this.pushChange({value:t,type:Rv.EdgeAdded}),r$(t)))),this.computeZIndex({edges:t},"add"))}addComboData(t=[]){if(!t.length)return;const{model:e}=this;e.hasTreeStructure(Yv)||e.attachTreeStructure(Yv),e.addNodes(t.map(t=>(this.comboIds.add(Vm(t)),this.pushChange({value:t,type:Rv.ComboAdded}),r$(t)))),this.updateNodeLikeHierarchy(t),this.computeZIndex({combos:t},"add")}addChildrenData(t,e){const n=this.getNodeLikeDatum(t),r=e.map(Vm);this.addNodeData(e),this.updateNodeData([{id:t,children:[...n.children||[],...r]}]),this.addEdgeData(r.map(e=>({source:t,target:e})))}computeZIndex(t,e,n=!1){!n&&this.isBatching()||this.batch(()=>{const{nodes:n=[],edges:r=[],combos:i=[]}=t;i.forEach(t=>{var n,r,i;const A=Vm(t);if("add"===e&&oe(null===(n=t.style)||void 0===n?void 0:n.zIndex))return;if("update"===e&&!("combo"in t))return;const o=this.getParentData(A,Yv),s=o?(null!==(i=null===(r=o.style)||void 0===r?void 0:r.zIndex)&&void 0!==i?i:0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:A,style:{zIndex:s}}])})}),n.forEach(t=>{var n,r,i;const A=Vm(t);if("add"===e&&oe(null===(n=t.style)||void 0===n?void 0:n.zIndex))return;if("update"===e&&!("combo"in t)&&!("children"in t))return;let o=0;const s=this.getParentData(A,Yv);if(s)o=((null===(r=s.style)||void 0===r?void 0:r.zIndex)||0)+1;else{const t=this.getParentData(A,Xv);t&&(o=(null===(i=null==t?void 0:t.style)||void 0===i?void 0:i.zIndex)||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:A,style:{zIndex:o}}])})}),r.forEach(t=>{var e,n,r,i,A;if(oe(null===(e=t.style)||void 0===e?void 0:e.zIndex))return;let{id:o,source:s,target:a}=t;if(o){const t=this.getEdgeDatum(o);s=t.source,a=t.target}else o=Vm(t);if(!s||!a)return;const c=(null===(r=null===(n=this.getNodeLikeDatum(s))||void 0===n?void 0:n.style)||void 0===r?void 0:r.zIndex)||0,l=(null===(A=null===(i=this.getNodeLikeDatum(a))||void 0===i?void 0:i.style)||void 0===A?void 0:A.zIndex)||0;this.updateEdgeData([{id:Vm(t),style:{zIndex:Math.max(c,l)-1}}])})})}getFrontZIndex(t){var e;const n=this.getElementType(t),r=this.getElementDataById(t),i=this.getData();if(Object.assign(i,{[`${n}s`]:i[`${n}s`].filter(e=>Vm(e)!==t)}),"combo"===n&&!nw(r)){const e=new Set(this.getAncestorsData(t,Yv).map(Vm));i.nodes=i.nodes.filter(t=>!e.has(Vm(t))),i.combos=i.combos.filter(t=>!e.has(Vm(t))),i.edges=i.edges.filter(({source:t,target:n})=>!e.has(t)&&!e.has(n))}return Math.max((null===(e=r.style)||void 0===e?void 0:e.zIndex)||0,0,...Object.values(i).flat().map(t=>{var e;return((null===(e=null==t?void 0:t.style)||void 0===e?void 0:e.zIndex)||0)+1}))}updateNodeLikeHierarchy(t){if(!this.enableUpdateNodeLikeHierarchy)return;const{model:e}=this;t.forEach(t=>{const n=Vm(t),r=zm(t);void 0!==r&&(e.hasTreeStructure(Yv)||e.attachTreeStructure(Yv),null===r&&this.refreshComboData(n),this.setParent(n,zm(t),Yv));const i=t.children||[];if(i.length){e.hasTreeStructure(Xv)||e.attachTreeStructure(Xv);const t=i.filter(t=>e.hasNode(t));t.forEach(t=>this.setParent(t,n,Xv)),t.length!==i.length&&this.updateNodeData([{id:n,children:t}])}})}preventUpdateNodeLikeHierarchy(t){this.enableUpdateNodeLikeHierarchy=!1,t(),this.enableUpdateNodeLikeHierarchy=!0}updateData(t){const{nodes:e,edges:n,combos:r}=t;this.batch(()=>{this.updateNodeData(e),this.updateComboData(r),this.updateEdgeData(n)}),this.computeZIndex(t,"update")}updateNodeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{const n=[];t.forEach(t=>{const r=Vm(t),i=i$(e.getNode(r));if(nE(i,t))return;const A=tE(i,t);this.pushChange({value:A,original:i,type:Rv.NodeUpdated}),e.mergeNodeData(r,A),n.push(A)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({nodes:t},"update")}refreshData(){const{nodes:t,edges:e,combos:n}=this.getData();t.forEach(t=>{this.pushChange({value:t,original:t,type:Rv.NodeUpdated})}),e.forEach(t=>{this.pushChange({value:t,original:t,type:Rv.EdgeUpdated})}),n.forEach(t=>{this.pushChange({value:t,original:t,type:Rv.ComboUpdated})})}syncNodeLikeDatum(t){const{model:e}=this,n=Vm(t);if(!e.hasNode(n))return;const r=tE(i$(e.getNode(n)),t);e.mergeNodeData(n,r)}syncEdgeDatum(t){const{model:e}=this,n=Vm(t);if(!e.hasEdge(n))return;const r=tE(i$(e.getEdge(n)),t);e.mergeEdgeData(n,r)}updateEdgeData(t=[]){if(!t.length)return;const{model:e}=this;this.batch(()=>{t.forEach(t=>{const n=Vm(t),r=i$(e.getEdge(n));if(nE(r,t))return;t.source&&r.source!==t.source&&e.updateEdgeSource(n,t.source),t.target&&r.target!==t.target&&e.updateEdgeTarget(n,t.target);const i=tE(r,t);this.pushChange({value:i,original:r,type:Rv.EdgeUpdated}),e.mergeEdgeData(n,i)})}),this.computeZIndex({edges:t},"update")}updateComboData(t=[]){if(!t.length)return;const{model:e}=this;e.batch(()=>{const n=[];t.forEach(t=>{const r=Vm(t),i=i$(e.getNode(r));if(nE(i,t))return;const A=tE(i,t);this.pushChange({value:A,original:i,type:Rv.ComboUpdated}),e.mergeNodeData(r,A),n.push(A)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({combos:t},"update")}setParent(t,e,n,r=!0){if(t===e)return;const i=zm(this.getNodeLikeDatum(t));if(i!==e&&n===Yv){const n={id:t,combo:e};this.isCombo(t),this.syncNodeLikeDatum(n)}this.model.setParent(t,e,n),r&&n===Yv&&function(t,e){void 0===e&&(e=new Map);var n=[];if(Array.isArray(t))for(var r=0,i=t.length;r<i;r++){var A=t[r];e.has(A)||(n.push(A),e.set(A,!0))}return n}([i,e]).forEach(t=>{void 0!==t&&this.refreshComboData(t)})}refreshComboData(t){const e=this.getComboData([t])[0],n=this.getAncestorsData(t,Yv);e&&this.pushChange({value:e,original:e,type:Rv.ComboUpdated}),n.forEach(t=>{this.pushChange({value:t,original:t,type:Rv.ComboUpdated})})}getElementPosition(t){return My(this.getElementDataById(t))}translateNodeLikeBy(t,e){this.isCombo(t)?this.translateComboBy(t,e):this.translateNodeBy(t,e)}translateNodeLikeTo(t,e){this.isCombo(t)?this.translateComboTo(t,e):this.translateNodeTo(t,e)}translateNodeBy(t,e){const n=cy(this.getElementPosition(t),[...e,0].slice(0,3));this.translateNodeTo(t,n)}translateNodeTo(t,e){const[n=0,r=0,i=0]=e;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:t,style:{x:n,y:r,z:i}}])})}translateComboBy(t,e){const[n=0,r=0,i=0]=e;if([n,r,i].some(isNaN)||[n,r,i].every(t=>0===t))return;const A=this.getComboData([t])[0];if(!A)return;const o=new Set;Zy(A,t=>{const e=Vm(t);if(o.has(e))return;o.add(e);const[A,s,a]=My(t),c=tE(t,{style:{x:A+n,y:s+r,z:a+i}});this.pushChange({value:c,original:t,type:this.isCombo(e)?Rv.ComboUpdated:Rv.NodeUpdated}),this.model.mergeNodeData(e,c)},t=>this.getChildrenData(Vm(t)),"BT")}translateComboTo(t,e){var n;if(e.some(isNaN))return;const[r=0,i=0,A=0]=e,o=null===(n=this.getComboData([t]))||void 0===n?void 0:n[0];if(!o)return;const[s,a,c]=My(o),l=r-s,u=i-a,h=A-c;Zy(o,t=>{const e=Vm(t),[n,r,i]=My(t),A=tE(t,{style:{x:n+l,y:r+u,z:i+h}});this.pushChange({value:A,original:t,type:this.isCombo(e)?Rv.ComboUpdated:Rv.NodeUpdated}),this.model.mergeNodeData(e,A)},t=>this.getChildrenData(Vm(t)),"BT")}removeData(t){const{nodes:e,edges:n,combos:r}=t;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(e),this.removeComboData(r),this.latestRemovedComboIds=new Set(r)})}removeNodeData(t=[]){t.length&&this.batch(()=>{t.forEach(t=>{this.removeEdgeData(this.getRelatedEdgesData(t).map(Vm)),this.pushChange({value:this.getNodeData([t])[0],type:Rv.NodeRemoved}),this.removeNodeLikeHierarchy(t)}),this.model.removeNodes(t)})}removeEdgeData(t=[]){t.length&&(t.forEach(t=>this.pushChange({value:this.getEdgeData([t])[0],type:Rv.EdgeRemoved})),this.model.removeEdges(t))}removeComboData(t=[]){t.length&&this.batch(()=>{t.forEach(t=>{this.pushChange({value:this.getComboData([t])[0],type:Rv.ComboRemoved}),this.removeNodeLikeHierarchy(t),this.comboIds.delete(t)}),this.model.removeNodes(t)})}removeNodeLikeHierarchy(t){if(this.model.hasTreeStructure(Yv)){const e=zm(this.getNodeLikeDatum(t));this.setParent(t,void 0,Yv,!1),this.model.getChildren(t,Yv).forEach(t=>{const n=i$(t),r=Vm(n);this.setParent(Vm(n),e,Yv,!1);const i=tE(n,{id:Vm(n),combo:e});this.pushChange({value:i,original:n,type:this.isCombo(r)?Rv.ComboUpdated:Rv.NodeUpdated}),this.model.mergeNodeData(Vm(n),i)}),zt(e)||this.refreshComboData(e)}}getElementType(t){if(this.model.hasNode(t))return this.isCombo(t)?"combo":"node";if(this.model.hasEdge(t))return"edge";throw new Error(tm(`Unknown element type of id: ${t}`))}destroy(){const{model:t}=this,e=t.getAllNodes(),n=t.getAllEdges();t.removeEdges(n.map(t=>t.id)),t.removeNodes(e.map(t=>t.id)),this.context={}}}class o${constructor(t){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=t}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){const{canvas:t}=this.context;this.container=t.appendChild(new Ja({className:"elements"}))}}emit(t,e){e.silence||XJ(this.context.graph,t)}forEachElementData(t){qy.forEach(e=>{const n=this.context.model.getElementsDataByType(e);t(e,n)})}getElementType(t,e){var n;const{options:r,graph:i}=this.context,A=iE(e)&&(null===(n=r[t])||void 0===n?void 0:n.type)||e.type;return A?"string"==typeof A?A:A.call(i,e):"edge"===t?"line":"circle"}getTheme(t){return nm(this.context.options)[t]||{}}getThemeStyle(t){return this.getTheme(t).style||{}}getThemeStateStyle(t,e){const{state:n={}}=this.getTheme(t);return Object.assign({},...e.map(t=>n[t]||{}))}computePaletteStyle(){const{options:t}=this.context;this.paletteStyle={},this.forEachElementData((e,n)=>{var r,i;const A=Object.assign({},uw(null===(r=this.getTheme(e))||void 0===r?void 0:r.palette),uw(null===(i=t[e])||void 0===i?void 0:i.palette));(null==A?void 0:A.field)&&Object.assign(this.paletteStyle,function(t,e){if(!e)return{};const{type:n,color:r,field:i,invert:A}=e,o=t=>{const e="string"==typeof r?Jv("palette",r):r;if("function"==typeof e){const n={};return t.forEach(([t,r])=>{n[t]=e(A?1-r:r)}),n}if(Array.isArray(e)){const n=A?[...e].reverse():e,r={};return t.forEach(([t,i])=>{r[t]=n[i%e.length]}),r}return{}},s=(t,e)=>{var n;return"string"==typeof t?null===(n=e.data)||void 0===n?void 0:n[t]:null==t?void 0:t(e)};if("group"===n){const e=ie(t,t=>{if(!i)return"default";const e=s(i,t);return e?String(e):"default"}),n=o(Object.keys(e).map((t,e)=>[t,e])),r={};return Object.entries(e).forEach(([t,e])=>{e.forEach(e=>{r[Vm(e)]=n[t]})}),r}if("value"===n){const[e,n]=t.reduce(([t,e],n)=>{const r=s(i,n);if("number"!=typeof r)throw new Error(tm(`Palette field ${i} is not a number`));return[Math.min(t,r),Math.max(e,r)]},[1/0,-1/0]),r=n-e;return o(t.map(t=>[t.id,(s(i,t)-e)/r]))}}(n,A))})}getPaletteStyle(t,e){const n=this.paletteStyle[e];return n?"edge"===t?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(t,e){var n;const{options:r}=this.context,i=(null===(n=r[t])||void 0===n?void 0:n.style)||{};"transform"in i&&Array.isArray(i.transform)&&(i.transform=[...i.transform]),this.defaultStyle[Vm(e.datum)]=cw(i,e)}computeElementsDefaultStyle(t){const{graph:e}=this.context;this.forEachElementData((n,r)=>{const i=r.length;for(let A=0;A<i;A++){const i=r[A];(void 0===t||t.includes(Vm(i)))&&this.computeElementDefaultStyle(n,{datum:i,graph:e})}})}getDefaultStyle(t){return this.defaultStyle[t]||{}}getElementState(t){try{const{model:e}=this.context;return e.getElementState(t)}catch(t){return[]}}getElementStateStyle(t,e,n){var r,i;const{options:A}=this.context;return cw((null===(i=null===(r=A[t])||void 0===r?void 0:r.state)||void 0===i?void 0:i[e])||{},n)}computeElementStatesStyle(t,e,n){this.stateStyle[Vm(n.datum)]=Object.assign({},...e.map(e=>this.getElementStateStyle(t,e,n)))}computeElementsStatesStyle(t){const{graph:e}=this.context;this.forEachElementData((n,r)=>{const i=r.length;for(let A=0;A<i;A++){const i=r[A];if(void 0===t||t.includes(Vm(i))){const t=this.getElementState(Vm(i));this.computeElementStatesStyle(n,t,{datum:i,graph:e})}}})}getStateStyle(t){return this.stateStyle[t]||{}}computeStyle(t,e){t&&["translate","zIndex"].includes(t)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(e),this.computeElementsStatesStyle(e))}getElement(t){return this.elementMap[t]}getNodes(){return this.context.model.getNodeData().map(({id:t})=>this.elementMap[t])}getEdges(){return this.context.model.getEdgeData().map(t=>this.elementMap[Vm(t)])}getCombos(){return this.context.model.getComboData().map(({id:t})=>this.elementMap[t])}getElementComputedStyle(t,e){const n=Vm(e),r=this.getThemeStyle(t),i=this.getPaletteStyle(t,n),A=e.style||{},o=this.getDefaultStyle(n),s=this.getThemeStateStyle(t,this.getElementState(n)),a=this.getStateStyle(n),c=iE(e)?Object.assign({},r,i,A,o,s,a):Object.assign({},A);if("combo"===t){const t=this.context.model.getChildrenData(n),e=!!c.collapsed?[]:t.map(Vm).filter(t=>this.getElement(t));Object.assign(c,{childrenNode:e,childrenData:t})}return c}getDrawData(t){this.init();const e=this.computeChangesAndDrawData(t);if(!e)return null;const{type:n="draw",stage:r=n}=t;return this.markDestroyElement(e.drawData),this.computeStyle(r),{type:n,stage:r,data:e}}draw(t={animation:!0}){const e=this.getDrawData(t);if(!e)return;const{data:{drawData:{add:n,update:r,remove:i}}}=e;return this.destroyElements(i,t),this.createElements(n,t),this.updateElements(r,t),this.setAnimationTask(t,e)}preLayoutDraw(){return _e(this,arguments,void 0,function*(t={animation:!0}){var e,n;const r=this.getDrawData(t);if(!r)return;const{data:{drawData:i}}=r;yield null===(n=null===(e=this.context.layout)||void 0===e?void 0:e.preLayout)||void 0===n?void 0:n.call(e,i);const{add:A,update:o,remove:s}=i;return this.destroyElements(s,t),this.createElements(A,t),this.updateElements(o,t),this.setAnimationTask(t,r)})}setAnimationTask(e,n){const{animation:r,silence:i}=e,{data:{dataChanges:A,drawData:o},stage:s,type:a}=n;return this.context.animation.animate(r,i?{}:{before:()=>this.emit(new VJ(t.GraphEvent.BEFORE_DRAW,{dataChanges:A,animation:r,stage:s,render:"render"===a}),e),beforeAnimate:n=>this.emit(new zJ(t.GraphEvent.BEFORE_ANIMATE,Hv.DRAW,n,o),e),afterAnimate:n=>this.emit(new zJ(t.GraphEvent.AFTER_ANIMATE,Hv.DRAW,n,o),e),after:()=>this.emit(new VJ(t.GraphEvent.AFTER_DRAW,{dataChanges:A,animation:r,stage:s,render:"render"===a,firstRender:!1===this.context.graph.rendered}),e)})}computeChangesAndDrawData(t){const{model:e}=this.context,n=e.getChanges(),r=ez(n);if(0===r.length)return null;const{NodeAdded:i=[],NodeUpdated:A=[],NodeRemoved:o=[],EdgeAdded:s=[],EdgeUpdated:a=[],EdgeRemoved:c=[],ComboAdded:l=[],ComboUpdated:u=[],ComboRemoved:h=[]}=ie(r,t=>t.type),d=(t,e)=>{const n=[];return t.forEach(t=>{const r=Vm(t.value);this.getElement(r)?n.push(t):e.push(t)}),n},f=d(A,i),g=d(a,s),p=d(u,l),v=t=>new Map(t.map(t=>{const e=t.value;return[Vm(e),e]})),m={add:{nodes:v(i),edges:v(s),combos:v(l)},update:{nodes:v(f),edges:v(g),combos:v(p)},remove:{nodes:v(o),edges:v(c),combos:v(h)}},y=this.transformData(m,t);return e.clearChanges(),{dataChanges:n,drawData:y}}transformData(t,e){const n=this.context.transform.getTransformInstance();return Object.values(n).reduce((t,n)=>n.beforeDraw(t,e),t)}createElement(e,n,r){var i;const A=Vm(n);if(this.getElement(A))return;const o=this.getElementType(e,n),s=this.getElementComputedStyle(e,n),a=Jv(e,o);if(!a)return em(`The element ${o} of ${e} is not registered.`);this.emit(new WJ(t.GraphEvent.BEFORE_ELEMENT_CREATE,e,n),r);const c=this.container.appendChild(new a({id:A,context:this.context,style:s}));this.shapeTypeMap[A]=o,this.elementMap[A]=c;const{stage:l="enter"}=r;null===(i=this.context.animation)||void 0===i||i.add({element:c,elementType:e,stage:l,originalStyle:Object.assign({},c.attributes),updatedStyle:s},{after:()=>{var i;this.emit(new WJ(t.GraphEvent.AFTER_ELEMENT_CREATE,e,n),r),null===(i=c.onCreate)||void 0===i||i.call(c)}})}createElements(t,e){const{nodes:n,edges:r,combos:i}=t;[["node",n],["combo",i],["edge",r]].forEach(([t,n])=>{n.forEach(n=>this.createElement(t,n,e))})}getUpdateStageStyle(t,e,n){const{stage:r="update"}=n;if("translate"===r){if("node"===t||"combo"===t){const{style:{x:t=0,y:n=0,z:r=0}={}}=e;return{x:t,y:n,z:r}}return{}}return this.getElementComputedStyle(t,e)}updateElement(e,n,r){var i;const A=Vm(n),{stage:o="update"}=r,s=this.getElement(A);if(!s)return()=>null;this.emit(new WJ(t.GraphEvent.BEFORE_ELEMENT_UPDATE,e,n),r);const a=this.getElementType(e,n),c=this.getUpdateStageStyle(e,n,r);this.shapeTypeMap[A]!==a&&(s.destroy(),delete this.shapeTypeMap[A],delete this.elementMap[A],this.createElement(e,n,{animation:!1,silence:!0}));const l="visibility"!==o?o:"hidden"===c.visibility?"hide":"show";"hide"===l&&delete c.visibility,null===(i=this.context.animation)||void 0===i||i.add({element:s,elementType:e,stage:l,originalStyle:Object.assign({},s.attributes),updatedStyle:c},{before:()=>{const t=this.elementMap[A];"collapse"!==o&&Zb(t,c),"visibility"===o&&(function(t,e){return JJ(e)in(ke(t,ZJ)||{})}(t,"opacity")||function(t,e){const n=Array.isArray(e)?e:[e];ke(t,ZJ)||Qe(t,ZJ,{}),n.forEach(e=>{Qe(ke(t,ZJ),JJ(e),t.attributes[e])})}(t,"opacity"),this.visibilityCache.set(t,"show"===l?"visible":"hidden"),"show"===l&&ry(t,"visible"))},after:()=>{var i;const s=this.elementMap[A];"collapse"===o&&Zb(s,c),"hide"===l&&ry(s,this.visibilityCache.get(s)),this.emit(new WJ(t.GraphEvent.AFTER_ELEMENT_UPDATE,e,n),r),null===(i=s.onUpdate)||void 0===i||i.call(s)}})}updateElements(t,e){const{nodes:n,edges:r,combos:i}=t;[["node",n],["combo",i],["edge",r]].forEach(([t,n])=>{n.forEach(n=>this.updateElement(t,n,e))})}markDestroyElement(t){Object.values(t.remove).forEach(t=>{t.forEach(t=>{const e=Vm(t),n=this.getElement(e);n&&function(t){Qe(t,"__to_be_destroyed__",!0)}(n)})})}destroyElement(e,n,r){var i;const{stage:A="exit"}=r,o=Vm(n),s=this.elementMap[o];if(!s)return()=>null;this.emit(new WJ(t.GraphEvent.BEFORE_ELEMENT_DESTROY,e,n),r),null===(i=this.context.animation)||void 0===i||i.add({element:s,elementType:e,stage:A,originalStyle:Object.assign({},s.attributes),updatedStyle:{}},{after:()=>{var i;this.clearElement(o),s.destroy(),null===(i=s.onDestroy)||void 0===i||i.call(s),this.emit(new WJ(t.GraphEvent.AFTER_ELEMENT_DESTROY,e,n),r)}})}destroyElements(t,e){const{nodes:n,edges:r,combos:i}=t;[["combo",i],["edge",r],["node",n]].forEach(([t,n])=>{n.forEach(n=>this.destroyElement(t,n,e))})}clearElement(t){delete this.paletteStyle[t],delete this.defaultStyle[t],delete this.stateStyle[t],delete this.elementMap[t],delete this.shapeTypeMap[t]}alignLayoutResultToElement(t,e){var n,r;const i=null===(n=t.nodes)||void 0===n?void 0:n.find(t=>Vm(t)===e);if(i){const n=ly(My(this.context.model.getNodeLikeDatum(e)),My(i));null===(r=t.nodes)||void 0===r||r.forEach(t=>{var e,r,i;(null===(e=t.style)||void 0===e?void 0:e.x)&&(t.style.x+=n[0]),(null===(r=t.style)||void 0===r?void 0:r.y)&&(t.style.y+=n[1]),(null===(i=t.style)||void 0===i?void 0:i.z)&&(t.style.z+=n[2]||0)})}}syncLayoutResult(t,e){return _e(this,void 0,void 0,function*(){const{layout:n,model:r}=this.context;if(!n)return;const i=this.context.options.layout,A=yield n.simulate(i?(o=i,Array.isArray(o)?o.map(t=>Object.assign(Object.assign({},t),{preLayout:!0})):Object.assign(Object.assign({},o),{preLayout:!0})):void 0);var o;e&&this.alignLayoutResultToElement(A,t),r.updateData(A)})}collapseNode(e,n){return _e(this,void 0,void 0,function*(){var r;const{animation:i,align:A}=n;yield this.syncLayoutResult(e,A);const o=this.computeChangesAndDrawData({stage:"collapse",animation:i});if(!o)return;const{drawData:s}=o,{add:a,remove:c,update:l}=s;this.markDestroyElement(s);const u={animation:i,stage:"collapse",data:s};this.destroyElements(c,u),this.createElements(a,u),this.updateElements(l,u),yield null===(r=this.context.animation.animate(i,{beforeAnimate:e=>this.emit(new zJ(t.GraphEvent.BEFORE_ANIMATE,Hv.COLLAPSE,e,s),u),afterAnimate:e=>this.emit(new zJ(t.GraphEvent.AFTER_ANIMATE,Hv.COLLAPSE,e,s),u)},{collapse:{target:e,descendants:Array.from(c.nodes).map(([,t])=>Vm(t)),position:My(l.nodes.get(e))}}))||void 0===r?void 0:r.finished})}expandNode(e,n){return _e(this,void 0,void 0,function*(){var r;const{model:i}=this.context,{animation:A,align:o}=n,s=My(i.getNodeData([e])[0]);yield this.syncLayoutResult(e,o);const a=this.computeChangesAndDrawData({stage:"expand",animation:A});if(this.createElements(a.drawData.add,{animation:!1,stage:"expand",target:e}),this.context.animation.clear(),this.computeStyle("expand"),!a)return;const{drawData:c}=a,{update:l,add:u}=c,h={animation:A,stage:"expand",data:c};u.edges.forEach(t=>l.edges.set(Vm(t),t)),u.nodes.forEach(t=>l.nodes.set(Vm(t),t)),this.updateElements(l,h),yield null===(r=this.context.animation.animate(A,{beforeAnimate:e=>this.emit(new zJ(t.GraphEvent.BEFORE_ANIMATE,Hv.EXPAND,e,c),h),afterAnimate:e=>this.emit(new zJ(t.GraphEvent.AFTER_ANIMATE,Hv.EXPAND,e,c),h)},{expand:{target:e,descendants:Array.from(u.nodes).map(([,t])=>Vm(t)),position:s}}))||void 0===r?void 0:r.finished})}collapseCombo(e,n){return _e(this,void 0,void 0,function*(){var r;const{model:i,element:A}=this.context;if(i.getAncestorsData(e,Yv).some(t=>nw(t)))return;const o=A.getElement(e),s=o.getComboPosition(Object.assign(Object.assign({},o.attributes),{collapsed:!0})),a=this.computeChangesAndDrawData({stage:"collapse",animation:n});if(!a)return;const{dataChanges:c,drawData:l}=a;this.markDestroyElement(l);const{update:u,remove:h}=l,d={animation:n,stage:"collapse",data:l};this.destroyElements(h,d),this.updateElements(u,d);const f=t=>Array.from(t).map(([,t])=>Vm(t));yield null===(r=this.context.animation.animate(n,{before:()=>this.emit(new VJ(t.GraphEvent.BEFORE_DRAW,{dataChanges:c,animation:n}),d),beforeAnimate:e=>this.emit(new zJ(t.GraphEvent.BEFORE_ANIMATE,Hv.COLLAPSE,e,l),d),afterAnimate:e=>this.emit(new zJ(t.GraphEvent.AFTER_ANIMATE,Hv.COLLAPSE,e,l),d),after:()=>this.emit(new VJ(t.GraphEvent.AFTER_DRAW,{dataChanges:c,animation:n}),d)},{collapse:{target:e,descendants:[...f(h.nodes),...f(h.combos)],position:s}}))||void 0===r?void 0:r.finished})}expandCombo(e,n){return _e(this,void 0,void 0,function*(){var r;const{model:i}=this.context,A=My(i.getComboData([e])[0]);this.computeStyle("expand");const o=this.computeChangesAndDrawData({stage:"expand",animation:n});if(!o)return;const{dataChanges:s,drawData:a}=o,{add:c,update:l}=a,u={animation:n,stage:"expand",data:a,target:e};this.createElements(c,u),this.updateElements(l,u);const h=t=>Array.from(t).map(([,t])=>Vm(t));yield null===(r=this.context.animation.animate(n,{before:()=>this.emit(new VJ(t.GraphEvent.BEFORE_DRAW,{dataChanges:s,animation:n}),u),beforeAnimate:e=>this.emit(new zJ(t.GraphEvent.BEFORE_ANIMATE,Hv.EXPAND,e,a),u),afterAnimate:e=>this.emit(new zJ(t.GraphEvent.AFTER_ANIMATE,Hv.EXPAND,e,a),u),after:()=>this.emit(new VJ(t.GraphEvent.AFTER_DRAW,{dataChanges:s,animation:n}),u)},{expand:{target:e,descendants:[...h(c.nodes),...h(c.combos)],position:A}}))||void 0===r?void 0:r.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}}class s${get presetOptions(){return{animation:!!om(this.context.options,!0)}}get options(){const{options:t}=this.context;return t.layout}constructor(t){this.instances=[],this.context=t}getLayoutInstance(){return this.instances}preLayout(e){return _e(this,void 0,void 0,function*(){var n,r,i,A;const{graph:o,model:s}=this.context,{add:a}=e;XJ(o,new VJ(t.GraphEvent.BEFORE_LAYOUT,{type:"pre"}));const c=yield null===(n=this.context.layout)||void 0===n?void 0:n.simulate();null===(r=null==c?void 0:c.nodes)||void 0===r||r.forEach(t=>{const e=Vm(t),n=a.nodes.get(e);s.syncNodeLikeDatum(t),n&&Object.assign(n.style,t.style)}),null===(i=null==c?void 0:c.edges)||void 0===i||i.forEach(t=>{const e=Vm(t),n=a.edges.get(e);s.syncEdgeDatum(t),n&&Object.assign(n.style,t.style)}),null===(A=null==c?void 0:c.combos)||void 0===A||A.forEach(t=>{const e=Vm(t),n=a.combos.get(e);s.syncNodeLikeDatum(t),n&&Object.assign(n.style,t.style)}),XJ(o,new VJ(t.GraphEvent.AFTER_LAYOUT,{type:"pre"})),this.transformDataAfterLayout("pre",e)})}postLayout(){return _e(this,arguments,void 0,function*(e=this.options){if(!e)return;const n=Array.isArray(e)?e:[e],{graph:r}=this.context;XJ(r,new VJ(t.GraphEvent.BEFORE_LAYOUT,{type:"post"}));for(let e=0;e<n.length;e++){const i=n[e],A=this.getLayoutData(i),o=Object.assign(Object.assign({},this.presetOptions),i);XJ(r,new VJ(t.GraphEvent.BEFORE_STAGE_LAYOUT,{options:o,index:e}));const s=yield this.stepLayout(A,o,e);XJ(r,new VJ(t.GraphEvent.AFTER_STAGE_LAYOUT,{options:o,index:e})),i.animation||this.updateElementPosition(s,!1)}XJ(r,new VJ(t.GraphEvent.AFTER_LAYOUT,{type:"post"})),this.transformDataAfterLayout("post")})}transformDataAfterLayout(t,e){const n=this.context.transform.getTransformInstance();Object.values(n).forEach(n=>n.afterLayout(t,e))}simulate(){return _e(this,arguments,void 0,function*(t=this.options){if(!t)return{};const e=Array.isArray(t)?t:[t];let n={};for(let t=0;t<e.length;t++){const r=e[t],i=this.getLayoutData(r);n=yield this.stepLayout(i,Object.assign(Object.assign(Object.assign({},this.presetOptions),r),{animation:!1}),t)}return n})}stepLayout(t,e,n){return _e(this,void 0,void 0,function*(){return function(t){const{type:e}=t;return["compact-box","mindmap","dendrogram","indented"].includes(e)}(e)?yield this.treeLayout(t,e,n):yield this.graphLayout(t,e,n)})}graphLayout(t,e,n){return _e(this,void 0,void 0,function*(){const{animation:r,enableWorker:i,iterations:A=300}=e,o=this.initGraphLayout(e);if(!o)return{};if(this.instances[n]=o,this.instance=o,i){const e=o;return this.supervisor=new Vj(e.graphData2LayoutModel(t),e.instance,{iterations:A}),pE(yield this.supervisor.execute())}if($M(o))return r?yield o.execute(t,{onTick:t=>{this.updateElementPosition(t,!1)}}):(o.execute(t),o.stop(),o.tick(A));const s=yield o.execute(t);if(r){const t=this.updateElementPosition(s,r);yield null==t?void 0:t.finished}return s})}treeLayout(t,e,n){return _e(this,void 0,void 0,function*(){const{type:n,animation:r}=e,i=Jv("layout",n);if(!i)return{};const{nodes:A=[],edges:o=[]}=t,s=new fE({nodes:A.map(t=>({id:Vm(t),data:t.data||{}})),edges:o.map(t=>({id:Vm(t),source:t.source,target:t.target,data:t.data||{}}))});!function(t){if(t.hasTreeStructure(Xv))return;t.attachTreeStructure(Xv);const e=t.getAllEdges();for(const n of e){const{source:e,target:r}=n;t.setParent(r,e,Xv)}}(s);const a={nodes:[],edges:[]},c={nodes:[],edges:[]};s.getRoots(Xv).forEach(t=>{Zy(t,t=>{t.children=s.getSuccessors(t.id)},t=>s.getSuccessors(t.id),"TB");const n=i(t,e),{x:r,y:A,z:o=0}=n;Zy(n,t=>{const{id:e,x:n,y:i,z:s=0}=t;a.nodes.push({id:e,style:{x:r,y:A,z:o}}),c.nodes.push({id:e,style:{x:n,y:i,z:s}})},t=>t.children,"TB")});const l=this.inferTreeLayoutOffset(c);if(a$(c,l),r){a$(a,l),this.updateElementPosition(a,!1);const t=this.updateElementPosition(c,r);yield null==t?void 0:t.finished}return c})}inferTreeLayoutOffset(t){var e;let[n,r]=[1/0,-1/0],[i,A]=[1/0,-1/0];null===(e=t.nodes)||void 0===e||e.forEach(t=>{const{x:e=0,y:o=0}=t.style||{};n=Math.min(n,e),r=Math.max(r,e),i=Math.min(i,o),A=Math.max(A,o)});const{canvas:o}=this.context,s=o.getSize(),[a,c]=o.getCanvasByViewport([0,0]),[l,u]=o.getCanvasByViewport(s);if(n>=a&&r<=l&&i>=c&&A<=u)return[0,0];return[(a+l)/2-(n+r)/2,(c+u)/2-(i+A)/2]}stopLayout(){this.instance&&$M(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&(this.supervisor.stop(),this.supervisor=void 0),this.animationResult&&(this.animationResult.finish(),this.animationResult=void 0)}getLayoutData(t){const{nodeFilter:e=()=>!0,comboFilter:n=()=>!0,preLayout:r=!1,isLayoutInvisibleNodes:i=!1}=t,{nodes:A,edges:o,combos:s}=this.context.model.getData(),{element:a,model:c}=this.context,l=t=>a.getElement(t),u=r?t=>{var n;if(!i){if("hidden"===(null===(n=t.style)||void 0===n?void 0:n.visibility))return!1;if(c.getAncestorsData(t.id,Xv).some(nw))return!1;if(c.getAncestorsData(t.id,Yv).some(nw))return!1}return e(t)}:t=>{const n=Vm(t),r=l(n);return!!r&&(!Jb(r)&&e(t))},h=A.filter(u),d=s.filter(n),f=new Map(h.map(t=>[Vm(t),t]));d.forEach(t=>f.set(Vm(t),t));return{nodes:h,edges:o.filter(({source:t,target:e})=>f.has(t)&&f.has(e)),combos:d}}initGraphLayout(t){var e;const{element:n,viewport:r}=this.context,{type:i,enableWorker:A,animation:o,iterations:s}=t,a=He(t,["type","enableWorker","animation","iterations"]),[c,l]=r.getCanvasSize(),u=[c/2,l/2],h=null!==(e=null==t?void 0:t.nodeSize)&&void 0!==e?e:t=>{const e=null==n?void 0:n.getElement(t.id);return e?e.attributes.size:null==n?void 0:n.getElementComputedStyle("node",t).size},d=Jv("layout",i);if(!d)return em(`The layout of ${i} is not registered.`);const f=Object.getPrototypeOf(d.prototype)===gE.prototype?d:function(t,e){return class extends gE{constructor(e,n){if(super(e,n),this.instance=new t({}),this.id=this.instance.id,"stop"in this.instance&&"tick"in this.instance){const t=this.instance;this.stop=t.stop.bind(t),this.tick=e=>pE(t.tick(e))}}execute(t,e){return _e(this,void 0,void 0,function*(){return pE(yield this.instance.execute(this.graphData2LayoutModel(t),this.transformOptions(xe({},this.options,e))))})}transformOptions(t){if(!("onTick"in t))return t;const e=t.onTick;return t.onTick=t=>e(pE(t)),t}graphData2LayoutModel(t){const{nodes:n=[],edges:r=[],combos:i=[]}=t,A=n.map(t=>{const e=Vm(t),{data:n,style:r,combo:i}=t,A=He(t,["data","style","combo"]),o={id:e,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),{data:n}),i?{parentId:i}:{}),{style:r}),A)};return(null==r?void 0:r.x)&&Object.assign(o.data,{x:r.x}),(null==r?void 0:r.y)&&Object.assign(o.data,{y:r.y}),(null==r?void 0:r.z)&&Object.assign(o.data,{z:r.z}),o}),o=new Map(A.map(t=>[t.id,t])),s=r.filter(t=>{const{source:e,target:n}=t;return o.has(e)&&o.has(n)}).map(t=>{const{source:e,target:n,data:r,style:i}=t;return{id:Vm(t),source:e,target:n,data:Object.assign({},r),style:Object.assign({},i)}}),a=i.map(t=>({id:Vm(t),data:Object.assign({_isCombo:!0},t.data),style:Object.assign({},t.style)})),c=new fE({nodes:[...A,...a],edges:s});return e.model.model.hasTreeStructure(Yv)&&(c.attachTreeStructure(Yv),A.forEach(t=>{const n=e.model.model.getParent(t.id,Yv);n&&c.hasNode(n.id)&&c.setParent(t.id,n.id,Yv)})),c}}}(d,this.context),g=new f(this.context),p={nodeSize:h,width:c,height:l,center:u};switch(g.id){case"d3-force":case"d3-force-3d":Object.assign(p,{center:{x:c/2,y:l/2,z:0}})}return xe(g.options,p,a),g}updateElementPosition(t,e){const{model:n,element:r}=this.context;return r?(n.updateData(t),r.draw({animation:e,silence:!0})):null}destroy(){var t;this.stopLayout(),this.context={},null===(t=this.supervisor)||void 0===t||t.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}}const a$=(t,e)=>{var n;const[r,i]=e;null===(n=t.nodes)||void 0===n||n.forEach(t=>{if(t.style){const{x:e=0,y:n=0}=t.style;t.style.x=e+r,t.style.y=n+i}else t.style={x:r,y:i}})};function c$(t){return t.layout?(Array.isArray(t.layout)||"preLayout"in t.layout||["antv-dagre","combo-combined","compact-box","circular","concentric","dagre","fishbone","grid","indented","mds","radial","random","snake","dendrogram","mindmap"].includes(t.layout.type)&&(t.layout.preLayout=!0),t):t}class l$ extends iy{constructor(t){super(t),this.category="plugin",this.setPlugins(this.context.options.plugins||[])}setPlugins(t){this.setExtensions(t)}getPluginInstance(t){const e=this.extensionMap[t];if(e)return e;em(`Cannot find the plugin ${t}, will try to find it by type.`);const n=this.extensions.find(e=>e.type===t);return n?this.extensionMap[n.key]:void 0}}const u$=["update-related-edges","collapse-expand-node","collapse-expand-combo","get-edge-actual-ends","arrange-draw-order"];class h$ extends iy{constructor(t){super(t),this.category="transform",this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(t){this.setExtensions([...u$.slice(0,u$.length-1),...t,u$[u$.length-1]])}getTransformInstance(t){return t?this.extensionMap[t]:this.extensionMap}}class d${get padding(){return mm(this.context.options.padding)}get paddingOffset(){const[t,e,n,r]=this.padding,[i,A,o]=[(r-e)/2,(t-n)/2,0];return[i,A,o]}constructor(t){this.landmarkCounter=0,this.context=t;const[e,n]=this.paddingOffset,{zoom:r,rotation:i,x:A=e,y:o=n}=t.options;this.transform({mode:"absolute",scale:r,translate:[A,o],rotate:i},!1)}get camera(){const{canvas:t}=this.context;return new Proxy(t.getCamera(),{get:(e,n)=>{const r=Object.entries(t.getLayers()).filter(([t])=>!["main"].includes(t)),i=r.map(([,t])=>t.getCamera()),A=e[n];if("function"==typeof A)return(...t)=>{const r=A.apply(e,t);return i.forEach(e=>{e[n].apply(e,t)}),r}}})}createLandmark(t){return this.camera.createLandmark("landmark-"+this.landmarkCounter++,t)}getAnimation(t){const e=om(this.context.options,t);return!!e&&Ue(Object.assign({},e),["easing","duration"])}getCanvasSize(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e,n]}getCanvasCenter(){const{canvas:t}=this.context,{width:e=0,height:n=0}=t.getConfig();return[e/2,n/2,0]}getViewportCenter(){const[t,e]=this.camera.getPosition();return[t,e,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(t){const{camera:e}=this,{mode:n,translate:r=[]}=t,i=this.getZoom(),A=e.getPosition(),o=e.getFocalPoint(),[s,a]=this.getCanvasCenter(),[c=0,l=0,u=0]=r,h=hy([-c,-l,-u],i);return"relative"===n?{position:cy(A,h),focalPoint:cy(o,h)}:{position:cy([s,a,A[2]],h),focalPoint:cy([s,a,o[2]],h)}}getRotateOptions(t){const{mode:e,rotate:n=0}=t;return{roll:"relative"===e?this.camera.getRoll()+n:n}}getZoomOptions(t){const{zoomRange:e}=this.context.options,n=this.camera.getZoom(),{mode:r,scale:i=1}=t;return Ae("relative"===r?n*i:i,...e)}transform(e,n){return _e(this,void 0,void 0,function*(){const{graph:r}=this.context,{translate:i,rotate:A,scale:o,origin:s}=e;this.cancelAnimation();const a=this.getAnimation(n);if(XJ(r,new YJ(t.GraphEvent.BEFORE_TRANSFORM,e)),!A&&o&&!i&&s&&!a)return this.camera.setZoomByViewportPoint(this.getZoomOptions(e),s),void XJ(r,new YJ(t.GraphEvent.AFTER_TRANSFORM,e));const c={};if(i&&Object.assign(c,this.getTranslateOptions(e)),oe(A)&&Object.assign(c,this.getRotateOptions(e)),oe(o)&&Object.assign(c,{zoom:this.getZoomOptions(e)}),a)return XJ(r,new zJ(t.GraphEvent.BEFORE_ANIMATE,Hv.TRANSFORM,null,e)),new Promise(n=>{this.transformResolver=n,this.camera.gotoLandmark(this.createLandmark(c),Object.assign(Object.assign({},a),{onfinish:()=>{XJ(r,new zJ(t.GraphEvent.AFTER_ANIMATE,Hv.TRANSFORM,null,e)),XJ(r,new YJ(t.GraphEvent.AFTER_TRANSFORM,e)),this.transformResolver=void 0,n()}}))});this.camera.gotoLandmark(this.createLandmark(c),{duration:0}),XJ(r,new YJ(t.GraphEvent.AFTER_TRANSFORM,e))})}fitView(t,e){return _e(this,void 0,void 0,function*(){const[n,r,i,A]=this.padding,{when:o="always",direction:s="both"}=t||{},[a,c]=this.context.canvas.getSize(),l=a-A-r,u=c-n-i,h=this.context.canvas.getBounds(),d=this.getBBoxInViewport(h),[f,g]=bm(d);if("overflow"===o&&!("x"===s&&f>=l||"y"===s&&g>=u||"both"===s&&f>=l&&g>=u))return yield this.fitCenter({animation:e});const p=l/f,v=u/g,m="x"===s?p:"y"===s?v:Math.min(p,v),y=this.getAnimation(e);Number.isFinite(m)&&(yield this.transform({mode:"relative",scale:m,translate:cy(ly(this.getCanvasCenter(),this.getBBoxInViewport(h).center),hy(this.paddingOffset,m))},y))})}fitCenter(t){return _e(this,void 0,void 0,function*(){const e=this.context.canvas.getBounds();yield this.focus(e,t)})}focusElements(t){return _e(this,arguments,void 0,function*(t,e={}){const{element:n}=this.context;if(!n)return;const r=Fm(t.map(t=>{return r=n.getElement(t),e.shapes?r.getShape(e.shapes).getRenderBounds():r.getRenderBounds();var r}));yield this.focus(r,e)})}focus(t,e){return _e(this,void 0,void 0,function*(){const n=this.context.graph.getViewportByCanvas(t.center),r=ly(e.position||this.getCanvasCenter(),n);yield this.transform({mode:"relative",translate:cy(r,this.paddingOffset)},e.animation)})}getBBoxInViewport(t){const{min:e,max:n}=t,{graph:r}=this.context,[i,A]=r.getViewportByCanvas(e),[o,s]=r.getViewportByCanvas(n),a=new br;return a.setMinMax([i,A,0],[o,s,0]),a}isInViewport(t,e=!1,n=0){const{graph:r}=this.context,i=this.getCanvasSize(),[A,o]=r.getCanvasByViewport([0,0]),[s,a]=r.getCanvasByViewport(i);let c=new br;return c.setMinMax([A,o,0],[s,a,0]),n&&(c=Cm(c,n)),pm(t)?Mm(t,c):e?function(t,e){const[n,r]=t.min,[i,A]=t.max,[o,s]=e.min,[a,c]=e.max;return n>=o&&i<=a&&r>=s&&A<=c}(t,c):c.intersects(t)}cancelAnimation(){var t,e;(null===(t=this.camera.landmarks)||void 0===t?void 0:t.length)&&this.camera.cancelLandmarkAnimation(),null===(e=this.transformResolver)||void 0===e||e.call(this)}}class f$ extends cE{constructor(t){var e;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new A$},this.isCollapsingExpanding=!1,this.onResize=ye(()=>{this.resize()},300),this._setOptions(Object.assign({},f$.defaultOptions,t),!0),this.context.graph=this,this.options.autoResize&&(null===(e=globalThis.addEventListener)||void 0===e||e.call(globalThis,"resize",this.onResize))}getOptions(){return this.options}setOptions(t){this._setOptions(t,!1)}_setOptions(t,e){if(this.updateCanvas(t),Object.assign(this.options,function(t){return[c$].reduce((t,e)=>e(t),t)}(t)),e){const{data:e}=t;return void(e&&this.addData(e))}const{behaviors:n,combo:r,data:i,edge:A,layout:o,node:s,plugins:a,theme:c,transforms:l}=t;n&&this.setBehaviors(n),i&&this.setData(i),s&&this.setNode(s),A&&this.setEdge(A),r&&this.setCombo(r),o&&this.setLayout(o),c&&this.setTheme(c),a&&this.setPlugins(a),l&&this.setTransforms(l)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(t,e){t&&(this.options.width=t),e&&(this.options.height=e),this.resize(t,e)}setZoomRange(t){this.options.zoomRange=t}getZoomRange(){return this.options.zoomRange}setNode(t){this.options.node=t,this.context.model.refreshData()}setEdge(t){this.options.edge=t,this.context.model.refreshData()}setCombo(t){this.options.combo=t,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(t){this.options.theme=Vt(t)?t(this.getTheme()):t}setLayout(t){this.options.layout=Vt(t)?t(this.getLayout()):t}getLayout(){return this.options.layout}setBehaviors(t){var e;this.options.behaviors=Vt(t)?t(this.getBehaviors()):t,null===(e=this.context.behavior)||void 0===e||e.setBehaviors(this.options.behaviors)}updateBehavior(t){this.setBehaviors(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getBehaviors(){return this.options.behaviors||[]}setPlugins(t){var e;this.options.plugins=Vt(t)?t(this.getPlugins()):t,null===(e=this.context.plugin)||void 0===e||e.setPlugins(this.options.plugins)}updatePlugin(t){this.setPlugins(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e))}getPlugins(){return this.options.plugins||[]}getPluginInstance(t){return this.context.plugin.getPluginInstance(t)}setTransforms(t){var e;this.options.transforms=Vt(t)?t(this.getTransforms()):t,null===(e=this.context.transform)||void 0===e||e.setTransforms(this.options.transforms)}updateTransform(t){this.setTransforms(e=>e.map(e=>"object"==typeof e&&e.key===t.key?Object.assign(Object.assign({},e),t):e)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}hasNode(t){return this.context.model.hasNode(t)}hasEdge(t){return this.context.model.hasEdge(t)}hasCombo(t){return this.context.model.hasCombo(t)}getElementData(t){return Array.isArray(t)?t.map(t=>this.context.model.getElementDataById(t)):this.context.model.getElementDataById(t)}getNodeData(t){return void 0===t?this.context.model.getNodeData():Array.isArray(t)?this.context.model.getNodeData(t):this.context.model.getNodeLikeDatum(t)}getEdgeData(t){return void 0===t?this.context.model.getEdgeData():Array.isArray(t)?this.context.model.getEdgeData(t):this.context.model.getEdgeDatum(t)}getComboData(t){return void 0===t?this.context.model.getComboData():Array.isArray(t)?this.context.model.getComboData(t):this.context.model.getNodeLikeDatum(t)}setData(t){this.context.model.setData(Vt(t)?t(this.getData()):t)}addData(t){this.context.model.addData(Vt(t)?t(this.getData()):t)}addNodeData(t){this.context.model.addNodeData(Vt(t)?t(this.getNodeData()):t)}addEdgeData(t){this.context.model.addEdgeData(Vt(t)?t(this.getEdgeData()):t)}addComboData(t){this.context.model.addComboData(Vt(t)?t(this.getComboData()):t)}addChildrenData(t,e){this.context.model.addChildrenData(t,e)}updateData(t){this.context.model.updateData(Vt(t)?t(this.getData()):t)}updateNodeData(t){this.context.model.updateNodeData(Vt(t)?t(this.getNodeData()):t)}updateEdgeData(t){this.context.model.updateEdgeData(Vt(t)?t(this.getEdgeData()):t)}updateComboData(t){this.context.model.updateComboData(Vt(t)?t(this.getComboData()):t)}removeData(t){this.context.model.removeData(Vt(t)?t(this.getData()):t)}removeNodeData(t){this.context.model.removeNodeData(Vt(t)?t(this.getNodeData()):t)}removeEdgeData(t){this.context.model.removeEdgeData(Vt(t)?t(this.getEdgeData()):t)}removeComboData(t){this.context.model.removeComboData(Vt(t)?t(this.getComboData()):t)}getElementType(t){return this.context.model.getElementType(t)}getRelatedEdgesData(t,e="both"){return this.context.model.getRelatedEdgesData(t,e)}getNeighborNodesData(t){return this.context.model.getNeighborNodesData(t)}getAncestorsData(t,e){return this.context.model.getAncestorsData(t,e)}getParentData(t,e){return this.context.model.getParentData(t,e)}getChildrenData(t){return this.context.model.getChildrenData(t)}getDescendantsData(t){return this.context.model.getDescendantsData(t)}getElementDataByState(t,e){return this.context.model.getElementDataByState(t,e)}initCanvas(){return _e(this,void 0,void 0,function*(){var e;if(this.context.canvas)return yield this.context.canvas.ready;const{container:n="container",width:r,height:i,renderer:A,cursor:o,background:s,canvas:a,devicePixelRatio:c=(null!==(e=globalThis.devicePixelRatio)&&void 0!==e?e:1)}=this.options;if(n instanceof RJ)this.context.canvas=n,o&&n.setCursor(o),A&&n.setRenderer(A),yield n.ready;else{const e=ne(n)?document.getElementById(n):n,l=KJ(e);this.emit(t.GraphEvent.BEFORE_CANVAS_INIT,{container:e,width:r,height:i});const u=Object.assign(Object.assign({},a),{container:e,width:r||l[0],height:i||l[1],background:s,renderer:A,cursor:o,devicePixelRatio:c}),h=new RJ(u);this.context.canvas=h,yield h.ready,this.emit(t.GraphEvent.AFTER_CANVAS_INIT,{canvas:h})}})}updateCanvas(e){var n,r;const{renderer:i,cursor:A,height:o,width:s}=e,a=this.context.canvas;a&&(i&&(this.emit(t.GraphEvent.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),a.setRenderer(i),this.emit(t.GraphEvent.AFTER_RENDERER_CHANGE,{renderer:i})),A&&a.setCursor(A),(oe(s)||oe(o))&&this.setSize(null!==(n=null!=s?s:this.options.width)&&void 0!==n?n:0,null!==(r=null!=o?o:this.options.height)&&void 0!==r?r:0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new e$(this.context)),this.context.plugin||(this.context.plugin=new l$(this.context)),this.context.viewport||(this.context.viewport=new d$(this.context)),this.context.transform||(this.context.transform=new h$(this.context)),this.context.element||(this.context.element=new o$(this.context)),this.context.animation||(this.context.animation=new t$(this.context)),this.context.layout||(this.context.layout=new s$(this.context)),this.context.behavior||(this.context.behavior=new n$(this.context))}prepare(){return _e(this,void 0,void 0,function*(){yield Promise.resolve(),this.destroyed?console.error(tm("The graph instance has been destroyed")):(yield this.initCanvas(),this.initRuntime())})}render(){return _e(this,void 0,void 0,function*(){if(yield this.prepare(),XJ(this,new VJ(t.GraphEvent.BEFORE_RENDER)),this.options.layout)if(this.rendered||(e=this.options.layout,Array.isArray(e)||!(null==e?void 0:e.preLayout))){const t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{const t=yield this.context.element.preLayoutDraw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.autoFit()])}else{const t=this.context.element.draw({type:"render"});yield Promise.all([null==t?void 0:t.finished,this.autoFit()])}var e;this.rendered=!0,XJ(this,new VJ(t.GraphEvent.AFTER_RENDER))})}draw(){return _e(this,void 0,void 0,function*(){var t;yield this.prepare(),yield null===(t=this.context.element.draw())||void 0===t?void 0:t.finished})}layout(t){return _e(this,void 0,void 0,function*(){yield this.context.layout.postLayout(t)})}stopLayout(){this.context.layout.stopLayout()}clear(){return _e(this,void 0,void 0,function*(){const{model:t,element:e}=this.context;t.setData({}),t.clearChanges(),null==e||e.clear()})}destroy(){var e;XJ(this,new VJ(t.GraphEvent.BEFORE_DESTROY));const{layout:n,animation:r,element:i,model:A,canvas:o,behavior:s,plugin:a}=this.context;null==a||a.destroy(),null==s||s.destroy(),null==n||n.destroy(),null==r||r.destroy(),null==i||i.destroy(),A.destroy(),null==o||o.destroy(),this.options={},this.context={},this.off(),null===(e=globalThis.removeEventListener)||void 0===e||e.call(globalThis,"resize",this.onResize),this.destroyed=!0,XJ(this,new VJ(t.GraphEvent.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(e,n){var r;const i=KJ(null===(r=this.context.canvas)||void 0===r?void 0:r.getContainer()),A=[e||i[0],n||i[1]];if(!this.context.canvas)return;const o=this.context.canvas.getSize();Me(A,o)||(XJ(this,new VJ(t.GraphEvent.BEFORE_SIZE_CHANGE,{size:A})),this.context.canvas.resize(...A),XJ(this,new VJ(t.GraphEvent.AFTER_SIZE_CHANGE,{size:A})))}fitView(t,e){return _e(this,void 0,void 0,function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.fitView(t,e)})}fitCenter(t){return _e(this,void 0,void 0,function*(){var e;yield null===(e=this.context.viewport)||void 0===e?void 0:e.fitCenter({animation:t})})}autoFit(){return _e(this,void 0,void 0,function*(){const{autoFit:t}=this.context.options;if(t)if(ne(t))"view"===t?yield this.fitView():"center"===t&&(yield this.fitCenter());else{const{type:e,animation:n}=t;"view"===e?yield this.fitView(t.options,n):"center"===e&&(yield this.fitCenter(n))}})}focusElement(t,e){return _e(this,void 0,void 0,function*(){var n;yield null===(n=this.context.viewport)||void 0===n?void 0:n.focusElements(Array.isArray(t)?t:[t],{animation:e})})}zoomBy(t,e,n){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",scale:t,origin:n},e)})}zoomTo(t,e,n){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",scale:t,origin:n},e)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(t,e,n){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",rotate:t,origin:n},e)})}rotateTo(t,e,n){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",rotate:t,origin:n},e)})}getRotation(){return this.context.viewport.getRotation()}translateBy(t,e){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"relative",translate:t},e)})}translateTo(t,e){return _e(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:"absolute",translate:t},e)})}getPosition(){return ly([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(t,e){return _e(this,arguments,void 0,function*(t,e,n=!0){var r,i;const[A,o]=Yt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n];Object.entries(A).forEach(([t,e])=>this.context.model.translateNodeLikeBy(t,e)),yield null===(i=this.context.element.draw({animation:o,stage:"translate"}))||void 0===i?void 0:i.finished})}translateElementTo(t,e){return _e(this,arguments,void 0,function*(t,e,n=!0){var r,i;const[A,o]=Yt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n];Object.entries(A).forEach(([t,e])=>this.context.model.translateNodeLikeTo(t,e)),yield null===(i=this.context.element.draw({animation:o,stage:"translate"}))||void 0===i?void 0:i.finished})}getElementPosition(t){return this.context.model.getElementPosition(t)}getElementRenderStyle(t){return Te(this.context.element.getElement(t).attributes,["context"])}setElementVisibility(t,e){return _e(this,arguments,void 0,function*(t,e,n=!0){var r,i;const[A,o]=Yt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n],s={nodes:[],edges:[],combos:[]};Object.entries(A).forEach(([t,e])=>{const n=this.getElementType(t);s[`${n}s`].push({id:t,style:{visibility:e}})});const{model:a,element:c}=this.context;a.preventUpdateNodeLikeHierarchy(()=>{a.updateData(s)}),yield null===(i=c.draw({animation:o,stage:"visibility"}))||void 0===i?void 0:i.finished})}showElement(t,e){return _e(this,void 0,void 0,function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(t=>[t,"visible"])),e)})}hideElement(t,e){return _e(this,void 0,void 0,function*(){const n=Array.isArray(t)?t:[t];yield this.setElementVisibility(Object.fromEntries(n.map(t=>[t,"hidden"])),e)})}getElementVisibility(t){var e,n;const r=this.context.element.getElement(t);return null!==(n=null===(e=null==r?void 0:r.style)||void 0===e?void 0:e.visibility)&&void 0!==n?n:"visible"}setElementZIndex(t,e){return _e(this,void 0,void 0,function*(){var n;const r={nodes:[],edges:[],combos:[]},i=Yt(t)?t:{[t]:e};Object.entries(i).forEach(([t,e])=>{const n=this.getElementType(t);r[`${n}s`].push({id:t,style:{zIndex:e}})});const{model:A,element:o}=this.context;A.preventUpdateNodeLikeHierarchy(()=>A.updateData(r)),yield null===(n=o.draw({animation:!1,stage:"zIndex"}))||void 0===n?void 0:n.finished})}frontElement(t){return _e(this,void 0,void 0,function*(){const e=Array.isArray(t)?t:[t],{model:n}=this.context,r={};e.map(t=>{const e=n.getFrontZIndex(t);if("combo"===n.getElementType(t)){const i=n.getAncestorsData(t,Yv).at(-1)||this.getComboData(t),A=[i,...n.getDescendantsData(Vm(i))],o=e-qJ(i);A.forEach(t=>{r[Vm(t)]=this.getElementZIndex(Vm(t))+o});const{internal:s}=gb(A.map(Vm),t=>n.getRelatedEdgesData(t));s.forEach(t=>{const e=Vm(t);r[e]=this.getElementZIndex(e)+o})}else r[t]=e}),yield this.setElementZIndex(r)})}getElementZIndex(t){return qJ(this.context.model.getElementDataById(t))}setElementState(t,e){return _e(this,arguments,void 0,function*(t,e,n=!0){var r,i;const[A,o]=Yt(t)?[t,null===(r=e)||void 0===r||r]:[{[t]:e},n],s={nodes:[],edges:[],combos:[]};Object.entries(A).forEach(([t,e])=>{const n=this.getElementType(t);var r;s[`${n}s`].push({id:t,states:(r=e,r?Array.isArray(r)?r:[r]:[])})}),this.updateData(s),yield null===(i=this.context.element.draw({animation:o,stage:"state"}))||void 0===i?void 0:i.finished})}getElementState(t){return this.context.model.getElementState(t)}getElementRenderBounds(t){return this.context.element.getElement(t).getRenderBounds()}collapseElement(t){return _e(this,arguments,void 0,function*(t,e=!0){const{model:n,element:r}=this.context;if(nw(n.getNodeLikeData([t])[0]))return;if(this.isCollapsingExpanding)return;"boolean"==typeof e&&(e={animation:e,align:!1});const i=n.getElementType(t);yield this.frontElement(t),this.isCollapsingExpanding=!0,n.updateData("node"===i?{nodes:[{id:t,style:{collapsed:!0}}]}:{combos:[{id:t,style:{collapsed:!0}}]}),"node"===i?yield r.collapseNode(t,e):"combo"===i&&(yield r.collapseCombo(t,!!e.animation)),this.isCollapsingExpanding=!1})}expandElement(t){return _e(this,arguments,void 0,function*(t,e=!0){const{model:n,element:r}=this.context;if(!nw(n.getNodeLikeData([t])[0]))return;if(this.isCollapsingExpanding)return;"boolean"==typeof e&&(e={animation:e,align:!1});const i=n.getElementType(t);this.isCollapsingExpanding=!0,n.updateData("node"===i?{nodes:[{id:t,style:{collapsed:!1}}]}:{combos:[{id:t,style:{collapsed:!1}}]}),"node"===i?yield r.expandNode(t,e):"combo"===i&&(yield r.expandCombo(t,!!e.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(t,e){const n=this.getElementType(t);"node"===n?this.updateNodeData([{id:t,style:{collapsed:e}}]):"combo"===n&&this.updateComboData([{id:t,style:{collapsed:e}}])}toDataURL(){return _e(this,arguments,void 0,function*(t={}){return this.context.canvas.toDataURL(t)})}getCanvasByViewport(t){return this.context.canvas.getCanvasByViewport(t)}getViewportByCanvas(t){return this.context.canvas.getViewportByCanvas(t)}getClientByCanvas(t){return this.context.canvas.getClientByCanvas(t)}getCanvasByClient(t){return this.context.canvas.getCanvasByClient(t)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(t,e,n){return super.on(t,e,n)}once(t,e){return super.once(t,e)}off(t,e){return super.off(t,e)}}f$.defaultOptions={autoResize:!1,theme:"light",rotation:0,zoom:1,zoomRange:[.01,10]};const g$=(t,e)=>{const{source:n,target:r}=e,i=t.getElementDataById(n),A=t.getElementDataById(r),o=pb(i,e=>t.getParentData(e,Yv)),s=pb(A,e=>t.getParentData(e,Yv)),a={sourceNode:Vm(o),targetNode:Vm(s)};return e.style?Object.assign(e.style,a):e.style=a,e};class p$ extends kJ{constructor(t,e){super(t,xe({},p$.defaultOptions,e)),this.assignSizeByCentrality=(t,e,n,r,i,A)=>{const o=[e,n],s=[r[0],i[0]],a=[r[1],i[1]],c=[r[2],i[2]],l=(t,e)=>{if("function"==typeof A)return A(t,o,e);switch(A){case"linear":return((t,e,n)=>{const[r,i]=e,[A,o]=n;return i===r?A:A+(t-r)/(i-r)*(o-A)})(t,o,e);case"log":return((t,e,n)=>{const[r,i]=e,[A,o]=n;return A+Math.log(t-r+1)/Math.log(i-r+1)*(o-A)})(t,o,e);case"pow":return((t,e,n,r=2)=>{const[i,A]=e,[o,s]=n;return o+Math.pow((t-i)/(A-i),r)*(s-o)})(t,o,e,2);case"sqrt":return((t,e,n)=>{const[r,i]=e,[A,o]=n;return A+Math.sqrt((t-r)/(i-r))*(o-A)})(t,o,e);default:return e[0]}};return[l(t,s),l(t,a),l(t,c)]}}beforeDraw(t){const{model:e}=this.context,n=e.getNodeData(),r=aw(this.options.maxSize),i=aw(this.options.minSize),A=this.getCentralities(this.options.centrality),o=A.size>0?Math.max(...A.values()):0,s=A.size>0?Math.min(...A.values()):0;return n.forEach(e=>{var n;const a=this.assignSizeByCentrality(A.get(Vm(e))||0,s,o,i,r,this.options.scale),c=null===(n=this.context.element)||void 0===n?void 0:n.getElement(Vm(e)),l={size:a};this.assignLabelStyle(l,a,e,c),c&&SJ(l,c.attributes)||QJ(t,c?"update":"add","node",xe(e,{style:l}),!0)}),t}assignLabelStyle(t,e,n,r){var i;const A=r?r.config.style:null===(i=this.context.element)||void 0===i?void 0:i.getElementComputedStyle("node",n);if(Object.assign(t,Ue(A,["labelFontSize","labelLineHeight"])),this.options.mapLabelSize){const n=this.getLabelSizeByNodeSize(e,1/0,Number(t.labelFontSize));Object.assign(t,{labelFontSize:n,labelLineHeight:n+ym(t.labelPadding)})}return t}getLabelSizeByNodeSize(t,e,n){const r=Math.min(...t)/2,[i,A]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,e];return Math.min(A,Math.max(r,i))}getCentralities(t){const{model:e}=this.context,n=e.getData();if("function"==typeof t)return t(n);const r=e.getRelatedEdgesData.bind(e);return Ym(n,r,t)}}p$.defaultOptions={centrality:{type:"degree"},maxSize:80,minSize:20,scale:"linear",mapLabelSize:!1};class v$ extends kJ{constructor(t,e){super(t,Object.assign({},v$.defaultOptions,e))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var t;const e=My(this.ref),{graph:n,model:r}=this.context;null===(t=r.getData().nodes)||void 0===t||t.forEach(t=>{var i;if(Vm(t)===Vm(this.ref))return;const A=by(ly(My(t),e)),o=Math.abs(A)>Math.PI/2,s=!t.children||0===t.children.length,a=Vm(t),c=null===(i=this.context.element)||void 0===i?void 0:i.getElement(a);if(!c||!c.isVisible())return;const l=(s?1:-1)*(aw(n.getElementRenderStyle(a).size)[0]/2+this.options.offset),u=[["translate",l*Math.cos(A),l*Math.sin(A)],["rotate",o?Lr(A)+180:Lr(A)]];r.updateNodeData([{id:Vm(t),style:{labelTextAlign:o===s?"right":"left",labelTextBaseline:"middle",labelTransform:u}}])}),n.draw()}}v$.defaultOptions={offset:5};const m$=["top","top-right","right","right-bottom","bottom","bottom-left","left","left-top"];class y$ extends kJ{constructor(t,e){super(t,Object.assign({},y$.defaultOptions,e)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=t=>{const{add:{edges:e},update:{nodes:n,edges:r,combos:i},remove:{edges:A}}=t,{model:o}=this.context,s=new Map,a=(t,e)=>{o.getRelatedEdgesData(e).forEach(t=>!s.has(Vm(t))&&s.set(Vm(t),t))};n.forEach(a),i.forEach(a);const c=e=>{const n=new Set(t.remove.edges.keys()),r=o.getEdgeData().filter(t=>!n.has(Vm(t))).map(t=>g$(o,t));B$(e,r).forEach(t=>{const e=Vm(t);s.has(e)||s.set(e,t)})};if(A.size&&A.forEach(c),e.size&&e.forEach(c),r.size){const t=nz(ez(o.getChanges())).update.edges;r.forEach(e=>{var n;c(e);const r=null===(n=t.find(t=>Vm(t.value)===Vm(e)))||void 0===n?void 0:n.original;r&&!b$(e,r)&&c(r)})}Fe(this.options.edges)||s.forEach((t,e)=>!this.options.edges.includes(e)&&s.delete(e));const l=o.getEdgeData().map(Vm);return new Map([...s].sort((t,e)=>l.indexOf(t[0])-l.indexOf(e[0])))},this.applyBundlingStyle=(t,e,n)=>{const{edgeMap:r,reverses:i}=w$(e);r.forEach(e=>{e.forEach((e,r,A)=>{var o;const s=A.length,a=e.style||{};if(e.source===e.target){const t=m$.length;a.loopPlacement=m$[r%t],a.loopDist=Math.floor(r/t)*n+50}else if(1===s)a.curveOffset=0;else{const t=(r%2==0?1:-1)*(i[`${e.source}|${e.target}|${r}`]?-1:1);a.curveOffset=s%2==1?t*Math.ceil(r/2)*n*2:t*(Math.floor(r/2)*n*2+n)}const c=Object.assign(e,{type:"quadratic",style:a}),l=null===(o=this.context.element)||void 0===o?void 0:o.getElement(Vm(e));l&&SJ(c.style,l.attributes)||QJ(t,l?"update":"add","edge",c,!0)})})},this.resetEdgeStyle=t=>{const e=t.style||{},n=this.cacheMergeStyle.get(Vm(t))||{};return Object.keys(n).forEach(r=>{Me(e[r],n[r])&&(t[r]?e[r]=t[r]:delete e[r])}),Object.assign(t,{style:e})},this.applyMergingStyle=(t,e)=>{const{edgeMap:n,reverses:r}=w$(e);n.forEach(e=>{var n;if(1===e.length){const r=e[0],i=null===(n=this.context.element)||void 0===n?void 0:n.getElement(Vm(r)),A=this.resetEdgeStyle(r);return void(i&&SJ(A,i.attributes)||QJ(t,i?"update":"add","edge",A))}const i=e.map(({source:t,target:e,style:n={}},i)=>{const{startArrow:A,endArrow:o}=n,s={},[a,c]=r[`${t}|${e}|${i}`]?["endArrow","startArrow"]:["startArrow","endArrow"];return fe(A)&&(s[a]=A),fe(o)&&(s[c]=o),s}).reduce((t,e)=>Object.assign(Object.assign({},t),e),{});e.forEach((e,n,r)=>{var A;if(0!==n)return void QJ(t,"remove","edge",e);const o=Object.assign({},Vt(this.options.style)?this.options.style(r):this.options.style,{childrenData:r});this.cacheMergeStyle.set(Vm(e),o);const s=Object.assign(Object.assign({},e),{type:"line",style:Object.assign(Object.assign(Object.assign({},e.style),i),o)}),a=null===(A=this.context.element)||void 0===A?void 0:A.getElement(Vm(e));a&&SJ(s.style,a.attributes)||QJ(t,a?"update":"add","edge",s,!0)})})}}beforeDraw(t){const e=this.getAffectedParallelEdges(t);return 0===e.size||("bundle"===this.options.mode?this.applyBundlingStyle(t,e,this.options.distance):this.applyMergingStyle(t,e)),t}}y$.defaultOptions={mode:"bundle",distance:15};const w$=t=>{const e=new Map,n=new Set,r={},i=new Map;for(const[A,o]of t){if(n.has(A))continue;const{source:s,target:a}=o,c=`${s}-${a}`;e.has(c)||(e.set(c,[]),i.set(c,new Set));const l=e.get(c),u=i.get(c);l&&u&&!u.has(A)&&(l.push(o),u.add(A),n.add(A));for(const[l,u]of t)if(!n.has(l)&&l!==A&&b$(o,u)){const t=e.get(c),A=i.get(c);t&&A&&!A.has(l)&&(t.push(u),A.add(l),s===u.target&&a===u.source&&(r[`${u.source}|${u.target}|${t.length-1}`]=!0),n.add(l))}}return{edgeMap:e,reverses:r}},B$=(t,e,n)=>e.filter(e=>b$(e,t)),b$=(t,e)=>{const{sourceNode:n,targetNode:r}=t.style||{},{sourceNode:i,targetNode:A}=e.style||{};return n===i&&r===A||n===A&&r===i};const E$={animation:{"combo-collapse":fm,"combo-expand":gm,"node-collapse":lm,"node-expand":um,"path-in":hm,"path-out":dm,fade:[{fields:["opacity"]}],translate:[{fields:["x","y"]}]},behavior:{"brush-select":Wy,"click-select":ew,"collapse-expand":$b,"create-edge":oE,"drag-canvas":sE,"drag-element-force":yE,"drag-element":aE,"fix-element-size":wE,"focus-element":BE,"hover-activate":bE,"lasso-select":EE,"auto-adapt-label":sy,"optimize-viewport-transform":xE,"scroll-canvas":CE,"zoom-canvas":FE},combo:{circle:WB,rect:YB},edge:{cubic:wb,line:xb,polyline:Ib,quadratic:Lb,"cubic-horizontal":Bb,"cubic-radial":bb,"cubic-vertical":Eb},layout:{"antv-dagre":vF,"combo-combined":nk,"compact-box":WE,"d3-force":jk,"force-atlas2":nj,circular:BF,concentric:CF,dagre:ZK,dendrogram:tx,fishbone:zj,force:YF,fruchterman:ij,grid:oj,indented:ox,mds:qM,mindmap:dx,radial:vj,random:xj,snake:qj},node:{circle:Tw,diamond:Nw,ellipse:Pw,hexagon:Rw,html:_B,image:GB,rect:KB,star:jB,donut:Iw,triangle:VB},palette:{spectral:["rgb(158, 1, 66)","rgb(213, 62, 79)","rgb(244, 109, 67)","rgb(253, 174, 97)","rgb(254, 224, 139)","rgb(255, 255, 191)","rgb(230, 245, 152)","rgb(171, 221, 164)","rgb(102, 194, 165)","rgb(50, 136, 189)","rgb(94, 79, 162)"],tableau:["rgb(78, 121, 167)","rgb(242, 142, 44)","rgb(225, 87, 89)","rgb(118, 183, 178)","rgb(89, 161, 79)","rgb(237, 201, 73)","rgb(175, 122, 161)","rgb(255, 157, 167)","rgb(156, 117, 95)","rgb(186, 176, 171)"],oranges:["rgb(255, 245, 235)","rgb(254, 230, 206)","rgb(253, 208, 162)","rgb(253, 174, 107)","rgb(253, 141, 60)","rgb(241, 105, 19)","rgb(217, 72, 1)","rgb(166, 54, 3)","rgb(127, 39, 4)"],greens:["rgb(247, 252, 245)","rgb(229, 245, 224)","rgb(199, 233, 192)","rgb(161, 217, 155)","rgb(116, 196, 118)","rgb(65, 171, 93)","rgb(35, 139, 69)","rgb(0, 109, 44)","rgb(0, 68, 27)"],blues:["rgb(247, 251, 255)","rgb(222, 235, 247)","rgb(198, 219, 239)","rgb(158, 202, 225)","rgb(107, 174, 214)","rgb(66, 146, 198)","rgb(33, 113, 181)","rgb(8, 81, 156)","rgb(8, 48, 107)"]},theme:{dark:FJ,light:MJ},plugin:{"bubble-sets":DV,"edge-bundling":_V,"edge-filter-lens":qV,"grid-line":tz,background:tV,contextmenu:HV,fisheye:JV,fullscreen:$V,history:Az,hull:Rz,legend:qZ,minimap:ZZ,snapline:eJ,timebar:AJ,title:gJ,toolbar:vJ,tooltip:mJ,watermark:BJ},transform:{"arrange-draw-order":class extends kJ{beforeDraw(t){const{model:e}=this.context,n=t.add.combos,r=t=>{const n=[];return t.forEach((t,r)=>{const i=e.getAncestorsData(r,"combo").map(t=>Vm(t)).reverse();n.push([r,t,i.length])}),new Map(n.sort(([,,t],[,,e])=>e-t).map(([t,e])=>[t,e]))};return t.add.combos=r(n),t.update.combos=r(t.update.combos),t}},"collapse-expand-combo":class extends kJ{beforeDraw(t,e){if("visibility"===e.stage)return t;if(!this.context.model.model.hasTreeStructure(Yv))return t;const{model:n}=this.context,{add:r,update:i}=t,A=[...t.update.combos.entries(),...t.add.combos.entries()];for(;A.length;){const[e,o]=A.pop();if(nw(o)){const o=n.getDescendantsData(e),s=o.map(Vm),{internal:a,external:c}=gb(s,t=>n.getRelatedEdgesData(t));o.forEach(e=>{const r=Vm(e),i=A.findIndex(([t])=>t===r);-1!==i&&A.splice(i,1);const o=n.getElementType(r);QJ(t,"remove",o,e)}),a.forEach(e=>QJ(t,"remove","edge",e)),c.forEach(t=>{var e;const n=Vm(t);(null===(e=this.context.element)||void 0===e?void 0:e.getElement(n))?i.edges.set(n,t):r.edges.set(n,t)})}else{const r=n.getChildrenData(e),i=r.map(Vm),{edges:o}=gb(i,t=>n.getRelatedEdgesData(t));[...r,...o].forEach(e=>{var r;const i=Vm(e),o=n.getElementType(i),s=null===(r=this.context.element)||void 0===r?void 0:r.getElement(i);QJ(t,s?"update":"add",o,e),"combo"===o&&A.push([i,e])})}}return t}},"collapse-expand-node":class extends kJ{getElement(t){return this.context.element.getElement(t)}handleExpand(t,e){if(UJ(e,"add","node",t),nw(t))return;const n=Vm(t);UJ(e,"add","node",t);this.context.model.getRelatedEdgesData(n).forEach(t=>{QJ(e,"add","edge",t)});this.context.model.getChildrenData(n).forEach(t=>{this.handleExpand(t,e)})}beforeDraw(t){const{graph:e,model:n}=this.context;if(!n.model.hasTreeStructure(Xv))return t;const{add:{nodes:r,edges:i},update:{nodes:A}}=t,o=new Map,s=new Map;r.forEach((t,e)=>{nw(t)&&o.set(e,t)}),i.forEach(t=>{if("node"!==e.getElementType(t.source))return;const n=e.getNodeData(t.source);nw(n)&&o.set(t.source,n)}),A.forEach((t,e)=>{const n=this.getElement(e);if(!n)return;const r=n.attributes.collapsed;nw(t)?r||o.set(e,t):r&&s.set(e,t)});const a=new Set;return o.forEach((e,r)=>{n.getDescendantsData(r).forEach(e=>{const r=Vm(e);if(a.has(r))return;QJ(t,"remove","node",e);n.getRelatedEdgesData(r).forEach(e=>{QJ(t,"remove","edge",e)}),a.add(r)})}),s.forEach((e,r)=>{n.getAncestorsData(r,Xv).some(nw)?QJ(t,"remove","node",e):this.handleExpand(e,t)}),t}},"get-edge-actual-ends":class extends kJ{beforeDraw(t){const{add:e,update:n}=t,{model:r}=this.context;return[...e.edges.entries(),...n.edges.entries()].forEach(([,t])=>{g$(r,t)}),t}},"map-node-size":p$,"place-radial-labels":v$,"process-parallel-edges":y$,"update-related-edges":class extends kJ{beforeDraw(t,e){const{stage:n}=e;if("visibility"===n)return t;const{model:r}=this.context,{update:{nodes:i,edges:A,combos:o}}=t,s=(t,e)=>{r.getRelatedEdgesData(e).forEach(t=>!A.has(Vm(t))&&A.set(Vm(t),t))};return i.forEach(s),o.forEach(s),t}}},shape:{circle:Ya,ellipse:Za,group:Ja,html:tc,image:xw,line:rc,path:Ac,polygon:sc,polyline:cc,rect:lc,text:hc,label:mw,badge:yw}};Object.entries(E$).forEach(([t,e])=>{Object.entries(e).forEach(([e,n])=>{NJ(t,e,n)})});t.AntVDagreLayout=vF,t.AutoAdaptLabel=sy,t.Background=tV,t.Badge=yw,t.BaseBehavior=oy,t.BaseCombo=zB,t.BaseEdge=yb,t.BaseLayout=gE,t.BaseNode=Uw,t.BasePlugin=Zj,t.BaseShape=gw,t.BaseTransform=kJ,t.BrushSelect=Wy,t.BubbleSets=DV,t.CameraSetting=class extends Zj{constructor(t,e){super(t,e),this.setOptions=t=>{const e=(t,e)=>{switch(t){case"projectionMode":return"perspective"===e?1:0;case"cameraType":return{orbiting:0,exploring:1,tracking:2}[e];case"aspect":return"number"==typeof e?e:this.getCanvasAspect();default:return e}};Object.entries({cameraType:"setType",near:"setNear",far:"setFar",fov:"setFov",aspect:"setAspect",projectionMode:"setProjectionMode",distance:"setDistance",minDistance:"setMinDistance",maxDistance:"setMaxDistance",roll:"setRoll",elevation:"setElevation",azimuth:"setAzimuth"}).forEach(([n,r])=>{const i=t[n];if(void 0!==i){const t=e(n,i);this.context.canvas.getCamera()[r](t)}})},this.bindEvents()}update(t){this.setOptions(t),super.update(t)}bindEvents(){this.context.graph.once(t.GraphEvent.BEFORE_DRAW,()=>this.setOptions(this.options))}getCanvasAspect(){const[t,e]=this.context.viewport.getCanvasSize();return t/e}},t.Canvas=RJ,t.Circle=Tw,t.CircleCombo=WB,t.CircularLayout=BF,t.ClickSelect=ew,t.CollapseExpand=$b,t.ComboCombinedLayout=nk,t.CompactBoxLayout=WE,t.ConcentricLayout=CF,t.Contextmenu=HV,t.CreateEdge=oE,t.Cubic=wb,t.CubicHorizontal=Bb,t.CubicRadial=bb,t.CubicVertical=Eb,t.D3ForceLayout=jk,t.DagreLayout=ZK,t.DendrogramLayout=tx,t.Diamond=Nw,t.Donut=Iw,t.DragCanvas=sE,t.DragElement=aE,t.DragElementForce=yE,t.EdgeBundling=_V,t.EdgeFilterLens=qV,t.Ellipse=Pw,t.FishboneLayout=zj,t.Fisheye=JV,t.FixElementSize=wE,t.FocusElement=BE,t.ForceAtlas2Layout=nj,t.ForceLayout=YF,t.FruchtermanLayout=ij,t.Fullscreen=$V,t.Graph=f$,t.GridLayout=oj,t.GridLine=tz,t.HTML=_B,t.Hexagon=Rw,t.History=Az,t.HoverActivate=bE,t.Hull=Rz,t.Icon=Qw,t.Image=GB,t.IndentedLayout=ox,t.Label=mw,t.LassoSelect=EE,t.Legend=qZ,t.Line=xb,t.MDSLayout=qM,t.MapNodeSize=p$,t.MindmapLayout=dx,t.Minimap=ZZ,t.OptimizeViewportTransform=xE,t.PlaceRadialLabels=v$,t.Polyline=Ib,t.ProcessParallelEdges=y$,t.Quadratic=Lb,t.RadialLayout=vj,t.RandomLayout=xj,t.Rect=KB,t.RectCombo=YB,t.ScrollCanvas=CE,t.Shortcut=zy,t.SnakeLayout=qj,t.Snapline=eJ,t.Star=jB,t.Timebar=AJ,t.Title=gJ,t.Toolbar=vJ,t.Tooltip=mJ,t.Triangle=VB,t.Watermark=BJ,t.ZoomCanvas=FE,t.effect=function(t,e,n){TJ.has(t)||TJ.set(t,{});const r=TJ.get(t);if(!r[e])return r[e]=n,!0;const i=r[e];return!OJ(i,n)&&(r[e]=n,!0)},t.getExtension=Jv,t.getExtensions=function(t){return Zv[t]},t.iconfont={css:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.css",js:"//at.alicdn.com/t/a/font_470089_8hnbbf8n4u8.js"},t.idOf=Vm,t.invokeLayoutMethod=vE,t.isCollapsed=nw,t.omitStyleProps=sw,t.parseSize=aw,t.positionOf=My,t.register=NJ,t.setVisibility=ry,t.subStyleProps=Aw,t.treeToGraphData=function(t,e){const{getNodeData:n=(t,e)=>{if(t.depth=e,!t.children)return t;const{children:n}=t,r=He(t,["children"]);return Object.assign(Object.assign({},r),{children:n.map(t=>t.id)})},getEdgeData:r=(t,e)=>({source:t.id,target:e.id}),getChildren:i=t=>t.children||[]}=e||{},A=[],o=[];return Zy(t,(t,e)=>{A.push(n(t,e));const s=i(t);for(const e of s)o.push(r(t,e))},t=>i(t),"TB"),{nodes:A,edges:o}},t.version=$v});
